Processing: 00_baseline_exploration/exp001_baseline
======================================================================
Evaluating TFT: 00_baseline_exploration/exp001_baseline
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/exp001_baseline/checkpoints/tft-epoch=00-val_loss=0.1371.ckpt
  Validation loss: 0.137105

Loading configuration...
Loading config from: experiments/00_baseline_exploration/exp001_baseline/config.json
Output directory: experiments/00_baseline_exploration/exp001_baseline/evaluation
Logging to: experiments/00_baseline_exploration/exp001_baseline/evaluation/evaluation_20251027_120033.log
Evaluation started at: 2025-10-27 12:00:33
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.104103
    Max: 0.177552
    Mean: 0.151518
    Std: 0.015194
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1041, max: 0.1776, mean: 0.1515
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  596 days ( 46.6%)
3. Consecutive-similarity      [WARN]  507 days ( 39.6%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    729 days ( 57.0%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 304 days ( 23.8%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0008, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-03-18 ( 114 days): WEAK_COLLAPSE        - std=0.0042, corr=-0.020, dir_acc=0.556
[UNI ] 2021-03-19 to 2021-03-30 (   8 days): UNIDIRECTIONAL       - std=0.0006, corr=+0.052, dir_acc=0.558
[WEAK] 2021-03-31 to 2021-12-02 ( 170 days): WEAK_COLLAPSE        - std=0.0032, corr=-0.086, dir_acc=0.566
[UNI ] 2021-12-03 to 2021-12-20 (  12 days): UNIDIRECTIONAL       - std=0.0016, corr=+0.229, dir_acc=0.603
[WEAK] 2021-12-21 to 2022-01-18 (  19 days): WEAK_COLLAPSE        - std=0.0020, corr=+0.196, dir_acc=0.591
[UNI ] 2022-01-19 to 2022-03-02 (  30 days): UNIDIRECTIONAL       - std=0.0035, corr=+0.278, dir_acc=0.464
[WEAK] 2022-03-03 to 2022-03-10 (   6 days): WEAK_COLLAPSE        - std=0.0015, corr=+0.245, dir_acc=0.408
[UNI ] 2022-03-11 to 2022-08-11 ( 106 days): UNIDIRECTIONAL       - std=0.0076, corr=-0.003, dir_acc=0.455
[WEAK] 2022-08-12 to 2022-10-17 (  45 days): WEAK_COLLAPSE        - std=0.0060, corr=-0.025, dir_acc=0.449
[UNI ] 2022-10-18 to 2023-02-27 (  89 days): UNIDIRECTIONAL       - std=0.0123, corr=-0.118, dir_acc=0.415
[WEAK] 2023-02-28 to 2023-04-17 (  34 days): WEAK_COLLAPSE        - std=0.0024, corr=-0.136, dir_acc=0.495
[UNI ] 2023-04-18 to 2024-02-26 ( 215 days): UNIDIRECTIONAL       - std=0.0091, corr=-0.005, dir_acc=0.549
[WEAK] 2024-02-27 to 2024-04-23 (  40 days): WEAK_COLLAPSE        - std=0.0040, corr=-0.134, dir_acc=0.571
[UNI ] 2024-04-24 to 2025-08-21 ( 331 days): UNIDIRECTIONAL       - std=0.0112, corr=+0.032, dir_acc=0.569
[UNI ] 2025-08-25 to 2025-10-06 (  30 days): UNIDIRECTIONAL       - std=0.0038, corr=-0.097, dir_acc=0.564
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    821 days ( 64.1%)
  WEAK_COLLAPSE:     429 days ( 33.5%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/exp001_baseline/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.185179
  RMSE:             1.088659
  MAE:              0.774865
  Out-of-sample RÂ²: -0.0072

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5421

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/exp001_baseline/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:00:34
======================================================================
---
Processing: 00_baseline_exploration/exp002_small
======================================================================
Evaluating TFT: 00_baseline_exploration/exp002_small
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/exp002_small/checkpoints/tft-epoch=01-val_loss=0.1552.ckpt
  Validation loss: 0.155190

Loading configuration...
Loading config from: experiments/00_baseline_exploration/exp002_small/config.json
Output directory: experiments/00_baseline_exploration/exp002_small/evaluation
Logging to: experiments/00_baseline_exploration/exp002_small/evaluation/evaluation_20251027_120035.log
Evaluation started at: 2025-10-27 12:00:35
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.048334
    Max: 0.118657
    Mean: 0.030250
    Std: 0.050884
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0483, max: 0.1187, mean: 0.0303
Negative predictions: 527/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  184 days ( 14.4%)
2. Range-based                 [WARN]  329 days ( 25.7%)
3. Consecutive-similarity      [WARN]  490 days ( 38.3%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    868 days ( 67.8%)
  Directional acc < 52%                476 days ( 37.2%)
  Combined (BOTH poor)                 311 days ( 24.3%)
  Unidirectional (>98%)        [WARN]  1016 days ( 79.4%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0064, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2020-10-28 (  19 days): WEAK_COLLAPSE        - std=0.0015, corr=+0.059, dir_acc=0.412
[UNI ] 2020-10-29 to 2021-02-16 (  73 days): UNIDIRECTIONAL       - std=0.0097, corr=-0.117, dir_acc=0.451
[DEGD] 2021-02-17 to 2021-04-05 (  33 days): DEGRADED             - std=0.0128, corr=-0.254, dir_acc=0.357
[ OK ] 2021-04-06 to 2021-04-21 (  12 days): HEALTHY              - std=0.0101, corr=+0.033, dir_acc=0.414
[ OK ] 2021-05-03 to 2021-05-11 (   7 days): HEALTHY              - std=0.0046, corr=+0.022, dir_acc=0.462
[DEGD] 2021-05-12 to 2021-06-03 (  16 days): DEGRADED             - std=0.0056, corr=-0.083, dir_acc=0.507
[UNI ] 2021-06-04 to 2021-09-22 (  77 days): UNIDIRECTIONAL       - std=0.0135, corr=-0.114, dir_acc=0.576
[DEGD] 2021-09-27 to 2021-10-25 (  20 days): DEGRADED             - std=0.0083, corr=-0.172, dir_acc=0.499
[ OK ] 2021-10-26 to 2021-11-18 (  17 days): HEALTHY              - std=0.0046, corr=-0.068, dir_acc=0.548
[DEGD] 2021-12-06 to 2021-12-13 (   6 days): DEGRADED             - std=0.0036, corr=-0.070, dir_acc=0.517
[ OK ] 2021-12-14 to 2022-02-03 (  36 days): HEALTHY              - std=0.0068, corr=-0.022, dir_acc=0.582
[ OK ] 2022-02-10 to 2022-02-18 (   7 days): HEALTHY              - std=0.0024, corr=-0.223, dir_acc=0.540
[UNI ] 2022-02-22 to 2022-06-07 (  74 days): UNIDIRECTIONAL       - std=0.0067, corr=-0.187, dir_acc=0.556
[FAIL] 2022-06-14 to 2022-07-22 (  27 days): STRONG_COLLAPSE      - std=0.0031, corr=-0.279, dir_acc=0.544
[WEAK] 2022-07-25 to 2022-09-09 (  34 days): WEAK_COLLAPSE        - std=0.0009, corr=-0.249, dir_acc=0.533
[FAIL] 2022-09-12 to 2023-01-12 (  84 days): STRONG_COLLAPSE      - std=0.0021, corr=-0.214, dir_acc=0.588
[WEAK] 2023-01-13 to 2023-02-13 (  21 days): WEAK_COLLAPSE        - std=0.0004, corr=+0.020, dir_acc=0.557
[FAIL] 2023-02-14 to 2023-04-13 (  41 days): STRONG_COLLAPSE      - std=0.0026, corr=+0.019, dir_acc=0.518
[WEAK] 2023-04-14 to 2023-05-26 (  31 days): WEAK_COLLAPSE        - std=0.0027, corr=+0.016, dir_acc=0.486
[UNI ] 2023-05-30 to 2023-06-15 (  13 days): UNIDIRECTIONAL       - std=0.0019, corr=-0.009, dir_acc=0.449
[DEGD] 2023-06-16 to 2023-07-14 (  19 days): DEGRADED             - std=0.0112, corr=+0.018, dir_acc=0.439
[ OK ] 2023-07-17 to 2023-07-28 (  10 days): HEALTHY              - std=0.0088, corr=+0.048, dir_acc=0.483
[DEGD] 2023-07-31 to 2023-09-07 (  28 days): DEGRADED             - std=0.0028, corr=-0.175, dir_acc=0.450
[UNI ] 2023-09-08 to 2023-10-26 (  34 days): UNIDIRECTIONAL       - std=0.0041, corr=-0.122, dir_acc=0.483
[WEAK] 2023-10-27 to 2023-11-09 (  10 days): WEAK_COLLAPSE        - std=0.0022, corr=-0.032, dir_acc=0.468
[UNI ] 2023-11-10 to 2024-02-22 (  70 days): UNIDIRECTIONAL       - std=0.0063, corr=+0.043, dir_acc=0.603
[WEAK] 2024-02-23 to 2024-03-01 (   6 days): WEAK_COLLAPSE        - std=0.0002, corr=+0.040, dir_acc=0.625
[FAIL] 2024-03-04 to 2024-04-12 (  29 days): STRONG_COLLAPSE      - std=0.0022, corr=+0.016, dir_acc=0.579
[UNI ] 2024-04-22 to 2024-07-25 (  66 days): UNIDIRECTIONAL       - std=0.0067, corr=+0.037, dir_acc=0.557
[UNI ] 2024-08-09 to 2025-10-02 ( 286 days): UNIDIRECTIONAL       - std=0.0208, corr=-0.075, dir_acc=0.569
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           129 days ( 10.1%)
  DEGRADED:          135 days ( 10.5%)
  UNIDIRECTIONAL:    693 days ( 54.1%)
  WEAK_COLLAPSE:     139 days ( 10.9%)
  STRONG_COLLAPSE:   184 days ( 14.4%)

  Total problematic: 1151 days (89.9%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/exp002_small/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.178172
  RMSE:             1.085436
  MAE:              0.771998
  Out-of-sample RÂ²: -0.0012

FINANCIAL METRICS:
  Directional Acc:  53.75%
  Sharpe Ratio:     0.9359
  Total Return:     64.46%
  Max Drawdown:     -18.90%
  Hit Rate:         33.12%
  Number of Trades: 753

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5631
  Recall:           0.6172
  F1 Score:         0.5889
  AUC-ROC:          0.5422

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        264             329
  Actual Up:          263             424

ALPHA (vs Buy-and-Hold):
  Excess Return:    -27.70%

======================================================================

Results saved to: experiments/00_baseline_exploration/exp002_small/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:00:37
======================================================================
---
Processing: 00_baseline_exploration/exp003_large
======================================================================
Evaluating TFT: 00_baseline_exploration/exp003_large
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/exp003_large/checkpoints/tft-epoch=00-val_loss=0.1477.ckpt
  Validation loss: 0.147677

Loading configuration...
Loading config from: experiments/00_baseline_exploration/exp003_large/config.json
Output directory: experiments/00_baseline_exploration/exp003_large/evaluation
Logging to: experiments/00_baseline_exploration/exp003_large/evaluation/evaluation_20251027_120038.log
Evaluation started at: 2025-10-27 12:00:38
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.055673
    Max: 0.132441
    Mean: 0.006923
    Std: 0.041476
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0557, max: 0.1324, mean: 0.0069
Negative predictions: 642/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  131 days ( 10.2%)
2. Range-based                 [WARN]  347 days ( 27.1%)
3. Consecutive-similarity      [WARN]  412 days ( 32.2%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    491 days ( 38.4%)
  Directional acc < 52%                967 days ( 75.5%)
  Combined (BOTH poor)                 426 days ( 33.3%)
  Unidirectional (>98%)        [WARN]   615 days ( 48.0%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0050, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2020-10-29 (  20 days): WEAK_COLLAPSE        - std=0.0034, corr=+0.162, dir_acc=0.414
[UNI ] 2020-10-30 to 2021-06-22 ( 160 days): UNIDIRECTIONAL       - std=0.0089, corr=-0.171, dir_acc=0.455
[WEAK] 2021-06-23 to 2021-08-02 (  28 days): WEAK_COLLAPSE        - std=0.0011, corr=-0.041, dir_acc=0.439
[FAIL] 2021-08-03 to 2021-11-30 (  82 days): STRONG_COLLAPSE      - std=0.0023, corr=+0.093, dir_acc=0.409
[UNI ] 2021-12-03 to 2022-01-28 (  39 days): UNIDIRECTIONAL       - std=0.0114, corr=+0.085, dir_acc=0.426
[ OK ] 2022-01-31 to 2022-04-21 (  57 days): HEALTHY              - std=0.0242, corr=+0.171, dir_acc=0.563
[UNI ] 2022-04-22 to 2023-01-25 ( 189 days): UNIDIRECTIONAL       - std=0.0358, corr=+0.143, dir_acc=0.439
[ OK ] 2023-01-30 to 2023-02-08 (   8 days): HEALTHY              - std=0.0020, corr=+0.055, dir_acc=0.431
[DEGD] 2023-02-09 to 2023-02-16 (   6 days): DEGRADED             - std=0.0010, corr=-0.024, dir_acc=0.431
[ OK ] 2023-03-14 to 2023-07-07 (  80 days): HEALTHY              - std=0.0179, corr=+0.157, dir_acc=0.536
[DEGD] 2023-07-10 to 2023-09-06 (  42 days): DEGRADED             - std=0.0035, corr=-0.050, dir_acc=0.475
[WEAK] 2023-09-07 to 2023-10-27 (  36 days): WEAK_COLLAPSE        - std=0.0045, corr=-0.054, dir_acc=0.493
[DEGD] 2023-10-30 to 2023-12-26 (  40 days): DEGRADED             - std=0.0092, corr=-0.176, dir_acc=0.485
[DEGD] 2024-01-09 to 2024-02-13 (  25 days): DEGRADED             - std=0.0009, corr=-0.140, dir_acc=0.519
[FAIL] 2024-02-20 to 2024-04-29 (  49 days): STRONG_COLLAPSE      - std=0.0026, corr=+0.014, dir_acc=0.569
[WEAK] 2024-04-30 to 2024-08-06 (  68 days): WEAK_COLLAPSE        - std=0.0045, corr=-0.132, dir_acc=0.511
[UNI ] 2024-08-07 to 2024-08-27 (  15 days): UNIDIRECTIONAL       - std=0.0163, corr=+0.229, dir_acc=0.618
[ OK ] 2024-08-28 to 2025-02-05 ( 108 days): HEALTHY              - std=0.0108, corr=+0.248, dir_acc=0.522
[DEGD] 2025-02-11 to 2025-02-24 (   9 days): DEGRADED             - std=0.0010, corr=-0.026, dir_acc=0.396
[ OK ] 2025-02-25 to 2025-03-07 (   9 days): HEALTHY              - std=0.0092, corr=+0.026, dir_acc=0.448
[ OK ] 2025-03-14 to 2025-04-08 (  18 days): HEALTHY              - std=0.0243, corr=+0.039, dir_acc=0.487
[DEGD] 2025-04-09 to 2025-04-23 (  10 days): DEGRADED             - std=0.0195, corr=-0.043, dir_acc=0.433
[ OK ] 2025-04-24 to 2025-08-12 (  76 days): HEALTHY              - std=0.0425, corr=+0.130, dir_acc=0.498
[UNI ] 2025-08-21 to 2025-08-28 (   6 days): UNIDIRECTIONAL       - std=0.0003, corr=+0.053, dir_acc=0.456
[WEAK] 2025-09-04 to 2025-10-06 (  23 days): WEAK_COLLAPSE        - std=0.0004, corr=+0.075, dir_acc=0.452
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           402 days ( 31.4%)
  DEGRADED:          155 days ( 12.1%)
  UNIDIRECTIONAL:    411 days ( 32.1%)
  WEAK_COLLAPSE:     181 days ( 14.1%)
  STRONG_COLLAPSE:   131 days ( 10.2%)

  Total problematic:  878 days (68.6%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/exp003_large/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.180435
  RMSE:             1.086478
  MAE:              0.777089
  Out-of-sample RÂ²: -0.0031

FINANCIAL METRICS:
  Directional Acc:  47.73%
  Sharpe Ratio:     0.2250
  Total Return:     11.51%
  Max Drawdown:     -25.06%
  Hit Rate:         25.62%
  Number of Trades: 638

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5141
  Recall:           0.4774
  F1 Score:         0.4951
  AUC-ROC:          0.4766

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        283             310
  Actual Up:          359             328

ALPHA (vs Buy-and-Hold):
  Excess Return:    -80.65%

======================================================================

Results saved to: experiments/00_baseline_exploration/exp003_large/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:00:39
======================================================================
---
Processing: 00_baseline_exploration/exp004_attn1
======================================================================
Evaluating TFT: 00_baseline_exploration/exp004_attn1
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/exp004_attn1/checkpoints/tft-epoch=00-val_loss=0.1191.ckpt
  Validation loss: 0.119101

Loading configuration...
Loading config from: experiments/00_baseline_exploration/exp004_attn1/config.json
Output directory: experiments/00_baseline_exploration/exp004_attn1/evaluation
Logging to: experiments/00_baseline_exploration/exp004_attn1/evaluation/evaluation_20251027_120041.log
Evaluation started at: 2025-10-27 12:00:41
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.316659
    Max: 0.416546
    Mean: 0.351856
    Std: 0.025734
    Unique values: 1278

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.3167, max: 0.4165, mean: 0.3519
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   81 days (  6.3%)
2. Range-based                 [WARN]  173 days ( 13.5%)
3. Consecutive-similarity      [WARN]  199 days ( 15.5%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    197 days ( 15.4%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                  79 days (  6.2%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0062, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2020-10-20 (  13 days): WEAK_COLLAPSE        - std=0.0013, corr=-0.067, dir_acc=0.596
[UNI ] 2020-10-21 to 2021-09-15 ( 226 days): UNIDIRECTIONAL       - std=0.0145, corr=+0.137, dir_acc=0.556
[UNI ] 2021-09-21 to 2023-08-01 ( 464 days): UNIDIRECTIONAL       - std=0.0272, corr=+0.177, dir_acc=0.485
[WEAK] 2023-08-02 to 2023-08-17 (  12 days): WEAK_COLLAPSE        - std=0.0019, corr=+0.144, dir_acc=0.562
[FAIL] 2023-08-25 to 2023-09-21 (  19 days): STRONG_COLLAPSE      - std=0.0022, corr=+0.039, dir_acc=0.518
[UNI ] 2023-09-27 to 2024-01-29 (  84 days): UNIDIRECTIONAL       - std=0.0102, corr=+0.021, dir_acc=0.547
[FAIL] 2024-01-31 to 2024-04-16 (  53 days): STRONG_COLLAPSE      - std=0.0030, corr=+0.143, dir_acc=0.600
[WEAK] 2024-04-17 to 2024-05-03 (  13 days): WEAK_COLLAPSE        - std=0.0074, corr=-0.077, dir_acc=0.501
[UNI ] 2024-05-06 to 2024-07-17 (  50 days): UNIDIRECTIONAL       - std=0.0022, corr=-0.120, dir_acc=0.557
[FAIL] 2024-07-18 to 2024-07-25 (   6 days): STRONG_COLLAPSE      - std=0.0030, corr=-0.060, dir_acc=0.644
[UNI ] 2024-07-26 to 2025-10-06 ( 298 days): UNIDIRECTIONAL       - std=0.0226, corr=+0.175, dir_acc=0.571
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:   1123 days ( 87.7%)
  WEAK_COLLAPSE:      49 days (  3.8%)
  STRONG_COLLAPSE:    78 days (  6.1%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/exp004_attn1/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.262526
  RMSE:             1.123622
  MAE:              0.809745
  Out-of-sample RÂ²: -0.0729

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4934

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/exp004_attn1/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:00:42
======================================================================
---
Processing: 00_baseline_exploration/exp005_attn4
======================================================================
Evaluating TFT: 00_baseline_exploration/exp005_attn4
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/exp005_attn4/checkpoints/tft-epoch=01-val_loss=0.1768.ckpt
  Validation loss: 0.176837

Loading configuration...
Loading config from: experiments/00_baseline_exploration/exp005_attn4/config.json
Output directory: experiments/00_baseline_exploration/exp005_attn4/evaluation
Logging to: experiments/00_baseline_exploration/exp005_attn4/evaluation/evaluation_20251027_120043.log
Evaluation started at: 2025-10-27 12:00:43
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.040436
    Max: 0.150005
    Mean: 0.081615
    Std: 0.020986
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0404, max: 0.1500, mean: 0.0816
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  231 days ( 18.0%)
3. Consecutive-similarity      [WARN]  191 days ( 14.9%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    330 days ( 25.8%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 124 days (  9.7%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0015, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-05-14 ( 154 days): WEAK_COLLAPSE        - std=0.0034, corr=+0.064, dir_acc=0.551
[UNI ] 2021-05-17 to 2024-02-27 ( 695 days): UNIDIRECTIONAL       - std=0.0181, corr=+0.092, dir_acc=0.511
[WEAK] 2024-02-28 to 2024-04-19 (  37 days): WEAK_COLLAPSE        - std=0.0050, corr=+0.127, dir_acc=0.574
[UNI ] 2024-04-22 to 2025-10-06 ( 364 days): UNIDIRECTIONAL       - std=0.0184, corr=+0.030, dir_acc=0.568
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:   1059 days ( 82.7%)
  WEAK_COLLAPSE:     191 days ( 14.9%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/exp005_attn4/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.175106
  RMSE:             1.084023
  MAE:              0.771611
  Out-of-sample RÂ²: 0.0014

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5263

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/exp005_attn4/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:00:44
======================================================================
---
Processing: 00_baseline_exploration/exp006_monthly
/Users/samufrank/.venvs/598-dl-final-py310/lib/python3.10/site-packages/numpy/core/fromnumeric.py:3715: RuntimeWarning: Degrees of freedom <= 0 for slice
  return _methods._var(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/samufrank/.venvs/598-dl-final-py310/lib/python3.10/site-packages/numpy/core/_methods.py:223: RuntimeWarning: invalid value encountered in divide
  arrmean = um.true_divide(arrmean, div, out=arrmean, casting='unsafe',
/Users/samufrank/.venvs/598-dl-final-py310/lib/python3.10/site-packages/numpy/core/_methods.py:257: RuntimeWarning: invalid value encountered in divide
  ret = ret.dtype.type(ret / rcount)
======================================================================
Evaluating TFT: 00_baseline_exploration/exp006_monthly
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/exp006_monthly/checkpoints/tft-epoch=48-val_loss=1.9104.ckpt
  Validation loss: 1.910372

Loading configuration...
Loading config from: experiments/00_baseline_exploration/exp006_monthly/config.json
Output directory: experiments/00_baseline_exploration/exp006_monthly/evaluation
Logging to: experiments/00_baseline_exploration/exp006_monthly/evaluation/evaluation_20251027_120046.log
Evaluation started at: 2025-10-27 12:00:46
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_monthly_fixed_test.csv
  Train: data/splits/fixed/core_proposal_monthly_fixed_train.csv
Test samples: 63
Preparing test dataset...
Expected test predictions: 52 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 51, Total actuals: 51

Prediction Generation Summary:
  Total predictions: 51
  Test dataset size: 51
  Test dataloader batches: 1
  Prediction statistics:
    Min: 1.042747
    Max: 1.226326
    Mean: 1.124869
    Std: 0.039392
    Unique values: 51

WARNING: Predictions (51) < Test samples (63)
Date range: 2021-08-31T00:00:00.000000000 to 2025-10-31T00:00:00.000000000

Prediction period: 2021-08-31T00:00:00.000000000 to 2025-10-31T00:00:00.000000000 (51 samples)
Computing metrics...
Predictions - min: 1.0427, max: 1.2263, mean: 1.1249
Negative predictions: 0/51
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [ OK ]    0 days (  0.0%)
3. Consecutive-similarity      [ OK ]    0 days (  0.0%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                     21 days ( 41.2%)
  Directional acc < 52%                  0 days (  0.0%)
  Combined (BOTH poor)                   0 days (  0.0%)
  Unidirectional (>98%)        [WARN]    21 days ( 41.2%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2021-08-31 to 2024-01-31 (  30 days): HEALTHY              - std=0.0383, corr=+0.000, dir_acc=0.500
[UNI ] 2024-02-29 to 2025-10-31 (  21 days): UNIDIRECTIONAL       - std=0.0282, corr=-0.129, dir_acc=0.604
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            30 days ( 58.8%)
  DEGRADED:            0 days (  0.0%)
  UNIDIRECTIONAL:     21 days ( 41.2%)
  WEAK_COLLAPSE:       0 days (  0.0%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic:   21 days (41.2%)
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/exp006_monthly/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              21.188587
  RMSE:             4.603106
  MAE:              3.803275
  Out-of-sample RÂ²: -0.0032

FINANCIAL METRICS:
  Directional Acc:  62.75%
  Sharpe Ratio:     3.2745
  Total Return:     53.35%
  Max Drawdown:     -24.77%
  Hit Rate:         62.75%
  Number of Trades: 51

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.6275
  Recall:           1.0000
  F1 Score:         0.7711
  AUC-ROC:          0.5033

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0              19
  Actual Up:            0              32

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/exp006_monthly/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:00:46
======================================================================
---
Processing: 00_baseline_exploration/sweep_baseline
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep_baseline
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep_baseline/checkpoints/tft-epoch=00-val_loss=0.1370.ckpt
  Validation loss: 0.137026

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep_baseline/config.json
Output directory: experiments/00_baseline_exploration/sweep_baseline/evaluation
Logging to: experiments/00_baseline_exploration/sweep_baseline/evaluation/evaluation_20251027_120048.log
Evaluation started at: 2025-10-27 12:00:48
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.103587
    Max: 0.177104
    Mean: 0.151069
    Std: 0.015213
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1036, max: 0.1771, mean: 0.1511
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  597 days ( 46.6%)
3. Consecutive-similarity      [WARN]  507 days ( 39.6%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    730 days ( 57.0%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 304 days ( 23.8%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0008, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-03-18 ( 114 days): WEAK_COLLAPSE        - std=0.0042, corr=-0.020, dir_acc=0.556
[UNI ] 2021-03-19 to 2021-03-30 (   8 days): UNIDIRECTIONAL       - std=0.0006, corr=+0.052, dir_acc=0.558
[WEAK] 2021-03-31 to 2021-12-02 ( 170 days): WEAK_COLLAPSE        - std=0.0032, corr=-0.087, dir_acc=0.566
[UNI ] 2021-12-03 to 2021-12-20 (  12 days): UNIDIRECTIONAL       - std=0.0016, corr=+0.229, dir_acc=0.603
[WEAK] 2021-12-21 to 2022-01-18 (  19 days): WEAK_COLLAPSE        - std=0.0020, corr=+0.196, dir_acc=0.591
[UNI ] 2022-01-19 to 2022-03-02 (  30 days): UNIDIRECTIONAL       - std=0.0035, corr=+0.277, dir_acc=0.464
[WEAK] 2022-03-03 to 2022-03-10 (   6 days): WEAK_COLLAPSE        - std=0.0015, corr=+0.243, dir_acc=0.408
[UNI ] 2022-03-11 to 2022-08-11 ( 106 days): UNIDIRECTIONAL       - std=0.0076, corr=-0.003, dir_acc=0.455
[WEAK] 2022-08-12 to 2022-10-17 (  45 days): WEAK_COLLAPSE        - std=0.0060, corr=-0.025, dir_acc=0.449
[UNI ] 2022-10-18 to 2023-02-27 (  89 days): UNIDIRECTIONAL       - std=0.0124, corr=-0.118, dir_acc=0.415
[WEAK] 2023-02-28 to 2023-04-17 (  34 days): WEAK_COLLAPSE        - std=0.0024, corr=-0.136, dir_acc=0.495
[UNI ] 2023-04-18 to 2024-02-26 ( 215 days): UNIDIRECTIONAL       - std=0.0091, corr=-0.005, dir_acc=0.549
[WEAK] 2024-02-27 to 2024-04-23 (  40 days): WEAK_COLLAPSE        - std=0.0040, corr=-0.135, dir_acc=0.571
[UNI ] 2024-04-24 to 2025-08-21 ( 331 days): UNIDIRECTIONAL       - std=0.0112, corr=+0.032, dir_acc=0.569
[UNI ] 2025-08-25 to 2025-10-06 (  30 days): UNIDIRECTIONAL       - std=0.0038, corr=-0.098, dir_acc=0.564
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    821 days ( 64.1%)
  WEAK_COLLAPSE:     429 days ( 33.5%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep_baseline/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.185095
  RMSE:             1.088621
  MAE:              0.774826
  Out-of-sample RÂ²: -0.0071

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5422

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep_baseline/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:00:49
======================================================================
---
Processing: 00_baseline_exploration/sweep_combo1
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep_combo1
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep_combo1/checkpoints/tft-epoch=01-val_loss=0.1494.ckpt
  Validation loss: 0.149419

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep_combo1/config.json
Output directory: experiments/00_baseline_exploration/sweep_combo1/evaluation
Logging to: experiments/00_baseline_exploration/sweep_combo1/evaluation/evaluation_20251027_120050.log
Evaluation started at: 2025-10-27 12:00:50
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1241 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1240, Total actuals: 1240

Prediction Generation Summary:
  Total predictions: 1240
  Test dataset size: 1240
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.061476
    Max: 0.147021
    Mean: 0.120703
    Std: 0.023861
    Unique values: 1239

WARNING: Predictions (1240) < Test samples (1300)
Date range: 2020-10-16T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-10-16T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1240 samples)
Computing metrics...
Predictions - min: 0.0615, max: 0.1470, mean: 0.1207
Negative predictions: 0/1240
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   45 days (  3.6%)
2. Range-based                 [WARN]  878 days ( 70.8%)
3. Consecutive-similarity      [WARN] 1167 days ( 94.1%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    678 days ( 54.7%)
  Directional acc < 52%                470 days ( 37.9%)
  Combined (BOTH poor)                 271 days ( 21.9%)
  Unidirectional (>98%)        [WARN]  1210 days ( 97.6%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-10-16 to 2020-11-27 (  29 days): HEALTHY              - std=0.0014, corr=+0.000, dir_acc=0.500
[WEAK] 2020-12-01 to 2021-08-09 ( 173 days): WEAK_COLLAPSE        - std=0.0023, corr=-0.089, dir_acc=0.548
[FAIL] 2021-08-10 to 2021-08-20 (   9 days): STRONG_COLLAPSE      - std=0.0010, corr=+0.149, dir_acc=0.604
[FAIL] 2021-08-24 to 2021-10-06 (  31 days): STRONG_COLLAPSE      - std=0.0010, corr=+0.165, dir_acc=0.591
[WEAK] 2021-10-07 to 2022-01-13 (  67 days): WEAK_COLLAPSE        - std=0.0014, corr=-0.105, dir_acc=0.594
[WEAK] 2022-01-24 to 2022-03-07 (  30 days): WEAK_COLLAPSE        - std=0.0047, corr=-0.085, dir_acc=0.454
[UNI ] 2022-03-08 to 2022-07-26 (  97 days): UNIDIRECTIONAL       - std=0.0117, corr=-0.057, dir_acc=0.451
[WEAK] 2022-07-27 to 2023-01-23 ( 122 days): WEAK_COLLAPSE        - std=0.0054, corr=-0.203, dir_acc=0.428
[UNI ] 2023-01-24 to 2023-04-28 (  67 days): UNIDIRECTIONAL       - std=0.0070, corr=-0.003, dir_acc=0.481
[WEAK] 2023-05-01 to 2023-06-12 (  30 days): WEAK_COLLAPSE        - std=0.0043, corr=+0.105, dir_acc=0.521
[UNI ] 2023-06-13 to 2023-09-19 (  68 days): UNIDIRECTIONAL       - std=0.0067, corr=-0.005, dir_acc=0.546
[WEAK] 2023-09-20 to 2025-05-12 ( 409 days): WEAK_COLLAPSE        - std=0.0043, corr=+0.057, dir_acc=0.562
[UNI ] 2025-05-13 to 2025-10-06 ( 101 days): UNIDIRECTIONAL       - std=0.0102, corr=-0.090, dir_acc=0.587
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    333 days ( 26.9%)
  WEAK_COLLAPSE:     832 days ( 67.1%)
  STRONG_COLLAPSE:    45 days (  3.6%)

  Total problematic: 1211 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep_combo1/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.166891
  RMSE:             1.080227
  MAE:              0.764935
  Out-of-sample RÂ²: -0.0031

FINANCIAL METRICS:
  Directional Acc:  53.55%
  Sharpe Ratio:     0.8480
  Total Return:     90.07%
  Max Drawdown:     -25.25%
  Hit Rate:         53.55%
  Number of Trades: 1240

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5355
  Recall:           1.0000
  F1 Score:         0.6975
  AUC-ROC:          0.5376

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             576
  Actual Up:            0             664

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep_combo1/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:00:52
======================================================================
---
Processing: 00_baseline_exploration/sweep_combo2
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep_combo2
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep_combo2/checkpoints/tft-epoch=01-val_loss=0.1386.ckpt
  Validation loss: 0.138556

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep_combo2/config.json
Output directory: experiments/00_baseline_exploration/sweep_combo2/evaluation
Logging to: experiments/00_baseline_exploration/sweep_combo2/evaluation/evaluation_20251027_120053.log
Evaluation started at: 2025-10-27 12:00:53
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1261 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1260, Total actuals: 1260

Prediction Generation Summary:
  Total predictions: 1260
  Test dataset size: 1260
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.032901
    Max: 0.150682
    Mean: 0.030760
    Std: 0.040943
    Unique values: 1260

WARNING: Predictions (1260) < Test samples (1300)
Date range: 2020-09-17T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-09-17T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1260 samples)
Computing metrics...
Predictions - min: -0.0329, max: 0.1507, mean: 0.0308
Negative predictions: 327/1260
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   92 days (  7.3%)
2. Range-based                 [WARN]  490 days ( 38.9%)
3. Consecutive-similarity      [WARN]  539 days ( 42.8%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    498 days ( 39.5%)
  Directional acc < 52%                703 days ( 55.8%)
  Combined (BOTH poor)                 329 days ( 26.1%)
  Unidirectional (>98%)        [WARN]  1139 days ( 90.4%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-09-17 to 2020-10-28 (  29 days): HEALTHY              - std=0.0011, corr=+0.000, dir_acc=0.500
[WEAK] 2020-11-02 to 2021-01-20 (  53 days): WEAK_COLLAPSE        - std=0.0030, corr=-0.347, dir_acc=0.471
[UNI ] 2021-01-21 to 2021-06-08 (  96 days): UNIDIRECTIONAL       - std=0.0082, corr=-0.214, dir_acc=0.452
[WEAK] 2021-06-09 to 2021-08-19 (  51 days): WEAK_COLLAPSE        - std=0.0016, corr=-0.047, dir_acc=0.438
[FAIL] 2021-08-20 to 2021-11-02 (  51 days): STRONG_COLLAPSE      - std=0.0022, corr=+0.134, dir_acc=0.411
[WEAK] 2021-11-03 to 2021-12-08 (  24 days): WEAK_COLLAPSE        - std=0.0051, corr=-0.075, dir_acc=0.404
[DEGD] 2021-12-09 to 2022-01-26 (  33 days): DEGRADED             - std=0.0049, corr=+0.012, dir_acc=0.416
[ OK ] 2022-01-27 to 2022-03-11 (  31 days): HEALTHY              - std=0.0195, corr=+0.080, dir_acc=0.561
[ OK ] 2022-03-15 to 2022-04-20 (  26 days): HEALTHY              - std=0.0086, corr=+0.169, dir_acc=0.537
[UNI ] 2022-04-21 to 2023-09-19 ( 353 days): UNIDIRECTIONAL       - std=0.0440, corr=+0.106, dir_acc=0.474
[WEAK] 2023-09-20 to 2023-12-22 (  66 days): WEAK_COLLAPSE        - std=0.0061, corr=-0.105, dir_acc=0.513
[WEAK] 2024-01-02 to 2024-03-13 (  50 days): WEAK_COLLAPSE        - std=0.0009, corr=-0.102, dir_acc=0.632
[FAIL] 2024-03-14 to 2024-05-08 (  39 days): STRONG_COLLAPSE      - std=0.0023, corr=+0.068, dir_acc=0.537
[WEAK] 2024-05-09 to 2024-08-08 (  63 days): WEAK_COLLAPSE        - std=0.0037, corr=-0.153, dir_acc=0.578
[UNI ] 2024-08-09 to 2025-09-04 ( 266 days): UNIDIRECTIONAL       - std=0.0243, corr=+0.091, dir_acc=0.569
[WEAK] 2025-09-05 to 2025-10-06 (  22 days): WEAK_COLLAPSE        - std=0.0010, corr=+0.108, dir_acc=0.567
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            86 days (  6.8%)
  DEGRADED:           34 days (  2.7%)
  UNIDIRECTIONAL:    719 days ( 57.1%)
  WEAK_COLLAPSE:     330 days ( 26.2%)
  STRONG_COLLAPSE:    91 days (  7.2%)

  Total problematic: 1174 days (93.2%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep_combo2/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.169992
  RMSE:             1.081662
  MAE:              0.772383
  Out-of-sample RÂ²: -0.0027

FINANCIAL METRICS:
  Directional Acc:  51.03%
  Sharpe Ratio:     0.6294
  Total Return:     53.67%
  Max Drawdown:     -22.58%
  Hit Rate:         39.29%
  Number of Trades: 933

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5305
  Recall:           0.7344
  F1 Score:         0.6161
  AUC-ROC:          0.4686

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        148             438
  Actual Up:          179             495

ALPHA (vs Buy-and-Hold):
  Excess Return:    -38.74%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep_combo2/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:00:55
======================================================================
---
Processing: 00_baseline_exploration/sweep_combo3
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep_combo3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep_combo3/checkpoints/tft-epoch=00-val_loss=0.1478.ckpt
  Validation loss: 0.147792

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep_combo3/config.json
Output directory: experiments/00_baseline_exploration/sweep_combo3/evaluation
Logging to: experiments/00_baseline_exploration/sweep_combo3/evaluation/evaluation_20251027_120056.log
Evaluation started at: 2025-10-27 12:00:56
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1241 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1240, Total actuals: 1240

Prediction Generation Summary:
  Total predictions: 1240
  Test dataset size: 1240
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.171516
    Max: 0.247286
    Mean: 0.208035
    Std: 0.016157
    Unique values: 1240

WARNING: Predictions (1240) < Test samples (1300)
Date range: 2020-10-16T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-10-16T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1240 samples)
Computing metrics...
Predictions - min: 0.1715, max: 0.2473, mean: 0.2080
Negative predictions: 0/1240
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]  112 days (  9.0%)
2. Range-based                 [WARN]  558 days ( 45.0%)
3. Consecutive-similarity      [WARN]  373 days ( 30.1%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    642 days ( 51.8%)
  Directional acc < 52%                470 days ( 37.9%)
  Combined (BOTH poor)                 245 days ( 19.8%)
  Unidirectional (>98%)        [WARN]  1210 days ( 97.6%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-10-16 to 2020-11-27 (  29 days): HEALTHY              - std=0.0023, corr=+0.000, dir_acc=0.500
[FAIL] 2020-12-01 to 2020-12-08 (   6 days): STRONG_COLLAPSE      - std=0.0006, corr=-0.262, dir_acc=0.552
[WEAK] 2020-12-09 to 2020-12-30 (  15 days): WEAK_COLLAPSE        - std=0.0006, corr=-0.172, dir_acc=0.520
[FAIL] 2020-12-31 to 2021-03-10 (  47 days): STRONG_COLLAPSE      - std=0.0025, corr=+0.039, dir_acc=0.558
[WEAK] 2021-03-11 to 2021-05-12 (  44 days): WEAK_COLLAPSE        - std=0.0033, corr=-0.036, dir_acc=0.543
[UNI ] 2021-05-13 to 2021-05-20 (   6 days): UNIDIRECTIONAL       - std=0.0015, corr=-0.033, dir_acc=0.525
[WEAK] 2021-05-21 to 2021-06-23 (  23 days): WEAK_COLLAPSE        - std=0.0022, corr=+0.012, dir_acc=0.538
[FAIL] 2021-06-24 to 2021-07-09 (  11 days): STRONG_COLLAPSE      - std=0.0012, corr=-0.108, dir_acc=0.558
[WEAK] 2021-07-12 to 2021-08-13 (  25 days): WEAK_COLLAPSE        - std=0.0019, corr=-0.243, dir_acc=0.569
[WEAK] 2021-08-18 to 2021-09-15 (  20 days): WEAK_COLLAPSE        - std=0.0024, corr=-0.322, dir_acc=0.620
[UNI ] 2021-09-16 to 2022-03-14 ( 122 days): UNIDIRECTIONAL       - std=0.0040, corr=+0.073, dir_acc=0.544
[UNI ] 2022-03-16 to 2022-04-04 (  14 days): UNIDIRECTIONAL       - std=0.0036, corr=+0.071, dir_acc=0.430
[UNI ] 2022-04-06 to 2022-06-09 (  45 days): UNIDIRECTIONAL       - std=0.0029, corr=+0.103, dir_acc=0.459
[WEAK] 2022-06-10 to 2022-07-11 (  20 days): WEAK_COLLAPSE        - std=0.0039, corr=+0.099, dir_acc=0.454
[UNI ] 2022-07-12 to 2022-08-10 (  22 days): UNIDIRECTIONAL       - std=0.0028, corr=-0.059, dir_acc=0.470
[WEAK] 2022-08-11 to 2022-09-27 (  33 days): WEAK_COLLAPSE        - std=0.0022, corr=-0.189, dir_acc=0.462
[UNI ] 2022-09-28 to 2022-10-21 (  17 days): UNIDIRECTIONAL       - std=0.0020, corr=-0.191, dir_acc=0.416
[WEAK] 2022-10-24 to 2022-11-03 (   9 days): WEAK_COLLAPSE        - std=0.0034, corr=-0.002, dir_acc=0.400
[UNI ] 2022-11-04 to 2023-04-06 ( 104 days): UNIDIRECTIONAL       - std=0.0123, corr=-0.023, dir_acc=0.437
[WEAK] 2023-04-10 to 2023-05-04 (  19 days): WEAK_COLLAPSE        - std=0.0017, corr=-0.018, dir_acc=0.516
[UNI ] 2023-05-05 to 2023-05-15 (   7 days): UNIDIRECTIONAL       - std=0.0014, corr=-0.037, dir_acc=0.500
[UNI ] 2023-05-24 to 2025-05-20 ( 496 days): UNIDIRECTIONAL       - std=0.0145, corr=-0.007, dir_acc=0.559
[WEAK] 2025-05-23 to 2025-06-24 (  21 days): WEAK_COLLAPSE        - std=0.0043, corr=+0.198, dir_acc=0.591
[UNI ] 2025-06-25 to 2025-10-06 (  72 days): UNIDIRECTIONAL       - std=0.0096, corr=-0.081, dir_acc=0.588
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            0 days (  0.0%)
  UNIDIRECTIONAL:    907 days ( 73.1%)
  WEAK_COLLAPSE:     238 days ( 19.2%)
  STRONG_COLLAPSE:    66 days (  5.3%)

  Total problematic: 1211 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep_combo3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.185111
  RMSE:             1.088628
  MAE:              0.774726
  Out-of-sample RÂ²: -0.0188

FINANCIAL METRICS:
  Directional Acc:  53.55%
  Sharpe Ratio:     0.8480
  Total Return:     90.07%
  Max Drawdown:     -25.25%
  Hit Rate:         53.55%
  Number of Trades: 1240

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5355
  Recall:           1.0000
  F1 Score:         0.6975
  AUC-ROC:          0.5393

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             576
  Actual Up:            0             664

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep_combo3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:00:57
======================================================================
---
Processing: 00_baseline_exploration/sweep_dropout_0.1
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep_dropout_0.1
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep_dropout_0.1/checkpoints/tft-epoch=00-val_loss=0.1531.ckpt
  Validation loss: 0.153082

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep_dropout_0.1/config.json
Output directory: experiments/00_baseline_exploration/sweep_dropout_0.1/evaluation
Logging to: experiments/00_baseline_exploration/sweep_dropout_0.1/evaluation/evaluation_20251027_120059.log
Evaluation started at: 2025-10-27 12:00:59
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.188690
    Max: 0.284557
    Mean: 0.236080
    Std: 0.020514
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1887, max: 0.2846, mean: 0.2361
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  331 days ( 25.9%)
3. Consecutive-similarity      [WARN]  197 days ( 15.4%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    732 days ( 57.2%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 308 days ( 24.1%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0029, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-03-05 ( 105 days): WEAK_COLLAPSE        - std=0.0055, corr=-0.071, dir_acc=0.556
[UNI ] 2021-03-08 to 2023-03-02 ( 497 days): UNIDIRECTIONAL       - std=0.0140, corr=-0.044, dir_acc=0.498
[UNI ] 2023-03-06 to 2024-02-27 ( 246 days): UNIDIRECTIONAL       - std=0.0152, corr=-0.025, dir_acc=0.543
[WEAK] 2024-02-28 to 2024-04-18 (  36 days): WEAK_COLLAPSE        - std=0.0050, corr=-0.119, dir_acc=0.576
[UNI ] 2024-04-19 to 2025-10-06 ( 365 days): UNIDIRECTIONAL       - std=0.0221, corr=+0.022, dir_acc=0.568
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:   1108 days ( 86.6%)
  WEAK_COLLAPSE:     142 days ( 11.1%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep_dropout_0.1/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.208866
  RMSE:             1.099484
  MAE:              0.786021
  Out-of-sample RÂ²: -0.0273

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5250

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep_dropout_0.1/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:01:00
======================================================================
---
Processing: 00_baseline_exploration/sweep_dropout_0.15
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep_dropout_0.15
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep_dropout_0.15/checkpoints/tft-epoch=00-val_loss=0.1544.ckpt
  Validation loss: 0.154445

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep_dropout_0.15/config.json
Output directory: experiments/00_baseline_exploration/sweep_dropout_0.15/evaluation
Logging to: experiments/00_baseline_exploration/sweep_dropout_0.15/evaluation/evaluation_20251027_120102.log
Evaluation started at: 2025-10-27 12:01:02
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.190289
    Max: 0.284467
    Mean: 0.236158
    Std: 0.020190
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1903, max: 0.2845, mean: 0.2362
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  332 days ( 25.9%)
3. Consecutive-similarity      [WARN]  198 days ( 15.5%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    729 days ( 57.0%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 305 days ( 23.8%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0029, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-03-05 ( 105 days): WEAK_COLLAPSE        - std=0.0058, corr=-0.071, dir_acc=0.556
[UNI ] 2021-03-08 to 2024-02-27 ( 744 days): UNIDIRECTIONAL       - std=0.0141, corr=-0.038, dir_acc=0.513
[WEAK] 2024-02-28 to 2024-04-18 (  36 days): WEAK_COLLAPSE        - std=0.0049, corr=-0.120, dir_acc=0.576
[UNI ] 2024-04-19 to 2025-10-06 ( 365 days): UNIDIRECTIONAL       - std=0.0221, corr=+0.022, dir_acc=0.568
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:   1109 days ( 86.6%)
  WEAK_COLLAPSE:     141 days ( 11.0%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep_dropout_0.15/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.208920
  RMSE:             1.099509
  MAE:              0.786047
  Out-of-sample RÂ²: -0.0273

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5242

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep_dropout_0.15/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:01:03
======================================================================
---
Processing: 00_baseline_exploration/sweep_dropout_0.2
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep_dropout_0.2
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep_dropout_0.2/checkpoints/tft-epoch=00-val_loss=0.1549.ckpt
  Validation loss: 0.154932

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep_dropout_0.2/config.json
Output directory: experiments/00_baseline_exploration/sweep_dropout_0.2/evaluation
Logging to: experiments/00_baseline_exploration/sweep_dropout_0.2/evaluation/evaluation_20251027_120104.log
Evaluation started at: 2025-10-27 12:01:04
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.192153
    Max: 0.286001
    Mean: 0.237614
    Std: 0.020268
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1922, max: 0.2860, mean: 0.2376
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  333 days ( 26.0%)
3. Consecutive-similarity      [WARN]  200 days ( 15.6%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    728 days ( 56.9%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 306 days ( 23.9%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0030, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-03-04 ( 104 days): WEAK_COLLAPSE        - std=0.0057, corr=-0.073, dir_acc=0.556
[UNI ] 2021-03-05 to 2023-03-01 ( 497 days): UNIDIRECTIONAL       - std=0.0135, corr=-0.045, dir_acc=0.498
[UNI ] 2023-03-06 to 2024-02-27 ( 246 days): UNIDIRECTIONAL       - std=0.0155, corr=-0.022, dir_acc=0.543
[WEAK] 2024-02-28 to 2024-04-18 (  36 days): WEAK_COLLAPSE        - std=0.0049, corr=-0.119, dir_acc=0.576
[UNI ] 2024-04-19 to 2025-10-06 ( 365 days): UNIDIRECTIONAL       - std=0.0224, corr=+0.022, dir_acc=0.568
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:   1108 days ( 86.6%)
  WEAK_COLLAPSE:     142 days ( 11.1%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep_dropout_0.2/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.209477
  RMSE:             1.099762
  MAE:              0.786290
  Out-of-sample RÂ²: -0.0278

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5233

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep_dropout_0.2/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:01:06
======================================================================
---
Processing: 00_baseline_exploration/sweep_dropout_0.3
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep_dropout_0.3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep_dropout_0.3/checkpoints/tft-epoch=01-val_loss=0.1507.ckpt
  Validation loss: 0.150724

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep_dropout_0.3/config.json
Output directory: experiments/00_baseline_exploration/sweep_dropout_0.3/evaluation
Logging to: experiments/00_baseline_exploration/sweep_dropout_0.3/evaluation/evaluation_20251027_120107.log
Evaluation started at: 2025-10-27 12:01:07
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.029525
    Max: 0.089710
    Mean: 0.065665
    Std: 0.012008
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0295, max: 0.0897, mean: 0.0657
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  784 days ( 61.3%)
3. Consecutive-similarity      [WARN]  759 days ( 59.3%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    585 days ( 45.7%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 223 days ( 17.4%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0006, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2022-01-26 ( 329 days): WEAK_COLLAPSE        - std=0.0071, corr=+0.037, dir_acc=0.564
[UNI ] 2022-01-27 to 2022-03-04 (  26 days): UNIDIRECTIONAL       - std=0.0040, corr=+0.376, dir_acc=0.452
[WEAK] 2022-03-07 to 2022-03-16 (   8 days): WEAK_COLLAPSE        - std=0.0022, corr=+0.262, dir_acc=0.400
[UNI ] 2022-03-17 to 2022-08-09 ( 100 days): UNIDIRECTIONAL       - std=0.0063, corr=+0.084, dir_acc=0.457
[WEAK] 2022-08-10 to 2022-10-31 (  57 days): WEAK_COLLAPSE        - std=0.0046, corr=+0.006, dir_acc=0.442
[UNI ] 2022-11-01 to 2023-01-03 (  42 days): UNIDIRECTIONAL       - std=0.0065, corr=-0.087, dir_acc=0.397
[WEAK] 2023-01-04 to 2023-01-12 (   7 days): WEAK_COLLAPSE        - std=0.0011, corr=-0.115, dir_acc=0.421
[UNI ] 2023-01-13 to 2023-02-13 (  21 days): UNIDIRECTIONAL       - std=0.0011, corr=-0.085, dir_acc=0.443
[WEAK] 2023-02-14 to 2023-05-04 (  56 days): WEAK_COLLAPSE        - std=0.0040, corr=-0.030, dir_acc=0.491
[UNI ] 2023-05-05 to 2023-05-12 (   6 days): UNIDIRECTIONAL       - std=0.0009, corr=+0.007, dir_acc=0.500
[WEAK] 2023-05-15 to 2023-05-23 (   7 days): WEAK_COLLAPSE        - std=0.0006, corr=-0.029, dir_acc=0.517
[UNI ] 2023-05-24 to 2023-07-26 (  43 days): UNIDIRECTIONAL       - std=0.0044, corr=-0.108, dir_acc=0.548
[UNI ] 2023-08-07 to 2023-08-21 (  11 days): UNIDIRECTIONAL       - std=0.0015, corr=-0.069, dir_acc=0.556
[UNI ] 2023-08-28 to 2023-09-11 (  10 days): UNIDIRECTIONAL       - std=0.0022, corr=+0.006, dir_acc=0.525
[UNI ] 2023-09-18 to 2024-02-21 ( 107 days): UNIDIRECTIONAL       - std=0.0076, corr=+0.078, dir_acc=0.558
[WEAK] 2024-02-22 to 2024-05-01 (  49 days): WEAK_COLLAPSE        - std=0.0041, corr=-0.156, dir_acc=0.566
[UNI ] 2024-05-02 to 2024-08-23 (  79 days): UNIDIRECTIONAL       - std=0.0067, corr=+0.153, dir_acc=0.578
[WEAK] 2024-08-26 to 2024-09-03 (   6 days): WEAK_COLLAPSE        - std=0.0006, corr=+0.236, dir_acc=0.614
[UNI ] 2024-09-04 to 2024-10-25 (  37 days): UNIDIRECTIONAL       - std=0.0027, corr=+0.236, dir_acc=0.578
[WEAK] 2024-10-31 to 2024-12-18 (  33 days): WEAK_COLLAPSE        - std=0.0038, corr=+0.026, dir_acc=0.580
[UNI ] 2024-12-19 to 2025-08-06 ( 156 days): UNIDIRECTIONAL       - std=0.0069, corr=-0.004, dir_acc=0.560
[WEAK] 2025-08-07 to 2025-10-06 (  42 days): WEAK_COLLAPSE        - std=0.0031, corr=-0.095, dir_acc=0.565
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    643 days ( 50.2%)
  WEAK_COLLAPSE:     607 days ( 47.4%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep_dropout_0.3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.176030
  RMSE:             1.084449
  MAE:              0.771768
  Out-of-sample RÂ²: 0.0006

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5452

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep_dropout_0.3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:01:08
======================================================================
---
Processing: 00_baseline_exploration/sweep_encoder_10
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep_encoder_10
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep_encoder_10/checkpoints/tft-epoch=00-val_loss=0.1521.ckpt
  Validation loss: 0.152070

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep_encoder_10/config.json
Output directory: experiments/00_baseline_exploration/sweep_encoder_10/evaluation
Logging to: experiments/00_baseline_exploration/sweep_encoder_10/evaluation/evaluation_20251027_120110.log
Evaluation started at: 2025-10-27 12:01:10
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1291 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1290, Total actuals: 1290

Prediction Generation Summary:
  Total predictions: 1290
  Test dataset size: 1290
  Test dataloader batches: 11
  Prediction statistics:
    Min: 0.188488
    Max: 0.283966
    Mean: 0.235076
    Std: 0.020626
    Unique values: 1290

WARNING: Predictions (1290) < Test samples (1300)
Date range: 2020-08-05T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-05T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1290 samples)
Computing metrics...
Predictions - min: 0.1885, max: 0.2840, mean: 0.2351
Negative predictions: 0/1290
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  220 days ( 17.1%)
3. Consecutive-similarity      [WARN]  187 days ( 14.5%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    719 days ( 55.7%)
  Directional acc < 52%                477 days ( 37.0%)
  Combined (BOTH poor)                 292 days ( 22.6%)
  Unidirectional (>98%)        [WARN]  1260 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-05 to 2020-09-15 (  29 days): HEALTHY              - std=0.0036, corr=+0.000, dir_acc=0.500
[WEAK] 2020-09-17 to 2020-10-30 (  31 days): WEAK_COLLAPSE        - std=0.0029, corr=+0.172, dir_acc=0.611
[WEAK] 2020-11-09 to 2021-02-25 (  73 days): WEAK_COLLAPSE        - std=0.0055, corr=-0.121, dir_acc=0.549
[UNI ] 2021-02-26 to 2023-03-01 ( 502 days): UNIDIRECTIONAL       - std=0.0145, corr=-0.031, dir_acc=0.498
[WEAK] 2023-03-02 to 2023-03-09 (   6 days): WEAK_COLLAPSE        - std=0.0015, corr=+0.027, dir_acc=0.475
[UNI ] 2023-03-10 to 2024-02-12 ( 232 days): UNIDIRECTIONAL       - std=0.0153, corr=+0.036, dir_acc=0.541
[WEAK] 2024-02-13 to 2024-03-06 (  16 days): WEAK_COLLAPSE        - std=0.0041, corr=-0.124, dir_acc=0.626
[UNI ] 2024-03-07 to 2025-10-06 ( 395 days): UNIDIRECTIONAL       - std=0.0221, corr=-0.013, dir_acc=0.568
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.2%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:   1134 days ( 87.9%)
  WEAK_COLLAPSE:     126 days (  9.8%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1261 days (97.8%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep_encoder_10/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.201504
  RMSE:             1.096131
  MAE:              0.782600
  Out-of-sample RÂ²: -0.0267

FINANCIAL METRICS:
  Directional Acc:  53.80%
  Sharpe Ratio:     0.8573
  Total Return:     97.00%
  Max Drawdown:     -25.25%
  Hit Rate:         53.80%
  Number of Trades: 1290

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5380
  Recall:           1.0000
  F1 Score:         0.6996
  AUC-ROC:          0.5203

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             596
  Actual Up:            0             694

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep_encoder_10/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:01:11
======================================================================
---
Processing: 00_baseline_exploration/sweep_encoder_20
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep_encoder_20
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep_encoder_20/checkpoints/tft-epoch=00-val_loss=0.1544.ckpt
  Validation loss: 0.154445

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep_encoder_20/config.json
Output directory: experiments/00_baseline_exploration/sweep_encoder_20/evaluation
Logging to: experiments/00_baseline_exploration/sweep_encoder_20/evaluation/evaluation_20251027_120112.log
Evaluation started at: 2025-10-27 12:01:12
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.190289
    Max: 0.284467
    Mean: 0.236158
    Std: 0.020190
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1903, max: 0.2845, mean: 0.2362
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  332 days ( 25.9%)
3. Consecutive-similarity      [WARN]  198 days ( 15.5%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    729 days ( 57.0%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 305 days ( 23.8%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0029, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-03-05 ( 105 days): WEAK_COLLAPSE        - std=0.0058, corr=-0.071, dir_acc=0.556
[UNI ] 2021-03-08 to 2024-02-27 ( 744 days): UNIDIRECTIONAL       - std=0.0141, corr=-0.038, dir_acc=0.513
[WEAK] 2024-02-28 to 2024-04-18 (  36 days): WEAK_COLLAPSE        - std=0.0049, corr=-0.120, dir_acc=0.576
[UNI ] 2024-04-19 to 2025-10-06 ( 365 days): UNIDIRECTIONAL       - std=0.0221, corr=+0.022, dir_acc=0.568
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:   1109 days ( 86.6%)
  WEAK_COLLAPSE:     141 days ( 11.0%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep_encoder_20/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.208920
  RMSE:             1.099509
  MAE:              0.786047
  Out-of-sample RÂ²: -0.0273

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5242

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep_encoder_20/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:01:13
======================================================================
---
Processing: 00_baseline_exploration/sweep_encoder_40
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep_encoder_40
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep_encoder_40/checkpoints/tft-epoch=00-val_loss=0.1533.ckpt
  Validation loss: 0.153250

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep_encoder_40/config.json
Output directory: experiments/00_baseline_exploration/sweep_encoder_40/evaluation
Logging to: experiments/00_baseline_exploration/sweep_encoder_40/evaluation/evaluation_20251027_120115.log
Evaluation started at: 2025-10-27 12:01:15
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1261 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1260, Total actuals: 1260

Prediction Generation Summary:
  Total predictions: 1260
  Test dataset size: 1260
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.192769
    Max: 0.286479
    Mean: 0.237538
    Std: 0.019101
    Unique values: 1260

WARNING: Predictions (1260) < Test samples (1300)
Date range: 2020-09-17T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-09-17T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1260 samples)
Computing metrics...
Predictions - min: 0.1928, max: 0.2865, mean: 0.2375
Negative predictions: 0/1260
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   71 days (  5.6%)
2. Range-based                 [WARN]  402 days ( 31.9%)
3. Consecutive-similarity      [WARN]  305 days ( 24.2%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    688 days ( 54.6%)
  Directional acc < 52%                480 days ( 38.1%)
  Combined (BOTH poor)                 318 days ( 25.2%)
  Unidirectional (>98%)        [WARN]  1230 days ( 97.6%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-09-17 to 2020-10-28 (  29 days): HEALTHY              - std=0.0035, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-30 to 2021-01-06 (  45 days): WEAK_COLLAPSE        - std=0.0012, corr=-0.091, dir_acc=0.524
[FAIL] 2021-01-07 to 2021-02-16 (  27 days): STRONG_COLLAPSE      - std=0.0027, corr=-0.087, dir_acc=0.564
[WEAK] 2021-02-17 to 2021-03-15 (  19 days): WEAK_COLLAPSE        - std=0.0022, corr=+0.065, dir_acc=0.552
[UNI ] 2021-03-16 to 2021-05-11 (  40 days): UNIDIRECTIONAL       - std=0.0018, corr=-0.043, dir_acc=0.542
[UNI ] 2021-05-13 to 2021-05-20 (   6 days): UNIDIRECTIONAL       - std=0.0016, corr=-0.080, dir_acc=0.525
[WEAK] 2021-05-21 to 2021-06-07 (  11 days): WEAK_COLLAPSE        - std=0.0013, corr=-0.009, dir_acc=0.542
[FAIL] 2021-06-08 to 2021-07-08 (  22 days): STRONG_COLLAPSE      - std=0.0020, corr=-0.206, dir_acc=0.545
[WEAK] 2021-07-09 to 2021-07-20 (   8 days): WEAK_COLLAPSE        - std=0.0027, corr=-0.222, dir_acc=0.558
[UNI ] 2021-07-21 to 2022-08-16 ( 269 days): UNIDIRECTIONAL       - std=0.0113, corr=-0.024, dir_acc=0.518
[UNI ] 2022-08-19 to 2022-10-05 (  33 days): UNIDIRECTIONAL       - std=0.0019, corr=-0.164, dir_acc=0.451
[WEAK] 2022-10-06 to 2022-10-19 (   9 days): WEAK_COLLAPSE        - std=0.0029, corr=-0.248, dir_acc=0.415
[UNI ] 2022-10-20 to 2023-03-30 ( 110 days): UNIDIRECTIONAL       - std=0.0153, corr=-0.086, dir_acc=0.429
[FAIL] 2023-04-05 to 2023-04-19 (  10 days): STRONG_COLLAPSE      - std=0.0012, corr=-0.040, dir_acc=0.523
[WEAK] 2023-04-20 to 2023-04-28 (   7 days): WEAK_COLLAPSE        - std=0.0022, corr=-0.065, dir_acc=0.521
[UNI ] 2023-05-01 to 2023-05-23 (  17 days): UNIDIRECTIONAL       - std=0.0023, corr=-0.147, dir_acc=0.506
[UNI ] 2023-05-25 to 2024-03-25 ( 208 days): UNIDIRECTIONAL       - std=0.0158, corr=+0.010, dir_acc=0.559
[WEAK] 2024-03-26 to 2024-04-09 (  10 days): WEAK_COLLAPSE        - std=0.0036, corr=-0.232, dir_acc=0.558
[UNI ] 2024-04-16 to 2025-10-06 ( 368 days): UNIDIRECTIONAL       - std=0.0212, corr=+0.012, dir_acc=0.567
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:   1053 days ( 83.6%)
  WEAK_COLLAPSE:     117 days (  9.3%)
  STRONG_COLLAPSE:    60 days (  4.8%)

  Total problematic: 1231 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep_encoder_40/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.198538
  RMSE:             1.094778
  MAE:              0.783467
  Out-of-sample RÂ²: -0.0272

FINANCIAL METRICS:
  Directional Acc:  53.49%
  Sharpe Ratio:     0.8492
  Total Return:     92.40%
  Max Drawdown:     -25.25%
  Hit Rate:         53.49%
  Number of Trades: 1260

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5349
  Recall:           1.0000
  F1 Score:         0.6970
  AUC-ROC:          0.5305

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             586
  Actual Up:            0             674

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep_encoder_40/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:01:16
======================================================================
---
Processing: 00_baseline_exploration/sweep_encoder_60
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep_encoder_60
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep_encoder_60/checkpoints/tft-epoch=00-val_loss=0.1534.ckpt
  Validation loss: 0.153373

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep_encoder_60/config.json
Output directory: experiments/00_baseline_exploration/sweep_encoder_60/evaluation
Logging to: experiments/00_baseline_exploration/sweep_encoder_60/evaluation/evaluation_20251027_120117.log
Evaluation started at: 2025-10-27 12:01:17
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1241 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1240, Total actuals: 1240

Prediction Generation Summary:
  Total predictions: 1240
  Test dataset size: 1240
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.188633
    Max: 0.280019
    Mean: 0.232162
    Std: 0.018162
    Unique values: 1239

WARNING: Predictions (1240) < Test samples (1300)
Date range: 2020-10-16T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-10-16T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1240 samples)
Computing metrics...
Predictions - min: 0.1886, max: 0.2800, mean: 0.2322
Negative predictions: 0/1240
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  219 days ( 17.7%)
2. Range-based                 [WARN]  506 days ( 40.8%)
3. Consecutive-similarity      [WARN]  314 days ( 25.3%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    656 days ( 52.9%)
  Directional acc < 52%                470 days ( 37.9%)
  Combined (BOTH poor)                 257 days ( 20.7%)
  Unidirectional (>98%)        [WARN]  1210 days ( 97.6%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-10-16 to 2020-11-27 (  29 days): HEALTHY              - std=0.0029, corr=+0.000, dir_acc=0.500
[FAIL] 2020-12-01 to 2021-03-09 (  67 days): STRONG_COLLAPSE      - std=0.0031, corr=-0.045, dir_acc=0.549
[WEAK] 2021-03-10 to 2021-03-24 (  11 days): WEAK_COLLAPSE        - std=0.0029, corr=+0.027, dir_acc=0.568
[UNI ] 2021-03-25 to 2021-06-07 (  51 days): UNIDIRECTIONAL       - std=0.0034, corr=-0.036, dir_acc=0.536
[WEAK] 2021-06-08 to 2021-06-16 (   7 days): WEAK_COLLAPSE        - std=0.0008, corr=-0.034, dir_acc=0.536
[WEAK] 2021-06-23 to 2021-06-30 (   6 days): WEAK_COLLAPSE        - std=0.0012, corr=-0.074, dir_acc=0.550
[WEAK] 2021-07-02 to 2021-10-19 (  75 days): WEAK_COLLAPSE        - std=0.0032, corr=-0.236, dir_acc=0.580
[UNI ] 2021-10-20 to 2022-02-10 (  78 days): UNIDIRECTIONAL       - std=0.0045, corr=+0.105, dir_acc=0.570
[WEAK] 2022-02-11 to 2022-03-02 (  13 days): WEAK_COLLAPSE        - std=0.0022, corr=+0.139, dir_acc=0.447
[UNI ] 2022-03-03 to 2022-04-04 (  23 days): UNIDIRECTIONAL       - std=0.0060, corr=+0.059, dir_acc=0.420
[UNI ] 2022-04-06 to 2022-06-08 (  44 days): UNIDIRECTIONAL       - std=0.0028, corr=+0.079, dir_acc=0.458
[WEAK] 2022-06-09 to 2022-06-24 (  11 days): WEAK_COLLAPSE        - std=0.0014, corr=+0.096, dir_acc=0.464
[UNI ] 2022-07-12 to 2022-08-09 (  21 days): UNIDIRECTIONAL       - std=0.0032, corr=-0.080, dir_acc=0.470
[WEAK] 2022-08-10 to 2022-09-23 (  32 days): WEAK_COLLAPSE        - std=0.0021, corr=-0.196, dir_acc=0.463
[UNI ] 2022-09-26 to 2022-10-21 (  19 days): UNIDIRECTIONAL       - std=0.0024, corr=-0.228, dir_acc=0.418
[WEAK] 2022-10-24 to 2022-11-02 (   8 days): WEAK_COLLAPSE        - std=0.0028, corr=-0.075, dir_acc=0.400
[UNI ] 2022-11-03 to 2023-04-06 ( 105 days): UNIDIRECTIONAL       - std=0.0137, corr=-0.033, dir_acc=0.437
[FAIL] 2023-04-12 to 2023-05-02 (  15 days): STRONG_COLLAPSE      - std=0.0018, corr=-0.063, dir_acc=0.518
[WEAK] 2023-05-03 to 2023-05-17 (  11 days): WEAK_COLLAPSE        - std=0.0013, corr=-0.097, dir_acc=0.500
[WEAK] 2023-05-23 to 2023-06-12 (  14 days): WEAK_COLLAPSE        - std=0.0059, corr=-0.261, dir_acc=0.538
[UNI ] 2023-06-13 to 2025-05-29 ( 489 days): UNIDIRECTIONAL       - std=0.0177, corr=+0.005, dir_acc=0.560
[UNI ] 2025-06-16 to 2025-10-06 (  78 days): UNIDIRECTIONAL       - std=0.0122, corr=-0.062, dir_acc=0.588
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            0 days (  0.0%)
  UNIDIRECTIONAL:    912 days ( 73.5%)
  WEAK_COLLAPSE:     203 days ( 16.4%)
  STRONG_COLLAPSE:    96 days (  7.7%)

  Total problematic: 1211 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep_encoder_60/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.193053
  RMSE:             1.092270
  MAE:              0.778506
  Out-of-sample RÂ²: -0.0256

FINANCIAL METRICS:
  Directional Acc:  53.55%
  Sharpe Ratio:     0.8480
  Total Return:     90.07%
  Max Drawdown:     -25.25%
  Hit Rate:         53.55%
  Number of Trades: 1240

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5355
  Recall:           1.0000
  F1 Score:         0.6975
  AUC-ROC:          0.5352

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             576
  Actual Up:            0             664

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep_encoder_60/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:01:19
======================================================================
---
Processing: 00_baseline_exploration/sweep_hidden_16
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep_hidden_16
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep_hidden_16/checkpoints/tft-epoch=01-val_loss=0.1324.ckpt
  Validation loss: 0.132447

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep_hidden_16/config.json
Output directory: experiments/00_baseline_exploration/sweep_hidden_16/evaluation
Logging to: experiments/00_baseline_exploration/sweep_hidden_16/evaluation/evaluation_20251027_120120.log
Evaluation started at: 2025-10-27 12:01:20
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.103241
    Max: 0.152375
    Mean: -0.003492
    Std: 0.076916
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.1032, max: 0.1524, mean: -0.0035
Negative predictions: 694/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   89 days (  7.0%)
2. Range-based                 [WARN]  187 days ( 14.6%)
3. Consecutive-similarity      [WARN]  294 days ( 23.0%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    758 days ( 59.2%)
  Directional acc < 52%                585 days ( 45.7%)
  Combined (BOTH poor)                 374 days ( 29.2%)
  Unidirectional (>98%)        [WARN]  1085 days ( 84.8%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-30 (  30 days): HEALTHY              - std=0.0083, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2021-04-05 ( 125 days): UNIDIRECTIONAL       - std=0.0188, corr=-0.114, dir_acc=0.444
[ OK ] 2021-04-06 to 2021-04-13 (   6 days): HEALTHY              - std=0.0088, corr=+0.022, dir_acc=0.489
[ OK ] 2021-05-03 to 2021-05-13 (   9 days): HEALTHY              - std=0.0122, corr=+0.016, dir_acc=0.544
[DEGD] 2021-05-26 to 2021-06-08 (   9 days): DEGRADED             - std=0.0053, corr=-0.112, dir_acc=0.502
[DEGD] 2021-06-10 to 2021-09-07 (  62 days): DEGRADED             - std=0.0166, corr=-0.138, dir_acc=0.437
[UNI ] 2021-09-08 to 2022-06-15 ( 193 days): UNIDIRECTIONAL       - std=0.0206, corr=-0.111, dir_acc=0.485
[WEAK] 2022-06-16 to 2022-07-22 (  25 days): WEAK_COLLAPSE        - std=0.0057, corr=-0.059, dir_acc=0.545
[UNI ] 2022-07-25 to 2022-09-23 (  44 days): UNIDIRECTIONAL       - std=0.0019, corr=-0.099, dir_acc=0.534
[WEAK] 2022-09-26 to 2022-10-06 (   9 days): WEAK_COLLAPSE        - std=0.0014, corr=+0.081, dir_acc=0.572
[FAIL] 2022-10-07 to 2022-12-20 (  50 days): STRONG_COLLAPSE      - std=0.0029, corr=+0.122, dir_acc=0.601
[WEAK] 2022-12-21 to 2022-12-29 (   6 days): WEAK_COLLAPSE        - std=0.0017, corr=+0.111, dir_acc=0.594
[FAIL] 2022-12-30 to 2023-02-06 (  25 days): STRONG_COLLAPSE      - std=0.0018, corr=+0.063, dir_acc=0.568
[WEAK] 2023-02-07 to 2023-03-10 (  23 days): WEAK_COLLAPSE        - std=0.0017, corr=+0.075, dir_acc=0.548
[FAIL] 2023-03-13 to 2023-03-30 (  14 days): STRONG_COLLAPSE      - std=0.0038, corr=-0.000, dir_acc=0.511
[WEAK] 2023-03-31 to 2023-04-10 (   6 days): WEAK_COLLAPSE        - std=0.0019, corr=+0.088, dir_acc=0.464
[UNI ] 2023-04-11 to 2023-07-14 (  66 days): UNIDIRECTIONAL       - std=0.0226, corr=+0.013, dir_acc=0.471
[ OK ] 2023-07-17 to 2023-07-28 (  10 days): HEALTHY              - std=0.0121, corr=+0.045, dir_acc=0.467
[DEGD] 2023-07-31 to 2023-10-04 (  47 days): DEGRADED             - std=0.0097, corr=-0.163, dir_acc=0.445
[UNI ] 2023-10-05 to 2024-02-26 (  97 days): UNIDIRECTIONAL       - std=0.0283, corr=+0.034, dir_acc=0.567
[WEAK] 2024-02-27 to 2024-04-08 (  29 days): WEAK_COLLAPSE        - std=0.0033, corr=+0.006, dir_acc=0.587
[UNI ] 2024-04-09 to 2025-10-06 ( 373 days): UNIDIRECTIONAL       - std=0.0336, corr=-0.065, dir_acc=0.567
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            66 days (  5.2%)
  DEGRADED:          129 days ( 10.1%)
  UNIDIRECTIONAL:    898 days ( 70.2%)
  WEAK_COLLAPSE:      98 days (  7.7%)
  STRONG_COLLAPSE:    89 days (  7.0%)

  Total problematic: 1214 days (94.8%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep_hidden_16/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.183202
  RMSE:             1.087751
  MAE:              0.773713
  Out-of-sample RÂ²: -0.0055

FINANCIAL METRICS:
  Directional Acc:  52.42%
  Sharpe Ratio:     0.8480
  Total Return:     52.05%
  Max Drawdown:     -18.90%
  Hit Rate:         25.94%
  Number of Trades: 586

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5666
  Recall:           0.4833
  F1 Score:         0.5216
  AUC-ROC:          0.5439

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        339             254
  Actual Up:          355             332

ALPHA (vs Buy-and-Hold):
  Excess Return:    -40.11%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep_hidden_16/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:01:21
======================================================================
---
Processing: 00_baseline_exploration/sweep_hidden_24
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep_hidden_24
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep_hidden_24/checkpoints/tft-epoch=00-val_loss=0.1056.ckpt
  Validation loss: 0.105576

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep_hidden_24/config.json
Output directory: experiments/00_baseline_exploration/sweep_hidden_24/evaluation
Logging to: experiments/00_baseline_exploration/sweep_hidden_24/evaluation/evaluation_20251027_120123.log
Evaluation started at: 2025-10-27 12:01:23
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.183870
    Max: 0.381522
    Mean: 0.296765
    Std: 0.046850
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1839, max: 0.3815, mean: 0.2968
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  196 days ( 15.3%)
2. Range-based                 [ OK ]    0 days (  0.0%)
3. Consecutive-similarity      [ OK ]    0 days (  0.0%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    303 days ( 23.7%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 124 days (  9.7%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-30 (  30 days): HEALTHY              - std=0.0148, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2025-10-06 (1250 days): UNIDIRECTIONAL       - std=0.0457, corr=+0.085, dir_acc=0.534
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            30 days (  2.3%)
  DEGRADED:            0 days (  0.0%)
  UNIDIRECTIONAL:   1250 days ( 97.7%)
  WEAK_COLLAPSE:       0 days (  0.0%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1250 days (97.7%)
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep_hidden_24/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.237303
  RMSE:             1.112341
  MAE:              0.797365
  Out-of-sample RÂ²: -0.0514

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4735

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep_hidden_24/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:01:24
======================================================================
---
Processing: 00_baseline_exploration/sweep_hidden_32
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep_hidden_32
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep_hidden_32/checkpoints/tft-epoch=00-val_loss=0.1544.ckpt
  Validation loss: 0.154445

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep_hidden_32/config.json
Output directory: experiments/00_baseline_exploration/sweep_hidden_32/evaluation
Logging to: experiments/00_baseline_exploration/sweep_hidden_32/evaluation/evaluation_20251027_120125.log
Evaluation started at: 2025-10-27 12:01:25
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.190289
    Max: 0.284467
    Mean: 0.236158
    Std: 0.020190
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1903, max: 0.2845, mean: 0.2362
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  332 days ( 25.9%)
3. Consecutive-similarity      [WARN]  198 days ( 15.5%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    729 days ( 57.0%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 305 days ( 23.8%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0029, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-03-05 ( 105 days): WEAK_COLLAPSE        - std=0.0058, corr=-0.071, dir_acc=0.556
[UNI ] 2021-03-08 to 2024-02-27 ( 744 days): UNIDIRECTIONAL       - std=0.0141, corr=-0.038, dir_acc=0.513
[WEAK] 2024-02-28 to 2024-04-18 (  36 days): WEAK_COLLAPSE        - std=0.0049, corr=-0.120, dir_acc=0.576
[UNI ] 2024-04-19 to 2025-10-06 ( 365 days): UNIDIRECTIONAL       - std=0.0221, corr=+0.022, dir_acc=0.568
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:   1109 days ( 86.6%)
  WEAK_COLLAPSE:     141 days ( 11.0%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep_hidden_32/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.208920
  RMSE:             1.099509
  MAE:              0.786047
  Out-of-sample RÂ²: -0.0273

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5242

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep_hidden_32/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:01:26
======================================================================
---
Processing: 00_baseline_exploration/sweep_hidden_48
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep_hidden_48
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep_hidden_48/checkpoints/tft-epoch=01-val_loss=0.1530.ckpt
  Validation loss: 0.152975

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep_hidden_48/config.json
Output directory: experiments/00_baseline_exploration/sweep_hidden_48/evaluation
Logging to: experiments/00_baseline_exploration/sweep_hidden_48/evaluation/evaluation_20251027_120128.log
Evaluation started at: 2025-10-27 12:01:28
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.010242
    Max: 0.140633
    Mean: 0.103628
    Std: 0.031830
    Unique values: 1278

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0102, max: 0.1406, mean: 0.1036
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   85 days (  6.6%)
2. Range-based                 [WARN]  584 days ( 45.6%)
3. Consecutive-similarity      [WARN]  619 days ( 48.4%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    885 days ( 69.1%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 388 days ( 30.3%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0040, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-03-08 ( 106 days): WEAK_COLLAPSE        - std=0.0056, corr=-0.059, dir_acc=0.555
[FAIL] 2021-03-09 to 2021-04-01 (  18 days): STRONG_COLLAPSE      - std=0.0019, corr=-0.291, dir_acc=0.560
[WEAK] 2021-04-05 to 2021-04-16 (  10 days): WEAK_COLLAPSE        - std=0.0026, corr=-0.034, dir_acc=0.545
[UNI ] 2021-04-19 to 2021-06-09 (  37 days): UNIDIRECTIONAL       - std=0.0067, corr=-0.067, dir_acc=0.530
[WEAK] 2021-06-10 to 2021-10-14 (  88 days): WEAK_COLLAPSE        - std=0.0047, corr=+0.032, dir_acc=0.574
[WEAK] 2021-10-19 to 2021-11-09 (  16 days): WEAK_COLLAPSE        - std=0.0061, corr=-0.266, dir_acc=0.605
[UNI ] 2021-11-10 to 2023-07-27 ( 426 days): UNIDIRECTIONAL       - std=0.0325, corr=-0.121, dir_acc=0.477
[WEAK] 2023-07-28 to 2023-08-04 (   6 days): WEAK_COLLAPSE        - std=0.0011, corr=+0.017, dir_acc=0.583
[UNI ] 2023-08-07 to 2023-09-06 (  22 days): UNIDIRECTIONAL       - std=0.0027, corr=-0.106, dir_acc=0.545
[WEAK] 2023-09-07 to 2024-02-13 ( 109 days): WEAK_COLLAPSE        - std=0.0039, corr=-0.063, dir_acc=0.552
[FAIL] 2024-02-14 to 2024-05-07 (  58 days): STRONG_COLLAPSE      - std=0.0020, corr=+0.159, dir_acc=0.567
[WEAK] 2024-05-08 to 2024-07-15 (  46 days): WEAK_COLLAPSE        - std=0.0008, corr=-0.116, dir_acc=0.554
[FAIL] 2024-07-16 to 2024-07-26 (   9 days): STRONG_COLLAPSE      - std=0.0024, corr=-0.051, dir_acc=0.652
[WEAK] 2024-07-29 to 2024-08-23 (  20 days): WEAK_COLLAPSE        - std=0.0068, corr=-0.242, dir_acc=0.617
[UNI ] 2024-08-26 to 2024-12-31 (  87 days): UNIDIRECTIONAL       - std=0.0070, corr=+0.061, dir_acc=0.579
[WEAK] 2025-01-02 to 2025-01-21 (  12 days): WEAK_COLLAPSE        - std=0.0029, corr=-0.034, dir_acc=0.543
[UNI ] 2025-01-22 to 2025-08-26 ( 150 days): UNIDIRECTIONAL       - std=0.0262, corr=-0.069, dir_acc=0.562
[WEAK] 2025-08-27 to 2025-10-06 (  28 days): WEAK_COLLAPSE        - std=0.0017, corr=+0.164, dir_acc=0.565
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    724 days ( 56.6%)
  WEAK_COLLAPSE:     441 days ( 34.5%)
  STRONG_COLLAPSE:    85 days (  6.6%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep_hidden_48/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.179696
  RMSE:             1.086138
  MAE:              0.772079
  Out-of-sample RÂ²: -0.0025

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5308

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep_hidden_48/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:01:29
======================================================================
---
Processing: 00_baseline_exploration/sweep_hidden_64
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep_hidden_64
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep_hidden_64/checkpoints/tft-epoch=00-val_loss=0.1633.ckpt
  Validation loss: 0.163348

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep_hidden_64/config.json
Output directory: experiments/00_baseline_exploration/sweep_hidden_64/evaluation
Logging to: experiments/00_baseline_exploration/sweep_hidden_64/evaluation/evaluation_20251027_120131.log
Evaluation started at: 2025-10-27 12:01:31
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.057978
    Max: 0.238127
    Mean: 0.149015
    Std: 0.039272
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0580, max: 0.2381, mean: 0.1490
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   47 days (  3.7%)
2. Range-based                 [WARN]  182 days ( 14.2%)
3. Consecutive-similarity      [WARN]  387 days ( 30.2%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    619 days ( 48.4%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 146 days ( 11.4%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-30 (  30 days): HEALTHY              - std=0.0064, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2021-08-04 ( 210 days): UNIDIRECTIONAL       - std=0.0205, corr=-0.125, dir_acc=0.551
[WEAK] 2021-08-05 to 2021-10-07 (  45 days): WEAK_COLLAPSE        - std=0.0042, corr=-0.032, dir_acc=0.592
[WEAK] 2021-10-12 to 2021-12-07 (  39 days): WEAK_COLLAPSE        - std=0.0051, corr=-0.194, dir_acc=0.591
[UNI ] 2021-12-08 to 2022-01-12 (  25 days): UNIDIRECTIONAL       - std=0.0062, corr=-0.042, dir_acc=0.603
[UNI ] 2022-01-18 to 2023-09-15 ( 416 days): UNIDIRECTIONAL       - std=0.0341, corr=+0.110, dir_acc=0.470
[WEAK] 2023-09-18 to 2023-10-06 (  15 days): WEAK_COLLAPSE        - std=0.0043, corr=-0.078, dir_acc=0.500
[UNI ] 2023-10-10 to 2024-02-16 (  90 days): UNIDIRECTIONAL       - std=0.0143, corr=-0.136, dir_acc=0.566
[FAIL] 2024-02-20 to 2024-04-25 (  47 days): STRONG_COLLAPSE      - std=0.0038, corr=+0.008, dir_acc=0.573
[WEAK] 2024-04-26 to 2024-05-29 (  23 days): WEAK_COLLAPSE        - std=0.0074, corr=-0.112, dir_acc=0.512
[UNI ] 2024-05-30 to 2024-07-31 (  43 days): UNIDIRECTIONAL       - std=0.0018, corr=-0.120, dir_acc=0.594
[WEAK] 2024-08-01 to 2024-08-08 (   6 days): WEAK_COLLAPSE        - std=0.0039, corr=+0.022, dir_acc=0.600
[UNI ] 2024-08-09 to 2025-09-29 ( 283 days): UNIDIRECTIONAL       - std=0.0187, corr=+0.074, dir_acc=0.569
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            30 days (  2.3%)
  DEGRADED:            0 days (  0.0%)
  UNIDIRECTIONAL:   1068 days ( 83.4%)
  WEAK_COLLAPSE:     135 days ( 10.5%)
  STRONG_COLLAPSE:    47 days (  3.7%)

  Total problematic: 1250 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep_hidden_64/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.186570
  RMSE:             1.089298
  MAE:              0.776662
  Out-of-sample RÂ²: -0.0083

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4913

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep_hidden_64/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:01:32
======================================================================
---
Processing: 00_baseline_exploration/sweep_lr_0.0003
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep_lr_0.0003
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep_lr_0.0003/checkpoints/tft-epoch=01-val_loss=0.1374.ckpt
  Validation loss: 0.137383

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep_lr_0.0003/config.json
Output directory: experiments/00_baseline_exploration/sweep_lr_0.0003/evaluation
Logging to: experiments/00_baseline_exploration/sweep_lr_0.0003/evaluation/evaluation_20251027_120133.log
Evaluation started at: 2025-10-27 12:01:33
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.107728
    Max: 0.186504
    Mean: 0.158401
    Std: 0.016140
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1077, max: 0.1865, mean: 0.1584
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  519 days ( 40.5%)
3. Consecutive-similarity      [WARN]  430 days ( 33.6%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    763 days ( 59.6%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 331 days ( 25.9%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0010, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-03-17 ( 113 days): WEAK_COLLAPSE        - std=0.0043, corr=-0.034, dir_acc=0.556
[UNI ] 2021-03-18 to 2021-04-06 (  13 days): UNIDIRECTIONAL       - std=0.0014, corr=+0.030, dir_acc=0.555
[WEAK] 2021-04-07 to 2021-08-23 (  97 days): WEAK_COLLAPSE        - std=0.0022, corr=-0.144, dir_acc=0.550
[WEAK] 2021-09-01 to 2021-09-23 (  16 days): WEAK_COLLAPSE        - std=0.0015, corr=-0.228, dir_acc=0.604
[UNI ] 2021-09-24 to 2021-10-13 (  13 days): UNIDIRECTIONAL       - std=0.0022, corr=-0.170, dir_acc=0.547
[WEAK] 2021-10-14 to 2021-11-09 (  19 days): WEAK_COLLAPSE        - std=0.0031, corr=+0.149, dir_acc=0.599
[WEAK] 2021-11-16 to 2021-11-30 (  10 days): WEAK_COLLAPSE        - std=0.0017, corr=+0.200, dir_acc=0.585
[UNI ] 2021-12-01 to 2021-12-27 (  18 days): UNIDIRECTIONAL       - std=0.0022, corr=+0.216, dir_acc=0.600
[WEAK] 2021-12-30 to 2022-01-06 (   6 days): WEAK_COLLAPSE        - std=0.0013, corr=+0.204, dir_acc=0.603
[UNI ] 2022-01-14 to 2022-03-04 (  34 days): UNIDIRECTIONAL       - std=0.0033, corr=+0.243, dir_acc=0.466
[UNI ] 2022-03-10 to 2022-10-06 ( 146 days): UNIDIRECTIONAL       - std=0.0076, corr=-0.024, dir_acc=0.454
[UNI ] 2022-10-12 to 2023-02-27 (  93 days): UNIDIRECTIONAL       - std=0.0136, corr=-0.117, dir_acc=0.415
[WEAK] 2023-02-28 to 2023-04-14 (  33 days): WEAK_COLLAPSE        - std=0.0022, corr=-0.148, dir_acc=0.494
[UNI ] 2023-04-17 to 2024-02-26 ( 216 days): UNIDIRECTIONAL       - std=0.0096, corr=-0.008, dir_acc=0.549
[WEAK] 2024-02-27 to 2024-04-22 (  39 days): WEAK_COLLAPSE        - std=0.0043, corr=-0.139, dir_acc=0.573
[UNI ] 2024-04-23 to 2025-10-06 ( 363 days): UNIDIRECTIONAL       - std=0.0119, corr=+0.016, dir_acc=0.568
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    908 days ( 70.9%)
  WEAK_COLLAPSE:     342 days ( 26.7%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep_lr_0.0003/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.186637
  RMSE:             1.089329
  MAE:              0.775565
  Out-of-sample RÂ²: -0.0084

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5403

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep_lr_0.0003/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:01:35
======================================================================
---
Processing: 00_baseline_exploration/sweep_lr_0.0005
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep_lr_0.0005
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep_lr_0.0005/checkpoints/tft-epoch=00-val_loss=0.1544.ckpt
  Validation loss: 0.154445

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep_lr_0.0005/config.json
Output directory: experiments/00_baseline_exploration/sweep_lr_0.0005/evaluation
Logging to: experiments/00_baseline_exploration/sweep_lr_0.0005/evaluation/evaluation_20251027_120136.log
Evaluation started at: 2025-10-27 12:01:36
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.190289
    Max: 0.284467
    Mean: 0.236158
    Std: 0.020190
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1903, max: 0.2845, mean: 0.2362
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  332 days ( 25.9%)
3. Consecutive-similarity      [WARN]  198 days ( 15.5%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    729 days ( 57.0%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 305 days ( 23.8%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0029, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-03-05 ( 105 days): WEAK_COLLAPSE        - std=0.0058, corr=-0.071, dir_acc=0.556
[UNI ] 2021-03-08 to 2024-02-27 ( 744 days): UNIDIRECTIONAL       - std=0.0141, corr=-0.038, dir_acc=0.513
[WEAK] 2024-02-28 to 2024-04-18 (  36 days): WEAK_COLLAPSE        - std=0.0049, corr=-0.120, dir_acc=0.576
[UNI ] 2024-04-19 to 2025-10-06 ( 365 days): UNIDIRECTIONAL       - std=0.0221, corr=+0.022, dir_acc=0.568
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:   1109 days ( 86.6%)
  WEAK_COLLAPSE:     141 days ( 11.0%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep_lr_0.0005/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.208920
  RMSE:             1.099509
  MAE:              0.786047
  Out-of-sample RÂ²: -0.0273

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5242

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep_lr_0.0005/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:01:37
======================================================================
---
Processing: 00_baseline_exploration/sweep_lr_0.0007
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep_lr_0.0007
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep_lr_0.0007/checkpoints/tft-epoch=00-val_loss=0.1466.ckpt
  Validation loss: 0.146601

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep_lr_0.0007/config.json
Output directory: experiments/00_baseline_exploration/sweep_lr_0.0007/evaluation
Logging to: experiments/00_baseline_exploration/sweep_lr_0.0007/evaluation/evaluation_20251027_120139.log
Evaluation started at: 2025-10-27 12:01:39
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.159545
    Max: 0.245914
    Mean: 0.209737
    Std: 0.017890
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1595, max: 0.2459, mean: 0.2097
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  389 days ( 30.4%)
3. Consecutive-similarity      [WARN]  246 days ( 19.2%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    752 days ( 58.8%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 319 days ( 24.9%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0018, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-03-12 ( 110 days): WEAK_COLLAPSE        - std=0.0050, corr=-0.057, dir_acc=0.556
[UNI ] 2021-03-15 to 2021-05-04 (  36 days): UNIDIRECTIONAL       - std=0.0031, corr=-0.028, dir_acc=0.547
[WEAK] 2021-05-05 to 2021-06-18 (  32 days): WEAK_COLLAPSE        - std=0.0027, corr=-0.050, dir_acc=0.531
[WEAK] 2021-06-29 to 2021-07-08 (   7 days): WEAK_COLLAPSE        - std=0.0006, corr=-0.161, dir_acc=0.560
[UNI ] 2021-07-09 to 2023-03-01 ( 410 days): UNIDIRECTIONAL       - std=0.0152, corr=-0.043, dir_acc=0.488
[UNI ] 2023-03-10 to 2023-04-06 (  20 days): UNIDIRECTIONAL       - std=0.0020, corr=-0.191, dir_acc=0.500
[UNI ] 2023-04-14 to 2024-02-26 ( 217 days): UNIDIRECTIONAL       - std=0.0126, corr=-0.011, dir_acc=0.549
[WEAK] 2024-02-27 to 2024-04-22 (  39 days): WEAK_COLLAPSE        - std=0.0047, corr=-0.121, dir_acc=0.573
[UNI ] 2024-04-23 to 2025-10-06 ( 363 days): UNIDIRECTIONAL       - std=0.0168, corr=+0.016, dir_acc=0.568
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:   1052 days ( 82.2%)
  WEAK_COLLAPSE:     198 days ( 15.5%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep_lr_0.0007/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.199952
  RMSE:             1.095423
  MAE:              0.782085
  Out-of-sample RÂ²: -0.0197

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5314

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep_lr_0.0007/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:01:40
======================================================================
---
Processing: 00_baseline_exploration/sweep_lr_0.001
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep_lr_0.001
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep_lr_0.001/checkpoints/tft-epoch=00-val_loss=0.1370.ckpt
  Validation loss: 0.137026

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep_lr_0.001/config.json
Output directory: experiments/00_baseline_exploration/sweep_lr_0.001/evaluation
Logging to: experiments/00_baseline_exploration/sweep_lr_0.001/evaluation/evaluation_20251027_120141.log
Evaluation started at: 2025-10-27 12:01:41
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.103587
    Max: 0.177104
    Mean: 0.151069
    Std: 0.015213
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1036, max: 0.1771, mean: 0.1511
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  597 days ( 46.6%)
3. Consecutive-similarity      [WARN]  507 days ( 39.6%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    730 days ( 57.0%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 304 days ( 23.8%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0008, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-03-18 ( 114 days): WEAK_COLLAPSE        - std=0.0042, corr=-0.020, dir_acc=0.556
[UNI ] 2021-03-19 to 2021-03-30 (   8 days): UNIDIRECTIONAL       - std=0.0006, corr=+0.052, dir_acc=0.558
[WEAK] 2021-03-31 to 2021-12-02 ( 170 days): WEAK_COLLAPSE        - std=0.0032, corr=-0.087, dir_acc=0.566
[UNI ] 2021-12-03 to 2021-12-20 (  12 days): UNIDIRECTIONAL       - std=0.0016, corr=+0.229, dir_acc=0.603
[WEAK] 2021-12-21 to 2022-01-18 (  19 days): WEAK_COLLAPSE        - std=0.0020, corr=+0.196, dir_acc=0.591
[UNI ] 2022-01-19 to 2022-03-02 (  30 days): UNIDIRECTIONAL       - std=0.0035, corr=+0.277, dir_acc=0.464
[WEAK] 2022-03-03 to 2022-03-10 (   6 days): WEAK_COLLAPSE        - std=0.0015, corr=+0.243, dir_acc=0.408
[UNI ] 2022-03-11 to 2022-08-11 ( 106 days): UNIDIRECTIONAL       - std=0.0076, corr=-0.003, dir_acc=0.455
[WEAK] 2022-08-12 to 2022-10-17 (  45 days): WEAK_COLLAPSE        - std=0.0060, corr=-0.025, dir_acc=0.449
[UNI ] 2022-10-18 to 2023-02-27 (  89 days): UNIDIRECTIONAL       - std=0.0124, corr=-0.118, dir_acc=0.415
[WEAK] 2023-02-28 to 2023-04-17 (  34 days): WEAK_COLLAPSE        - std=0.0024, corr=-0.136, dir_acc=0.495
[UNI ] 2023-04-18 to 2024-02-26 ( 215 days): UNIDIRECTIONAL       - std=0.0091, corr=-0.005, dir_acc=0.549
[WEAK] 2024-02-27 to 2024-04-23 (  40 days): WEAK_COLLAPSE        - std=0.0040, corr=-0.135, dir_acc=0.571
[UNI ] 2024-04-24 to 2025-08-21 ( 331 days): UNIDIRECTIONAL       - std=0.0112, corr=+0.032, dir_acc=0.569
[UNI ] 2025-08-25 to 2025-10-06 (  30 days): UNIDIRECTIONAL       - std=0.0038, corr=-0.098, dir_acc=0.564
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    821 days ( 64.1%)
  WEAK_COLLAPSE:     429 days ( 33.5%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep_lr_0.001/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.185095
  RMSE:             1.088621
  MAE:              0.774826
  Out-of-sample RÂ²: -0.0071

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5422

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep_lr_0.001/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:01:42
======================================================================
---
Processing: 00_baseline_exploration/sweep_lr_0.002
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep_lr_0.002
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep_lr_0.002/checkpoints/tft-epoch=00-val_loss=0.1701.ckpt
  Validation loss: 0.170112

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep_lr_0.002/config.json
Output directory: experiments/00_baseline_exploration/sweep_lr_0.002/evaluation
Logging to: experiments/00_baseline_exploration/sweep_lr_0.002/evaluation/evaluation_20251027_120144.log
Evaluation started at: 2025-10-27 12:01:44
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.015348
    Max: 0.082184
    Mean: 0.050214
    Std: 0.014044
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0153, max: 0.0822, mean: 0.0502
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  629 days ( 49.1%)
3. Consecutive-similarity      [WARN]  865 days ( 67.6%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    362 days ( 28.3%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 157 days ( 12.3%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0010, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-04-13 ( 131 days): WEAK_COLLAPSE        - std=0.0059, corr=+0.017, dir_acc=0.555
[UNI ] 2021-04-14 to 2021-05-27 (  32 days): UNIDIRECTIONAL       - std=0.0026, corr=-0.008, dir_acc=0.528
[WEAK] 2021-05-28 to 2021-11-10 ( 115 days): WEAK_COLLAPSE        - std=0.0040, corr=+0.093, dir_acc=0.577
[UNI ] 2021-11-12 to 2022-08-10 ( 186 days): UNIDIRECTIONAL       - std=0.0110, corr=+0.200, dir_acc=0.488
[WEAK] 2022-08-11 to 2022-10-28 (  55 days): WEAK_COLLAPSE        - std=0.0044, corr=+0.033, dir_acc=0.442
[UNI ] 2022-10-31 to 2023-01-10 (  48 days): UNIDIRECTIONAL       - std=0.0068, corr=-0.076, dir_acc=0.399
[UNI ] 2023-01-12 to 2023-02-08 (  19 days): UNIDIRECTIONAL       - std=0.0006, corr=-0.081, dir_acc=0.443
[WEAK] 2023-02-09 to 2023-06-01 (  78 days): WEAK_COLLAPSE        - std=0.0031, corr=+0.058, dir_acc=0.495
[WEAK] 2023-06-08 to 2023-10-02 (  80 days): WEAK_COLLAPSE        - std=0.0049, corr=-0.058, dir_acc=0.541
[UNI ] 2023-10-03 to 2024-02-22 (  97 days): UNIDIRECTIONAL       - std=0.0092, corr=+0.124, dir_acc=0.565
[WEAK] 2024-02-23 to 2024-05-06 (  51 days): WEAK_COLLAPSE        - std=0.0047, corr=-0.107, dir_acc=0.561
[UNI ] 2024-05-07 to 2024-10-30 ( 122 days): UNIDIRECTIONAL       - std=0.0085, corr=+0.186, dir_acc=0.582
[UNI ] 2024-11-04 to 2024-12-02 (  19 days): UNIDIRECTIONAL       - std=0.0039, corr=+0.112, dir_acc=0.566
[WEAK] 2024-12-03 to 2024-12-16 (  10 days): WEAK_COLLAPSE        - std=0.0030, corr=+0.037, dir_acc=0.610
[UNI ] 2024-12-17 to 2025-02-14 (  40 days): UNIDIRECTIONAL       - std=0.0055, corr=+0.132, dir_acc=0.563
[WEAK] 2025-02-18 to 2025-02-28 (   9 days): WEAK_COLLAPSE        - std=0.0016, corr=+0.103, dir_acc=0.543
[UNI ] 2025-03-03 to 2025-07-09 (  89 days): UNIDIRECTIONAL       - std=0.0052, corr=+0.052, dir_acc=0.547
[WEAK] 2025-07-10 to 2025-10-06 (  62 days): WEAK_COLLAPSE        - std=0.0040, corr=+0.029, dir_acc=0.584
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    656 days ( 51.2%)
  WEAK_COLLAPSE:     594 days ( 46.4%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep_lr_0.002/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.175750
  RMSE:             1.084320
  MAE:              0.772066
  Out-of-sample RÂ²: 0.0009

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5406

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep_lr_0.002/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:01:45
======================================================================
---
Processing: 00_baseline_exploration/sweep2_combo1
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_combo1
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_combo1/checkpoints/tft-epoch=04-val_loss=0.1253.ckpt
  Validation loss: 0.125286

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_combo1/config.json
Output directory: experiments/00_baseline_exploration/sweep2_combo1/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_combo1/evaluation/evaluation_20251027_120146.log
Evaluation started at: 2025-10-27 12:01:46
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1261 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1260, Total actuals: 1260

Prediction Generation Summary:
  Total predictions: 1260
  Test dataset size: 1260
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.026537
    Max: 0.126190
    Mean: 0.075311
    Std: 0.019504
    Unique values: 1260

WARNING: Predictions (1260) < Test samples (1300)
Date range: 2020-09-17T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-09-17T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1260 samples)
Computing metrics...
Predictions - min: 0.0265, max: 0.1262, mean: 0.0753
Negative predictions: 0/1260
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  301 days ( 23.9%)
2. Range-based                 [WARN]  488 days ( 38.7%)
3. Consecutive-similarity      [WARN]  618 days ( 49.0%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                   1059 days ( 84.0%)
  Directional acc < 52%                480 days ( 38.1%)
  Combined (BOTH poor)                 388 days ( 30.8%)
  Unidirectional (>98%)        [WARN]  1230 days ( 97.6%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-09-17 to 2020-10-28 (  29 days): HEALTHY              - std=0.0024, corr=+0.000, dir_acc=0.500
[FAIL] 2020-10-30 to 2020-12-01 (  21 days): STRONG_COLLAPSE      - std=0.0032, corr=-0.144, dir_acc=0.522
[WEAK] 2020-12-02 to 2021-01-04 (  22 days): WEAK_COLLAPSE        - std=0.0060, corr=-0.089, dir_acc=0.525
[UNI ] 2021-01-05 to 2021-07-20 ( 136 days): UNIDIRECTIONAL       - std=0.0064, corr=-0.083, dir_acc=0.548
[WEAK] 2021-07-21 to 2021-08-11 (  16 days): WEAK_COLLAPSE        - std=0.0012, corr=-0.123, dir_acc=0.569
[FAIL] 2021-08-12 to 2021-12-01 (  76 days): STRONG_COLLAPSE      - std=0.0034, corr=-0.237, dir_acc=0.593
[UNI ] 2021-12-08 to 2021-12-17 (   8 days): UNIDIRECTIONAL       - std=0.0030, corr=-0.174, dir_acc=0.610
[WEAK] 2021-12-20 to 2021-12-31 (   9 days): WEAK_COLLAPSE        - std=0.0021, corr=-0.109, dir_acc=0.615
[UNI ] 2022-01-03 to 2022-07-28 ( 143 days): UNIDIRECTIONAL       - std=0.0156, corr=-0.122, dir_acc=0.463
[WEAK] 2022-08-05 to 2022-08-12 (   6 days): WEAK_COLLAPSE        - std=0.0013, corr=-0.115, dir_acc=0.467
[UNI ] 2022-08-15 to 2023-02-14 ( 125 days): UNIDIRECTIONAL       - std=0.0111, corr=-0.118, dir_acc=0.425
[WEAK] 2023-02-15 to 2023-03-30 (  31 days): WEAK_COLLAPSE        - std=0.0031, corr=-0.057, dir_acc=0.470
[FAIL] 2023-03-31 to 2023-04-28 (  20 days): STRONG_COLLAPSE      - std=0.0021, corr=-0.233, dir_acc=0.525
[WEAK] 2023-05-01 to 2023-06-02 (  24 days): WEAK_COLLAPSE        - std=0.0018, corr=-0.175, dir_acc=0.512
[UNI ] 2023-06-05 to 2023-06-14 (   8 days): UNIDIRECTIONAL       - std=0.0004, corr=-0.102, dir_acc=0.560
[WEAK] 2023-06-15 to 2023-07-13 (  19 days): WEAK_COLLAPSE        - std=0.0005, corr=-0.009, dir_acc=0.542
[FAIL] 2023-07-14 to 2023-10-02 (  56 days): STRONG_COLLAPSE      - std=0.0035, corr=-0.038, dir_acc=0.539
[WEAK] 2023-10-03 to 2023-10-19 (  12 days): WEAK_COLLAPSE        - std=0.0015, corr=-0.087, dir_acc=0.479
[UNI ] 2023-10-20 to 2023-11-30 (  29 days): UNIDIRECTIONAL       - std=0.0052, corr=-0.100, dir_acc=0.497
[WEAK] 2023-12-01 to 2023-12-19 (  13 days): WEAK_COLLAPSE        - std=0.0011, corr=-0.089, dir_acc=0.568
[UNI ] 2023-12-20 to 2024-01-26 (  25 days): UNIDIRECTIONAL       - std=0.0009, corr=-0.056, dir_acc=0.629
[WEAK] 2024-01-29 to 2024-02-13 (  12 days): WEAK_COLLAPSE        - std=0.0002, corr=-0.145, dir_acc=0.651
[FAIL] 2024-02-14 to 2024-08-06 ( 120 days): STRONG_COLLAPSE      - std=0.0029, corr=-0.032, dir_acc=0.571
[UNI ] 2024-08-07 to 2025-09-18 ( 278 days): UNIDIRECTIONAL       - std=0.0116, corr=-0.174, dir_acc=0.569
[WEAK] 2025-09-19 to 2025-10-02 (  10 days): WEAK_COLLAPSE        - std=0.0004, corr=-0.114, dir_acc=0.567
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            0 days (  0.0%)
  UNIDIRECTIONAL:    752 days ( 59.7%)
  WEAK_COLLAPSE:     179 days ( 14.2%)
  STRONG_COLLAPSE:   300 days ( 23.8%)

  Total problematic: 1231 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_combo1/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.168689
  RMSE:             1.081059
  MAE:              0.769293
  Out-of-sample RÂ²: -0.0016

FINANCIAL METRICS:
  Directional Acc:  53.49%
  Sharpe Ratio:     0.8492
  Total Return:     92.40%
  Max Drawdown:     -25.25%
  Hit Rate:         53.49%
  Number of Trades: 1260

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5349
  Recall:           1.0000
  F1 Score:         0.6970
  AUC-ROC:          0.4990

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             586
  Actual Up:            0             674

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_combo1/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:01:48
======================================================================
---
Processing: 00_baseline_exploration/sweep2_combo2
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_combo2
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_combo2/checkpoints/tft-epoch=03-val_loss=0.1249.ckpt
  Validation loss: 0.124887

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_combo2/config.json
Output directory: experiments/00_baseline_exploration/sweep2_combo2/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_combo2/evaluation/evaluation_20251027_120149.log
Evaluation started at: 2025-10-27 12:01:49
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1271 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1270, Total actuals: 1270

Prediction Generation Summary:
  Total predictions: 1270
  Test dataset size: 1270
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.071648
    Max: -0.024248
    Mean: -0.044235
    Std: 0.011009
    Unique values: 1266

WARNING: Predictions (1270) < Test samples (1300)
Date range: 2020-09-02T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-09-02T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1270 samples)
Computing metrics...
Predictions - min: -0.0716, max: -0.0242, mean: -0.0442
Negative predictions: 1270/1270
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  297 days ( 23.4%)
2. Range-based                 [WARN] 1176 days ( 92.6%)
3. Consecutive-similarity      [WARN] 1230 days ( 96.9%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    778 days ( 61.3%)
  Directional acc < 52%                976 days ( 76.9%)
  Combined (BOTH poor)                 612 days ( 48.2%)
  Unidirectional (>98%)        [WARN]  1240 days ( 97.6%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-09-02 to 2020-10-14 (  29 days): HEALTHY              - std=0.0019, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-16 to 2021-03-10 (  98 days): WEAK_COLLAPSE        - std=0.0045, corr=-0.086, dir_acc=0.464
[FAIL] 2021-03-11 to 2021-03-26 (  12 days): STRONG_COLLAPSE      - std=0.0009, corr=+0.061, dir_acc=0.432
[WEAK] 2021-03-29 to 2021-07-20 (  79 days): WEAK_COLLAPSE        - std=0.0027, corr=-0.013, dir_acc=0.460
[FAIL] 2021-07-21 to 2021-12-14 ( 101 days): STRONG_COLLAPSE      - std=0.0009, corr=+0.015, dir_acc=0.411
[WEAK] 2021-12-15 to 2022-03-17 (  64 days): WEAK_COLLAPSE        - std=0.0044, corr=+0.126, dir_acc=0.499
[UNI ] 2022-03-18 to 2022-06-21 (  65 days): UNIDIRECTIONAL       - std=0.0060, corr=-0.108, dir_acc=0.545
[WEAK] 2022-06-22 to 2023-07-24 ( 271 days): WEAK_COLLAPSE        - std=0.0099, corr=-0.045, dir_acc=0.534
[FAIL] 2023-07-25 to 2023-09-18 (  39 days): STRONG_COLLAPSE      - std=0.0013, corr=-0.050, dir_acc=0.456
[WEAK] 2023-09-27 to 2024-02-14 (  96 days): WEAK_COLLAPSE        - std=0.0029, corr=-0.143, dir_acc=0.441
[FAIL] 2024-02-15 to 2024-04-18 (  44 days): STRONG_COLLAPSE      - std=0.0011, corr=-0.168, dir_acc=0.415
[WEAK] 2024-04-19 to 2024-06-24 (  45 days): WEAK_COLLAPSE        - std=0.0010, corr=-0.023, dir_acc=0.477
[FAIL] 2024-06-25 to 2024-08-06 (  30 days): STRONG_COLLAPSE      - std=0.0012, corr=-0.024, dir_acc=0.378
[WEAK] 2024-08-07 to 2024-11-01 (  61 days): WEAK_COLLAPSE        - std=0.0016, corr=+0.138, dir_acc=0.411
[FAIL] 2024-11-04 to 2024-12-18 (  31 days): STRONG_COLLAPSE      - std=0.0008, corr=+0.159, dir_acc=0.420
[WEAK] 2024-12-19 to 2025-05-16 ( 101 days): WEAK_COLLAPSE        - std=0.0039, corr=-0.010, dir_acc=0.465
[UNI ] 2025-05-19 to 2025-06-02 (  10 days): UNIDIRECTIONAL       - std=0.0022, corr=-0.005, dir_acc=0.425
[WEAK] 2025-06-03 to 2025-08-14 (  51 days): WEAK_COLLAPSE        - std=0.0005, corr=+0.009, dir_acc=0.392
[FAIL] 2025-08-15 to 2025-10-06 (  36 days): STRONG_COLLAPSE      - std=0.0004, corr=-0.191, dir_acc=0.436
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:     75 days (  5.9%)
  WEAK_COLLAPSE:     868 days ( 68.3%)
  STRONG_COLLAPSE:   297 days ( 23.4%)

  Total problematic: 1241 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_combo2/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.192757
  RMSE:             1.092134
  MAE:              0.780820
  Out-of-sample RÂ²: -0.0079

FINANCIAL METRICS:
  Directional Acc:  46.54%
  Sharpe Ratio:     0.0000
  Total Return:     0.00%
  Max Drawdown:     0.00%
  Hit Rate:         0.00%
  Number of Trades: 0

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.0000
  Recall:           0.0000
  F1 Score:         0.0000
  AUC-ROC:          0.5398

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        591               0
  Actual Up:          679               0

ALPHA (vs Buy-and-Hold):
  Excess Return:    -84.70%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_combo2/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:01:50
======================================================================
---
Processing: 00_baseline_exploration/sweep2_combo3
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_combo3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_combo3/checkpoints/tft-epoch=03-val_loss=0.1409.ckpt
  Validation loss: 0.140893

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_combo3/config.json
Output directory: experiments/00_baseline_exploration/sweep2_combo3/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_combo3/evaluation/evaluation_20251027_120152.log
Evaluation started at: 2025-10-27 12:01:52
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1271 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1270, Total actuals: 1270

Prediction Generation Summary:
  Total predictions: 1270
  Test dataset size: 1270
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.081186
    Max: 0.507954
    Mean: 0.192054
    Std: 0.113448
    Unique values: 1270

WARNING: Predictions (1270) < Test samples (1300)
Date range: 2020-09-02T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-09-02T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1270 samples)
Computing metrics...
Predictions - min: 0.0812, max: 0.5080, mean: 0.1921
Negative predictions: 0/1270
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   97 days (  7.6%)
2. Range-based                 [WARN]  181 days ( 14.3%)
3. Consecutive-similarity      [ OK ]   94 days (  7.4%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    167 days ( 13.1%)
  Directional acc < 52%                495 days ( 39.0%)
  Combined (BOTH poor)                  61 days (  4.8%)
  Unidirectional (>98%)        [WARN]  1240 days ( 97.6%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-09-02 to 2020-10-15 (  30 days): HEALTHY              - std=0.0101, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-16 to 2023-08-25 ( 714 days): UNIDIRECTIONAL       - std=0.1254, corr=+0.121, dir_acc=0.508
[WEAK] 2023-08-28 to 2023-10-04 (  27 days): WEAK_COLLAPSE        - std=0.0042, corr=+0.001, dir_acc=0.511
[UNI ] 2023-10-05 to 2024-02-09 (  87 days): UNIDIRECTIONAL       - std=0.0187, corr=+0.174, dir_acc=0.561
[FAIL] 2024-02-13 to 2024-04-22 (  48 days): STRONG_COLLAPSE      - std=0.0024, corr=-0.198, dir_acc=0.583
[UNI ] 2024-04-30 to 2024-05-07 (   6 days): UNIDIRECTIONAL       - std=0.0019, corr=+0.032, dir_acc=0.500
[UNI ] 2024-05-15 to 2024-07-08 (  36 days): UNIDIRECTIONAL       - std=0.0032, corr=+0.094, dir_acc=0.549
[WEAK] 2024-07-09 to 2024-07-18 (   8 days): WEAK_COLLAPSE        - std=0.0006, corr=+0.039, dir_acc=0.654
[FAIL] 2024-07-19 to 2024-08-02 (  11 days): STRONG_COLLAPSE      - std=0.0019, corr=-0.061, dir_acc=0.633
[UNI ] 2024-08-05 to 2025-10-03 ( 291 days): UNIDIRECTIONAL       - std=0.0831, corr=+0.132, dir_acc=0.569
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            30 days (  2.4%)
  DEGRADED:            0 days (  0.0%)
  UNIDIRECTIONAL:   1134 days ( 89.3%)
  WEAK_COLLAPSE:      47 days (  3.7%)
  STRONG_COLLAPSE:    59 days (  4.6%)

  Total problematic: 1240 days (97.6%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_combo3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.212385
  RMSE:             1.101084
  MAE:              0.785103
  Out-of-sample RÂ²: -0.0245

FINANCIAL METRICS:
  Directional Acc:  53.46%
  Sharpe Ratio:     0.7915
  Total Return:     84.70%
  Max Drawdown:     -25.25%
  Hit Rate:         53.46%
  Number of Trades: 1270

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5346
  Recall:           1.0000
  F1 Score:         0.6968
  AUC-ROC:          0.4733

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             591
  Actual Up:            0             679

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_combo3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:01:53
======================================================================
---
Processing: 00_baseline_exploration/sweep2_h16_drop_0.05
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_h16_drop_0.05
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_h16_drop_0.05/checkpoints/tft-epoch=01-val_loss=0.1388.ckpt
  Validation loss: 0.138778

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_h16_drop_0.05/config.json
Output directory: experiments/00_baseline_exploration/sweep2_h16_drop_0.05/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_h16_drop_0.05/evaluation/evaluation_20251027_120154.log
Evaluation started at: 2025-10-27 12:01:54
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.146745
    Max: 0.109964
    Mean: -0.052392
    Std: 0.073581
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.1467, max: 0.1100, mean: -0.0524
Negative predictions: 863/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]  120 days (  9.4%)
2. Range-based                 [WARN]  203 days ( 15.9%)
3. Consecutive-similarity      [WARN]  312 days ( 24.4%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    740 days ( 57.8%)
  Directional acc < 52%                707 days ( 55.2%)
  Combined (BOTH poor)                 467 days ( 36.5%)
  Unidirectional (>98%)        [WARN]   873 days ( 68.2%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-30 (  30 days): HEALTHY              - std=0.0087, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2021-04-15 ( 133 days): UNIDIRECTIONAL       - std=0.0255, corr=-0.115, dir_acc=0.445
[ OK ] 2021-05-03 to 2021-05-13 (   9 days): HEALTHY              - std=0.0125, corr=+0.017, dir_acc=0.489
[DEGD] 2021-05-14 to 2021-07-15 (  43 days): DEGRADED             - std=0.0079, corr=-0.076, dir_acc=0.454
[UNI ] 2021-07-16 to 2022-06-10 ( 227 days): UNIDIRECTIONAL       - std=0.0184, corr=-0.101, dir_acc=0.471
[WEAK] 2022-06-13 to 2022-07-26 (  30 days): WEAK_COLLAPSE        - std=0.0058, corr=-0.067, dir_acc=0.543
[UNI ] 2022-07-27 to 2022-09-19 (  38 days): UNIDIRECTIONAL       - std=0.0017, corr=-0.114, dir_acc=0.532
[WEAK] 2022-09-20 to 2022-10-05 (  12 days): WEAK_COLLAPSE        - std=0.0015, corr=+0.052, dir_acc=0.565
[FAIL] 2022-10-06 to 2023-03-31 ( 120 days): STRONG_COLLAPSE      - std=0.0026, corr=+0.079, dir_acc=0.572
[WEAK] 2023-04-03 to 2023-04-19 (  12 days): WEAK_COLLAPSE        - std=0.0016, corr=+0.088, dir_acc=0.474
[UNI ] 2023-04-20 to 2023-11-14 ( 144 days): UNIDIRECTIONAL       - std=0.0382, corr=-0.042, dir_acc=0.479
[ OK ] 2023-11-15 to 2024-02-07 (  57 days): HEALTHY              - std=0.0127, corr=+0.093, dir_acc=0.575
[UNI ] 2024-02-08 to 2024-02-26 (  12 days): UNIDIRECTIONAL       - std=0.0017, corr=-0.012, dir_acc=0.633
[WEAK] 2024-02-27 to 2024-04-08 (  29 days): WEAK_COLLAPSE        - std=0.0034, corr=+0.010, dir_acc=0.587
[ OK ] 2024-04-17 to 2024-07-31 (  73 days): HEALTHY              - std=0.0154, corr=+0.036, dir_acc=0.545
[ OK ] 2024-08-08 to 2024-08-15 (   6 days): HEALTHY              - std=0.0058, corr=-0.162, dir_acc=0.567
[DEGD] 2024-08-28 to 2024-11-07 (  50 days): DEGRADED             - std=0.0260, corr=-0.243, dir_acc=0.481
[ OK ] 2024-11-08 to 2024-11-19 (   7 days): HEALTHY              - std=0.0030, corr=-0.125, dir_acc=0.543
[UNI ] 2024-11-20 to 2025-03-06 (  71 days): UNIDIRECTIONAL       - std=0.0270, corr=+0.038, dir_acc=0.565
[ OK ] 2025-03-07 to 2025-04-03 (  20 days): HEALTHY              - std=0.0322, corr=+0.072, dir_acc=0.511
[ OK ] 2025-04-09 to 2025-05-07 (  20 days): HEALTHY              - std=0.0341, corr=+0.050, dir_acc=0.487
[DEGD] 2025-05-08 to 2025-07-16 (  47 days): DEGRADED             - std=0.0398, corr=-0.061, dir_acc=0.469
[DEGD] 2025-07-18 to 2025-07-25 (   6 days): DEGRADED             - std=0.0086, corr=-0.217, dir_acc=0.517
[DEGD] 2025-07-31 to 2025-08-07 (   6 days): DEGRADED             - std=0.0074, corr=-0.240, dir_acc=0.514
[UNI ] 2025-08-12 to 2025-10-06 (  39 days): UNIDIRECTIONAL       - std=0.0074, corr=-0.171, dir_acc=0.564
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           235 days ( 18.4%)
  DEGRADED:          172 days ( 13.4%)
  UNIDIRECTIONAL:    670 days ( 52.3%)
  WEAK_COLLAPSE:      83 days (  6.5%)
  STRONG_COLLAPSE:   120 days (  9.4%)

  Total problematic: 1045 days (81.6%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_h16_drop_0.05/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.190743
  RMSE:             1.091212
  MAE:              0.778039
  Out-of-sample RÂ²: -0.0119

FINANCIAL METRICS:
  Directional Acc:  51.09%
  Sharpe Ratio:     0.6879
  Total Return:     34.31%
  Max Drawdown:     -17.85%
  Hit Rate:         18.67%
  Number of Trades: 417

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5731
  Recall:           0.3479
  F1 Score:         0.4330
  AUC-ROC:          0.5449

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        415             178
  Actual Up:          448             239

ALPHA (vs Buy-and-Hold):
  Excess Return:    -57.85%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_h16_drop_0.05/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:01:55
======================================================================
---
Processing: 00_baseline_exploration/sweep2_h16_drop_0.1
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_h16_drop_0.1
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_h16_drop_0.1/checkpoints/tft-epoch=01-val_loss=0.1322.ckpt
  Validation loss: 0.132155

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_h16_drop_0.1/config.json
Output directory: experiments/00_baseline_exploration/sweep2_h16_drop_0.1/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_h16_drop_0.1/evaluation/evaluation_20251027_120157.log
Evaluation started at: 2025-10-27 12:01:57
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.111615
    Max: 0.141732
    Mean: -0.015853
    Std: 0.074493
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.1116, max: 0.1417, mean: -0.0159
Negative predictions: 740/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]  121 days (  9.5%)
2. Range-based                 [WARN]  199 days ( 15.5%)
3. Consecutive-similarity      [WARN]  305 days ( 23.8%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    747 days ( 58.4%)
  Directional acc < 52%                585 days ( 45.7%)
  Combined (BOTH poor)                 369 days ( 28.8%)
  Unidirectional (>98%)        [WARN]   983 days ( 76.8%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-30 (  30 days): HEALTHY              - std=0.0086, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2021-04-06 ( 126 days): UNIDIRECTIONAL       - std=0.0190, corr=-0.120, dir_acc=0.444
[ OK ] 2021-05-03 to 2021-05-13 (   9 days): HEALTHY              - std=0.0123, corr=+0.016, dir_acc=0.524
[DEGD] 2021-05-14 to 2021-07-30 (  54 days): DEGRADED             - std=0.0138, corr=-0.108, dir_acc=0.474
[UNI ] 2021-08-02 to 2022-06-13 ( 217 days): UNIDIRECTIONAL       - std=0.0191, corr=-0.108, dir_acc=0.473
[WEAK] 2022-06-14 to 2022-07-26 (  29 days): WEAK_COLLAPSE        - std=0.0059, corr=-0.076, dir_acc=0.543
[UNI ] 2022-07-27 to 2022-09-19 (  38 days): UNIDIRECTIONAL       - std=0.0017, corr=-0.114, dir_acc=0.532
[WEAK] 2022-09-20 to 2022-10-04 (  11 days): WEAK_COLLAPSE        - std=0.0016, corr=+0.047, dir_acc=0.565
[FAIL] 2022-10-05 to 2023-03-31 ( 121 days): STRONG_COLLAPSE      - std=0.0027, corr=+0.079, dir_acc=0.571
[WEAK] 2023-04-03 to 2023-04-14 (   9 days): WEAK_COLLAPSE        - std=0.0015, corr=+0.080, dir_acc=0.474
[UNI ] 2023-04-17 to 2023-07-21 (  67 days): UNIDIRECTIONAL       - std=0.0261, corr=+0.015, dir_acc=0.468
[DEGD] 2023-07-31 to 2023-10-26 (  62 days): DEGRADED             - std=0.0102, corr=-0.146, dir_acc=0.449
[ OK ] 2023-10-27 to 2024-01-23 (  59 days): HEALTHY              - std=0.0226, corr=+0.119, dir_acc=0.668
[UNI ] 2024-01-24 to 2024-02-26 (  23 days): UNIDIRECTIONAL       - std=0.0038, corr=-0.049, dir_acc=0.647
[WEAK] 2024-02-27 to 2024-04-08 (  29 days): WEAK_COLLAPSE        - std=0.0033, corr=+0.009, dir_acc=0.587
[UNI ] 2024-04-09 to 2025-05-08 ( 270 days): UNIDIRECTIONAL       - std=0.0307, corr=-0.030, dir_acc=0.560
[ OK ] 2025-05-13 to 2025-08-05 (  58 days): HEALTHY              - std=0.0284, corr=-0.113, dir_acc=0.586
[UNI ] 2025-08-06 to 2025-10-06 (  43 days): UNIDIRECTIONAL       - std=0.0075, corr=-0.187, dir_acc=0.566
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           171 days ( 13.4%)
  DEGRADED:          126 days (  9.8%)
  UNIDIRECTIONAL:    784 days ( 61.3%)
  WEAK_COLLAPSE:      78 days (  6.1%)
  STRONG_COLLAPSE:   121 days (  9.5%)

  Total problematic: 1109 days (86.6%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_h16_drop_0.1/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.184442
  RMSE:             1.088321
  MAE:              0.774635
  Out-of-sample RÂ²: -0.0065

FINANCIAL METRICS:
  Directional Acc:  52.73%
  Sharpe Ratio:     0.9333
  Total Return:     56.60%
  Max Drawdown:     -18.90%
  Hit Rate:         24.30%
  Number of Trades: 540

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5759
  Recall:           0.4527
  F1 Score:         0.5069
  AUC-ROC:          0.5441

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        364             229
  Actual Up:          376             311

ALPHA (vs Buy-and-Hold):
  Excess Return:    -35.56%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_h16_drop_0.1/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:01:58
======================================================================
---
Processing: 00_baseline_exploration/sweep2_h16_drop_0.15
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_h16_drop_0.15
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_h16_drop_0.15/checkpoints/tft-epoch=01-val_loss=0.1324.ckpt
  Validation loss: 0.132447

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_h16_drop_0.15/config.json
Output directory: experiments/00_baseline_exploration/sweep2_h16_drop_0.15/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_h16_drop_0.15/evaluation/evaluation_20251027_120159.log
Evaluation started at: 2025-10-27 12:01:59
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.103241
    Max: 0.152375
    Mean: -0.003492
    Std: 0.076916
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.1032, max: 0.1524, mean: -0.0035
Negative predictions: 694/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   89 days (  7.0%)
2. Range-based                 [WARN]  187 days ( 14.6%)
3. Consecutive-similarity      [WARN]  294 days ( 23.0%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    758 days ( 59.2%)
  Directional acc < 52%                585 days ( 45.7%)
  Combined (BOTH poor)                 374 days ( 29.2%)
  Unidirectional (>98%)        [WARN]  1085 days ( 84.8%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-30 (  30 days): HEALTHY              - std=0.0083, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2021-04-05 ( 125 days): UNIDIRECTIONAL       - std=0.0188, corr=-0.114, dir_acc=0.444
[ OK ] 2021-04-06 to 2021-04-13 (   6 days): HEALTHY              - std=0.0088, corr=+0.022, dir_acc=0.489
[ OK ] 2021-05-03 to 2021-05-13 (   9 days): HEALTHY              - std=0.0122, corr=+0.016, dir_acc=0.544
[DEGD] 2021-05-26 to 2021-06-08 (   9 days): DEGRADED             - std=0.0053, corr=-0.112, dir_acc=0.502
[DEGD] 2021-06-10 to 2021-09-07 (  62 days): DEGRADED             - std=0.0166, corr=-0.138, dir_acc=0.437
[UNI ] 2021-09-08 to 2022-06-15 ( 193 days): UNIDIRECTIONAL       - std=0.0206, corr=-0.111, dir_acc=0.485
[WEAK] 2022-06-16 to 2022-07-22 (  25 days): WEAK_COLLAPSE        - std=0.0057, corr=-0.059, dir_acc=0.545
[UNI ] 2022-07-25 to 2022-09-23 (  44 days): UNIDIRECTIONAL       - std=0.0019, corr=-0.099, dir_acc=0.534
[WEAK] 2022-09-26 to 2022-10-06 (   9 days): WEAK_COLLAPSE        - std=0.0014, corr=+0.081, dir_acc=0.572
[FAIL] 2022-10-07 to 2022-12-20 (  50 days): STRONG_COLLAPSE      - std=0.0029, corr=+0.122, dir_acc=0.601
[WEAK] 2022-12-21 to 2022-12-29 (   6 days): WEAK_COLLAPSE        - std=0.0017, corr=+0.111, dir_acc=0.594
[FAIL] 2022-12-30 to 2023-02-06 (  25 days): STRONG_COLLAPSE      - std=0.0018, corr=+0.063, dir_acc=0.568
[WEAK] 2023-02-07 to 2023-03-10 (  23 days): WEAK_COLLAPSE        - std=0.0017, corr=+0.075, dir_acc=0.548
[FAIL] 2023-03-13 to 2023-03-30 (  14 days): STRONG_COLLAPSE      - std=0.0038, corr=-0.000, dir_acc=0.511
[WEAK] 2023-03-31 to 2023-04-10 (   6 days): WEAK_COLLAPSE        - std=0.0019, corr=+0.088, dir_acc=0.464
[UNI ] 2023-04-11 to 2023-07-14 (  66 days): UNIDIRECTIONAL       - std=0.0226, corr=+0.013, dir_acc=0.471
[ OK ] 2023-07-17 to 2023-07-28 (  10 days): HEALTHY              - std=0.0121, corr=+0.045, dir_acc=0.467
[DEGD] 2023-07-31 to 2023-10-04 (  47 days): DEGRADED             - std=0.0097, corr=-0.163, dir_acc=0.445
[UNI ] 2023-10-05 to 2024-02-26 (  97 days): UNIDIRECTIONAL       - std=0.0283, corr=+0.034, dir_acc=0.567
[WEAK] 2024-02-27 to 2024-04-08 (  29 days): WEAK_COLLAPSE        - std=0.0033, corr=+0.006, dir_acc=0.587
[UNI ] 2024-04-09 to 2025-10-06 ( 373 days): UNIDIRECTIONAL       - std=0.0336, corr=-0.065, dir_acc=0.567
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            66 days (  5.2%)
  DEGRADED:          129 days ( 10.1%)
  UNIDIRECTIONAL:    898 days ( 70.2%)
  WEAK_COLLAPSE:      98 days (  7.7%)
  STRONG_COLLAPSE:    89 days (  7.0%)

  Total problematic: 1214 days (94.8%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_h16_drop_0.15/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.183202
  RMSE:             1.087751
  MAE:              0.773713
  Out-of-sample RÂ²: -0.0055

FINANCIAL METRICS:
  Directional Acc:  52.42%
  Sharpe Ratio:     0.8480
  Total Return:     52.05%
  Max Drawdown:     -18.90%
  Hit Rate:         25.94%
  Number of Trades: 586

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5666
  Recall:           0.4833
  F1 Score:         0.5216
  AUC-ROC:          0.5439

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        339             254
  Actual Up:          355             332

ALPHA (vs Buy-and-Hold):
  Excess Return:    -40.11%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_h16_drop_0.15/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:02:00
======================================================================
---
Processing: 00_baseline_exploration/sweep2_h16_drop_0.2
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_h16_drop_0.2
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_h16_drop_0.2/checkpoints/tft-epoch=01-val_loss=0.1284.ckpt
  Validation loss: 0.128439

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_h16_drop_0.2/config.json
Output directory: experiments/00_baseline_exploration/sweep2_h16_drop_0.2/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_h16_drop_0.2/evaluation/evaluation_20251027_120202.log
Evaluation started at: 2025-10-27 12:02:02
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.083295
    Max: 0.170167
    Mean: 0.017215
    Std: 0.077218
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0833, max: 0.1702, mean: 0.0172
Negative predictions: 646/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   83 days (  6.5%)
2. Range-based                 [WARN]  186 days ( 14.5%)
3. Consecutive-similarity      [WARN]  290 days ( 22.7%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    766 days ( 59.8%)
  Directional acc < 52%                551 days ( 43.0%)
  Combined (BOTH poor)                 344 days ( 26.9%)
  Unidirectional (>98%)        [WARN]  1058 days ( 82.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-30 (  30 days): HEALTHY              - std=0.0082, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2021-03-23 ( 117 days): UNIDIRECTIONAL       - std=0.0152, corr=-0.110, dir_acc=0.443
[DEGD] 2021-03-24 to 2021-04-05 (   8 days): DEGRADED             - std=0.0068, corr=-0.146, dir_acc=0.423
[ OK ] 2021-04-06 to 2021-04-13 (   6 days): HEALTHY              - std=0.0087, corr=+0.023, dir_acc=0.472
[ OK ] 2021-05-03 to 2021-05-12 (   8 days): HEALTHY              - std=0.0079, corr=+0.018, dir_acc=0.527
[DEGD] 2021-05-13 to 2021-06-10 (  20 days): DEGRADED             - std=0.0085, corr=-0.077, dir_acc=0.497
[ OK ] 2021-06-21 to 2021-07-23 (  24 days): HEALTHY              - std=0.0116, corr=-0.138, dir_acc=0.548
[DEGD] 2021-08-11 to 2021-09-13 (  23 days): DEGRADED             - std=0.0046, corr=-0.120, dir_acc=0.478
[DEGD] 2021-09-15 to 2021-10-04 (  14 days): DEGRADED             - std=0.0059, corr=-0.117, dir_acc=0.470
[UNI ] 2021-10-05 to 2022-06-15 ( 174 days): UNIDIRECTIONAL       - std=0.0206, corr=-0.115, dir_acc=0.491
[WEAK] 2022-06-16 to 2022-07-22 (  25 days): WEAK_COLLAPSE        - std=0.0057, corr=-0.063, dir_acc=0.545
[UNI ] 2022-07-25 to 2022-09-23 (  44 days): UNIDIRECTIONAL       - std=0.0019, corr=-0.099, dir_acc=0.534
[WEAK] 2022-09-26 to 2022-10-06 (   9 days): WEAK_COLLAPSE        - std=0.0014, corr=+0.081, dir_acc=0.572
[FAIL] 2022-10-07 to 2022-12-20 (  50 days): STRONG_COLLAPSE      - std=0.0029, corr=+0.125, dir_acc=0.601
[WEAK] 2022-12-21 to 2022-12-30 (   7 days): WEAK_COLLAPSE        - std=0.0018, corr=+0.110, dir_acc=0.595
[FAIL] 2023-01-03 to 2023-02-01 (  21 days): STRONG_COLLAPSE      - std=0.0020, corr=+0.059, dir_acc=0.571
[WEAK] 2023-02-02 to 2023-03-14 (  28 days): WEAK_COLLAPSE        - std=0.0020, corr=+0.079, dir_acc=0.546
[FAIL] 2023-03-15 to 2023-03-30 (  12 days): STRONG_COLLAPSE      - std=0.0038, corr=-0.020, dir_acc=0.506
[UNI ] 2023-04-10 to 2023-06-30 (  58 days): UNIDIRECTIONAL       - std=0.0137, corr=+0.007, dir_acc=0.472
[ OK ] 2023-07-11 to 2023-07-28 (  14 days): HEALTHY              - std=0.0153, corr=+0.048, dir_acc=0.510
[DEGD] 2023-07-31 to 2023-09-08 (  29 days): DEGRADED             - std=0.0067, corr=-0.169, dir_acc=0.484
[UNI ] 2023-09-22 to 2024-02-26 ( 106 days): UNIDIRECTIONAL       - std=0.0305, corr=+0.013, dir_acc=0.561
[WEAK] 2024-02-27 to 2024-04-08 (  29 days): WEAK_COLLAPSE        - std=0.0033, corr=+0.004, dir_acc=0.587
[UNI ] 2024-04-09 to 2025-10-06 ( 373 days): UNIDIRECTIONAL       - std=0.0330, corr=-0.067, dir_acc=0.567
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           108 days (  8.4%)
  DEGRADED:          114 days (  8.9%)
  UNIDIRECTIONAL:    872 days ( 68.1%)
  WEAK_COLLAPSE:     103 days (  8.0%)
  STRONG_COLLAPSE:    83 days (  6.5%)

  Total problematic: 1172 days (91.6%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_h16_drop_0.2/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.181262
  RMSE:             1.086859
  MAE:              0.772644
  Out-of-sample RÂ²: -0.0038

FINANCIAL METRICS:
  Directional Acc:  53.05%
  Sharpe Ratio:     0.9282
  Total Return:     60.09%
  Max Drawdown:     -18.90%
  Hit Rate:         28.12%
  Number of Trades: 634

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5678
  Recall:           0.5240
  F1 Score:         0.5450
  AUC-ROC:          0.5435

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        319             274
  Actual Up:          327             360

ALPHA (vs Buy-and-Hold):
  Excess Return:    -32.08%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_h16_drop_0.2/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:02:03
======================================================================
---
Processing: 00_baseline_exploration/sweep2_h16_drop_0.25
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_h16_drop_0.25
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_h16_drop_0.25/checkpoints/tft-epoch=01-val_loss=0.1260.ckpt
  Validation loss: 0.125999

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_h16_drop_0.25/config.json
Output directory: experiments/00_baseline_exploration/sweep2_h16_drop_0.25/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_h16_drop_0.25/evaluation/evaluation_20251027_120204.log
Evaluation started at: 2025-10-27 12:02:04
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.060714
    Max: 0.193351
    Mean: 0.039860
    Std: 0.077330
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0607, max: 0.1934, mean: 0.0399
Negative predictions: 582/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   49 days (  3.8%)
2. Range-based                 [WARN]  184 days ( 14.4%)
3. Consecutive-similarity      [WARN]  286 days ( 22.3%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    767 days ( 59.9%)
  Directional acc < 52%                499 days ( 39.0%)
  Combined (BOTH poor)                 313 days ( 24.5%)
  Unidirectional (>98%)        [WARN]   994 days ( 77.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-30 (  30 days): HEALTHY              - std=0.0082, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2021-03-16 ( 112 days): UNIDIRECTIONAL       - std=0.0134, corr=-0.103, dir_acc=0.444
[DEGD] 2021-03-17 to 2021-04-05 (  13 days): DEGRADED             - std=0.0081, corr=-0.181, dir_acc=0.417
[ OK ] 2021-04-06 to 2021-04-13 (   6 days): HEALTHY              - std=0.0086, corr=+0.024, dir_acc=0.472
[ OK ] 2021-05-03 to 2021-05-12 (   8 days): HEALTHY              - std=0.0078, corr=+0.018, dir_acc=0.527
[DEGD] 2021-05-13 to 2021-06-07 (  17 days): DEGRADED             - std=0.0079, corr=-0.081, dir_acc=0.491
[UNI ] 2021-06-08 to 2021-07-21 (  31 days): UNIDIRECTIONAL       - std=0.0106, corr=-0.118, dir_acc=0.547
[ OK ] 2021-08-11 to 2021-08-20 (   8 days): HEALTHY              - std=0.0053, corr=-0.111, dir_acc=0.552
[DEGD] 2021-08-23 to 2021-09-13 (  15 days): DEGRADED             - std=0.0042, corr=-0.130, dir_acc=0.481
[DEGD] 2021-09-15 to 2021-11-03 (  35 days): DEGRADED             - std=0.0158, corr=-0.136, dir_acc=0.433
[ OK ] 2021-11-15 to 2022-02-03 (  56 days): HEALTHY              - std=0.0138, corr=-0.005, dir_acc=0.557
[UNI ] 2022-02-15 to 2022-06-17 (  86 days): UNIDIRECTIONAL       - std=0.0091, corr=-0.189, dir_acc=0.552
[WEAK] 2022-06-21 to 2022-07-22 (  23 days): WEAK_COLLAPSE        - std=0.0053, corr=-0.058, dir_acc=0.545
[UNI ] 2022-07-25 to 2022-09-23 (  44 days): UNIDIRECTIONAL       - std=0.0020, corr=-0.097, dir_acc=0.534
[WEAK] 2022-09-26 to 2022-10-07 (  10 days): WEAK_COLLAPSE        - std=0.0014, corr=+0.092, dir_acc=0.572
[WEAK] 2022-10-14 to 2022-11-18 (  25 days): WEAK_COLLAPSE        - std=0.0017, corr=+0.146, dir_acc=0.597
[FAIL] 2022-11-21 to 2022-12-19 (  20 days): STRONG_COLLAPSE      - std=0.0030, corr=+0.121, dir_acc=0.608
[WEAK] 2022-12-20 to 2023-01-10 (  14 days): WEAK_COLLAPSE        - std=0.0019, corr=+0.111, dir_acc=0.595
[FAIL] 2023-01-11 to 2023-01-31 (  14 days): STRONG_COLLAPSE      - std=0.0014, corr=+0.046, dir_acc=0.565
[WEAK] 2023-02-01 to 2023-03-14 (  29 days): WEAK_COLLAPSE        - std=0.0021, corr=+0.081, dir_acc=0.545
[FAIL] 2023-03-15 to 2023-03-30 (  12 days): STRONG_COLLAPSE      - std=0.0038, corr=-0.008, dir_acc=0.506
[UNI ] 2023-04-10 to 2023-06-22 (  52 days): UNIDIRECTIONAL       - std=0.0085, corr=+0.008, dir_acc=0.473
[ OK ] 2023-07-11 to 2023-07-20 (   8 days): HEALTHY              - std=0.0083, corr=+0.068, dir_acc=0.500
[DEGD] 2023-07-31 to 2023-09-08 (  29 days): DEGRADED             - std=0.0064, corr=-0.169, dir_acc=0.484
[UNI ] 2023-09-14 to 2024-02-26 ( 112 days): UNIDIRECTIONAL       - std=0.0304, corr=+0.001, dir_acc=0.559
[WEAK] 2024-02-27 to 2024-04-08 (  29 days): WEAK_COLLAPSE        - std=0.0033, corr=+0.004, dir_acc=0.587
[UNI ] 2024-04-09 to 2025-10-06 ( 373 days): UNIDIRECTIONAL       - std=0.0329, corr=-0.066, dir_acc=0.567
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           156 days ( 12.2%)
  DEGRADED:          130 days ( 10.2%)
  UNIDIRECTIONAL:    810 days ( 63.3%)
  WEAK_COLLAPSE:     135 days ( 10.5%)
  STRONG_COLLAPSE:    49 days (  3.8%)

  Total problematic: 1124 days (87.8%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_h16_drop_0.25/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.180080
  RMSE:             1.086315
  MAE:              0.772187
  Out-of-sample RÂ²: -0.0028

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     1.0193
  Total Return:     69.87%
  Max Drawdown:     -18.90%
  Hit Rate:         30.94%
  Number of Trades: 698

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5673
  Recall:           0.5764
  F1 Score:         0.5718
  AUC-ROC:          0.5429

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        291             302
  Actual Up:          291             396

ALPHA (vs Buy-and-Hold):
  Excess Return:    -22.29%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_h16_drop_0.25/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:02:06
======================================================================
---
Processing: 00_baseline_exploration/sweep2_h16_drop_0.3
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_h16_drop_0.3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_h16_drop_0.3/checkpoints/tft-epoch=01-val_loss=0.1280.ckpt
  Validation loss: 0.127994

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_h16_drop_0.3/config.json
Output directory: experiments/00_baseline_exploration/sweep2_h16_drop_0.3/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_h16_drop_0.3/evaluation/evaluation_20251027_120207.log
Evaluation started at: 2025-10-27 12:02:07
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.053870
    Max: 0.206286
    Mean: 0.048741
    Std: 0.078851
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0539, max: 0.2063, mean: 0.0487
Negative predictions: 535/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   39 days (  3.0%)
2. Range-based                 [WARN]  181 days ( 14.1%)
3. Consecutive-similarity      [WARN]  280 days ( 21.9%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    770 days ( 60.2%)
  Directional acc < 52%                453 days ( 35.4%)
  Combined (BOTH poor)                 279 days ( 21.8%)
  Unidirectional (>98%)        [WARN]   979 days ( 76.5%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-30 (  30 days): HEALTHY              - std=0.0083, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2021-02-11 (  90 days): UNIDIRECTIONAL       - std=0.0123, corr=-0.057, dir_acc=0.436
[DEGD] 2021-02-12 to 2021-04-05 (  35 days): DEGRADED             - std=0.0159, corr=-0.246, dir_acc=0.382
[ OK ] 2021-04-06 to 2021-04-13 (   6 days): HEALTHY              - std=0.0086, corr=+0.024, dir_acc=0.439
[ OK ] 2021-05-03 to 2021-05-12 (   8 days): HEALTHY              - std=0.0079, corr=+0.018, dir_acc=0.492
[DEGD] 2021-05-13 to 2021-06-03 (  15 days): DEGRADED             - std=0.0072, corr=-0.081, dir_acc=0.514
[UNI ] 2021-06-04 to 2021-08-03 (  42 days): UNIDIRECTIONAL       - std=0.0161, corr=-0.144, dir_acc=0.552
[ OK ] 2021-08-04 to 2021-09-22 (  35 days): HEALTHY              - std=0.0067, corr=-0.113, dir_acc=0.570
[DEGD] 2021-09-23 to 2021-10-25 (  22 days): DEGRADED             - std=0.0139, corr=-0.184, dir_acc=0.499
[ OK ] 2021-10-26 to 2022-02-03 (  69 days): HEALTHY              - std=0.0211, corr=-0.012, dir_acc=0.576
[ OK ] 2022-02-10 to 2022-02-18 (   7 days): HEALTHY              - std=0.0039, corr=-0.241, dir_acc=0.540
[UNI ] 2022-02-22 to 2022-06-17 (  82 days): UNIDIRECTIONAL       - std=0.0095, corr=-0.186, dir_acc=0.553
[WEAK] 2022-06-21 to 2022-07-22 (  23 days): WEAK_COLLAPSE        - std=0.0054, corr=-0.056, dir_acc=0.545
[UNI ] 2022-07-25 to 2022-09-26 (  45 days): UNIDIRECTIONAL       - std=0.0020, corr=-0.093, dir_acc=0.534
[WEAK] 2022-09-27 to 2022-10-07 (   9 days): WEAK_COLLAPSE        - std=0.0010, corr=+0.083, dir_acc=0.574
[WEAK] 2022-10-13 to 2022-11-25 (  30 days): WEAK_COLLAPSE        - std=0.0019, corr=+0.148, dir_acc=0.596
[FAIL] 2022-11-28 to 2022-12-16 (  15 days): STRONG_COLLAPSE      - std=0.0032, corr=+0.122, dir_acc=0.611
[WEAK] 2022-12-19 to 2023-01-11 (  16 days): WEAK_COLLAPSE        - std=0.0023, corr=+0.114, dir_acc=0.596
[FAIL] 2023-01-12 to 2023-01-27 (  11 days): STRONG_COLLAPSE      - std=0.0012, corr=+0.051, dir_acc=0.567
[WEAK] 2023-01-30 to 2023-03-15 (  32 days): WEAK_COLLAPSE        - std=0.0023, corr=+0.078, dir_acc=0.546
[FAIL] 2023-03-16 to 2023-03-30 (  11 days): STRONG_COLLAPSE      - std=0.0038, corr=-0.013, dir_acc=0.503
[UNI ] 2023-04-06 to 2023-06-12 (  46 days): UNIDIRECTIONAL       - std=0.0062, corr=+0.015, dir_acc=0.479
[DEGD] 2023-06-16 to 2023-06-27 (   7 days): DEGRADED             - std=0.0073, corr=-0.075, dir_acc=0.471
[ OK ] 2023-07-11 to 2023-07-31 (  15 days): HEALTHY              - std=0.0148, corr=+0.042, dir_acc=0.527
[DEGD] 2023-08-01 to 2023-09-01 (  24 days): DEGRADED             - std=0.0059, corr=-0.177, dir_acc=0.497
[UNI ] 2023-09-05 to 2024-02-26 ( 119 days): UNIDIRECTIONAL       - std=0.0311, corr=-0.009, dir_acc=0.556
[WEAK] 2024-02-27 to 2024-04-05 (  28 days): WEAK_COLLAPSE        - std=0.0026, corr=+0.003, dir_acc=0.589
[UNI ] 2024-04-08 to 2025-10-06 ( 374 days): UNIDIRECTIONAL       - std=0.0336, corr=-0.065, dir_acc=0.567
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           184 days ( 14.4%)
  DEGRADED:          117 days (  9.1%)
  UNIDIRECTIONAL:    798 days ( 62.3%)
  WEAK_COLLAPSE:     142 days ( 11.1%)
  STRONG_COLLAPSE:    39 days (  3.0%)

  Total problematic: 1096 days (85.6%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_h16_drop_0.3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.180042
  RMSE:             1.086298
  MAE:              0.772168
  Out-of-sample RÂ²: -0.0028

FINANCIAL METRICS:
  Directional Acc:  54.06%
  Sharpe Ratio:     1.0108
  Total Return:     70.92%
  Max Drawdown:     -18.90%
  Hit Rate:         32.97%
  Number of Trades: 745

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5664
  Recall:           0.6143
  F1 Score:         0.5894
  AUC-ROC:          0.5427

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        270             323
  Actual Up:          265             422

ALPHA (vs Buy-and-Hold):
  Excess Return:    -21.24%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_h16_drop_0.3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:02:08
======================================================================
---
Processing: 00_baseline_exploration/sweep2_h16_enc_15
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_h16_enc_15
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_h16_enc_15/checkpoints/tft-epoch=01-val_loss=0.1319.ckpt
  Validation loss: 0.131924

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_h16_enc_15/config.json
Output directory: experiments/00_baseline_exploration/sweep2_h16_enc_15/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_h16_enc_15/evaluation/evaluation_20251027_120210.log
Evaluation started at: 2025-10-27 12:02:10
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1286 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1285, Total actuals: 1285

Prediction Generation Summary:
  Total predictions: 1285
  Test dataset size: 1285
  Test dataloader batches: 11
  Prediction statistics:
    Min: -0.112058
    Max: 0.141576
    Mean: -0.016162
    Std: 0.074957
    Unique values: 1284

WARNING: Predictions (1285) < Test samples (1300)
Date range: 2020-08-12T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-12T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1285 samples)
Computing metrics...
Predictions - min: -0.1121, max: 0.1416, mean: -0.0162
Negative predictions: 746/1285
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]  125 days (  9.7%)
2. Range-based                 [WARN]  199 days ( 15.5%)
3. Consecutive-similarity      [WARN]  297 days ( 23.1%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    778 days ( 60.5%)
  Directional acc < 52%                605 days ( 47.1%)
  Combined (BOTH poor)                 385 days ( 30.0%)
  Unidirectional (>98%)        [WARN]   986 days ( 76.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-12 to 2020-09-23 (  30 days): HEALTHY              - std=0.0091, corr=+0.000, dir_acc=0.500
[UNI ] 2020-09-24 to 2021-04-05 ( 130 days): UNIDIRECTIONAL       - std=0.0196, corr=-0.097, dir_acc=0.442
[ OK ] 2021-04-06 to 2021-04-13 (   6 days): HEALTHY              - std=0.0075, corr=+0.025, dir_acc=0.489
[ OK ] 2021-05-03 to 2021-05-13 (   9 days): HEALTHY              - std=0.0124, corr=+0.030, dir_acc=0.524
[DEGD] 2021-05-14 to 2021-06-08 (  17 days): DEGRADED             - std=0.0086, corr=-0.049, dir_acc=0.496
[DEGD] 2021-06-10 to 2021-07-27 (  33 days): DEGRADED             - std=0.0140, corr=-0.093, dir_acc=0.456
[UNI ] 2021-07-28 to 2022-06-14 ( 221 days): UNIDIRECTIONAL       - std=0.0179, corr=-0.115, dir_acc=0.473
[WEAK] 2022-06-15 to 2022-07-19 (  23 days): WEAK_COLLAPSE        - std=0.0058, corr=-0.021, dir_acc=0.548
[UNI ] 2022-07-20 to 2022-09-19 (  43 days): UNIDIRECTIONAL       - std=0.0022, corr=-0.106, dir_acc=0.531
[WEAK] 2022-09-20 to 2022-09-29 (   8 days): WEAK_COLLAPSE        - std=0.0012, corr=-0.023, dir_acc=0.558
[FAIL] 2022-09-30 to 2023-04-03 ( 125 days): STRONG_COLLAPSE      - std=0.0033, corr=+0.078, dir_acc=0.571
[WEAK] 2023-04-04 to 2023-04-13 (   7 days): WEAK_COLLAPSE        - std=0.0005, corr=+0.090, dir_acc=0.476
[UNI ] 2023-04-14 to 2023-07-17 (  64 days): UNIDIRECTIONAL       - std=0.0227, corr=+0.021, dir_acc=0.470
[DEGD] 2023-07-27 to 2023-10-04 (  49 days): DEGRADED             - std=0.0109, corr=-0.132, dir_acc=0.470
[DEGD] 2023-10-06 to 2023-11-09 (  24 days): DEGRADED             - std=0.0199, corr=-0.104, dir_acc=0.461
[ OK ] 2023-11-10 to 2024-01-26 (  52 days): HEALTHY              - std=0.0137, corr=+0.119, dir_acc=0.564
[UNI ] 2024-01-29 to 2024-02-16 (  15 days): UNIDIRECTIONAL       - std=0.0032, corr=+0.076, dir_acc=0.646
[WEAK] 2024-02-20 to 2024-03-07 (  13 days): WEAK_COLLAPSE        - std=0.0023, corr=+0.054, dir_acc=0.626
[UNI ] 2024-03-08 to 2024-03-20 (   9 days): UNIDIRECTIONAL       - std=0.0012, corr=+0.029, dir_acc=0.587
[WEAK] 2024-03-21 to 2024-04-02 (   8 days): WEAK_COLLAPSE        - std=0.0021, corr=+0.005, dir_acc=0.560
[UNI ] 2024-04-03 to 2024-07-31 (  83 days): UNIDIRECTIONAL       - std=0.0146, corr=+0.117, dir_acc=0.559
[UNI ] 2024-08-02 to 2025-05-07 ( 189 days): UNIDIRECTIONAL       - std=0.0338, corr=-0.120, dir_acc=0.561
[ OK ] 2025-05-08 to 2025-07-30 (  57 days): HEALTHY              - std=0.0311, corr=-0.183, dir_acc=0.599
[UNI ] 2025-07-31 to 2025-10-06 (  47 days): UNIDIRECTIONAL       - std=0.0087, corr=-0.242, dir_acc=0.568
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           167 days ( 13.0%)
  DEGRADED:          132 days ( 10.3%)
  UNIDIRECTIONAL:    801 days ( 62.3%)
  WEAK_COLLAPSE:      60 days (  4.7%)
  STRONG_COLLAPSE:   125 days (  9.7%)

  Total problematic: 1118 days (87.0%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_h16_enc_15/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.182758
  RMSE:             1.087547
  MAE:              0.773402
  Out-of-sample RÂ²: -0.0077

FINANCIAL METRICS:
  Directional Acc:  52.30%
  Sharpe Ratio:     0.9166
  Total Return:     56.21%
  Max Drawdown:     -18.90%
  Hit Rate:         23.97%
  Number of Trades: 539

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5714
  Recall:           0.4464
  F1 Score:         0.5012
  AUC-ROC:          0.5431

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        364             231
  Actual Up:          382             308

ALPHA (vs Buy-and-Hold):
  Excess Return:    -39.19%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_h16_enc_15/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:02:11
======================================================================
---
Processing: 00_baseline_exploration/sweep2_h16_enc_20
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_h16_enc_20
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_h16_enc_20/checkpoints/tft-epoch=01-val_loss=0.1324.ckpt
  Validation loss: 0.132447

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_h16_enc_20/config.json
Output directory: experiments/00_baseline_exploration/sweep2_h16_enc_20/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_h16_enc_20/evaluation/evaluation_20251027_120212.log
Evaluation started at: 2025-10-27 12:02:12
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.103241
    Max: 0.152375
    Mean: -0.003492
    Std: 0.076916
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.1032, max: 0.1524, mean: -0.0035
Negative predictions: 694/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   89 days (  7.0%)
2. Range-based                 [WARN]  187 days ( 14.6%)
3. Consecutive-similarity      [WARN]  294 days ( 23.0%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    758 days ( 59.2%)
  Directional acc < 52%                585 days ( 45.7%)
  Combined (BOTH poor)                 374 days ( 29.2%)
  Unidirectional (>98%)        [WARN]  1085 days ( 84.8%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-30 (  30 days): HEALTHY              - std=0.0083, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2021-04-05 ( 125 days): UNIDIRECTIONAL       - std=0.0188, corr=-0.114, dir_acc=0.444
[ OK ] 2021-04-06 to 2021-04-13 (   6 days): HEALTHY              - std=0.0088, corr=+0.022, dir_acc=0.489
[ OK ] 2021-05-03 to 2021-05-13 (   9 days): HEALTHY              - std=0.0122, corr=+0.016, dir_acc=0.544
[DEGD] 2021-05-26 to 2021-06-08 (   9 days): DEGRADED             - std=0.0053, corr=-0.112, dir_acc=0.502
[DEGD] 2021-06-10 to 2021-09-07 (  62 days): DEGRADED             - std=0.0166, corr=-0.138, dir_acc=0.437
[UNI ] 2021-09-08 to 2022-06-15 ( 193 days): UNIDIRECTIONAL       - std=0.0206, corr=-0.111, dir_acc=0.485
[WEAK] 2022-06-16 to 2022-07-22 (  25 days): WEAK_COLLAPSE        - std=0.0057, corr=-0.059, dir_acc=0.545
[UNI ] 2022-07-25 to 2022-09-23 (  44 days): UNIDIRECTIONAL       - std=0.0019, corr=-0.099, dir_acc=0.534
[WEAK] 2022-09-26 to 2022-10-06 (   9 days): WEAK_COLLAPSE        - std=0.0014, corr=+0.081, dir_acc=0.572
[FAIL] 2022-10-07 to 2022-12-20 (  50 days): STRONG_COLLAPSE      - std=0.0029, corr=+0.122, dir_acc=0.601
[WEAK] 2022-12-21 to 2022-12-29 (   6 days): WEAK_COLLAPSE        - std=0.0017, corr=+0.111, dir_acc=0.594
[FAIL] 2022-12-30 to 2023-02-06 (  25 days): STRONG_COLLAPSE      - std=0.0018, corr=+0.063, dir_acc=0.568
[WEAK] 2023-02-07 to 2023-03-10 (  23 days): WEAK_COLLAPSE        - std=0.0017, corr=+0.075, dir_acc=0.548
[FAIL] 2023-03-13 to 2023-03-30 (  14 days): STRONG_COLLAPSE      - std=0.0038, corr=-0.000, dir_acc=0.511
[WEAK] 2023-03-31 to 2023-04-10 (   6 days): WEAK_COLLAPSE        - std=0.0019, corr=+0.088, dir_acc=0.464
[UNI ] 2023-04-11 to 2023-07-14 (  66 days): UNIDIRECTIONAL       - std=0.0226, corr=+0.013, dir_acc=0.471
[ OK ] 2023-07-17 to 2023-07-28 (  10 days): HEALTHY              - std=0.0121, corr=+0.045, dir_acc=0.467
[DEGD] 2023-07-31 to 2023-10-04 (  47 days): DEGRADED             - std=0.0097, corr=-0.163, dir_acc=0.445
[UNI ] 2023-10-05 to 2024-02-26 (  97 days): UNIDIRECTIONAL       - std=0.0283, corr=+0.034, dir_acc=0.567
[WEAK] 2024-02-27 to 2024-04-08 (  29 days): WEAK_COLLAPSE        - std=0.0033, corr=+0.006, dir_acc=0.587
[UNI ] 2024-04-09 to 2025-10-06 ( 373 days): UNIDIRECTIONAL       - std=0.0336, corr=-0.065, dir_acc=0.567
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            66 days (  5.2%)
  DEGRADED:          129 days ( 10.1%)
  UNIDIRECTIONAL:    898 days ( 70.2%)
  WEAK_COLLAPSE:      98 days (  7.7%)
  STRONG_COLLAPSE:    89 days (  7.0%)

  Total problematic: 1214 days (94.8%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_h16_enc_20/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.183202
  RMSE:             1.087751
  MAE:              0.773713
  Out-of-sample RÂ²: -0.0055

FINANCIAL METRICS:
  Directional Acc:  52.42%
  Sharpe Ratio:     0.8480
  Total Return:     52.05%
  Max Drawdown:     -18.90%
  Hit Rate:         25.94%
  Number of Trades: 586

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5666
  Recall:           0.4833
  F1 Score:         0.5216
  AUC-ROC:          0.5439

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        339             254
  Actual Up:          355             332

ALPHA (vs Buy-and-Hold):
  Excess Return:    -40.11%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_h16_enc_20/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:02:13
======================================================================
---
Processing: 00_baseline_exploration/sweep2_h16_enc_30
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_h16_enc_30
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_h16_enc_30/checkpoints/tft-epoch=01-val_loss=0.1304.ckpt
  Validation loss: 0.130379

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_h16_enc_30/config.json
Output directory: experiments/00_baseline_exploration/sweep2_h16_enc_30/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_h16_enc_30/evaluation/evaluation_20251027_120215.log
Evaluation started at: 2025-10-27 12:02:15
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1271 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1270, Total actuals: 1270

Prediction Generation Summary:
  Total predictions: 1270
  Test dataset size: 1270
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.095573
    Max: 0.146902
    Mean: -0.004036
    Std: 0.072306
    Unique values: 1270

WARNING: Predictions (1270) < Test samples (1300)
Date range: 2020-09-02T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-09-02T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1270 samples)
Computing metrics...
Predictions - min: -0.0956, max: 0.1469, mean: -0.0040
Negative predictions: 698/1270
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  128 days ( 10.1%)
2. Range-based                 [WARN]  216 days ( 17.0%)
3. Consecutive-similarity      [WARN]  312 days ( 24.6%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    873 days ( 68.7%)
  Directional acc < 52%                574 days ( 45.2%)
  Combined (BOTH poor)                 437 days ( 34.4%)
  Unidirectional (>98%)        [WARN]  1034 days ( 81.4%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-09-02 to 2020-10-14 (  29 days): HEALTHY              - std=0.0028, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-15 to 2020-10-28 (  10 days): WEAK_COLLAPSE        - std=0.0019, corr=-0.238, dir_acc=0.492
[UNI ] 2020-10-29 to 2021-04-05 ( 106 days): UNIDIRECTIONAL       - std=0.0163, corr=-0.196, dir_acc=0.457
[DEGD] 2021-04-22 to 2021-04-30 (   7 days): DEGRADED             - std=0.0019, corr=-0.037, dir_acc=0.507
[ OK ] 2021-05-03 to 2021-05-12 (   8 days): HEALTHY              - std=0.0062, corr=-0.002, dir_acc=0.544
[DEGD] 2021-05-13 to 2021-08-04 (  58 days): DEGRADED             - std=0.0137, corr=-0.147, dir_acc=0.465
[UNI ] 2021-08-05 to 2022-06-09 ( 212 days): UNIDIRECTIONAL       - std=0.0189, corr=-0.116, dir_acc=0.473
[WEAK] 2022-06-10 to 2022-08-03 (  37 days): WEAK_COLLAPSE        - std=0.0060, corr=-0.138, dir_acc=0.539
[UNI ] 2022-08-04 to 2022-09-19 (  32 days): UNIDIRECTIONAL       - std=0.0022, corr=-0.101, dir_acc=0.534
[WEAK] 2022-09-20 to 2022-10-07 (  14 days): WEAK_COLLAPSE        - std=0.0018, corr=+0.173, dir_acc=0.565
[FAIL] 2022-10-11 to 2023-03-31 ( 118 days): STRONG_COLLAPSE      - std=0.0025, corr=+0.063, dir_acc=0.572
[WEAK] 2023-04-03 to 2023-04-18 (  11 days): WEAK_COLLAPSE        - std=0.0014, corr=+0.074, dir_acc=0.473
[UNI ] 2023-04-19 to 2023-07-24 (  66 days): UNIDIRECTIONAL       - std=0.0238, corr=+0.012, dir_acc=0.467
[DEGD] 2023-08-01 to 2023-10-13 (  52 days): DEGRADED             - std=0.0081, corr=-0.176, dir_acc=0.417
[ OK ] 2023-11-03 to 2024-01-24 (  55 days): HEALTHY              - std=0.0203, corr=+0.110, dir_acc=0.625
[UNI ] 2024-01-25 to 2024-03-08 (  31 days): UNIDIRECTIONAL       - std=0.0030, corr=-0.026, dir_acc=0.639
[WEAK] 2024-03-11 to 2024-04-12 (  24 days): WEAK_COLLAPSE        - std=0.0046, corr=-0.018, dir_acc=0.568
[UNI ] 2024-04-15 to 2025-10-06 ( 369 days): UNIDIRECTIONAL       - std=0.0317, corr=-0.073, dir_acc=0.567
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           106 days (  8.3%)
  DEGRADED:          129 days ( 10.2%)
  UNIDIRECTIONAL:    821 days ( 64.6%)
  WEAK_COLLAPSE:      96 days (  7.6%)
  STRONG_COLLAPSE:   118 days (  9.3%)

  Total problematic: 1164 days (91.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_h16_enc_30/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.188548
  RMSE:             1.090206
  MAE:              0.775463
  Out-of-sample RÂ²: -0.0043

FINANCIAL METRICS:
  Directional Acc:  52.68%
  Sharpe Ratio:     0.8522
  Total Return:     51.90%
  Max Drawdown:     -18.90%
  Hit Rate:         25.59%
  Number of Trades: 572

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5682
  Recall:           0.4786
  F1 Score:         0.5196
  AUC-ROC:          0.5451

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        344             247
  Actual Up:          354             325

ALPHA (vs Buy-and-Hold):
  Excess Return:    -32.80%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_h16_enc_30/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:02:16
======================================================================
---
Processing: 00_baseline_exploration/sweep2_h16_enc_40
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_h16_enc_40
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_h16_enc_40/checkpoints/tft-epoch=01-val_loss=0.1277.ckpt
  Validation loss: 0.127670

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_h16_enc_40/config.json
Output directory: experiments/00_baseline_exploration/sweep2_h16_enc_40/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_h16_enc_40/evaluation/evaluation_20251027_120217.log
Evaluation started at: 2025-10-27 12:02:17
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1261 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1260, Total actuals: 1260

Prediction Generation Summary:
  Total predictions: 1260
  Test dataset size: 1260
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.096524
    Max: 0.132057
    Mean: -0.008205
    Std: 0.069638
    Unique values: 1260

WARNING: Predictions (1260) < Test samples (1300)
Date range: 2020-09-17T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-09-17T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1260 samples)
Computing metrics...
Predictions - min: -0.0965, max: 0.1321, mean: -0.0082
Negative predictions: 723/1260
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  129 days ( 10.2%)
2. Range-based                 [WARN]  244 days ( 19.4%)
3. Consecutive-similarity      [WARN]  333 days ( 26.4%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    865 days ( 68.7%)
  Directional acc < 52%                590 days ( 46.8%)
  Combined (BOTH poor)                 443 days ( 35.2%)
  Unidirectional (>98%)        [WARN]  1032 days ( 81.9%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-09-17 to 2020-10-28 (  29 days): HEALTHY              - std=0.0028, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-30 to 2021-04-06 ( 106 days): UNIDIRECTIONAL       - std=0.0159, corr=-0.197, dir_acc=0.456
[DEGD] 2021-04-22 to 2021-04-30 (   7 days): DEGRADED             - std=0.0013, corr=-0.039, dir_acc=0.490
[DEGD] 2021-05-12 to 2021-08-04 (  59 days): DEGRADED             - std=0.0133, corr=-0.170, dir_acc=0.457
[UNI ] 2021-08-05 to 2022-06-03 ( 208 days): UNIDIRECTIONAL       - std=0.0180, corr=-0.118, dir_acc=0.473
[WEAK] 2022-06-06 to 2022-06-21 (  11 days): WEAK_COLLAPSE        - std=0.0021, corr=-0.301, dir_acc=0.520
[FAIL] 2022-06-22 to 2022-07-07 (  11 days): STRONG_COLLAPSE      - std=0.0026, corr=-0.147, dir_acc=0.555
[WEAK] 2022-07-08 to 2022-08-26 (  36 days): WEAK_COLLAPSE        - std=0.0019, corr=-0.197, dir_acc=0.530
[UNI ] 2022-08-29 to 2022-09-16 (  14 days): UNIDIRECTIONAL       - std=0.0010, corr=+0.006, dir_acc=0.542
[WEAK] 2022-09-19 to 2022-10-25 (  26 days): WEAK_COLLAPSE        - std=0.0020, corr=+0.177, dir_acc=0.576
[FAIL] 2022-10-26 to 2023-04-03 ( 108 days): STRONG_COLLAPSE      - std=0.0027, corr=-0.023, dir_acc=0.568
[WEAK] 2023-04-04 to 2023-05-08 (  24 days): WEAK_COLLAPSE        - std=0.0017, corr=+0.032, dir_acc=0.483
[UNI ] 2023-05-09 to 2023-06-26 (  33 days): UNIDIRECTIONAL       - std=0.0047, corr=-0.027, dir_acc=0.464
[UNI ] 2023-06-28 to 2023-08-14 (  33 days): UNIDIRECTIONAL       - std=0.0164, corr=-0.011, dir_acc=0.443
[DEGD] 2023-08-15 to 2023-10-12 (  41 days): DEGRADED             - std=0.0043, corr=-0.159, dir_acc=0.459
[ OK ] 2023-10-20 to 2024-01-29 (  68 days): HEALTHY              - std=0.0301, corr=+0.090, dir_acc=0.550
[UNI ] 2024-01-30 to 2024-03-21 (  37 days): UNIDIRECTIONAL       - std=0.0017, corr=+0.032, dir_acc=0.622
[FAIL] 2024-03-25 to 2024-04-05 (   9 days): STRONG_COLLAPSE      - std=0.0020, corr=-0.060, dir_acc=0.557
[WEAK] 2024-04-08 to 2024-04-15 (   6 days): WEAK_COLLAPSE        - std=0.0016, corr=+0.051, dir_acc=0.558
[UNI ] 2024-04-16 to 2025-10-06 ( 368 days): UNIDIRECTIONAL       - std=0.0317, corr=-0.058, dir_acc=0.567
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           110 days (  8.7%)
  DEGRADED:          118 days (  9.4%)
  UNIDIRECTIONAL:    799 days ( 63.4%)
  WEAK_COLLAPSE:     105 days (  8.3%)
  STRONG_COLLAPSE:   128 days ( 10.2%)

  Total problematic: 1150 days (91.3%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_h16_enc_40/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.172904
  RMSE:             1.083007
  MAE:              0.770170
  Out-of-sample RÂ²: -0.0052

FINANCIAL METRICS:
  Directional Acc:  52.46%
  Sharpe Ratio:     0.8151
  Total Return:     47.55%
  Max Drawdown:     -18.90%
  Hit Rate:         24.29%
  Number of Trades: 537

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5698
  Recall:           0.4540
  F1 Score:         0.5054
  AUC-ROC:          0.5443

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        355             231
  Actual Up:          368             306

ALPHA (vs Buy-and-Hold):
  Excess Return:    -44.86%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_h16_enc_40/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:02:18
======================================================================
---
Processing: 00_baseline_exploration/sweep2_h16_enc_50
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_h16_enc_50
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_h16_enc_50/checkpoints/tft-epoch=01-val_loss=0.1314.ckpt
  Validation loss: 0.131412

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_h16_enc_50/config.json
Output directory: experiments/00_baseline_exploration/sweep2_h16_enc_50/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_h16_enc_50/evaluation/evaluation_20251027_120220.log
Evaluation started at: 2025-10-27 12:02:20
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1251 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1250, Total actuals: 1250

Prediction Generation Summary:
  Total predictions: 1250
  Test dataset size: 1250
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.104499
    Max: 0.127710
    Mean: -0.015148
    Std: 0.069373
    Unique values: 1250

WARNING: Predictions (1250) < Test samples (1300)
Date range: 2020-10-01T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-10-01T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1250 samples)
Computing metrics...
Predictions - min: -0.1045, max: 0.1277, mean: -0.0151
Negative predictions: 744/1250
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  226 days ( 18.1%)
2. Range-based                 [WARN]  242 days ( 19.4%)
3. Consecutive-similarity      [WARN]  369 days ( 29.5%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    960 days ( 76.8%)
  Directional acc < 52%                542 days ( 43.4%)
  Combined (BOTH poor)                 434 days ( 34.7%)
  Unidirectional (>98%)        [WARN]  1046 days ( 83.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-10-01 to 2020-11-12 (  29 days): HEALTHY              - std=0.0054, corr=+0.000, dir_acc=0.500
[UNI ] 2020-11-16 to 2021-04-09 (  99 days): UNIDIRECTIONAL       - std=0.0150, corr=-0.199, dir_acc=0.454
[DEGD] 2021-04-20 to 2021-05-04 (  11 days): DEGRADED             - std=0.0033, corr=-0.034, dir_acc=0.479
[DEGD] 2021-05-10 to 2021-07-28 (  56 days): DEGRADED             - std=0.0095, corr=-0.170, dir_acc=0.435
[UNI ] 2021-07-29 to 2022-06-02 ( 212 days): UNIDIRECTIONAL       - std=0.0187, corr=-0.112, dir_acc=0.472
[FAIL] 2022-06-06 to 2022-09-02 (  63 days): STRONG_COLLAPSE      - std=0.0049, corr=-0.198, dir_acc=0.535
[FAIL] 2022-09-14 to 2023-04-18 ( 147 days): STRONG_COLLAPSE      - std=0.0039, corr=-0.018, dir_acc=0.562
[WEAK] 2023-04-19 to 2023-05-15 (  19 days): WEAK_COLLAPSE        - std=0.0009, corr=+0.012, dir_acc=0.492
[UNI ] 2023-05-16 to 2023-06-26 (  28 days): UNIDIRECTIONAL       - std=0.0049, corr=-0.041, dir_acc=0.457
[UNI ] 2023-06-28 to 2023-09-07 (  50 days): UNIDIRECTIONAL       - std=0.0178, corr=-0.072, dir_acc=0.450
[DEGD] 2023-09-08 to 2023-09-25 (  12 days): DEGRADED             - std=0.0021, corr=-0.143, dir_acc=0.511
[ OK ] 2023-10-12 to 2023-11-01 (  15 days): HEALTHY              - std=0.0049, corr=-0.055, dir_acc=0.572
[ OK ] 2023-11-08 to 2024-01-30 (  56 days): HEALTHY              - std=0.0216, corr=+0.021, dir_acc=0.601
[UNI ] 2024-01-31 to 2024-04-02 (  43 days): UNIDIRECTIONAL       - std=0.0019, corr=-0.106, dir_acc=0.610
[FAIL] 2024-04-08 to 2024-04-16 (   7 days): STRONG_COLLAPSE      - std=0.0025, corr=+0.102, dir_acc=0.555
[UNI ] 2024-04-18 to 2025-10-06 ( 366 days): UNIDIRECTIONAL       - std=0.0307, corr=-0.091, dir_acc=0.568
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           110 days (  8.8%)
  DEGRADED:           94 days (  7.5%)
  UNIDIRECTIONAL:    800 days ( 64.0%)
  WEAK_COLLAPSE:      29 days (  2.3%)
  STRONG_COLLAPSE:   217 days ( 17.4%)

  Total problematic: 1140 days (91.2%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_h16_enc_50/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.170961
  RMSE:             1.082109
  MAE:              0.768010
  Out-of-sample RÂ²: -0.0067

FINANCIAL METRICS:
  Directional Acc:  52.72%
  Sharpe Ratio:     0.9140
  Total Return:     53.48%
  Max Drawdown:     -18.90%
  Hit Rate:         23.36%
  Number of Trades: 506

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5771
  Recall:           0.4365
  F1 Score:         0.4970
  AUC-ROC:          0.5424

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        367             214
  Actual Up:          377             292

ALPHA (vs Buy-and-Hold):
  Excess Return:    -40.21%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_h16_enc_50/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:02:21
======================================================================
---
Processing: 00_baseline_exploration/sweep2_h16_enc_60
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_h16_enc_60
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_h16_enc_60/checkpoints/tft-epoch=01-val_loss=0.1357.ckpt
  Validation loss: 0.135668

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_h16_enc_60/config.json
Output directory: experiments/00_baseline_exploration/sweep2_h16_enc_60/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_h16_enc_60/evaluation/evaluation_20251027_120222.log
Evaluation started at: 2025-10-27 12:02:22
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1241 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1240, Total actuals: 1240

Prediction Generation Summary:
  Total predictions: 1240
  Test dataset size: 1240
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.108034
    Max: 0.135420
    Mean: -0.014461
    Std: 0.072170
    Unique values: 1240

WARNING: Predictions (1240) < Test samples (1300)
Date range: 2020-10-16T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-10-16T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1240 samples)
Computing metrics...
Predictions - min: -0.1080, max: 0.1354, mean: -0.0145
Negative predictions: 746/1240
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  336 days ( 27.1%)
2. Range-based                 [WARN]  216 days ( 17.4%)
3. Consecutive-similarity      [WARN]  319 days ( 25.7%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    933 days ( 75.2%)
  Directional acc < 52%                565 days ( 45.6%)
  Combined (BOTH poor)                 425 days ( 34.3%)
  Unidirectional (>98%)        [WARN]  1058 days ( 85.3%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-10-16 to 2020-11-30 (  30 days): HEALTHY              - std=0.0093, corr=+0.000, dir_acc=0.500
[UNI ] 2020-12-01 to 2021-04-15 (  93 days): UNIDIRECTIONAL       - std=0.0185, corr=-0.180, dir_acc=0.449
[DEGD] 2021-04-22 to 2021-05-04 (   9 days): DEGRADED             - std=0.0016, corr=-0.037, dir_acc=0.469
[DEGD] 2021-05-10 to 2021-07-13 (  45 days): DEGRADED             - std=0.0085, corr=-0.159, dir_acc=0.459
[UNI ] 2021-07-14 to 2022-06-08 ( 227 days): UNIDIRECTIONAL       - std=0.0223, corr=-0.126, dir_acc=0.470
[FAIL] 2022-06-17 to 2023-04-21 ( 210 days): STRONG_COLLAPSE      - std=0.0057, corr=-0.056, dir_acc=0.554
[WEAK] 2023-04-24 to 2023-05-12 (  15 days): WEAK_COLLAPSE        - std=0.0010, corr=+0.005, dir_acc=0.494
[UNI ] 2023-05-15 to 2023-05-25 (   9 days): UNIDIRECTIONAL       - std=0.0008, corr=-0.031, dir_acc=0.481
[WEAK] 2023-05-26 to 2023-06-06 (   7 days): WEAK_COLLAPSE        - std=0.0035, corr=-0.037, dir_acc=0.467
[UNI ] 2023-06-07 to 2023-06-14 (   6 days): UNIDIRECTIONAL       - std=0.0011, corr=-0.062, dir_acc=0.433
[WEAK] 2023-06-15 to 2023-06-28 (   9 days): WEAK_COLLAPSE        - std=0.0019, corr=-0.030, dir_acc=0.448
[UNI ] 2023-06-29 to 2023-09-14 (  54 days): UNIDIRECTIONAL       - std=0.0170, corr=-0.066, dir_acc=0.455
[DEGD] 2023-09-15 to 2023-11-15 (  43 days): DEGRADED             - std=0.0083, corr=-0.090, dir_acc=0.484
[ OK ] 2023-11-16 to 2024-01-26 (  48 days): HEALTHY              - std=0.0223, corr=+0.059, dir_acc=0.596
[UNI ] 2024-01-29 to 2024-04-22 (  59 days): UNIDIRECTIONAL       - std=0.0072, corr=+0.008, dir_acc=0.595
[UNI ] 2024-04-24 to 2024-06-05 (  30 days): UNIDIRECTIONAL       - std=0.0060, corr=+0.007, dir_acc=0.514
[UNI ] 2024-06-12 to 2025-10-06 ( 328 days): UNIDIRECTIONAL       - std=0.0314, corr=-0.110, dir_acc=0.574
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            84 days (  6.8%)
  DEGRADED:           98 days (  7.9%)
  UNIDIRECTIONAL:    806 days ( 65.0%)
  WEAK_COLLAPSE:      38 days (  3.1%)
  STRONG_COLLAPSE:   214 days ( 17.3%)

  Total problematic: 1156 days (93.2%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_h16_enc_60/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.171128
  RMSE:             1.082187
  MAE:              0.766426
  Out-of-sample RÂ²: -0.0068

FINANCIAL METRICS:
  Directional Acc:  52.58%
  Sharpe Ratio:     0.8934
  Total Return:     51.75%
  Max Drawdown:     -18.90%
  Hit Rate:         22.98%
  Number of Trades: 494

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5769
  Recall:           0.4292
  F1 Score:         0.4922
  AUC-ROC:          0.5418

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        367             209
  Actual Up:          379             285

ALPHA (vs Buy-and-Hold):
  Excess Return:    -38.32%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_h16_enc_60/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:02:24
======================================================================
---
Processing: 00_baseline_exploration/sweep2_h16_lr_0.0002
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_h16_lr_0.0002
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_h16_lr_0.0002/checkpoints/tft-epoch=03-val_loss=0.1154.ckpt
  Validation loss: 0.115431

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_h16_lr_0.0002/config.json
Output directory: experiments/00_baseline_exploration/sweep2_h16_lr_0.0002/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_h16_lr_0.0002/evaluation/evaluation_20251027_120225.log
Evaluation started at: 2025-10-27 12:02:25
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.109191
    Max: 0.128515
    Mean: -0.011445
    Std: 0.070952
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.1092, max: 0.1285, mean: -0.0114
Negative predictions: 711/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  145 days ( 11.3%)
2. Range-based                 [WARN]  239 days ( 18.7%)
3. Consecutive-similarity      [WARN]  335 days ( 26.2%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    753 days ( 58.8%)
  Directional acc < 52%                608 days ( 47.5%)
  Combined (BOTH poor)                 368 days ( 28.7%)
  Unidirectional (>98%)        [WARN]  1048 days ( 81.9%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-30 (  30 days): HEALTHY              - std=0.0090, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2021-04-05 ( 125 days): UNIDIRECTIONAL       - std=0.0195, corr=-0.126, dir_acc=0.444
[ OK ] 2021-05-03 to 2021-05-13 (   9 days): HEALTHY              - std=0.0127, corr=+0.017, dir_acc=0.544
[DEGD] 2021-05-26 to 2021-06-08 (   9 days): DEGRADED             - std=0.0045, corr=-0.100, dir_acc=0.502
[DEGD] 2021-06-10 to 2021-08-03 (  38 days): DEGRADED             - std=0.0161, corr=-0.128, dir_acc=0.467
[UNI ] 2021-08-04 to 2022-06-13 ( 215 days): UNIDIRECTIONAL       - std=0.0185, corr=-0.111, dir_acc=0.474
[FAIL] 2022-06-22 to 2022-07-14 (  16 days): STRONG_COLLAPSE      - std=0.0030, corr=-0.106, dir_acc=0.551
[WEAK] 2022-07-15 to 2022-08-30 (  33 days): WEAK_COLLAPSE        - std=0.0017, corr=-0.192, dir_acc=0.529
[UNI ] 2022-08-31 to 2022-09-09 (   7 days): UNIDIRECTIONAL       - std=0.0012, corr=-0.072, dir_acc=0.552
[WEAK] 2022-09-12 to 2022-09-26 (  11 days): WEAK_COLLAPSE        - std=0.0008, corr=+0.012, dir_acc=0.536
[FAIL] 2022-09-27 to 2023-04-04 ( 129 days): STRONG_COLLAPSE      - std=0.0029, corr=+0.051, dir_acc=0.570
[WEAK] 2023-04-05 to 2023-04-19 (  10 days): WEAK_COLLAPSE        - std=0.0014, corr=+0.080, dir_acc=0.477
[UNI ] 2023-04-20 to 2023-07-19 (  62 days): UNIDIRECTIONAL       - std=0.0230, corr=+0.016, dir_acc=0.469
[DEGD] 2023-07-31 to 2023-11-03 (  68 days): DEGRADED             - std=0.0094, corr=-0.129, dir_acc=0.415
[ OK ] 2023-11-06 to 2024-01-08 (  43 days): HEALTHY              - std=0.0169, corr=+0.155, dir_acc=0.507
[UNI ] 2024-01-09 to 2024-02-23 (  32 days): UNIDIRECTIONAL       - std=0.0045, corr=-0.030, dir_acc=0.640
[WEAK] 2024-02-26 to 2024-04-12 (  34 days): WEAK_COLLAPSE        - std=0.0045, corr=+0.017, dir_acc=0.585
[UNI ] 2024-04-15 to 2024-08-01 (  76 days): UNIDIRECTIONAL       - std=0.0126, corr=+0.043, dir_acc=0.559
[UNI ] 2024-08-05 to 2025-10-06 ( 292 days): UNIDIRECTIONAL       - std=0.0299, corr=-0.083, dir_acc=0.569
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           103 days (  8.0%)
  DEGRADED:          129 days ( 10.1%)
  UNIDIRECTIONAL:    809 days ( 63.2%)
  WEAK_COLLAPSE:      94 days (  7.3%)
  STRONG_COLLAPSE:   145 days ( 11.3%)

  Total problematic: 1177 days (92.0%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_h16_lr_0.0002/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.183532
  RMSE:             1.087903
  MAE:              0.774261
  Out-of-sample RÂ²: -0.0058

FINANCIAL METRICS:
  Directional Acc:  52.03%
  Sharpe Ratio:     0.7923
  Total Return:     47.32%
  Max Drawdown:     -18.90%
  Hit Rate:         25.08%
  Number of Trades: 569

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5641
  Recall:           0.4672
  F1 Score:         0.5111
  AUC-ROC:          0.5427

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        345             248
  Actual Up:          366             321

ALPHA (vs Buy-and-Hold):
  Excess Return:    -44.84%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_h16_lr_0.0002/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:02:26
======================================================================
---
Processing: 00_baseline_exploration/sweep2_h16_lr_0.0003
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_h16_lr_0.0003
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_h16_lr_0.0003/checkpoints/tft-epoch=02-val_loss=0.1227.ckpt
  Validation loss: 0.122651

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_h16_lr_0.0003/config.json
Output directory: experiments/00_baseline_exploration/sweep2_h16_lr_0.0003/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_h16_lr_0.0003/evaluation/evaluation_20251027_120228.log
Evaluation started at: 2025-10-27 12:02:28
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.116703
    Max: 0.130325
    Mean: -0.017223
    Std: 0.073818
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.1167, max: 0.1303, mean: -0.0172
Negative predictions: 727/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]  125 days (  9.8%)
2. Range-based                 [WARN]  210 days ( 16.4%)
3. Consecutive-similarity      [WARN]  314 days ( 24.5%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    752 days ( 58.8%)
  Directional acc < 52%                587 days ( 45.9%)
  Combined (BOTH poor)                 372 days ( 29.1%)
  Unidirectional (>98%)        [WARN]   986 days ( 77.0%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-30 (  30 days): HEALTHY              - std=0.0090, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2021-04-07 ( 127 days): UNIDIRECTIONAL       - std=0.0210, corr=-0.121, dir_acc=0.444
[ OK ] 2021-05-03 to 2021-05-13 (   9 days): HEALTHY              - std=0.0126, corr=+0.017, dir_acc=0.541
[DEGD] 2021-05-26 to 2021-06-08 (   9 days): DEGRADED             - std=0.0048, corr=-0.103, dir_acc=0.502
[DEGD] 2021-06-10 to 2021-07-30 (  36 days): DEGRADED             - std=0.0154, corr=-0.126, dir_acc=0.469
[UNI ] 2021-08-02 to 2022-06-14 ( 218 days): UNIDIRECTIONAL       - std=0.0192, corr=-0.113, dir_acc=0.474
[WEAK] 2022-06-15 to 2022-08-02 (  33 days): WEAK_COLLAPSE        - std=0.0060, corr=-0.121, dir_acc=0.540
[UNI ] 2022-08-03 to 2022-09-15 (  31 days): UNIDIRECTIONAL       - std=0.0015, corr=-0.125, dir_acc=0.534
[WEAK] 2022-09-16 to 2022-09-29 (  10 days): WEAK_COLLAPSE        - std=0.0011, corr=+0.021, dir_acc=0.553
[FAIL] 2022-09-30 to 2023-04-03 ( 125 days): STRONG_COLLAPSE      - std=0.0028, corr=+0.069, dir_acc=0.571
[WEAK] 2023-04-04 to 2023-04-17 (   9 days): WEAK_COLLAPSE        - std=0.0014, corr=+0.080, dir_acc=0.476
[UNI ] 2023-04-18 to 2023-07-20 (  65 days): UNIDIRECTIONAL       - std=0.0254, corr=+0.017, dir_acc=0.468
[DEGD] 2023-07-31 to 2023-11-02 (  67 days): DEGRADED             - std=0.0097, corr=-0.136, dir_acc=0.415
[ OK ] 2023-11-03 to 2024-01-18 (  51 days): HEALTHY              - std=0.0178, corr=+0.139, dir_acc=0.581
[UNI ] 2024-01-19 to 2024-02-23 (  25 days): UNIDIRECTIONAL       - std=0.0037, corr=-0.055, dir_acc=0.648
[WEAK] 2024-02-26 to 2024-04-10 (  32 days): WEAK_COLLAPSE        - std=0.0039, corr=+0.013, dir_acc=0.586
[UNI ] 2024-04-11 to 2025-05-08 ( 268 days): UNIDIRECTIONAL       - std=0.0276, corr=-0.029, dir_acc=0.560
[ OK ] 2025-05-13 to 2025-08-05 (  58 days): HEALTHY              - std=0.0267, corr=-0.113, dir_acc=0.586
[UNI ] 2025-08-06 to 2025-10-06 (  43 days): UNIDIRECTIONAL       - std=0.0064, corr=-0.177, dir_acc=0.566
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           168 days ( 13.1%)
  DEGRADED:          126 days (  9.8%)
  UNIDIRECTIONAL:    777 days ( 60.7%)
  WEAK_COLLAPSE:      84 days (  6.6%)
  STRONG_COLLAPSE:   125 days (  9.8%)

  Total problematic: 1112 days (86.9%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_h16_lr_0.0003/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.184653
  RMSE:             1.088417
  MAE:              0.774727
  Out-of-sample RÂ²: -0.0067

FINANCIAL METRICS:
  Directional Acc:  52.19%
  Sharpe Ratio:     0.7683
  Total Return:     44.54%
  Max Drawdown:     -18.90%
  Hit Rate:         24.53%
  Number of Trades: 553

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5678
  Recall:           0.4571
  F1 Score:         0.5065
  AUC-ROC:          0.5432

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        354             239
  Actual Up:          373             314

ALPHA (vs Buy-and-Hold):
  Excess Return:    -47.62%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_h16_lr_0.0003/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:02:29
======================================================================
---
Processing: 00_baseline_exploration/sweep2_h16_lr_0.0004
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_h16_lr_0.0004
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_h16_lr_0.0004/checkpoints/tft-epoch=02-val_loss=0.1298.ckpt
  Validation loss: 0.129827

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_h16_lr_0.0004/config.json
Output directory: experiments/00_baseline_exploration/sweep2_h16_lr_0.0004/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_h16_lr_0.0004/evaluation/evaluation_20251027_120230.log
Evaluation started at: 2025-10-27 12:02:30
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.090900
    Max: 0.113292
    Mean: 0.000587
    Std: 0.062344
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0909, max: 0.1133, mean: 0.0006
Negative predictions: 681/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  169 days ( 13.2%)
2. Range-based                 [WARN]  274 days ( 21.4%)
3. Consecutive-similarity      [WARN]  387 days ( 30.2%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    832 days ( 65.0%)
  Directional acc < 52%                571 days ( 44.6%)
  Combined (BOTH poor)                 366 days ( 28.6%)
  Unidirectional (>98%)        [WARN]  1081 days ( 84.5%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-30 (  30 days): HEALTHY              - std=0.0085, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2021-04-01 ( 124 days): UNIDIRECTIONAL       - std=0.0181, corr=-0.130, dir_acc=0.444
[ OK ] 2021-04-29 to 2021-05-13 (  11 days): HEALTHY              - std=0.0130, corr=+0.014, dir_acc=0.553
[DEGD] 2021-05-26 to 2021-06-10 (  11 days): DEGRADED             - std=0.0040, corr=-0.098, dir_acc=0.503
[DEGD] 2021-06-15 to 2021-09-10 (  62 days): DEGRADED             - std=0.0146, corr=-0.126, dir_acc=0.392
[UNI ] 2021-09-13 to 2022-06-09 ( 186 days): UNIDIRECTIONAL       - std=0.0178, corr=-0.119, dir_acc=0.485
[FAIL] 2022-06-15 to 2022-07-19 (  23 days): STRONG_COLLAPSE      - std=0.0037, corr=-0.232, dir_acc=0.548
[WEAK] 2022-07-20 to 2022-09-15 (  41 days): WEAK_COLLAPSE        - std=0.0010, corr=-0.195, dir_acc=0.531
[FAIL] 2022-09-16 to 2023-04-06 ( 138 days): STRONG_COLLAPSE      - std=0.0033, corr=-0.033, dir_acc=0.567
[WEAK] 2023-04-10 to 2023-05-10 (  23 days): WEAK_COLLAPSE        - std=0.0019, corr=+0.051, dir_acc=0.486
[UNI ] 2023-05-11 to 2023-05-22 (   8 days): UNIDIRECTIONAL       - std=0.0003, corr=+0.022, dir_acc=0.490
[UNI ] 2023-05-30 to 2023-07-11 (  29 days): UNIDIRECTIONAL       - std=0.0155, corr=-0.007, dir_acc=0.456
[ OK ] 2023-07-12 to 2023-07-26 (  11 days): HEALTHY              - std=0.0120, corr=+0.061, dir_acc=0.511
[DEGD] 2023-07-31 to 2023-09-08 (  29 days): DEGRADED             - std=0.0046, corr=-0.175, dir_acc=0.484
[DEGD] 2023-09-19 to 2023-09-29 (   9 days): DEGRADED             - std=0.0032, corr=-0.169, dir_acc=0.504
[UNI ] 2023-10-02 to 2024-02-22 (  98 days): UNIDIRECTIONAL       - std=0.0209, corr=+0.034, dir_acc=0.564
[WEAK] 2024-02-23 to 2024-04-01 (  26 days): WEAK_COLLAPSE        - std=0.0009, corr=+0.027, dir_acc=0.596
[FAIL] 2024-04-02 to 2024-04-10 (   7 days): STRONG_COLLAPSE      - std=0.0024, corr=-0.008, dir_acc=0.560
[UNI ] 2024-04-17 to 2024-07-30 (  72 days): UNIDIRECTIONAL       - std=0.0093, corr=+0.042, dir_acc=0.558
[UNI ] 2024-08-07 to 2025-10-06 ( 290 days): UNIDIRECTIONAL       - std=0.0242, corr=-0.077, dir_acc=0.569
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            74 days (  5.8%)
  DEGRADED:          125 days (  9.8%)
  UNIDIRECTIONAL:    807 days ( 63.0%)
  WEAK_COLLAPSE:     105 days (  8.2%)
  STRONG_COLLAPSE:   169 days ( 13.2%)

  Total problematic: 1206 days (94.2%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_h16_lr_0.0004/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.181439
  RMSE:             1.086940
  MAE:              0.773395
  Out-of-sample RÂ²: -0.0040

FINANCIAL METRICS:
  Directional Acc:  52.50%
  Sharpe Ratio:     0.8370
  Total Return:     51.70%
  Max Drawdown:     -18.90%
  Hit Rate:         26.48%
  Number of Trades: 599

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5659
  Recall:           0.4934
  F1 Score:         0.5272
  AUC-ROC:          0.5401

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        333             260
  Actual Up:          348             339

ALPHA (vs Buy-and-Hold):
  Excess Return:    -40.46%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_h16_lr_0.0004/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:02:31
======================================================================
---
Processing: 00_baseline_exploration/sweep2_h16_lr_0.0005
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_h16_lr_0.0005
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_h16_lr_0.0005/checkpoints/tft-epoch=01-val_loss=0.1324.ckpt
  Validation loss: 0.132447

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_h16_lr_0.0005/config.json
Output directory: experiments/00_baseline_exploration/sweep2_h16_lr_0.0005/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_h16_lr_0.0005/evaluation/evaluation_20251027_120233.log
Evaluation started at: 2025-10-27 12:02:33
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.103241
    Max: 0.152375
    Mean: -0.003492
    Std: 0.076916
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.1032, max: 0.1524, mean: -0.0035
Negative predictions: 694/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   89 days (  7.0%)
2. Range-based                 [WARN]  187 days ( 14.6%)
3. Consecutive-similarity      [WARN]  294 days ( 23.0%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    758 days ( 59.2%)
  Directional acc < 52%                585 days ( 45.7%)
  Combined (BOTH poor)                 374 days ( 29.2%)
  Unidirectional (>98%)        [WARN]  1085 days ( 84.8%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-30 (  30 days): HEALTHY              - std=0.0083, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2021-04-05 ( 125 days): UNIDIRECTIONAL       - std=0.0188, corr=-0.114, dir_acc=0.444
[ OK ] 2021-04-06 to 2021-04-13 (   6 days): HEALTHY              - std=0.0088, corr=+0.022, dir_acc=0.489
[ OK ] 2021-05-03 to 2021-05-13 (   9 days): HEALTHY              - std=0.0122, corr=+0.016, dir_acc=0.544
[DEGD] 2021-05-26 to 2021-06-08 (   9 days): DEGRADED             - std=0.0053, corr=-0.112, dir_acc=0.502
[DEGD] 2021-06-10 to 2021-09-07 (  62 days): DEGRADED             - std=0.0166, corr=-0.138, dir_acc=0.437
[UNI ] 2021-09-08 to 2022-06-15 ( 193 days): UNIDIRECTIONAL       - std=0.0206, corr=-0.111, dir_acc=0.485
[WEAK] 2022-06-16 to 2022-07-22 (  25 days): WEAK_COLLAPSE        - std=0.0057, corr=-0.059, dir_acc=0.545
[UNI ] 2022-07-25 to 2022-09-23 (  44 days): UNIDIRECTIONAL       - std=0.0019, corr=-0.099, dir_acc=0.534
[WEAK] 2022-09-26 to 2022-10-06 (   9 days): WEAK_COLLAPSE        - std=0.0014, corr=+0.081, dir_acc=0.572
[FAIL] 2022-10-07 to 2022-12-20 (  50 days): STRONG_COLLAPSE      - std=0.0029, corr=+0.122, dir_acc=0.601
[WEAK] 2022-12-21 to 2022-12-29 (   6 days): WEAK_COLLAPSE        - std=0.0017, corr=+0.111, dir_acc=0.594
[FAIL] 2022-12-30 to 2023-02-06 (  25 days): STRONG_COLLAPSE      - std=0.0018, corr=+0.063, dir_acc=0.568
[WEAK] 2023-02-07 to 2023-03-10 (  23 days): WEAK_COLLAPSE        - std=0.0017, corr=+0.075, dir_acc=0.548
[FAIL] 2023-03-13 to 2023-03-30 (  14 days): STRONG_COLLAPSE      - std=0.0038, corr=-0.000, dir_acc=0.511
[WEAK] 2023-03-31 to 2023-04-10 (   6 days): WEAK_COLLAPSE        - std=0.0019, corr=+0.088, dir_acc=0.464
[UNI ] 2023-04-11 to 2023-07-14 (  66 days): UNIDIRECTIONAL       - std=0.0226, corr=+0.013, dir_acc=0.471
[ OK ] 2023-07-17 to 2023-07-28 (  10 days): HEALTHY              - std=0.0121, corr=+0.045, dir_acc=0.467
[DEGD] 2023-07-31 to 2023-10-04 (  47 days): DEGRADED             - std=0.0097, corr=-0.163, dir_acc=0.445
[UNI ] 2023-10-05 to 2024-02-26 (  97 days): UNIDIRECTIONAL       - std=0.0283, corr=+0.034, dir_acc=0.567
[WEAK] 2024-02-27 to 2024-04-08 (  29 days): WEAK_COLLAPSE        - std=0.0033, corr=+0.006, dir_acc=0.587
[UNI ] 2024-04-09 to 2025-10-06 ( 373 days): UNIDIRECTIONAL       - std=0.0336, corr=-0.065, dir_acc=0.567
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            66 days (  5.2%)
  DEGRADED:          129 days ( 10.1%)
  UNIDIRECTIONAL:    898 days ( 70.2%)
  WEAK_COLLAPSE:      98 days (  7.7%)
  STRONG_COLLAPSE:    89 days (  7.0%)

  Total problematic: 1214 days (94.8%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_h16_lr_0.0005/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.183202
  RMSE:             1.087751
  MAE:              0.773713
  Out-of-sample RÂ²: -0.0055

FINANCIAL METRICS:
  Directional Acc:  52.42%
  Sharpe Ratio:     0.8480
  Total Return:     52.05%
  Max Drawdown:     -18.90%
  Hit Rate:         25.94%
  Number of Trades: 586

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5666
  Recall:           0.4833
  F1 Score:         0.5216
  AUC-ROC:          0.5439

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        339             254
  Actual Up:          355             332

ALPHA (vs Buy-and-Hold):
  Excess Return:    -40.11%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_h16_lr_0.0005/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:02:34
======================================================================
---
Processing: 00_baseline_exploration/sweep2_h16_lr_0.0006
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_h16_lr_0.0006
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_h16_lr_0.0006/checkpoints/tft-epoch=01-val_loss=0.1198.ckpt
  Validation loss: 0.119825

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_h16_lr_0.0006/config.json
Output directory: experiments/00_baseline_exploration/sweep2_h16_lr_0.0006/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_h16_lr_0.0006/evaluation/evaluation_20251027_120236.log
Evaluation started at: 2025-10-27 12:02:36
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.102260
    Max: 0.135011
    Mean: -0.004432
    Std: 0.071754
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.1023, max: 0.1350, mean: -0.0044
Negative predictions: 693/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  141 days ( 11.0%)
2. Range-based                 [WARN]  218 days ( 17.0%)
3. Consecutive-similarity      [WARN]  324 days ( 25.3%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    755 days ( 59.0%)
  Directional acc < 52%                591 days ( 46.2%)
  Combined (BOTH poor)                 380 days ( 29.7%)
  Unidirectional (>98%)        [WARN]  1085 days ( 84.8%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-30 (  30 days): HEALTHY              - std=0.0085, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2021-04-05 ( 125 days): UNIDIRECTIONAL       - std=0.0193, corr=-0.121, dir_acc=0.444
[ OK ] 2021-05-03 to 2021-05-12 (   8 days): HEALTHY              - std=0.0082, corr=+0.019, dir_acc=0.544
[DEGD] 2021-05-13 to 2021-09-07 (  81 days): DEGRADED             - std=0.0161, corr=-0.119, dir_acc=0.443
[UNI ] 2021-09-08 to 2022-06-10 ( 190 days): UNIDIRECTIONAL       - std=0.0197, corr=-0.115, dir_acc=0.484
[WEAK] 2022-06-13 to 2022-06-21 (   6 days): WEAK_COLLAPSE        - std=0.0011, corr=-0.192, dir_acc=0.539
[FAIL] 2022-06-22 to 2022-07-12 (  14 days): STRONG_COLLAPSE      - std=0.0027, corr=-0.101, dir_acc=0.551
[WEAK] 2022-07-13 to 2022-08-09 (  20 days): WEAK_COLLAPSE        - std=0.0023, corr=-0.176, dir_acc=0.529
[UNI ] 2022-08-10 to 2022-09-14 (  25 days): UNIDIRECTIONAL       - std=0.0015, corr=-0.129, dir_acc=0.535
[WEAK] 2022-09-15 to 2022-09-27 (   9 days): WEAK_COLLAPSE        - std=0.0007, corr=+0.007, dir_acc=0.546
[FAIL] 2022-09-28 to 2023-04-03 ( 127 days): STRONG_COLLAPSE      - std=0.0028, corr=+0.054, dir_acc=0.571
[WEAK] 2023-04-04 to 2023-04-17 (   9 days): WEAK_COLLAPSE        - std=0.0014, corr=+0.076, dir_acc=0.476
[UNI ] 2023-04-18 to 2023-07-14 (  61 days): UNIDIRECTIONAL       - std=0.0205, corr=+0.011, dir_acc=0.470
[ OK ] 2023-07-17 to 2023-07-26 (   8 days): HEALTHY              - std=0.0109, corr=+0.055, dir_acc=0.467
[DEGD] 2023-07-31 to 2023-10-04 (  47 days): DEGRADED             - std=0.0090, corr=-0.164, dir_acc=0.445
[UNI ] 2023-10-05 to 2024-02-23 (  96 days): UNIDIRECTIONAL       - std=0.0254, corr=+0.038, dir_acc=0.567
[WEAK] 2024-02-26 to 2024-04-10 (  32 days): WEAK_COLLAPSE        - std=0.0037, corr=+0.014, dir_acc=0.586
[UNI ] 2024-04-11 to 2025-10-06 ( 371 days): UNIDIRECTIONAL       - std=0.0294, corr=-0.061, dir_acc=0.567
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            57 days (  4.5%)
  DEGRADED:          138 days ( 10.8%)
  UNIDIRECTIONAL:    868 days ( 67.8%)
  WEAK_COLLAPSE:      76 days (  5.9%)
  STRONG_COLLAPSE:   141 days ( 11.0%)

  Total problematic: 1223 days (95.5%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_h16_lr_0.0006/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.182812
  RMSE:             1.087572
  MAE:              0.773734
  Out-of-sample RÂ²: -0.0051

FINANCIAL METRICS:
  Directional Acc:  52.34%
  Sharpe Ratio:     0.8038
  Total Return:     48.79%
  Max Drawdown:     -18.90%
  Hit Rate:         25.94%
  Number of Trades: 587

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5656
  Recall:           0.4833
  F1 Score:         0.5212
  AUC-ROC:          0.5431

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        338             255
  Actual Up:          355             332

ALPHA (vs Buy-and-Hold):
  Excess Return:    -43.37%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_h16_lr_0.0006/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:02:37
======================================================================
---
Processing: 00_baseline_exploration/sweep2_h16_lr_0.0007
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_h16_lr_0.0007
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_h16_lr_0.0007/checkpoints/tft-epoch=01-val_loss=0.1187.ckpt
  Validation loss: 0.118747

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_h16_lr_0.0007/config.json
Output directory: experiments/00_baseline_exploration/sweep2_h16_lr_0.0007/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_h16_lr_0.0007/evaluation/evaluation_20251027_120238.log
Evaluation started at: 2025-10-27 12:02:38
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.087910
    Max: 0.125154
    Mean: 0.004895
    Std: 0.064972
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0879, max: 0.1252, mean: 0.0049
Negative predictions: 661/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  157 days ( 12.3%)
2. Range-based                 [WARN]  254 days ( 19.8%)
3. Consecutive-similarity      [WARN]  362 days ( 28.3%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    846 days ( 66.1%)
  Directional acc < 52%                494 days ( 38.6%)
  Combined (BOTH poor)                 307 days ( 24.0%)
  Unidirectional (>98%)        [WARN]  1068 days ( 83.4%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-30 (  30 days): HEALTHY              - std=0.0083, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2021-03-31 ( 123 days): UNIDIRECTIONAL       - std=0.0176, corr=-0.125, dir_acc=0.444
[ OK ] 2021-04-06 to 2021-04-13 (   6 days): HEALTHY              - std=0.0084, corr=+0.022, dir_acc=0.522
[ OK ] 2021-04-15 to 2021-08-11 (  83 days): HEALTHY              - std=0.0253, corr=-0.092, dir_acc=0.555
[DEGD] 2021-08-12 to 2021-09-13 (  22 days): DEGRADED             - std=0.0036, corr=-0.104, dir_acc=0.488
[DEGD] 2021-09-15 to 2021-09-28 (  10 days): DEGRADED             - std=0.0060, corr=-0.080, dir_acc=0.493
[UNI ] 2021-09-29 to 2022-06-09 ( 174 days): UNIDIRECTIONAL       - std=0.0191, corr=-0.123, dir_acc=0.490
[FAIL] 2022-06-15 to 2022-07-15 (  21 days): STRONG_COLLAPSE      - std=0.0037, corr=-0.209, dir_acc=0.548
[WEAK] 2022-07-18 to 2022-09-19 (  45 days): WEAK_COLLAPSE        - std=0.0011, corr=-0.175, dir_acc=0.531
[FAIL] 2022-09-20 to 2023-04-05 ( 135 days): STRONG_COLLAPSE      - std=0.0033, corr=-0.019, dir_acc=0.569
[WEAK] 2023-04-06 to 2023-04-21 (  11 days): WEAK_COLLAPSE        - std=0.0017, corr=+0.068, dir_acc=0.477
[UNI ] 2023-04-24 to 2023-07-10 (  53 days): UNIDIRECTIONAL       - std=0.0152, corr=+0.001, dir_acc=0.471
[ OK ] 2023-07-11 to 2023-07-31 (  15 days): HEALTHY              - std=0.0149, corr=+0.047, dir_acc=0.527
[DEGD] 2023-08-01 to 2023-09-07 (  27 days): DEGRADED             - std=0.0047, corr=-0.183, dir_acc=0.499
[ OK ] 2023-09-08 to 2023-09-19 (   8 days): HEALTHY              - std=0.0009, corr=-0.126, dir_acc=0.544
[UNI ] 2023-09-29 to 2024-02-23 ( 100 days): UNIDIRECTIONAL       - std=0.0231, corr=+0.029, dir_acc=0.565
[WEAK] 2024-02-26 to 2024-04-04 (  28 days): WEAK_COLLAPSE        - std=0.0012, corr=+0.018, dir_acc=0.590
[WEAK] 2024-04-08 to 2024-04-15 (   6 days): WEAK_COLLAPSE        - std=0.0022, corr=+0.067, dir_acc=0.558
[UNI ] 2024-04-16 to 2024-07-31 (  74 days): UNIDIRECTIONAL       - std=0.0106, corr=+0.047, dir_acc=0.559
[UNI ] 2024-08-07 to 2025-10-06 ( 290 days): UNIDIRECTIONAL       - std=0.0268, corr=-0.086, dir_acc=0.569
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           145 days ( 11.3%)
  DEGRADED:           67 days (  5.2%)
  UNIDIRECTIONAL:    814 days ( 63.6%)
  WEAK_COLLAPSE:      97 days (  7.6%)
  STRONG_COLLAPSE:   157 days ( 12.3%)

  Total problematic: 1135 days (88.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_h16_lr_0.0007/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.181228
  RMSE:             1.086843
  MAE:              0.773134
  Out-of-sample RÂ²: -0.0038

FINANCIAL METRICS:
  Directional Acc:  53.44%
  Sharpe Ratio:     0.9643
  Total Return:     62.70%
  Max Drawdown:     -18.90%
  Hit Rate:         27.73%
  Number of Trades: 619

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5735
  Recall:           0.5167
  F1 Score:         0.5436
  AUC-ROC:          0.5413

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        329             264
  Actual Up:          332             355

ALPHA (vs Buy-and-Hold):
  Excess Return:    -29.47%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_h16_lr_0.0007/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:02:39
======================================================================
---
Processing: 00_baseline_exploration/sweep2_h16_lr_0.0008
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_h16_lr_0.0008
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_h16_lr_0.0008/checkpoints/tft-epoch=01-val_loss=0.1341.ckpt
  Validation loss: 0.134112

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_h16_lr_0.0008/config.json
Output directory: experiments/00_baseline_exploration/sweep2_h16_lr_0.0008/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_h16_lr_0.0008/evaluation/evaluation_20251027_120241.log
Evaluation started at: 2025-10-27 12:02:41
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.074573
    Max: 0.119518
    Mean: 0.013883
    Std: 0.059772
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0746, max: 0.1195, mean: 0.0139
Negative predictions: 621/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  170 days ( 13.3%)
2. Range-based                 [WARN]  277 days ( 21.6%)
3. Consecutive-similarity      [WARN]  392 days ( 30.6%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    848 days ( 66.2%)
  Directional acc < 52%                479 days ( 37.4%)
  Combined (BOTH poor)                 311 days ( 24.3%)
  Unidirectional (>98%)        [WARN]  1011 days ( 79.0%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-30 (  30 days): HEALTHY              - std=0.0078, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2021-03-23 ( 117 days): UNIDIRECTIONAL       - std=0.0146, corr=-0.124, dir_acc=0.443
[DEGD] 2021-03-24 to 2021-04-05 (   8 days): DEGRADED             - std=0.0067, corr=-0.148, dir_acc=0.438
[ OK ] 2021-04-06 to 2021-04-13 (   6 days): HEALTHY              - std=0.0080, corr=+0.025, dir_acc=0.489
[ OK ] 2021-05-03 to 2021-05-14 (  10 days): HEALTHY              - std=0.0139, corr=+0.011, dir_acc=0.542
[DEGD] 2021-05-17 to 2021-06-07 (  15 days): DEGRADED             - std=0.0053, corr=-0.092, dir_acc=0.504
[UNI ] 2021-06-15 to 2021-07-19 (  24 days): UNIDIRECTIONAL       - std=0.0063, corr=-0.125, dir_acc=0.551
[DEGD] 2021-08-10 to 2021-09-13 (  24 days): DEGRADED             - std=0.0031, corr=-0.099, dir_acc=0.482
[DEGD] 2021-09-21 to 2021-10-07 (  13 days): DEGRADED             - std=0.0032, corr=-0.142, dir_acc=0.453
[UNI ] 2021-10-08 to 2021-10-25 (  11 days): UNIDIRECTIONAL       - std=0.0093, corr=-0.179, dir_acc=0.432
[DEGD] 2021-10-26 to 2021-11-08 (  10 days): DEGRADED             - std=0.0008, corr=-0.063, dir_acc=0.460
[ OK ] 2021-11-09 to 2021-12-23 (  31 days): HEALTHY              - std=0.0172, corr=-0.006, dir_acc=0.554
[ OK ] 2021-12-30 to 2022-02-02 (  24 days): HEALTHY              - std=0.0096, corr=-0.015, dir_acc=0.592
[UNI ] 2022-02-03 to 2022-06-09 (  88 days): UNIDIRECTIONAL       - std=0.0076, corr=-0.199, dir_acc=0.553
[FAIL] 2022-06-15 to 2022-07-18 (  22 days): STRONG_COLLAPSE      - std=0.0035, corr=-0.257, dir_acc=0.548
[WEAK] 2022-07-19 to 2022-09-13 (  40 days): WEAK_COLLAPSE        - std=0.0009, corr=-0.222, dir_acc=0.531
[FAIL] 2022-09-14 to 2023-04-06 ( 140 days): STRONG_COLLAPSE      - std=0.0035, corr=-0.077, dir_acc=0.567
[WEAK] 2023-04-10 to 2023-05-09 (  22 days): WEAK_COLLAPSE        - std=0.0022, corr=+0.042, dir_acc=0.486
[UNI ] 2023-05-10 to 2023-05-23 (  10 days): UNIDIRECTIONAL       - std=0.0004, corr=+0.014, dir_acc=0.490
[UNI ] 2023-05-26 to 2023-06-29 (  23 days): UNIDIRECTIONAL       - std=0.0095, corr=-0.023, dir_acc=0.452
[DEGD] 2023-06-30 to 2023-07-10 (   6 days): DEGRADED             - std=0.0029, corr=+0.035, dir_acc=0.494
[ OK ] 2023-07-11 to 2023-07-31 (  15 days): HEALTHY              - std=0.0138, corr=+0.047, dir_acc=0.527
[DEGD] 2023-08-01 to 2023-09-07 (  27 days): DEGRADED             - std=0.0038, corr=-0.183, dir_acc=0.499
[ OK ] 2023-09-08 to 2023-09-19 (   8 days): HEALTHY              - std=0.0008, corr=-0.124, dir_acc=0.544
[UNI ] 2023-09-21 to 2024-02-22 ( 105 days): UNIDIRECTIONAL       - std=0.0210, corr=+0.013, dir_acc=0.560
[WEAK] 2024-02-23 to 2024-03-28 (  25 days): WEAK_COLLAPSE        - std=0.0007, corr=+0.030, dir_acc=0.597
[FAIL] 2024-04-01 to 2024-04-10 (   8 days): STRONG_COLLAPSE      - std=0.0026, corr=-0.017, dir_acc=0.560
[UNI ] 2024-04-17 to 2024-07-29 (  71 days): UNIDIRECTIONAL       - std=0.0090, corr=+0.051, dir_acc=0.557
[WEAK] 2024-07-30 to 2024-08-06 (   6 days): WEAK_COLLAPSE        - std=0.0030, corr=-0.078, dir_acc=0.614
[UNI ] 2024-08-07 to 2025-10-06 ( 290 days): UNIDIRECTIONAL       - std=0.0242, corr=-0.081, dir_acc=0.569
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           151 days ( 11.8%)
  DEGRADED:          118 days (  9.2%)
  UNIDIRECTIONAL:    739 days ( 57.7%)
  WEAK_COLLAPSE:     102 days (  8.0%)
  STRONG_COLLAPSE:   170 days ( 13.3%)

  Total problematic: 1129 days (88.2%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_h16_lr_0.0008/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.179987
  RMSE:             1.086272
  MAE:              0.772694
  Out-of-sample RÂ²: -0.0027

FINANCIAL METRICS:
  Directional Acc:  53.91%
  Sharpe Ratio:     1.0582
  Total Return:     72.35%
  Max Drawdown:     -18.90%
  Hit Rate:         29.53%
  Number of Trades: 659

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5736
  Recall:           0.5502
  F1 Score:         0.5617
  AUC-ROC:          0.5403

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        312             281
  Actual Up:          309             378

ALPHA (vs Buy-and-Hold):
  Excess Return:    -19.81%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_h16_lr_0.0008/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:02:42
======================================================================
---
Processing: 00_baseline_exploration/sweep2_hidden_10
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_hidden_10
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_hidden_10/checkpoints/tft-epoch=03-val_loss=0.1229.ckpt
  Validation loss: 0.122900

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_hidden_10/config.json
Output directory: experiments/00_baseline_exploration/sweep2_hidden_10/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_hidden_10/evaluation/evaluation_20251027_120243.log
Evaluation started at: 2025-10-27 12:02:43
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.072671
    Max: -0.022862
    Mean: -0.041874
    Std: 0.011204
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0727, max: -0.0229, mean: -0.0419
Negative predictions: 1280/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  480 days ( 37.5%)
2. Range-based                 [WARN] 1179 days ( 92.1%)
3. Consecutive-similarity      [WARN] 1226 days ( 95.8%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    838 days ( 65.5%)
  Directional acc < 52%                986 days ( 77.0%)
  Combined (BOTH poor)                 664 days ( 51.9%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0024, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-02-24 (  98 days): WEAK_COLLAPSE        - std=0.0048, corr=-0.114, dir_acc=0.443
[FAIL] 2021-02-25 to 2021-03-31 (  25 days): STRONG_COLLAPSE      - std=0.0011, corr=+0.032, dir_acc=0.447
[WEAK] 2021-04-01 to 2021-06-24 (  59 days): WEAK_COLLAPSE        - std=0.0018, corr=+0.017, dir_acc=0.466
[FAIL] 2021-06-25 to 2021-12-20 ( 122 days): STRONG_COLLAPSE      - std=0.0014, corr=+0.014, dir_acc=0.414
[WEAK] 2021-12-21 to 2022-03-10 (  55 days): WEAK_COLLAPSE        - std=0.0044, corr=+0.044, dir_acc=0.498
[UNI ] 2022-03-11 to 2022-06-23 (  72 days): UNIDIRECTIONAL       - std=0.0070, corr=-0.173, dir_acc=0.549
[WEAK] 2022-06-24 to 2023-03-30 ( 191 days): WEAK_COLLAPSE        - std=0.0086, corr=-0.043, dir_acc=0.561
[FAIL] 2023-03-31 to 2023-04-28 (  20 days): STRONG_COLLAPSE      - std=0.0024, corr=-0.125, dir_acc=0.475
[WEAK] 2023-05-01 to 2023-07-05 (  45 days): WEAK_COLLAPSE        - std=0.0012, corr=-0.086, dir_acc=0.469
[FAIL] 2023-07-06 to 2023-10-17 (  72 days): STRONG_COLLAPSE      - std=0.0016, corr=-0.069, dir_acc=0.469
[WEAK] 2023-10-18 to 2024-02-02 (  74 days): WEAK_COLLAPSE        - std=0.0035, corr=-0.127, dir_acc=0.437
[FAIL] 2024-02-05 to 2024-08-08 ( 129 days): STRONG_COLLAPSE      - std=0.0016, corr=-0.081, dir_acc=0.424
[WEAK] 2024-08-09 to 2024-10-28 (  55 days): WEAK_COLLAPSE        - std=0.0012, corr=+0.087, dir_acc=0.410
[FAIL] 2024-10-29 to 2025-01-14 (  51 days): STRONG_COLLAPSE      - std=0.0019, corr=+0.052, dir_acc=0.431
[WEAK] 2025-01-15 to 2025-03-03 (  32 days): WEAK_COLLAPSE        - std=0.0009, corr=-0.012, dir_acc=0.436
[WEAK] 2025-03-07 to 2025-05-12 (  46 days): WEAK_COLLAPSE        - std=0.0039, corr=-0.084, dir_acc=0.486
[UNI ] 2025-05-13 to 2025-06-02 (  14 days): UNIDIRECTIONAL       - std=0.0008, corr=-0.024, dir_acc=0.431
[WEAK] 2025-06-03 to 2025-07-15 (  29 days): WEAK_COLLAPSE        - std=0.0005, corr=-0.031, dir_acc=0.392
[FAIL] 2025-07-16 to 2025-10-06 (  58 days): STRONG_COLLAPSE      - std=0.0006, corr=-0.113, dir_acc=0.420
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:     86 days (  6.7%)
  WEAK_COLLAPSE:     684 days ( 53.4%)
  STRONG_COLLAPSE:   480 days ( 37.5%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_hidden_10/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.186440
  RMSE:             1.089238
  MAE:              0.778930
  Out-of-sample RÂ²: -0.0082

FINANCIAL METRICS:
  Directional Acc:  46.33%
  Sharpe Ratio:     0.0000
  Total Return:     0.00%
  Max Drawdown:     0.00%
  Hit Rate:         0.00%
  Number of Trades: 0

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.0000
  Recall:           0.0000
  F1 Score:         0.0000
  AUC-ROC:          0.5312

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        593               0
  Actual Up:          687               0

ALPHA (vs Buy-and-Hold):
  Excess Return:    -92.16%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_hidden_10/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:02:44
======================================================================
---
Processing: 00_baseline_exploration/sweep2_hidden_12
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_hidden_12
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_hidden_12/checkpoints/tft-epoch=03-val_loss=0.1119.ckpt
  Validation loss: 0.111938

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_hidden_12/config.json
Output directory: experiments/00_baseline_exploration/sweep2_hidden_12/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_hidden_12/evaluation/evaluation_20251027_120246.log
Evaluation started at: 2025-10-27 12:02:46
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.025467
    Max: 0.130225
    Mean: 0.075131
    Std: 0.021607
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0255, max: 0.1302, mean: 0.0751
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  319 days ( 24.9%)
2. Range-based                 [WARN]  410 days ( 32.0%)
3. Consecutive-similarity      [WARN]  520 days ( 40.6%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                   1004 days ( 78.4%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 328 days ( 25.6%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0056, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2020-10-14 (   9 days): UNIDIRECTIONAL       - std=0.0012, corr=+0.235, dir_acc=0.603
[WEAK] 2020-10-15 to 2020-12-09 (  38 days): WEAK_COLLAPSE        - std=0.0038, corr=+0.089, dir_acc=0.556
[UNI ] 2020-12-10 to 2021-06-22 ( 133 days): UNIDIRECTIONAL       - std=0.0087, corr=-0.115, dir_acc=0.544
[FAIL] 2021-06-23 to 2021-07-29 (  26 days): STRONG_COLLAPSE      - std=0.0010, corr=-0.129, dir_acc=0.561
[WEAK] 2021-07-30 to 2021-08-06 (   6 days): WEAK_COLLAPSE        - std=0.0005, corr=-0.156, dir_acc=0.561
[FAIL] 2021-08-09 to 2021-12-07 (  83 days): STRONG_COLLAPSE      - std=0.0042, corr=-0.217, dir_acc=0.592
[WEAK] 2021-12-08 to 2021-12-15 (   6 days): WEAK_COLLAPSE        - std=0.0034, corr=-0.248, dir_acc=0.608
[UNI ] 2021-12-23 to 2023-03-01 ( 295 days): UNIDIRECTIONAL       - std=0.0201, corr=-0.053, dir_acc=0.450
[WEAK] 2023-03-02 to 2023-03-13 (   8 days): WEAK_COLLAPSE        - std=0.0023, corr=-0.057, dir_acc=0.471
[UNI ] 2023-03-14 to 2023-06-22 (  70 days): UNIDIRECTIONAL       - std=0.0084, corr=-0.125, dir_acc=0.522
[FAIL] 2023-06-29 to 2023-10-03 (  67 days): STRONG_COLLAPSE      - std=0.0038, corr=-0.036, dir_acc=0.537
[WEAK] 2023-10-04 to 2023-10-19 (  11 days): WEAK_COLLAPSE        - std=0.0018, corr=-0.119, dir_acc=0.477
[UNI ] 2023-10-20 to 2024-01-29 (  68 days): UNIDIRECTIONAL       - std=0.0085, corr=-0.076, dir_acc=0.562
[WEAK] 2024-01-30 to 2024-02-07 (   7 days): WEAK_COLLAPSE        - std=0.0002, corr=-0.175, dir_acc=0.648
[FAIL] 2024-02-08 to 2024-08-06 ( 124 days): STRONG_COLLAPSE      - std=0.0030, corr=-0.046, dir_acc=0.574
[UNI ] 2024-08-08 to 2025-09-17 ( 276 days): UNIDIRECTIONAL       - std=0.0126, corr=-0.152, dir_acc=0.569
[FAIL] 2025-09-19 to 2025-10-06 (  12 days): STRONG_COLLAPSE      - std=0.0005, corr=-0.112, dir_acc=0.571
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    855 days ( 66.8%)
  WEAK_COLLAPSE:      83 days (  6.5%)
  STRONG_COLLAPSE:   312 days ( 24.4%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_hidden_12/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.178435
  RMSE:             1.085557
  MAE:              0.772422
  Out-of-sample RÂ²: -0.0014

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5004

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_hidden_12/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:02:47
======================================================================
---
Processing: 00_baseline_exploration/sweep2_hidden_14
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_hidden_14
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_hidden_14/checkpoints/tft-epoch=01-val_loss=0.1377.ckpt
  Validation loss: 0.137691

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_hidden_14/config.json
Output directory: experiments/00_baseline_exploration/sweep2_hidden_14/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_hidden_14/evaluation/evaluation_20251027_120249.log
Evaluation started at: 2025-10-27 12:02:49
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.289786
    Max: -0.230790
    Mean: -0.267436
    Std: 0.017006
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.2898, max: -0.2308, mean: -0.2674
Negative predictions: 1280/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  255 days ( 19.9%)
2. Range-based                 [WARN]  324 days ( 25.3%)
3. Consecutive-similarity      [WARN]  412 days ( 32.2%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    258 days ( 20.2%)
  Directional acc < 52%                986 days ( 77.0%)
  Combined (BOTH poor)                 203 days ( 15.9%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0047, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2020-11-13 (  30 days): WEAK_COLLAPSE        - std=0.0040, corr=-0.194, dir_acc=0.420
[UNI ] 2020-11-16 to 2021-08-18 ( 190 days): UNIDIRECTIONAL       - std=0.0131, corr=+0.112, dir_acc=0.452
[WEAK] 2021-08-19 to 2021-09-20 (  22 days): WEAK_COLLAPSE        - std=0.0035, corr=+0.460, dir_acc=0.383
[UNI ] 2021-09-21 to 2022-07-19 ( 206 days): UNIDIRECTIONAL       - std=0.0177, corr=+0.138, dir_acc=0.495
[FAIL] 2022-07-20 to 2022-08-11 (  17 days): STRONG_COLLAPSE      - std=0.0050, corr=+0.026, dir_acc=0.525
[UNI ] 2022-08-15 to 2022-11-22 (  69 days): UNIDIRECTIONAL       - std=0.0083, corr=+0.051, dir_acc=0.568
[WEAK] 2022-11-23 to 2022-12-21 (  20 days): WEAK_COLLAPSE        - std=0.0040, corr=-0.130, dir_acc=0.609
[WEAK] 2022-12-23 to 2023-01-03 (   6 days): WEAK_COLLAPSE        - std=0.0006, corr=+0.060, dir_acc=0.597
[UNI ] 2023-01-11 to 2023-07-05 ( 120 days): UNIDIRECTIONAL       - std=0.0140, corr=+0.112, dir_acc=0.503
[FAIL] 2023-07-10 to 2023-10-20 (  73 days): STRONG_COLLAPSE      - std=0.0033, corr=+0.063, dir_acc=0.472
[UNI ] 2023-10-23 to 2024-01-29 (  67 days): UNIDIRECTIONAL       - std=0.0067, corr=+0.095, dir_acc=0.437
[FAIL] 2024-01-31 to 2024-08-05 ( 129 days): STRONG_COLLAPSE      - std=0.0020, corr=-0.047, dir_acc=0.423
[UNI ] 2024-08-07 to 2025-09-17 ( 277 days): UNIDIRECTIONAL       - std=0.0155, corr=+0.194, dir_acc=0.431
[FAIL] 2025-09-18 to 2025-10-06 (  13 days): STRONG_COLLAPSE      - std=0.0004, corr=+0.174, dir_acc=0.429
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    933 days ( 72.9%)
  WEAK_COLLAPSE:      85 days (  6.6%)
  STRONG_COLLAPSE:   232 days ( 18.1%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_hidden_14/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.281640
  RMSE:             1.132096
  MAE:              0.836103
  Out-of-sample RÂ²: -0.0891

FINANCIAL METRICS:
  Directional Acc:  46.33%
  Sharpe Ratio:     0.0000
  Total Return:     0.00%
  Max Drawdown:     0.00%
  Hit Rate:         0.00%
  Number of Trades: 0

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.0000
  Recall:           0.0000
  F1 Score:         0.0000
  AUC-ROC:          0.4853

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        593               0
  Actual Up:          687               0

ALPHA (vs Buy-and-Hold):
  Excess Return:    -92.16%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_hidden_14/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:02:50
======================================================================
---
Processing: 00_baseline_exploration/sweep2_hidden_16
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_hidden_16
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_hidden_16/checkpoints/tft-epoch=01-val_loss=0.1324.ckpt
  Validation loss: 0.132447

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_hidden_16/config.json
Output directory: experiments/00_baseline_exploration/sweep2_hidden_16/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_hidden_16/evaluation/evaluation_20251027_120251.log
Evaluation started at: 2025-10-27 12:02:51
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.103241
    Max: 0.152375
    Mean: -0.003492
    Std: 0.076916
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.1032, max: 0.1524, mean: -0.0035
Negative predictions: 694/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   89 days (  7.0%)
2. Range-based                 [WARN]  187 days ( 14.6%)
3. Consecutive-similarity      [WARN]  294 days ( 23.0%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    758 days ( 59.2%)
  Directional acc < 52%                585 days ( 45.7%)
  Combined (BOTH poor)                 374 days ( 29.2%)
  Unidirectional (>98%)        [WARN]  1085 days ( 84.8%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-30 (  30 days): HEALTHY              - std=0.0083, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2021-04-05 ( 125 days): UNIDIRECTIONAL       - std=0.0188, corr=-0.114, dir_acc=0.444
[ OK ] 2021-04-06 to 2021-04-13 (   6 days): HEALTHY              - std=0.0088, corr=+0.022, dir_acc=0.489
[ OK ] 2021-05-03 to 2021-05-13 (   9 days): HEALTHY              - std=0.0122, corr=+0.016, dir_acc=0.544
[DEGD] 2021-05-26 to 2021-06-08 (   9 days): DEGRADED             - std=0.0053, corr=-0.112, dir_acc=0.502
[DEGD] 2021-06-10 to 2021-09-07 (  62 days): DEGRADED             - std=0.0166, corr=-0.138, dir_acc=0.437
[UNI ] 2021-09-08 to 2022-06-15 ( 193 days): UNIDIRECTIONAL       - std=0.0206, corr=-0.111, dir_acc=0.485
[WEAK] 2022-06-16 to 2022-07-22 (  25 days): WEAK_COLLAPSE        - std=0.0057, corr=-0.059, dir_acc=0.545
[UNI ] 2022-07-25 to 2022-09-23 (  44 days): UNIDIRECTIONAL       - std=0.0019, corr=-0.099, dir_acc=0.534
[WEAK] 2022-09-26 to 2022-10-06 (   9 days): WEAK_COLLAPSE        - std=0.0014, corr=+0.081, dir_acc=0.572
[FAIL] 2022-10-07 to 2022-12-20 (  50 days): STRONG_COLLAPSE      - std=0.0029, corr=+0.122, dir_acc=0.601
[WEAK] 2022-12-21 to 2022-12-29 (   6 days): WEAK_COLLAPSE        - std=0.0017, corr=+0.111, dir_acc=0.594
[FAIL] 2022-12-30 to 2023-02-06 (  25 days): STRONG_COLLAPSE      - std=0.0018, corr=+0.063, dir_acc=0.568
[WEAK] 2023-02-07 to 2023-03-10 (  23 days): WEAK_COLLAPSE        - std=0.0017, corr=+0.075, dir_acc=0.548
[FAIL] 2023-03-13 to 2023-03-30 (  14 days): STRONG_COLLAPSE      - std=0.0038, corr=-0.000, dir_acc=0.511
[WEAK] 2023-03-31 to 2023-04-10 (   6 days): WEAK_COLLAPSE        - std=0.0019, corr=+0.088, dir_acc=0.464
[UNI ] 2023-04-11 to 2023-07-14 (  66 days): UNIDIRECTIONAL       - std=0.0226, corr=+0.013, dir_acc=0.471
[ OK ] 2023-07-17 to 2023-07-28 (  10 days): HEALTHY              - std=0.0121, corr=+0.045, dir_acc=0.467
[DEGD] 2023-07-31 to 2023-10-04 (  47 days): DEGRADED             - std=0.0097, corr=-0.163, dir_acc=0.445
[UNI ] 2023-10-05 to 2024-02-26 (  97 days): UNIDIRECTIONAL       - std=0.0283, corr=+0.034, dir_acc=0.567
[WEAK] 2024-02-27 to 2024-04-08 (  29 days): WEAK_COLLAPSE        - std=0.0033, corr=+0.006, dir_acc=0.587
[UNI ] 2024-04-09 to 2025-10-06 ( 373 days): UNIDIRECTIONAL       - std=0.0336, corr=-0.065, dir_acc=0.567
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            66 days (  5.2%)
  DEGRADED:          129 days ( 10.1%)
  UNIDIRECTIONAL:    898 days ( 70.2%)
  WEAK_COLLAPSE:      98 days (  7.7%)
  STRONG_COLLAPSE:    89 days (  7.0%)

  Total problematic: 1214 days (94.8%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_hidden_16/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.183202
  RMSE:             1.087751
  MAE:              0.773713
  Out-of-sample RÂ²: -0.0055

FINANCIAL METRICS:
  Directional Acc:  52.42%
  Sharpe Ratio:     0.8480
  Total Return:     52.05%
  Max Drawdown:     -18.90%
  Hit Rate:         25.94%
  Number of Trades: 586

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5666
  Recall:           0.4833
  F1 Score:         0.5216
  AUC-ROC:          0.5439

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        339             254
  Actual Up:          355             332

ALPHA (vs Buy-and-Hold):
  Excess Return:    -40.11%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_hidden_16/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:02:52
======================================================================
---
Processing: 00_baseline_exploration/sweep2_hidden_18
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_hidden_18
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_hidden_18/checkpoints/tft-epoch=03-val_loss=0.1477.ckpt
  Validation loss: 0.147669

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_hidden_18/config.json
Output directory: experiments/00_baseline_exploration/sweep2_hidden_18/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_hidden_18/evaluation/evaluation_20251027_120254.log
Evaluation started at: 2025-10-27 12:02:54
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.034599
    Max: 0.317420
    Mean: 0.074550
    Std: 0.103643
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0346, max: 0.3174, mean: 0.0746
Negative predictions: 518/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  206 days ( 16.1%)
2. Range-based                 [WARN]  149 days ( 11.6%)
3. Consecutive-similarity      [ OK ]   65 days (  5.1%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    187 days ( 14.6%)
  Directional acc < 52%                834 days ( 65.2%)
  Combined (BOTH poor)                 149 days ( 11.6%)
  Unidirectional (>98%)        [WARN]   658 days ( 51.4%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-30 (  30 days): HEALTHY              - std=0.0103, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2021-04-23 ( 139 days): UNIDIRECTIONAL       - std=0.0370, corr=+0.044, dir_acc=0.555
[DEGD] 2021-04-29 to 2021-05-11 (   9 days): DEGRADED             - std=0.0027, corr=-0.028, dir_acc=0.494
[ OK ] 2021-05-12 to 2021-12-17 ( 152 days): HEALTHY              - std=0.0441, corr=+0.158, dir_acc=0.506
[ OK ] 2021-12-21 to 2022-02-18 (  42 days): HEALTHY              - std=0.0728, corr=+0.143, dir_acc=0.474
[UNI ] 2022-02-22 to 2023-04-21 ( 291 days): UNIDIRECTIONAL       - std=0.0855, corr=+0.124, dir_acc=0.446
[ OK ] 2023-04-24 to 2023-06-27 (  45 days): HEALTHY              - std=0.0060, corr=+0.126, dir_acc=0.509
[ OK ] 2023-07-03 to 2023-07-14 (   9 days): HEALTHY              - std=0.0021, corr=+0.036, dir_acc=0.450
[UNI ] 2023-07-17 to 2023-08-29 (  32 days): UNIDIRECTIONAL       - std=0.0032, corr=+0.110, dir_acc=0.440
[WEAK] 2023-08-30 to 2023-10-03 (  24 days): WEAK_COLLAPSE        - std=0.0040, corr=-0.001, dir_acc=0.490
[UNI ] 2023-10-04 to 2023-10-20 (  12 days): UNIDIRECTIONAL       - std=0.0052, corr=+0.183, dir_acc=0.525
[ OK ] 2023-10-31 to 2024-02-02 (  65 days): HEALTHY              - std=0.0182, corr=+0.178, dir_acc=0.469
[FAIL] 2024-02-09 to 2024-04-16 (  46 days): STRONG_COLLAPSE      - std=0.0022, corr=-0.190, dir_acc=0.407
[WEAK] 2024-04-17 to 2024-07-10 (  58 days): WEAK_COLLAPSE        - std=0.0034, corr=+0.029, dir_acc=0.464
[FAIL] 2024-07-11 to 2024-08-02 (  17 days): STRONG_COLLAPSE      - std=0.0019, corr=-0.120, dir_acc=0.356
[ OK ] 2024-08-08 to 2025-03-10 ( 144 days): HEALTHY              - std=0.0376, corr=+0.169, dir_acc=0.545
[ OK ] 2025-03-14 to 2025-04-04 (  16 days): HEALTHY              - std=0.0188, corr=+0.035, dir_acc=0.525
[DEGD] 2025-04-07 to 2025-04-21 (  10 days): DEGRADED             - std=0.0226, corr=-0.025, dir_acc=0.505
[ OK ] 2025-04-22 to 2025-05-21 (  22 days): HEALTHY              - std=0.0373, corr=+0.132, dir_acc=0.563
[UNI ] 2025-05-22 to 2025-07-08 (  31 days): UNIDIRECTIONAL       - std=0.0227, corr=+0.122, dir_acc=0.597
[ OK ] 2025-07-09 to 2025-08-11 (  24 days): HEALTHY              - std=0.0054, corr=+0.164, dir_acc=0.567
[ OK ] 2025-08-18 to 2025-09-26 (  29 days): HEALTHY              - std=0.0023, corr=+0.186, dir_acc=0.488
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           585 days ( 45.7%)
  DEGRADED:           37 days (  2.9%)
  UNIDIRECTIONAL:    508 days ( 39.7%)
  WEAK_COLLAPSE:      87 days (  6.8%)
  STRONG_COLLAPSE:    63 days (  4.9%)

  Total problematic:  695 days (54.3%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_hidden_18/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.185299
  RMSE:             1.088714
  MAE:              0.778657
  Out-of-sample RÂ²: -0.0073

FINANCIAL METRICS:
  Directional Acc:  48.98%
  Sharpe Ratio:     0.5427
  Total Return:     44.95%
  Max Drawdown:     -25.25%
  Hit Rate:         31.09%
  Number of Trades: 762

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5223
  Recall:           0.5793
  F1 Score:         0.5493
  AUC-ROC:          0.4797

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        229             364
  Actual Up:          289             398

ALPHA (vs Buy-and-Hold):
  Excess Return:    -47.21%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_hidden_18/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:02:55
======================================================================
---
Processing: 00_baseline_exploration/sweep2_hidden_20
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_hidden_20
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_hidden_20/checkpoints/tft-epoch=01-val_loss=0.0671.ckpt
  Validation loss: 0.067114

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_hidden_20/config.json
Output directory: experiments/00_baseline_exploration/sweep2_hidden_20/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_hidden_20/evaluation/evaluation_20251027_120257.log
Evaluation started at: 2025-10-27 12:02:57
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.191917
    Max: 0.393936
    Mean: 0.245988
    Std: 0.051568
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1919, max: 0.3939, mean: 0.2460
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]  107 days (  8.4%)
2. Range-based                 [WARN]  141 days ( 11.0%)
3. Consecutive-similarity      [WARN]  225 days ( 17.6%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    233 days ( 18.2%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                  87 days (  6.8%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-30 (  30 days): HEALTHY              - std=0.0083, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2021-09-02 ( 231 days): UNIDIRECTIONAL       - std=0.0226, corr=+0.001, dir_acc=0.556
[FAIL] 2021-09-03 to 2021-09-27 (  16 days): STRONG_COLLAPSE      - std=0.0049, corr=+0.081, dir_acc=0.594
[UNI ] 2021-09-29 to 2023-08-28 ( 477 days): UNIDIRECTIONAL       - std=0.0556, corr=+0.101, dir_acc=0.487
[FAIL] 2023-09-01 to 2023-10-03 (  22 days): STRONG_COLLAPSE      - std=0.0023, corr=+0.061, dir_acc=0.507
[UNI ] 2023-10-10 to 2024-02-16 (  90 days): UNIDIRECTIONAL       - std=0.0228, corr=+0.157, dir_acc=0.566
[FAIL] 2024-02-22 to 2024-04-30 (  48 days): STRONG_COLLAPSE      - std=0.0056, corr=+0.060, dir_acc=0.568
[WEAK] 2024-05-07 to 2024-07-12 (  46 days): WEAK_COLLAPSE        - std=0.0053, corr=+0.135, dir_acc=0.551
[UNI ] 2024-07-15 to 2024-07-29 (  11 days): UNIDIRECTIONAL       - std=0.0022, corr=+0.141, dir_acc=0.653
[UNI ] 2024-08-07 to 2025-10-06 ( 290 days): UNIDIRECTIONAL       - std=0.0482, corr=+0.103, dir_acc=0.569
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            30 days (  2.3%)
  DEGRADED:            0 days (  0.0%)
  UNIDIRECTIONAL:   1102 days ( 86.1%)
  WEAK_COLLAPSE:      58 days (  4.5%)
  STRONG_COLLAPSE:    90 days (  7.0%)

  Total problematic: 1250 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_hidden_20/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.215273
  RMSE:             1.102394
  MAE:              0.787636
  Out-of-sample RÂ²: -0.0327

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4737

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_hidden_20/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:02:58
======================================================================
---
Processing: 00_baseline_exploration/sweep2_hidden_8
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_hidden_8
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_hidden_8/checkpoints/tft-epoch=04-val_loss=0.1451.ckpt
  Validation loss: 0.145136

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_hidden_8/config.json
Output directory: experiments/00_baseline_exploration/sweep2_hidden_8/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_hidden_8/evaluation/evaluation_20251027_120259.log
Evaluation started at: 2025-10-27 12:02:59
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.164699
    Max: -0.089697
    Mean: -0.099073
    Std: 0.008907
    Unique values: 1278

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.1647, max: -0.0897, mean: -0.0991
Negative predictions: 1280/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    9 days (  0.7%)
2. Range-based                 [WARN] 1079 days ( 84.3%)
3. Consecutive-similarity      [WARN] 1128 days ( 88.1%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    921 days ( 72.0%)
  Directional acc < 52%                986 days ( 77.0%)
  Combined (BOTH poor)                 728 days ( 56.9%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0003, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2020-10-27 (  18 days): WEAK_COLLAPSE        - std=0.0001, corr=+0.111, dir_acc=0.410
[FAIL] 2020-10-28 to 2020-11-09 (   9 days): STRONG_COLLAPSE      - std=0.0003, corr=+0.041, dir_acc=0.434
[WEAK] 2020-11-10 to 2022-10-07 ( 478 days): WEAK_COLLAPSE        - std=0.0032, corr=-0.043, dir_acc=0.478
[UNI ] 2022-10-11 to 2023-03-01 (  96 days): UNIDIRECTIONAL       - std=0.0138, corr=-0.117, dir_acc=0.585
[WEAK] 2023-03-02 to 2025-03-19 ( 511 days): WEAK_COLLAPSE        - std=0.0043, corr=-0.055, dir_acc=0.444
[WEAK] 2025-03-21 to 2025-04-30 (  28 days): WEAK_COLLAPSE        - std=0.0058, corr=-0.012, dir_acc=0.486
[UNI ] 2025-05-01 to 2025-08-18 (  75 days): UNIDIRECTIONAL       - std=0.0174, corr=-0.113, dir_acc=0.408
[WEAK] 2025-08-19 to 2025-10-06 (  34 days): WEAK_COLLAPSE        - std=0.0002, corr=-0.079, dir_acc=0.436
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    172 days ( 13.4%)
  WEAK_COLLAPSE:    1069 days ( 83.5%)
  STRONG_COLLAPSE:     9 days (  0.7%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_hidden_8/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.202223
  RMSE:             1.096460
  MAE:              0.788696
  Out-of-sample RÂ²: -0.0216

FINANCIAL METRICS:
  Directional Acc:  46.33%
  Sharpe Ratio:     0.0000
  Total Return:     0.00%
  Max Drawdown:     0.00%
  Hit Rate:         0.00%
  Number of Trades: 0

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.0000
  Recall:           0.0000
  F1 Score:         0.0000
  AUC-ROC:          0.4901

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        593               0
  Actual Up:          687               0

ALPHA (vs Buy-and-Hold):
  Excess Return:    -92.16%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_hidden_8/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:03:00
======================================================================
---
Processing: 01_staleness_features_fixed/baseline_fixed_h16_drop0.25
======================================================================
Evaluating TFT: 01_staleness_features_fixed/baseline_fixed_h16_drop0.25
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/baseline_fixed_h16_drop0.25/checkpoints/tft-epoch=01-val_loss=0.1051.ckpt
  Validation loss: 0.105134

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/baseline_fixed_h16_drop0.25/config.json
Output directory: experiments/01_staleness_features_fixed/baseline_fixed_h16_drop0.25/evaluation
Logging to: experiments/01_staleness_features_fixed/baseline_fixed_h16_drop0.25/evaluation/evaluation_20251027_120302.log
Evaluation started at: 2025-10-27 12:03:02
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.031874
    Max: 0.041145
    Mean: 0.003011
    Std: 0.014727
    Unique values: 1278

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0319, max: 0.0411, mean: 0.0030
Negative predictions: 450/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  614 days ( 48.0%)
2. Range-based                 [WARN]  907 days ( 70.9%)
3. Consecutive-similarity      [WARN] 1177 days ( 92.0%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                   1017 days ( 79.5%)
  Directional acc < 52%                384 days ( 30.0%)
  Combined (BOTH poor)                 345 days ( 27.0%)
  Unidirectional (>98%)        [WARN]   893 days ( 69.8%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0017, corr=+0.000, dir_acc=0.500
[FAIL] 2020-10-01 to 2020-12-04 (  44 days): STRONG_COLLAPSE      - std=0.0032, corr=-0.225, dir_acc=0.433
[WEAK] 2020-12-07 to 2021-01-04 (  19 days): WEAK_COLLAPSE        - std=0.0011, corr=-0.125, dir_acc=0.475
[UNI ] 2021-01-05 to 2021-02-19 (  32 days): UNIDIRECTIONAL       - std=0.0032, corr=-0.106, dir_acc=0.436
[DEGD] 2021-02-22 to 2021-05-12 (  57 days): DEGRADED             - std=0.0133, corr=-0.021, dir_acc=0.468
[UNI ] 2021-05-13 to 2021-09-28 (  96 days): UNIDIRECTIONAL       - std=0.0076, corr=-0.055, dir_acc=0.569
[WEAK] 2021-09-29 to 2021-10-08 (   8 days): WEAK_COLLAPSE        - std=0.0016, corr=-0.083, dir_acc=0.544
[FAIL] 2021-10-12 to 2021-10-27 (  12 days): STRONG_COLLAPSE      - std=0.0048, corr=-0.153, dir_acc=0.575
[WEAK] 2021-10-28 to 2021-12-03 (  25 days): WEAK_COLLAPSE        - std=0.0047, corr=-0.006, dir_acc=0.599
[ OK ] 2021-12-14 to 2022-01-14 (  23 days): HEALTHY              - std=0.0033, corr=-0.014, dir_acc=0.609
[DEGD] 2022-01-18 to 2022-01-27 (   8 days): DEGRADED             - std=0.0013, corr=+0.044, dir_acc=0.594
[ OK ] 2022-02-10 to 2022-02-18 (   7 days): HEALTHY              - std=0.0006, corr=-0.078, dir_acc=0.540
[DEGD] 2022-02-22 to 2022-03-01 (   6 days): DEGRADED             - std=0.0008, corr=-0.010, dir_acc=0.558
[UNI ] 2022-03-02 to 2022-04-20 (  35 days): UNIDIRECTIONAL       - std=0.0026, corr=-0.100, dir_acc=0.569
[WEAK] 2022-04-21 to 2022-05-02 (   8 days): WEAK_COLLAPSE        - std=0.0010, corr=-0.044, dir_acc=0.550
[WEAK] 2022-05-05 to 2022-06-24 (  35 days): WEAK_COLLAPSE        - std=0.0013, corr=-0.149, dir_acc=0.537
[FAIL] 2022-06-27 to 2022-09-13 (  55 days): STRONG_COLLAPSE      - std=0.0033, corr=-0.134, dir_acc=0.537
[WEAK] 2022-09-14 to 2022-10-26 (  30 days): WEAK_COLLAPSE        - std=0.0023, corr=-0.137, dir_acc=0.572
[DEGD] 2022-10-31 to 2022-11-16 (  12 days): DEGRADED             - std=0.0007, corr=+0.082, dir_acc=0.581
[WEAK] 2022-11-17 to 2022-12-27 (  27 days): WEAK_COLLAPSE        - std=0.0014, corr=+0.081, dir_acc=0.589
[FAIL] 2022-12-28 to 2023-06-14 ( 116 days): STRONG_COLLAPSE      - std=0.0030, corr=-0.055, dir_acc=0.498
[WEAK] 2023-06-15 to 2023-08-18 (  45 days): WEAK_COLLAPSE        - std=0.0011, corr=-0.039, dir_acc=0.534
[FAIL] 2023-08-21 to 2024-08-26 ( 255 days): STRONG_COLLAPSE      - std=0.0021, corr=-0.121, dir_acc=0.564
[WEAK] 2024-08-27 to 2024-09-27 (  23 days): WEAK_COLLAPSE        - std=0.0010, corr=-0.061, dir_acc=0.597
[FAIL] 2024-09-30 to 2024-12-26 (  60 days): STRONG_COLLAPSE      - std=0.0031, corr=-0.111, dir_acc=0.573
[WEAK] 2024-12-27 to 2025-01-14 (  11 days): WEAK_COLLAPSE        - std=0.0005, corr=-0.137, dir_acc=0.539
[FAIL] 2025-01-15 to 2025-04-01 (  53 days): STRONG_COLLAPSE      - std=0.0033, corr=-0.087, dir_acc=0.540
[DEGD] 2025-04-09 to 2025-05-12 (  23 days): DEGRADED             - std=0.0028, corr=-0.235, dir_acc=0.516
[DEGD] 2025-05-19 to 2025-06-04 (  12 days): DEGRADED             - std=0.0013, corr=-0.347, dir_acc=0.578
[ OK ] 2025-06-05 to 2025-06-16 (   8 days): HEALTHY              - std=0.0005, corr=-0.262, dir_acc=0.608
[ OK ] 2025-06-24 to 2025-07-02 (   7 days): HEALTHY              - std=0.0016, corr=-0.222, dir_acc=0.602
[WEAK] 2025-07-11 to 2025-08-20 (  29 days): WEAK_COLLAPSE        - std=0.0014, corr=-0.155, dir_acc=0.604
[WEAK] 2025-08-28 to 2025-09-19 (  16 days): WEAK_COLLAPSE        - std=0.0007, corr=-0.147, dir_acc=0.561
[FAIL] 2025-09-22 to 2025-10-06 (  11 days): STRONG_COLLAPSE      - std=0.0008, corr=-0.039, dir_acc=0.570
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            86 days (  6.7%)
  DEGRADED:          132 days ( 10.3%)
  UNIDIRECTIONAL:    167 days ( 13.0%)
  WEAK_COLLAPSE:     282 days ( 22.0%)
  STRONG_COLLAPSE:   613 days ( 47.9%)

  Total problematic: 1194 days (93.3%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/baseline_fixed_h16_drop0.25/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.179492
  RMSE:             1.086044
  MAE:              0.774347
  Out-of-sample RÂ²: -0.0023

FINANCIAL METRICS:
  Directional Acc:  54.61%
  Sharpe Ratio:     1.0594
  Total Return:     77.65%
  Max Drawdown:     -21.25%
  Hit Rate:         36.56%
  Number of Trades: 830

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5639
  Recall:           0.6812
  F1 Score:         0.6170
  AUC-ROC:          0.5323

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        231             362
  Actual Up:          219             468

ALPHA (vs Buy-and-Hold):
  Excess Return:    -14.51%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/baseline_fixed_h16_drop0.25/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:03:03
======================================================================
---
Processing: 01_staleness_features_fixed/staleness_fixed_h16_drop0.25_seed999
======================================================================
Evaluating TFT: 01_staleness_features_fixed/staleness_fixed_h16_drop0.25_seed999
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/staleness_fixed_h16_drop0.25_seed999/checkpoints/tft-epoch=02-val_loss=0.1369.ckpt
  Validation loss: 0.136869

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/staleness_fixed_h16_drop0.25_seed999/config.json
Output directory: experiments/01_staleness_features_fixed/staleness_fixed_h16_drop0.25_seed999/evaluation
Logging to: experiments/01_staleness_features_fixed/staleness_fixed_h16_drop0.25_seed999/evaluation/evaluation_20251027_120304.log
Evaluation started at: 2025-10-27 12:03:04
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.242151
    Max: 0.304402
    Mean: 0.284554
    Std: 0.014566
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.2422, max: 0.3044, mean: 0.2846
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  176 days ( 13.8%)
2. Range-based                 [WARN] 1145 days ( 89.5%)
3. Consecutive-similarity      [WARN] 1190 days ( 93.0%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    704 days ( 55.0%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 226 days ( 17.7%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0022, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-04-22 ( 138 days): WEAK_COLLAPSE        - std=0.0048, corr=-0.031, dir_acc=0.555
[UNI ] 2021-04-23 to 2021-08-09 (  75 days): UNIDIRECTIONAL       - std=0.0091, corr=-0.066, dir_acc=0.544
[WEAK] 2021-08-10 to 2021-09-15 (  26 days): WEAK_COLLAPSE        - std=0.0012, corr=+0.065, dir_acc=0.615
[FAIL] 2021-09-16 to 2021-10-08 (  17 days): STRONG_COLLAPSE      - std=0.0014, corr=+0.037, dir_acc=0.558
[FAIL] 2021-10-15 to 2021-10-26 (   8 days): STRONG_COLLAPSE      - std=0.0019, corr=-0.179, dir_acc=0.577
[WEAK] 2021-10-27 to 2022-08-11 ( 198 days): WEAK_COLLAPSE        - std=0.0030, corr=+0.067, dir_acc=0.495
[FAIL] 2022-08-12 to 2022-08-23 (   8 days): STRONG_COLLAPSE      - std=0.0018, corr=+0.102, dir_acc=0.477
[WEAK] 2022-08-24 to 2023-09-11 ( 261 days): WEAK_COLLAPSE        - std=0.0033, corr=-0.025, dir_acc=0.477
[FAIL] 2023-09-12 to 2024-01-08 (  81 days): STRONG_COLLAPSE      - std=0.0013, corr=-0.080, dir_acc=0.524
[WEAK] 2024-01-09 to 2024-01-18 (   7 days): WEAK_COLLAPSE        - std=0.0001, corr=-0.076, dir_acc=0.614
[FAIL] 2024-01-19 to 2024-03-22 (  45 days): STRONG_COLLAPSE      - std=0.0015, corr=-0.028, dir_acc=0.629
[WEAK] 2024-03-25 to 2024-04-18 (  18 days): WEAK_COLLAPSE        - std=0.0008, corr=-0.104, dir_acc=0.551
[WEAK] 2024-04-22 to 2024-05-15 (  18 days): WEAK_COLLAPSE        - std=0.0016, corr=-0.026, dir_acc=0.506
[WEAK] 2024-05-22 to 2024-06-10 (  13 days): WEAK_COLLAPSE        - std=0.0008, corr=-0.050, dir_acc=0.526
[FAIL] 2024-06-11 to 2024-06-27 (  12 days): STRONG_COLLAPSE      - std=0.0014, corr=+0.026, dir_acc=0.562
[WEAK] 2024-06-28 to 2024-07-11 (   9 days): WEAK_COLLAPSE        - std=0.0036, corr=-0.029, dir_acc=0.604
[UNI ] 2024-07-12 to 2024-09-19 (  49 days): UNIDIRECTIONAL       - std=0.0034, corr=+0.150, dir_acc=0.618
[WEAK] 2024-09-20 to 2025-10-06 ( 259 days): WEAK_COLLAPSE        - std=0.0040, corr=-0.013, dir_acc=0.565
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    124 days (  9.7%)
  WEAK_COLLAPSE:     950 days ( 74.2%)
  STRONG_COLLAPSE:   176 days ( 13.8%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/staleness_fixed_h16_drop0.25_seed999/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.229084
  RMSE:             1.108641
  MAE:              0.795938
  Out-of-sample RÂ²: -0.0445

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4949

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/staleness_fixed_h16_drop0.25_seed999/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:03:06
======================================================================
---
Processing: 01_staleness_features_fixed/staleness_fixed_h16_drop0.25
======================================================================
Evaluating TFT: 01_staleness_features_fixed/staleness_fixed_h16_drop0.25
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/staleness_fixed_h16_drop0.25/checkpoints/tft-epoch=01-val_loss=0.1476.ckpt
  Validation loss: 0.147566

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/staleness_fixed_h16_drop0.25/config.json
Output directory: experiments/01_staleness_features_fixed/staleness_fixed_h16_drop0.25/evaluation
Logging to: experiments/01_staleness_features_fixed/staleness_fixed_h16_drop0.25/evaluation/evaluation_20251027_120307.log
Evaluation started at: 2025-10-27 12:03:07
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.019630
    Max: 0.122707
    Mean: 0.087928
    Std: 0.018846
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0196, max: 0.1227, mean: 0.0879
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  681 days ( 53.2%)
3. Consecutive-similarity      [WARN]  643 days ( 50.2%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    982 days ( 76.7%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 347 days ( 27.1%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0021, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2020-11-19 (  34 days): UNIDIRECTIONAL       - std=0.0027, corr=+0.075, dir_acc=0.578
[UNI ] 2020-11-23 to 2020-12-18 (  19 days): UNIDIRECTIONAL       - std=0.0025, corr=-0.130, dir_acc=0.528
[UNI ] 2020-12-22 to 2021-01-21 (  20 days): UNIDIRECTIONAL       - std=0.0015, corr=-0.191, dir_acc=0.537
[UNI ] 2021-01-26 to 2021-04-27 (  64 days): UNIDIRECTIONAL       - std=0.0048, corr=-0.108, dir_acc=0.556
[WEAK] 2021-04-28 to 2021-12-14 ( 159 days): WEAK_COLLAPSE        - std=0.0053, corr=-0.147, dir_acc=0.571
[UNI ] 2021-12-15 to 2022-05-03 (  96 days): UNIDIRECTIONAL       - std=0.0087, corr=-0.025, dir_acc=0.482
[WEAK] 2022-05-04 to 2022-10-17 ( 114 days): WEAK_COLLAPSE        - std=0.0040, corr=-0.160, dir_acc=0.458
[UNI ] 2022-10-18 to 2023-03-08 (  96 days): UNIDIRECTIONAL       - std=0.0139, corr=-0.117, dir_acc=0.418
[WEAK] 2023-03-09 to 2023-04-14 (  26 days): WEAK_COLLAPSE        - std=0.0059, corr=+0.003, dir_acc=0.503
[UNI ] 2023-04-17 to 2023-06-28 (  51 days): UNIDIRECTIONAL       - std=0.0030, corr=-0.027, dir_acc=0.529
[WEAK] 2023-06-29 to 2023-08-21 (  37 days): WEAK_COLLAPSE        - std=0.0034, corr=+0.058, dir_acc=0.556
[UNI ] 2023-08-22 to 2024-02-20 ( 124 days): UNIDIRECTIONAL       - std=0.0070, corr=-0.068, dir_acc=0.552
[UNI ] 2024-02-26 to 2024-03-20 (  18 days): UNIDIRECTIONAL       - std=0.0016, corr=-0.029, dir_acc=0.607
[WEAK] 2024-03-21 to 2024-04-04 (  10 days): WEAK_COLLAPSE        - std=0.0025, corr=+0.047, dir_acc=0.560
[UNI ] 2024-04-05 to 2024-04-18 (  10 days): UNIDIRECTIONAL       - std=0.0018, corr=+0.168, dir_acc=0.547
[UNI ] 2024-04-23 to 2024-05-17 (  19 days): UNIDIRECTIONAL       - std=0.0012, corr=+0.009, dir_acc=0.508
[UNI ] 2024-05-23 to 2024-06-18 (  18 days): UNIDIRECTIONAL       - std=0.0013, corr=-0.168, dir_acc=0.538
[UNI ] 2024-06-25 to 2025-08-19 ( 287 days): UNIDIRECTIONAL       - std=0.0163, corr=-0.151, dir_acc=0.575
[UNI ] 2025-08-22 to 2025-09-17 (  18 days): UNIDIRECTIONAL       - std=0.0021, corr=-0.184, dir_acc=0.560
[WEAK] 2025-09-18 to 2025-09-26 (   7 days): WEAK_COLLAPSE        - std=0.0027, corr=-0.138, dir_acc=0.564
[UNI ] 2025-09-29 to 2025-10-06 (   6 days): UNIDIRECTIONAL       - std=0.0013, corr=-0.075, dir_acc=0.578
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    880 days ( 68.8%)
  WEAK_COLLAPSE:     370 days ( 28.9%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/staleness_fixed_h16_drop0.25/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.178549
  RMSE:             1.085610
  MAE:              0.772370
  Out-of-sample RÂ²: -0.0015

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5214

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/staleness_fixed_h16_drop0.25/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:03:08
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr3
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr3/checkpoints/tft-epoch=04-val_loss=0.1419.ckpt
  Validation loss: 0.141882

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr3/evaluation/evaluation_20251027_120310.log
Evaluation started at: 2025-10-27 12:03:10
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.007867
    Max: 0.072061
    Mean: 0.047417
    Std: 0.013259
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0079, max: 0.0721, mean: 0.0474
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   86 days (  6.7%)
2. Range-based                 [WARN]  803 days ( 62.7%)
3. Consecutive-similarity      [WARN]  645 days ( 50.4%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    634 days ( 49.5%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 306 days ( 23.9%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0030, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-01-27 (  79 days): WEAK_COLLAPSE        - std=0.0051, corr=-0.051, dir_acc=0.554
[UNI ] 2021-01-28 to 2021-02-12 (  12 days): UNIDIRECTIONAL       - std=0.0028, corr=-0.056, dir_acc=0.575
[WEAK] 2021-02-16 to 2021-05-20 (  67 days): WEAK_COLLAPSE        - std=0.0029, corr=+0.098, dir_acc=0.543
[FAIL] 2021-05-21 to 2021-06-04 (  10 days): STRONG_COLLAPSE      - std=0.0009, corr=+0.118, dir_acc=0.543
[WEAK] 2021-06-07 to 2022-02-07 ( 169 days): WEAK_COLLAPSE        - std=0.0055, corr=+0.148, dir_acc=0.573
[UNI ] 2022-02-08 to 2022-07-22 ( 114 days): UNIDIRECTIONAL       - std=0.0065, corr=-0.121, dir_acc=0.450
[WEAK] 2022-07-25 to 2022-10-14 (  58 days): WEAK_COLLAPSE        - std=0.0046, corr=-0.126, dir_acc=0.456
[UNI ] 2022-10-17 to 2023-02-13 (  81 days): UNIDIRECTIONAL       - std=0.0106, corr=-0.135, dir_acc=0.412
[WEAK] 2023-02-14 to 2023-03-07 (  15 days): WEAK_COLLAPSE        - std=0.0012, corr=+0.148, dir_acc=0.449
[FAIL] 2023-03-08 to 2023-04-20 (  31 days): STRONG_COLLAPSE      - std=0.0026, corr=+0.094, dir_acc=0.505
[WEAK] 2023-04-21 to 2023-05-22 (  22 days): WEAK_COLLAPSE        - std=0.0030, corr=+0.044, dir_acc=0.510
[UNI ] 2023-05-23 to 2023-06-15 (  17 days): UNIDIRECTIONAL       - std=0.0010, corr=+0.030, dir_acc=0.546
[UNI ] 2023-06-21 to 2023-09-18 (  62 days): UNIDIRECTIONAL       - std=0.0025, corr=-0.031, dir_acc=0.544
[UNI ] 2023-09-20 to 2023-10-18 (  20 days): UNIDIRECTIONAL       - std=0.0031, corr=-0.165, dir_acc=0.491
[UNI ] 2023-10-23 to 2024-02-20 (  82 days): UNIDIRECTIONAL       - std=0.0030, corr=-0.009, dir_acc=0.578
[UNI ] 2024-02-22 to 2024-03-20 (  20 days): UNIDIRECTIONAL       - std=0.0024, corr=+0.228, dir_acc=0.609
[WEAK] 2024-04-02 to 2024-04-12 (   9 days): WEAK_COLLAPSE        - std=0.0006, corr=+0.195, dir_acc=0.561
[FAIL] 2024-04-15 to 2024-05-20 (  26 days): STRONG_COLLAPSE      - std=0.0022, corr=+0.196, dir_acc=0.509
[UNI ] 2024-05-28 to 2024-06-17 (  15 days): UNIDIRECTIONAL       - std=0.0013, corr=+0.010, dir_acc=0.539
[UNI ] 2024-06-21 to 2025-01-22 ( 145 days): UNIDIRECTIONAL       - std=0.0058, corr=-0.023, dir_acc=0.588
[UNI ] 2025-01-24 to 2025-02-20 (  19 days): UNIDIRECTIONAL       - std=0.0024, corr=+0.089, dir_acc=0.578
[WEAK] 2025-02-26 to 2025-03-18 (  15 days): WEAK_COLLAPSE        - std=0.0018, corr=+0.052, dir_acc=0.494
[UNI ] 2025-03-19 to 2025-08-18 ( 105 days): UNIDIRECTIONAL       - std=0.0095, corr=-0.149, dir_acc=0.570
[UNI ] 2025-08-22 to 2025-09-17 (  18 days): UNIDIRECTIONAL       - std=0.0019, corr=-0.098, dir_acc=0.560
[WEAK] 2025-09-18 to 2025-10-06 (  13 days): WEAK_COLLAPSE        - std=0.0035, corr=-0.246, dir_acc=0.571
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    713 days ( 55.7%)
  WEAK_COLLAPSE:     468 days ( 36.6%)
  STRONG_COLLAPSE:    69 days (  5.4%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.176697
  RMSE:             1.084757
  MAE:              0.772140
  Out-of-sample RÂ²: 0.0001

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5417

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:03:11
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr5
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr5/checkpoints/tft-epoch=03-val_loss=0.1440.ckpt
  Validation loss: 0.144020

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr5/evaluation/evaluation_20251027_120312.log
Evaluation started at: 2025-10-27 12:03:12
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.009982
    Max: 0.049443
    Mean: 0.035727
    Std: 0.008089
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0100, max: 0.0494, mean: 0.0357
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    2 days (  0.2%)
2. Range-based                 [WARN] 1152 days ( 90.0%)
3. Consecutive-similarity      [WARN]  927 days ( 72.4%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    517 days ( 40.4%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 264 days ( 20.6%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0020, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2022-03-11 ( 360 days): WEAK_COLLAPSE        - std=0.0052, corr=+0.142, dir_acc=0.554
[UNI ] 2022-03-14 to 2022-04-27 (  32 days): UNIDIRECTIONAL       - std=0.0048, corr=-0.089, dir_acc=0.440
[WEAK] 2022-04-28 to 2022-12-20 ( 162 days): WEAK_COLLAPSE        - std=0.0045, corr=-0.148, dir_acc=0.441
[UNI ] 2022-12-21 to 2023-01-24 (  22 days): UNIDIRECTIONAL       - std=0.0012, corr=-0.100, dir_acc=0.418
[WEAK] 2023-01-25 to 2023-03-08 (  30 days): WEAK_COLLAPSE        - std=0.0010, corr=+0.119, dir_acc=0.449
[WEAK] 2023-03-13 to 2023-07-21 (  91 days): WEAK_COLLAPSE        - std=0.0033, corr=+0.133, dir_acc=0.525
[UNI ] 2023-07-24 to 2023-08-16 (  18 days): UNIDIRECTIONAL       - std=0.0018, corr=-0.026, dir_acc=0.572
[WEAK] 2023-08-17 to 2023-10-06 (  36 days): WEAK_COLLAPSE        - std=0.0022, corr=-0.112, dir_acc=0.514
[UNI ] 2023-10-10 to 2023-10-17 (   6 days): UNIDIRECTIONAL       - std=0.0006, corr=-0.052, dir_acc=0.483
[WEAK] 2023-10-18 to 2023-11-21 (  25 days): WEAK_COLLAPSE        - std=0.0024, corr=-0.008, dir_acc=0.481
[UNI ] 2023-11-22 to 2023-12-19 (  19 days): UNIDIRECTIONAL       - std=0.0019, corr=+0.033, dir_acc=0.561
[UNI ] 2023-12-21 to 2024-02-15 (  38 days): UNIDIRECTIONAL       - std=0.0019, corr=+0.065, dir_acc=0.637
[UNI ] 2024-02-23 to 2024-03-19 (  18 days): UNIDIRECTIONAL       - std=0.0014, corr=+0.187, dir_acc=0.610
[WEAK] 2024-03-20 to 2024-07-31 (  92 days): WEAK_COLLAPSE        - std=0.0037, corr=+0.077, dir_acc=0.559
[UNI ] 2024-08-01 to 2024-08-16 (  12 days): UNIDIRECTIONAL       - std=0.0042, corr=-0.050, dir_acc=0.606
[UNI ] 2024-08-22 to 2025-01-21 ( 101 days): UNIDIRECTIONAL       - std=0.0029, corr=+0.021, dir_acc=0.576
[UNI ] 2025-01-27 to 2025-02-21 (  19 days): UNIDIRECTIONAL       - std=0.0016, corr=+0.149, dir_acc=0.576
[WEAK] 2025-02-24 to 2025-03-17 (  16 days): WEAK_COLLAPSE        - std=0.0022, corr=+0.119, dir_acc=0.498
[UNI ] 2025-03-24 to 2025-08-06 (  94 days): UNIDIRECTIONAL       - std=0.0051, corr=-0.147, dir_acc=0.571
[WEAK] 2025-08-07 to 2025-10-06 (  42 days): WEAK_COLLAPSE        - std=0.0022, corr=-0.116, dir_acc=0.565
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    381 days ( 29.8%)
  WEAK_COLLAPSE:     867 days ( 67.7%)
  STRONG_COLLAPSE:     2 days (  0.2%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.176891
  RMSE:             1.084846
  MAE:              0.772700
  Out-of-sample RÂ²: -0.0001

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5511

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:03:14
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr3
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr3/checkpoints/tft-epoch=04-val_loss=0.1416.ckpt
  Validation loss: 0.141599

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr3/evaluation/evaluation_20251027_120315.log
Evaluation started at: 2025-10-27 12:03:15
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.015881
    Max: 0.076112
    Mean: 0.053930
    Std: 0.011901
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0159, max: 0.0761, mean: 0.0539
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   69 days (  5.4%)
2. Range-based                 [WARN]  890 days ( 69.5%)
3. Consecutive-similarity      [WARN]  712 days ( 55.6%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    623 days ( 48.7%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 300 days ( 23.4%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0027, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-05-18 ( 156 days): WEAK_COLLAPSE        - std=0.0054, corr=+0.019, dir_acc=0.551
[FAIL] 2021-05-19 to 2021-06-07 (  13 days): STRONG_COLLAPSE      - std=0.0013, corr=+0.152, dir_acc=0.538
[WEAK] 2021-06-08 to 2022-02-14 ( 173 days): WEAK_COLLAPSE        - std=0.0052, corr=+0.156, dir_acc=0.570
[UNI ] 2022-02-15 to 2022-02-28 (   9 days): UNIDIRECTIONAL       - std=0.0006, corr=+0.126, dir_acc=0.448
[UNI ] 2022-03-04 to 2022-07-22 (  97 days): UNIDIRECTIONAL       - std=0.0059, corr=-0.153, dir_acc=0.449
[WEAK] 2022-07-25 to 2022-10-13 (  57 days): WEAK_COLLAPSE        - std=0.0044, corr=-0.117, dir_acc=0.457
[UNI ] 2022-10-14 to 2023-02-13 (  82 days): UNIDIRECTIONAL       - std=0.0103, corr=-0.134, dir_acc=0.412
[WEAK] 2023-02-14 to 2023-03-07 (  15 days): WEAK_COLLAPSE        - std=0.0012, corr=+0.162, dir_acc=0.449
[FAIL] 2023-03-08 to 2023-04-20 (  31 days): STRONG_COLLAPSE      - std=0.0023, corr=+0.131, dir_acc=0.505
[WEAK] 2023-04-21 to 2023-05-22 (  22 days): WEAK_COLLAPSE        - std=0.0029, corr=+0.062, dir_acc=0.510
[UNI ] 2023-05-23 to 2023-06-08 (  12 days): UNIDIRECTIONAL       - std=0.0009, corr=+0.034, dir_acc=0.533
[WEAK] 2023-06-09 to 2023-06-22 (   9 days): WEAK_COLLAPSE        - std=0.0035, corr=+0.008, dir_acc=0.570
[UNI ] 2023-06-23 to 2023-07-18 (  17 days): UNIDIRECTIONAL       - std=0.0018, corr=+0.045, dir_acc=0.536
[UNI ] 2023-07-24 to 2023-09-18 (  40 days): UNIDIRECTIONAL       - std=0.0023, corr=-0.066, dir_acc=0.545
[UNI ] 2023-09-25 to 2023-10-18 (  17 days): UNIDIRECTIONAL       - std=0.0015, corr=-0.149, dir_acc=0.488
[UNI ] 2023-10-24 to 2024-02-20 (  81 days): UNIDIRECTIONAL       - std=0.0028, corr=-0.006, dir_acc=0.580
[UNI ] 2024-02-22 to 2024-03-20 (  20 days): UNIDIRECTIONAL       - std=0.0023, corr=+0.222, dir_acc=0.609
[WEAK] 2024-03-21 to 2024-04-18 (  20 days): WEAK_COLLAPSE        - std=0.0013, corr=+0.191, dir_acc=0.553
[FAIL] 2024-04-19 to 2024-05-20 (  22 days): STRONG_COLLAPSE      - std=0.0022, corr=+0.197, dir_acc=0.506
[WEAK] 2024-05-21 to 2024-06-20 (  21 days): WEAK_COLLAPSE        - std=0.0025, corr=+0.012, dir_acc=0.538
[UNI ] 2024-06-21 to 2024-07-17 (  18 days): UNIDIRECTIONAL       - std=0.0019, corr=-0.004, dir_acc=0.607
[UNI ] 2024-07-19 to 2025-01-22 ( 126 days): UNIDIRECTIONAL       - std=0.0044, corr=-0.023, dir_acc=0.584
[UNI ] 2025-01-24 to 2025-02-21 (  20 days): UNIDIRECTIONAL       - std=0.0024, corr=+0.106, dir_acc=0.577
[UNI ] 2025-03-07 to 2025-08-15 ( 112 days): UNIDIRECTIONAL       - std=0.0087, corr=-0.142, dir_acc=0.564
[UNI ] 2025-08-22 to 2025-09-17 (  18 days): UNIDIRECTIONAL       - std=0.0019, corr=-0.086, dir_acc=0.560
[WEAK] 2025-09-18 to 2025-10-06 (  13 days): WEAK_COLLAPSE        - std=0.0034, corr=-0.237, dir_acc=0.571
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    671 days ( 52.4%)
  WEAK_COLLAPSE:     513 days ( 40.1%)
  STRONG_COLLAPSE:    66 days (  5.2%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.176676
  RMSE:             1.084747
  MAE:              0.772054
  Out-of-sample RÂ²: 0.0001

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5437

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:03:16
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr5
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr5/checkpoints/tft-epoch=03-val_loss=0.1432.ckpt
  Validation loss: 0.143209

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr5/evaluation/evaluation_20251027_120318.log
Evaluation started at: 2025-10-27 12:03:18
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.028134
    Max: 0.069326
    Mean: 0.054600
    Std: 0.007989
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0281, max: 0.0693, mean: 0.0546
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN] 1169 days ( 91.3%)
3. Consecutive-similarity      [WARN]  928 days ( 72.5%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    520 days ( 40.6%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 266 days ( 20.8%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0019, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2022-03-11 ( 360 days): WEAK_COLLAPSE        - std=0.0049, corr=+0.143, dir_acc=0.554
[UNI ] 2022-03-14 to 2022-04-27 (  32 days): UNIDIRECTIONAL       - std=0.0048, corr=-0.091, dir_acc=0.440
[WEAK] 2022-04-28 to 2022-12-20 ( 162 days): WEAK_COLLAPSE        - std=0.0049, corr=-0.144, dir_acc=0.441
[UNI ] 2022-12-21 to 2023-01-24 (  22 days): UNIDIRECTIONAL       - std=0.0012, corr=-0.101, dir_acc=0.418
[WEAK] 2023-01-25 to 2023-07-26 ( 126 days): WEAK_COLLAPSE        - std=0.0032, corr=+0.134, dir_acc=0.507
[UNI ] 2023-07-27 to 2023-08-10 (  11 days): UNIDIRECTIONAL       - std=0.0005, corr=-0.024, dir_acc=0.576
[WEAK] 2023-08-15 to 2023-10-10 (  39 days): WEAK_COLLAPSE        - std=0.0022, corr=-0.108, dir_acc=0.515
[WEAK] 2023-10-18 to 2023-11-21 (  25 days): WEAK_COLLAPSE        - std=0.0024, corr=-0.018, dir_acc=0.481
[UNI ] 2023-11-22 to 2023-12-19 (  19 days): UNIDIRECTIONAL       - std=0.0019, corr=+0.010, dir_acc=0.561
[UNI ] 2023-12-21 to 2024-02-15 (  38 days): UNIDIRECTIONAL       - std=0.0018, corr=+0.056, dir_acc=0.637
[UNI ] 2024-02-23 to 2024-03-19 (  18 days): UNIDIRECTIONAL       - std=0.0014, corr=+0.190, dir_acc=0.610
[WEAK] 2024-03-20 to 2024-07-24 (  87 days): WEAK_COLLAPSE        - std=0.0040, corr=+0.084, dir_acc=0.555
[UNI ] 2024-07-25 to 2024-08-16 (  17 days): UNIDIRECTIONAL       - std=0.0041, corr=-0.075, dir_acc=0.614
[UNI ] 2024-08-22 to 2025-01-21 ( 101 days): UNIDIRECTIONAL       - std=0.0029, corr=+0.019, dir_acc=0.576
[UNI ] 2025-01-27 to 2025-02-21 (  19 days): UNIDIRECTIONAL       - std=0.0016, corr=+0.148, dir_acc=0.576
[WEAK] 2025-02-24 to 2025-03-17 (  16 days): WEAK_COLLAPSE        - std=0.0022, corr=+0.112, dir_acc=0.498
[UNI ] 2025-03-25 to 2025-08-05 (  92 days): UNIDIRECTIONAL       - std=0.0055, corr=-0.147, dir_acc=0.572
[WEAK] 2025-08-06 to 2025-10-06 (  43 days): WEAK_COLLAPSE        - std=0.0023, corr=-0.113, dir_acc=0.566
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    378 days ( 29.5%)
  WEAK_COLLAPSE:     872 days ( 68.1%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.176543
  RMSE:             1.084686
  MAE:              0.772216
  Out-of-sample RÂ²: 0.0002

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5492

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:03:19
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr3
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr3/checkpoints/tft-epoch=04-val_loss=0.1415.ckpt
  Validation loss: 0.141453

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr3/evaluation/evaluation_20251027_120320.log
Evaluation started at: 2025-10-27 12:03:20
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.024672
    Max: 0.082473
    Mean: 0.061934
    Std: 0.011233
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0247, max: 0.0825, mean: 0.0619
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   69 days (  5.4%)
2. Range-based                 [WARN]  903 days ( 70.5%)
3. Consecutive-similarity      [WARN]  774 days ( 60.5%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    624 days ( 48.8%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 300 days ( 23.4%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0026, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-05-17 ( 155 days): WEAK_COLLAPSE        - std=0.0047, corr=+0.023, dir_acc=0.551
[FAIL] 2021-05-18 to 2021-06-10 (  17 days): STRONG_COLLAPSE      - std=0.0013, corr=+0.166, dir_acc=0.536
[WEAK] 2021-06-11 to 2022-03-03 ( 182 days): WEAK_COLLAPSE        - std=0.0061, corr=+0.159, dir_acc=0.563
[UNI ] 2022-03-04 to 2022-07-19 (  94 days): UNIDIRECTIONAL       - std=0.0059, corr=-0.150, dir_acc=0.448
[WEAK] 2022-07-20 to 2022-10-13 (  60 days): WEAK_COLLAPSE        - std=0.0045, corr=-0.114, dir_acc=0.458
[UNI ] 2022-10-14 to 2023-02-10 (  81 days): UNIDIRECTIONAL       - std=0.0101, corr=-0.137, dir_acc=0.411
[WEAK] 2023-02-13 to 2023-03-07 (  16 days): WEAK_COLLAPSE        - std=0.0011, corr=+0.159, dir_acc=0.449
[FAIL] 2023-03-08 to 2023-04-19 (  30 days): STRONG_COLLAPSE      - std=0.0018, corr=+0.143, dir_acc=0.504
[WEAK] 2023-04-20 to 2023-05-24 (  25 days): WEAK_COLLAPSE        - std=0.0027, corr=+0.061, dir_acc=0.511
[WEAK] 2023-05-31 to 2023-06-22 (  16 days): WEAK_COLLAPSE        - std=0.0027, corr=+0.018, dir_acc=0.556
[UNI ] 2023-06-23 to 2023-07-17 (  16 days): UNIDIRECTIONAL       - std=0.0017, corr=+0.041, dir_acc=0.534
[UNI ] 2023-07-24 to 2023-08-17 (  19 days): UNIDIRECTIONAL       - std=0.0021, corr=-0.040, dir_acc=0.570
[UNI ] 2023-08-23 to 2023-09-14 (  16 days): UNIDIRECTIONAL       - std=0.0013, corr=-0.077, dir_acc=0.521
[WEAK] 2023-09-15 to 2023-09-22 (   6 days): WEAK_COLLAPSE        - std=0.0052, corr=-0.082, dir_acc=0.511
[UNI ] 2023-09-25 to 2023-10-18 (  17 days): UNIDIRECTIONAL       - std=0.0015, corr=-0.143, dir_acc=0.488
[UNI ] 2023-10-24 to 2024-02-20 (  81 days): UNIDIRECTIONAL       - std=0.0026, corr=-0.014, dir_acc=0.580
[UNI ] 2024-02-23 to 2024-03-20 (  19 days): UNIDIRECTIONAL       - std=0.0014, corr=+0.221, dir_acc=0.609
[WEAK] 2024-03-21 to 2024-04-18 (  20 days): WEAK_COLLAPSE        - std=0.0012, corr=+0.191, dir_acc=0.553
[FAIL] 2024-04-19 to 2024-05-20 (  22 days): STRONG_COLLAPSE      - std=0.0021, corr=+0.196, dir_acc=0.506
[WEAK] 2024-05-21 to 2024-07-08 (  32 days): WEAK_COLLAPSE        - std=0.0050, corr=+0.001, dir_acc=0.552
[UNI ] 2024-07-09 to 2024-07-17 (   7 days): UNIDIRECTIONAL       - std=0.0006, corr=-0.011, dir_acc=0.652
[UNI ] 2024-07-19 to 2025-01-22 ( 126 days): UNIDIRECTIONAL       - std=0.0043, corr=-0.022, dir_acc=0.584
[UNI ] 2025-01-27 to 2025-02-21 (  19 days): UNIDIRECTIONAL       - std=0.0017, corr=+0.114, dir_acc=0.576
[WEAK] 2025-02-24 to 2025-03-06 (   9 days): WEAK_COLLAPSE        - std=0.0020, corr=+0.117, dir_acc=0.506
[UNI ] 2025-03-07 to 2025-08-15 ( 112 days): UNIDIRECTIONAL       - std=0.0084, corr=-0.141, dir_acc=0.564
[UNI ] 2025-08-25 to 2025-09-17 (  17 days): UNIDIRECTIONAL       - std=0.0018, corr=-0.080, dir_acc=0.560
[WEAK] 2025-09-18 to 2025-10-06 (  13 days): WEAK_COLLAPSE        - std=0.0034, corr=-0.231, dir_acc=0.571
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    627 days ( 49.0%)
  WEAK_COLLAPSE:     554 days ( 43.3%)
  STRONG_COLLAPSE:    69 days (  5.4%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.176735
  RMSE:             1.084774
  MAE:              0.771952
  Out-of-sample RÂ²: 0.0000

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5454

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:03:22
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr5
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr5/checkpoints/tft-epoch=03-val_loss=0.1437.ckpt
  Validation loss: 0.143697

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr5/evaluation/evaluation_20251027_120323.log
Evaluation started at: 2025-10-27 12:03:23
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.037576
    Max: 0.076257
    Mean: 0.062383
    Std: 0.007209
    Unique values: 1278

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0376, max: 0.0763, mean: 0.0624
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   12 days (  0.9%)
2. Range-based                 [WARN] 1194 days ( 93.3%)
3. Consecutive-similarity      [WARN]  979 days ( 76.5%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    523 days ( 40.9%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 264 days ( 20.6%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0018, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-06-01 ( 165 days): WEAK_COLLAPSE        - std=0.0022, corr=+0.078, dir_acc=0.550
[FAIL] 2021-06-02 to 2021-06-11 (   8 days): STRONG_COLLAPSE      - std=0.0006, corr=+0.189, dir_acc=0.540
[WEAK] 2021-06-14 to 2022-03-15 ( 189 days): WEAK_COLLAPSE        - std=0.0043, corr=+0.204, dir_acc=0.556
[UNI ] 2022-03-16 to 2022-04-27 (  30 days): UNIDIRECTIONAL       - std=0.0048, corr=-0.106, dir_acc=0.443
[WEAK] 2022-04-28 to 2023-03-07 ( 213 days): WEAK_COLLAPSE        - std=0.0051, corr=-0.101, dir_acc=0.440
[WEAK] 2023-03-14 to 2023-11-21 ( 175 days): WEAK_COLLAPSE        - std=0.0041, corr=+0.054, dir_acc=0.520
[UNI ] 2023-11-22 to 2023-12-19 (  19 days): UNIDIRECTIONAL       - std=0.0019, corr=+0.028, dir_acc=0.561
[UNI ] 2023-12-21 to 2024-01-19 (  19 days): UNIDIRECTIONAL       - std=0.0020, corr=+0.066, dir_acc=0.618
[UNI ] 2024-01-25 to 2024-02-15 (  16 days): UNIDIRECTIONAL       - std=0.0006, corr=+0.032, dir_acc=0.654
[WEAK] 2024-02-16 to 2024-02-26 (   6 days): WEAK_COLLAPSE        - std=0.0027, corr=+0.059, dir_acc=0.619
[UNI ] 2024-02-27 to 2024-03-05 (   6 days): UNIDIRECTIONAL       - std=0.0004, corr=+0.181, dir_acc=0.628
[WEAK] 2024-03-06 to 2024-08-05 ( 105 days): WEAK_COLLAPSE        - std=0.0037, corr=+0.076, dir_acc=0.564
[UNI ] 2024-08-06 to 2024-08-16 (   9 days): UNIDIRECTIONAL       - std=0.0047, corr=-0.063, dir_acc=0.606
[UNI ] 2024-08-22 to 2024-11-18 (  60 days): UNIDIRECTIONAL       - std=0.0030, corr=-0.061, dir_acc=0.579
[UNI ] 2024-11-22 to 2025-01-21 (  38 days): UNIDIRECTIONAL       - std=0.0014, corr=+0.148, dir_acc=0.572
[UNI ] 2025-01-28 to 2025-02-19 (  16 days): UNIDIRECTIONAL       - std=0.0012, corr=+0.169, dir_acc=0.578
[WEAK] 2025-02-20 to 2025-03-24 (  23 days): WEAK_COLLAPSE        - std=0.0032, corr=+0.095, dir_acc=0.507
[UNI ] 2025-03-25 to 2025-08-01 (  90 days): UNIDIRECTIONAL       - std=0.0053, corr=-0.142, dir_acc=0.571
[WEAK] 2025-08-04 to 2025-10-06 (  45 days): WEAK_COLLAPSE        - std=0.0021, corr=-0.108, dir_acc=0.567
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    304 days ( 23.8%)
  WEAK_COLLAPSE:     934 days ( 73.0%)
  STRONG_COLLAPSE:    12 days (  0.9%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.176626
  RMSE:             1.084724
  MAE:              0.772113
  Out-of-sample RÂ²: 0.0001

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5500

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:03:25
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr3
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr3/checkpoints/tft-epoch=04-val_loss=0.1421.ckpt
  Validation loss: 0.142120

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr3/evaluation/evaluation_20251027_120326.log
Evaluation started at: 2025-10-27 12:03:26
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.032921
    Max: 0.093685
    Mean: 0.071264
    Std: 0.011498
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0329, max: 0.0937, mean: 0.0713
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   86 days (  6.7%)
2. Range-based                 [WARN]  888 days ( 69.4%)
3. Consecutive-similarity      [WARN]  744 days ( 58.1%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    640 days ( 50.0%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 306 days ( 23.9%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0027, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-05-17 ( 155 days): WEAK_COLLAPSE        - std=0.0053, corr=+0.011, dir_acc=0.551
[FAIL] 2021-05-18 to 2021-06-16 (  21 days): STRONG_COLLAPSE      - std=0.0014, corr=+0.152, dir_acc=0.537
[WEAK] 2021-06-17 to 2022-02-15 ( 167 days): WEAK_COLLAPSE        - std=0.0050, corr=+0.155, dir_acc=0.571
[WEAK] 2022-02-17 to 2022-03-03 (  10 days): WEAK_COLLAPSE        - std=0.0006, corr=+0.131, dir_acc=0.443
[UNI ] 2022-03-04 to 2022-07-25 (  98 days): UNIDIRECTIONAL       - std=0.0061, corr=-0.154, dir_acc=0.450
[WEAK] 2022-07-26 to 2022-10-12 (  55 days): WEAK_COLLAPSE        - std=0.0045, corr=-0.111, dir_acc=0.457
[UNI ] 2022-10-13 to 2023-02-13 (  83 days): UNIDIRECTIONAL       - std=0.0107, corr=-0.133, dir_acc=0.412
[WEAK] 2023-02-14 to 2023-03-06 (  14 days): WEAK_COLLAPSE        - std=0.0011, corr=+0.156, dir_acc=0.446
[FAIL] 2023-03-07 to 2023-04-20 (  32 days): STRONG_COLLAPSE      - std=0.0022, corr=+0.130, dir_acc=0.504
[WEAK] 2023-04-21 to 2023-05-24 (  24 days): WEAK_COLLAPSE        - std=0.0027, corr=+0.046, dir_acc=0.510
[WEAK] 2023-05-31 to 2023-06-22 (  16 days): WEAK_COLLAPSE        - std=0.0028, corr=+0.010, dir_acc=0.556
[UNI ] 2023-06-23 to 2023-07-17 (  16 days): UNIDIRECTIONAL       - std=0.0016, corr=+0.035, dir_acc=0.534
[UNI ] 2023-07-24 to 2023-08-17 (  19 days): UNIDIRECTIONAL       - std=0.0022, corr=-0.041, dir_acc=0.570
[UNI ] 2023-08-22 to 2023-09-14 (  17 days): UNIDIRECTIONAL       - std=0.0013, corr=-0.086, dir_acc=0.522
[WEAK] 2023-09-15 to 2023-09-22 (   6 days): WEAK_COLLAPSE        - std=0.0057, corr=-0.085, dir_acc=0.511
[UNI ] 2023-09-25 to 2023-10-18 (  17 days): UNIDIRECTIONAL       - std=0.0014, corr=-0.152, dir_acc=0.488
[UNI ] 2023-10-24 to 2024-02-20 (  81 days): UNIDIRECTIONAL       - std=0.0027, corr=-0.024, dir_acc=0.580
[UNI ] 2024-02-22 to 2024-03-20 (  20 days): UNIDIRECTIONAL       - std=0.0023, corr=+0.235, dir_acc=0.609
[WEAK] 2024-03-21 to 2024-04-15 (  17 days): WEAK_COLLAPSE        - std=0.0013, corr=+0.205, dir_acc=0.560
[FAIL] 2024-04-16 to 2024-05-20 (  25 days): STRONG_COLLAPSE      - std=0.0022, corr=+0.207, dir_acc=0.507
[WEAK] 2024-05-21 to 2024-06-20 (  21 days): WEAK_COLLAPSE        - std=0.0026, corr=-0.003, dir_acc=0.538
[UNI ] 2024-06-21 to 2025-01-22 ( 145 days): UNIDIRECTIONAL       - std=0.0057, corr=-0.023, dir_acc=0.588
[UNI ] 2025-01-24 to 2025-02-21 (  20 days): UNIDIRECTIONAL       - std=0.0024, corr=+0.113, dir_acc=0.577
[UNI ] 2025-03-10 to 2025-08-15 ( 111 days): UNIDIRECTIONAL       - std=0.0100, corr=-0.147, dir_acc=0.565
[UNI ] 2025-08-22 to 2025-09-17 (  18 days): UNIDIRECTIONAL       - std=0.0019, corr=-0.072, dir_acc=0.560
[WEAK] 2025-09-18 to 2025-10-06 (  13 days): WEAK_COLLAPSE        - std=0.0037, corr=-0.225, dir_acc=0.571
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    649 days ( 50.7%)
  WEAK_COLLAPSE:     519 days ( 40.5%)
  STRONG_COLLAPSE:    82 days (  6.4%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.177050
  RMSE:             1.084920
  MAE:              0.771881
  Out-of-sample RÂ²: -0.0002

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5438

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:03:27
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr5
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr5/checkpoints/tft-epoch=03-val_loss=0.1437.ckpt
  Validation loss: 0.143750

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr5/evaluation/evaluation_20251027_120329.log
Evaluation started at: 2025-10-27 12:03:29
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.041770
    Max: 0.084537
    Mean: 0.068741
    Std: 0.007946
    Unique values: 1277

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0418, max: 0.0845, mean: 0.0687
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   27 days (  2.1%)
2. Range-based                 [WARN] 1059 days ( 82.7%)
3. Consecutive-similarity      [WARN]  913 days ( 71.3%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    548 days ( 42.8%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 270 days ( 21.1%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0019, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-05-17 ( 155 days): WEAK_COLLAPSE        - std=0.0031, corr=+0.059, dir_acc=0.551
[FAIL] 2021-05-18 to 2021-06-16 (  21 days): STRONG_COLLAPSE      - std=0.0013, corr=+0.174, dir_acc=0.537
[WEAK] 2021-06-17 to 2022-03-10 ( 183 days): WEAK_COLLAPSE        - std=0.0043, corr=+0.190, dir_acc=0.559
[UNI ] 2022-03-11 to 2022-04-27 (  33 days): UNIDIRECTIONAL       - std=0.0055, corr=-0.100, dir_acc=0.438
[WEAK] 2022-04-28 to 2022-10-20 ( 121 days): WEAK_COLLAPSE        - std=0.0045, corr=-0.134, dir_acc=0.456
[UNI ] 2022-10-21 to 2022-11-29 (  26 days): UNIDIRECTIONAL       - std=0.0048, corr=-0.205, dir_acc=0.404
[WEAK] 2022-11-30 to 2022-12-20 (  15 days): WEAK_COLLAPSE        - std=0.0013, corr=-0.171, dir_acc=0.383
[UNI ] 2022-12-21 to 2023-01-30 (  26 days): UNIDIRECTIONAL       - std=0.0012, corr=-0.083, dir_acc=0.420
[WEAK] 2023-01-31 to 2023-03-07 (  25 days): WEAK_COLLAPSE        - std=0.0010, corr=+0.127, dir_acc=0.451
[WEAK] 2023-03-22 to 2023-07-26 (  87 days): WEAK_COLLAPSE        - std=0.0036, corr=+0.111, dir_acc=0.531
[UNI ] 2023-07-27 to 2023-08-14 (  13 days): UNIDIRECTIONAL       - std=0.0007, corr=-0.040, dir_acc=0.574
[WEAK] 2023-08-15 to 2023-09-27 (  31 days): WEAK_COLLAPSE        - std=0.0023, corr=-0.101, dir_acc=0.520
[UNI ] 2023-10-04 to 2023-10-17 (   9 days): UNIDIRECTIONAL       - std=0.0009, corr=-0.090, dir_acc=0.485
[WEAK] 2023-10-18 to 2023-11-17 (  23 days): WEAK_COLLAPSE        - std=0.0018, corr=-0.045, dir_acc=0.474
[UNI ] 2023-11-20 to 2023-12-19 (  21 days): UNIDIRECTIONAL       - std=0.0030, corr=-0.010, dir_acc=0.560
[UNI ] 2023-12-21 to 2024-02-15 (  38 days): UNIDIRECTIONAL       - std=0.0018, corr=+0.053, dir_acc=0.637
[UNI ] 2024-02-23 to 2024-03-19 (  18 days): UNIDIRECTIONAL       - std=0.0013, corr=+0.210, dir_acc=0.610
[WEAK] 2024-03-20 to 2024-05-16 (  41 days): WEAK_COLLAPSE        - std=0.0012, corr=+0.178, dir_acc=0.530
[WEAK] 2024-05-20 to 2024-07-23 (  44 days): WEAK_COLLAPSE        - std=0.0048, corr=+0.011, dir_acc=0.577
[UNI ] 2024-07-24 to 2024-08-16 (  18 days): UNIDIRECTIONAL       - std=0.0043, corr=-0.080, dir_acc=0.615
[UNI ] 2024-08-22 to 2025-01-21 ( 101 days): UNIDIRECTIONAL       - std=0.0031, corr=+0.014, dir_acc=0.576
[UNI ] 2025-01-27 to 2025-02-21 (  19 days): UNIDIRECTIONAL       - std=0.0016, corr=+0.155, dir_acc=0.576
[WEAK] 2025-02-24 to 2025-03-17 (  16 days): WEAK_COLLAPSE        - std=0.0021, corr=+0.111, dir_acc=0.498
[UNI ] 2025-03-25 to 2025-08-11 (  96 days): UNIDIRECTIONAL       - std=0.0068, corr=-0.155, dir_acc=0.572
[WEAK] 2025-08-12 to 2025-10-06 (  39 days): WEAK_COLLAPSE        - std=0.0027, corr=-0.109, dir_acc=0.565
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    422 days ( 33.0%)
  WEAK_COLLAPSE:     801 days ( 62.6%)
  STRONG_COLLAPSE:    27 days (  2.1%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.176815
  RMSE:             1.084811
  MAE:              0.772021
  Out-of-sample RÂ²: -0.0000

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5478

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:03:30
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr3
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr3/checkpoints/tft-epoch=04-val_loss=0.1437.ckpt
  Validation loss: 0.143721

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr3/evaluation/evaluation_20251027_120332.log
Evaluation started at: 2025-10-27 12:03:32
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.037222
    Max: 0.101782
    Mean: 0.076262
    Std: 0.012071
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0372, max: 0.1018, mean: 0.0763
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   96 days (  7.5%)
2. Range-based                 [WARN]  829 days ( 64.8%)
3. Consecutive-similarity      [WARN]  742 days ( 58.0%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    661 days ( 51.6%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 314 days ( 24.5%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0028, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-01-27 (  79 days): WEAK_COLLAPSE        - std=0.0046, corr=-0.067, dir_acc=0.554
[UNI ] 2021-01-28 to 2021-02-11 (  11 days): UNIDIRECTIONAL       - std=0.0029, corr=-0.060, dir_acc=0.574
[WEAK] 2021-02-12 to 2021-05-17 (  65 days): WEAK_COLLAPSE        - std=0.0026, corr=+0.101, dir_acc=0.545
[FAIL] 2021-05-18 to 2021-06-29 (  30 days): STRONG_COLLAPSE      - std=0.0013, corr=+0.145, dir_acc=0.538
[WEAK] 2021-06-30 to 2022-03-03 ( 169 days): WEAK_COLLAPSE        - std=0.0059, corr=+0.149, dir_acc=0.564
[UNI ] 2022-03-04 to 2022-07-25 (  98 days): UNIDIRECTIONAL       - std=0.0061, corr=-0.154, dir_acc=0.450
[WEAK] 2022-07-26 to 2022-10-12 (  55 days): WEAK_COLLAPSE        - std=0.0046, corr=-0.111, dir_acc=0.457
[UNI ] 2022-10-13 to 2023-02-13 (  83 days): UNIDIRECTIONAL       - std=0.0109, corr=-0.133, dir_acc=0.412
[WEAK] 2023-02-14 to 2023-03-07 (  15 days): WEAK_COLLAPSE        - std=0.0011, corr=+0.153, dir_acc=0.449
[FAIL] 2023-03-08 to 2023-04-20 (  31 days): STRONG_COLLAPSE      - std=0.0023, corr=+0.111, dir_acc=0.505
[WEAK] 2023-04-21 to 2023-05-24 (  24 days): WEAK_COLLAPSE        - std=0.0027, corr=+0.031, dir_acc=0.510
[WEAK] 2023-05-31 to 2023-06-22 (  16 days): WEAK_COLLAPSE        - std=0.0032, corr=-0.003, dir_acc=0.556
[UNI ] 2023-06-23 to 2023-07-17 (  16 days): UNIDIRECTIONAL       - std=0.0016, corr=+0.024, dir_acc=0.534
[UNI ] 2023-07-24 to 2023-09-18 (  40 days): UNIDIRECTIONAL       - std=0.0025, corr=-0.072, dir_acc=0.545
[UNI ] 2023-09-22 to 2023-10-18 (  18 days): UNIDIRECTIONAL       - std=0.0026, corr=-0.169, dir_acc=0.489
[UNI ] 2023-10-23 to 2024-02-20 (  82 days): UNIDIRECTIONAL       - std=0.0030, corr=-0.040, dir_acc=0.578
[UNI ] 2024-02-22 to 2024-03-20 (  20 days): UNIDIRECTIONAL       - std=0.0025, corr=+0.254, dir_acc=0.609
[WEAK] 2024-03-22 to 2024-04-11 (  14 days): WEAK_COLLAPSE        - std=0.0012, corr=+0.234, dir_acc=0.558
[FAIL] 2024-04-12 to 2024-05-20 (  27 days): STRONG_COLLAPSE      - std=0.0024, corr=+0.226, dir_acc=0.511
[WEAK] 2024-05-21 to 2024-06-20 (  21 days): WEAK_COLLAPSE        - std=0.0028, corr=-0.008, dir_acc=0.538
[UNI ] 2024-06-21 to 2025-01-22 ( 145 days): UNIDIRECTIONAL       - std=0.0064, corr=-0.027, dir_acc=0.588
[UNI ] 2025-01-24 to 2025-02-21 (  20 days): UNIDIRECTIONAL       - std=0.0026, corr=+0.107, dir_acc=0.577
[UNI ] 2025-03-11 to 2025-08-15 ( 110 days): UNIDIRECTIONAL       - std=0.0113, corr=-0.154, dir_acc=0.565
[UNI ] 2025-08-22 to 2025-09-17 (  18 days): UNIDIRECTIONAL       - std=0.0019, corr=-0.059, dir_acc=0.560
[WEAK] 2025-09-18 to 2025-10-06 (  13 days): WEAK_COLLAPSE        - std=0.0042, corr=-0.213, dir_acc=0.571
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    665 days ( 52.0%)
  WEAK_COLLAPSE:     494 days ( 38.6%)
  STRONG_COLLAPSE:    91 days (  7.1%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.177288
  RMSE:             1.085029
  MAE:              0.771862
  Out-of-sample RÂ²: -0.0004

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5409

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:03:33
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr5
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr5/checkpoints/tft-epoch=03-val_loss=0.1435.ckpt
  Validation loss: 0.143479

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr5/evaluation/evaluation_20251027_120334.log
Evaluation started at: 2025-10-27 12:03:34
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.054771
    Max: 0.097794
    Mean: 0.081259
    Std: 0.007787
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0548, max: 0.0978, mean: 0.0813
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   11 days (  0.9%)
2. Range-based                 [WARN] 1044 days ( 81.6%)
3. Consecutive-similarity      [WARN]  891 days ( 69.6%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    569 days ( 44.5%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 277 days ( 21.6%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0019, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-05-27 ( 163 days): WEAK_COLLAPSE        - std=0.0028, corr=+0.063, dir_acc=0.550
[FAIL] 2021-05-28 to 2021-06-11 (  10 days): STRONG_COLLAPSE      - std=0.0008, corr=+0.179, dir_acc=0.543
[WEAK] 2021-06-14 to 2022-03-11 ( 187 days): WEAK_COLLAPSE        - std=0.0043, corr=+0.189, dir_acc=0.558
[UNI ] 2022-03-14 to 2022-04-27 (  32 days): UNIDIRECTIONAL       - std=0.0051, corr=-0.103, dir_acc=0.440
[WEAK] 2022-04-28 to 2022-10-21 ( 122 days): WEAK_COLLAPSE        - std=0.0045, corr=-0.130, dir_acc=0.456
[UNI ] 2022-10-24 to 2022-11-29 (  25 days): UNIDIRECTIONAL       - std=0.0045, corr=-0.206, dir_acc=0.405
[WEAK] 2022-11-30 to 2022-12-20 (  15 days): WEAK_COLLAPSE        - std=0.0012, corr=-0.173, dir_acc=0.383
[UNI ] 2022-12-21 to 2023-01-26 (  24 days): UNIDIRECTIONAL       - std=0.0012, corr=-0.092, dir_acc=0.419
[WEAK] 2023-01-27 to 2023-07-21 ( 121 days): WEAK_COLLAPSE        - std=0.0030, corr=+0.122, dir_acc=0.507
[UNI ] 2023-07-24 to 2023-08-16 (  18 days): UNIDIRECTIONAL       - std=0.0020, corr=-0.029, dir_acc=0.572
[WEAK] 2023-08-17 to 2023-09-25 (  27 days): WEAK_COLLAPSE        - std=0.0027, corr=-0.091, dir_acc=0.520
[UNI ] 2023-09-26 to 2023-10-17 (  15 days): UNIDIRECTIONAL       - std=0.0009, corr=-0.137, dir_acc=0.490
[WEAK] 2023-10-18 to 2023-11-17 (  23 days): WEAK_COLLAPSE        - std=0.0018, corr=-0.070, dir_acc=0.474
[UNI ] 2023-11-20 to 2024-02-20 (  62 days): UNIDIRECTIONAL       - std=0.0027, corr=+0.017, dir_acc=0.610
[UNI ] 2024-02-23 to 2024-03-19 (  18 days): UNIDIRECTIONAL       - std=0.0013, corr=+0.229, dir_acc=0.610
[WEAK] 2024-03-20 to 2024-05-16 (  41 days): WEAK_COLLAPSE        - std=0.0012, corr=+0.206, dir_acc=0.530
[WEAK] 2024-05-20 to 2024-07-22 (  43 days): WEAK_COLLAPSE        - std=0.0055, corr=+0.008, dir_acc=0.575
[UNI ] 2024-07-23 to 2024-08-16 (  19 days): UNIDIRECTIONAL       - std=0.0042, corr=-0.087, dir_acc=0.617
[UNI ] 2024-08-20 to 2025-01-21 ( 103 days): UNIDIRECTIONAL       - std=0.0031, corr=+0.005, dir_acc=0.577
[UNI ] 2025-01-27 to 2025-02-21 (  19 days): UNIDIRECTIONAL       - std=0.0016, corr=+0.147, dir_acc=0.576
[WEAK] 2025-02-24 to 2025-03-17 (  16 days): WEAK_COLLAPSE        - std=0.0021, corr=+0.098, dir_acc=0.498
[UNI ] 2025-03-25 to 2025-08-12 (  97 days): UNIDIRECTIONAL       - std=0.0070, corr=-0.165, dir_acc=0.572
[WEAK] 2025-08-13 to 2025-09-04 (  16 days): WEAK_COLLAPSE        - std=0.0022, corr=-0.017, dir_acc=0.560
[UNI ] 2025-09-05 to 2025-09-16 (   8 days): UNIDIRECTIONAL       - std=0.0011, corr=-0.081, dir_acc=0.562
[WEAK] 2025-09-17 to 2025-10-06 (  14 days): WEAK_COLLAPSE        - std=0.0034, corr=-0.221, dir_acc=0.570
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    442 days ( 34.5%)
  WEAK_COLLAPSE:     797 days ( 62.3%)
  STRONG_COLLAPSE:    11 days (  0.9%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.177300
  RMSE:             1.085035
  MAE:              0.771958
  Out-of-sample RÂ²: -0.0005

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5475

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:03:36
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr3
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr3/checkpoints/tft-epoch=05-val_loss=0.1541.ckpt
  Validation loss: 0.154143

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr3/evaluation/evaluation_20251027_120337.log
Evaluation started at: 2025-10-27 12:03:37
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.205059
    Max: 0.293864
    Mean: 0.228891
    Std: 0.012394
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.2051, max: 0.2939, mean: 0.2289
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   85 days (  6.6%)
2. Range-based                 [WARN]  980 days ( 76.6%)
3. Consecutive-similarity      [WARN]  955 days ( 74.6%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    200 days ( 15.6%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 102 days (  8.0%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0045, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2021-04-29 ( 143 days): UNIDIRECTIONAL       - std=0.0073, corr=+0.175, dir_acc=0.554
[WEAK] 2021-04-30 to 2021-09-09 (  92 days): WEAK_COLLAPSE        - std=0.0026, corr=+0.135, dir_acc=0.562
[FAIL] 2021-09-10 to 2021-09-20 (   7 days): STRONG_COLLAPSE      - std=0.0006, corr=+0.078, dir_acc=0.605
[WEAK] 2021-09-21 to 2021-10-04 (  10 days): WEAK_COLLAPSE        - std=0.0014, corr=+0.108, dir_acc=0.552
[FAIL] 2021-10-05 to 2021-11-24 (  35 days): STRONG_COLLAPSE      - std=0.0015, corr=+0.116, dir_acc=0.590
[WEAK] 2021-11-26 to 2022-01-24 (  40 days): WEAK_COLLAPSE        - std=0.0023, corr=+0.026, dir_acc=0.583
[UNI ] 2022-01-25 to 2022-02-03 (   8 days): UNIDIRECTIONAL       - std=0.0024, corr=+0.045, dir_acc=0.471
[WEAK] 2022-02-04 to 2022-02-11 (   6 days): WEAK_COLLAPSE        - std=0.0007, corr=+0.162, dir_acc=0.458
[UNI ] 2022-02-14 to 2022-02-25 (   9 days): UNIDIRECTIONAL       - std=0.0028, corr=+0.129, dir_acc=0.448
[WEAK] 2022-02-28 to 2022-03-08 (   7 days): WEAK_COLLAPSE        - std=0.0004, corr=+0.062, dir_acc=0.426
[UNI ] 2022-03-09 to 2022-04-11 (  24 days): UNIDIRECTIONAL       - std=0.0024, corr=+0.177, dir_acc=0.429
[WEAK] 2022-04-12 to 2024-02-16 ( 462 days): WEAK_COLLAPSE        - std=0.0069, corr=+0.114, dir_acc=0.493
[FAIL] 2024-02-20 to 2024-04-19 (  43 days): STRONG_COLLAPSE      - std=0.0016, corr=-0.052, dir_acc=0.581
[WEAK] 2024-04-22 to 2024-07-19 (  62 days): WEAK_COLLAPSE        - std=0.0062, corr=+0.047, dir_acc=0.552
[UNI ] 2024-07-22 to 2024-11-04 (  74 days): UNIDIRECTIONAL       - std=0.0058, corr=+0.214, dir_acc=0.595
[WEAK] 2024-11-05 to 2025-03-10 (  83 days): WEAK_COLLAPSE        - std=0.0026, corr=+0.131, dir_acc=0.561
[UNI ] 2025-03-11 to 2025-03-21 (   9 days): UNIDIRECTIONAL       - std=0.0039, corr=+0.114, dir_acc=0.500
[WEAK] 2025-03-24 to 2025-04-03 (   9 days): WEAK_COLLAPSE        - std=0.0008, corr=+0.087, dir_acc=0.528
[UNI ] 2025-04-04 to 2025-08-05 (  84 days): UNIDIRECTIONAL       - std=0.0203, corr=+0.122, dir_acc=0.576
[WEAK] 2025-08-06 to 2025-10-06 (  43 days): WEAK_COLLAPSE        - std=0.0038, corr=+0.027, dir_acc=0.566
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    351 days ( 27.4%)
  WEAK_COLLAPSE:     814 days ( 63.6%)
  STRONG_COLLAPSE:    85 days (  6.6%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.205917
  RMSE:             1.098143
  MAE:              0.785020
  Out-of-sample RÂ²: -0.0248

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4750

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:03:38
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr5
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr5/checkpoints/tft-epoch=03-val_loss=0.1530.ckpt
  Validation loss: 0.152988

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr5/evaluation/evaluation_20251027_120340.log
Evaluation started at: 2025-10-27 12:03:40
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.227937
    Max: 0.313118
    Mean: 0.252988
    Std: 0.012972
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.2279, max: 0.3131, mean: 0.2530
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   28 days (  2.2%)
2. Range-based                 [WARN]  973 days ( 76.0%)
3. Consecutive-similarity      [WARN]  984 days ( 76.9%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    222 days ( 17.3%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 123 days (  9.6%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0041, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-15 to 2020-10-26 (   8 days): WEAK_COLLAPSE        - std=0.0017, corr=-0.039, dir_acc=0.578
[UNI ] 2020-10-27 to 2021-02-12 (  74 days): UNIDIRECTIONAL       - std=0.0079, corr=+0.198, dir_acc=0.548
[WEAK] 2021-02-16 to 2021-02-23 (   6 days): WEAK_COLLAPSE        - std=0.0012, corr=+0.245, dir_acc=0.567
[UNI ] 2021-02-24 to 2021-04-23 (  42 days): UNIDIRECTIONAL       - std=0.0025, corr=+0.216, dir_acc=0.549
[WEAK] 2021-04-26 to 2021-10-13 ( 119 days): WEAK_COLLAPSE        - std=0.0034, corr=+0.093, dir_acc=0.562
[FAIL] 2021-10-14 to 2021-11-23 (  28 days): STRONG_COLLAPSE      - std=0.0012, corr=+0.116, dir_acc=0.599
[WEAK] 2021-11-24 to 2022-03-08 (  71 days): WEAK_COLLAPSE        - std=0.0061, corr=+0.034, dir_acc=0.527
[UNI ] 2022-03-09 to 2022-04-08 (  23 days): UNIDIRECTIONAL       - std=0.0017, corr=+0.151, dir_acc=0.428
[WEAK] 2022-04-11 to 2023-10-20 ( 382 days): WEAK_COLLAPSE        - std=0.0070, corr=+0.122, dir_acc=0.475
[WEAK] 2023-10-27 to 2023-12-21 (  39 days): WEAK_COLLAPSE        - std=0.0044, corr=+0.017, dir_acc=0.535
[UNI ] 2023-12-22 to 2024-01-18 (  17 days): UNIDIRECTIONAL       - std=0.0011, corr=-0.025, dir_acc=0.616
[WEAK] 2024-01-19 to 2024-07-03 ( 115 days): WEAK_COLLAPSE        - std=0.0036, corr=+0.042, dir_acc=0.572
[UNI ] 2024-07-05 to 2024-11-04 (  85 days): UNIDIRECTIONAL       - std=0.0068, corr=+0.190, dir_acc=0.602
[WEAK] 2024-11-05 to 2025-03-11 (  84 days): WEAK_COLLAPSE        - std=0.0029, corr=+0.121, dir_acc=0.561
[UNI ] 2025-03-12 to 2025-03-19 (   6 days): UNIDIRECTIONAL       - std=0.0024, corr=+0.146, dir_acc=0.497
[WEAK] 2025-03-20 to 2025-04-03 (  11 days): WEAK_COLLAPSE        - std=0.0010, corr=+0.129, dir_acc=0.526
[UNI ] 2025-04-04 to 2025-08-06 (  85 days): UNIDIRECTIONAL       - std=0.0190, corr=+0.125, dir_acc=0.576
[WEAK] 2025-08-07 to 2025-10-06 (  42 days): WEAK_COLLAPSE        - std=0.0049, corr=+0.002, dir_acc=0.565
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    344 days ( 26.9%)
  WEAK_COLLAPSE:     878 days ( 68.6%)
  STRONG_COLLAPSE:    28 days (  2.2%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.214957
  RMSE:             1.102251
  MAE:              0.789087
  Out-of-sample RÂ²: -0.0325

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4728

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:03:41
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr3
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr3/checkpoints/tft-epoch=05-val_loss=0.1576.ckpt
  Validation loss: 0.157562

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr3/evaluation/evaluation_20251027_120342.log
Evaluation started at: 2025-10-27 12:03:42
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.221860
    Max: 0.313233
    Mean: 0.246619
    Std: 0.013057
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.2219, max: 0.3132, mean: 0.2466
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]  101 days (  7.9%)
2. Range-based                 [WARN] 1007 days ( 78.7%)
3. Consecutive-similarity      [WARN]  962 days ( 75.2%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    220 days ( 17.2%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 104 days (  8.1%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0044, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2021-04-29 ( 143 days): UNIDIRECTIONAL       - std=0.0070, corr=+0.177, dir_acc=0.554
[WEAK] 2021-04-30 to 2021-09-09 (  92 days): WEAK_COLLAPSE        - std=0.0026, corr=+0.118, dir_acc=0.562
[FAIL] 2021-09-10 to 2021-09-20 (   7 days): STRONG_COLLAPSE      - std=0.0006, corr=+0.054, dir_acc=0.605
[WEAK] 2021-09-21 to 2021-09-29 (   7 days): WEAK_COLLAPSE        - std=0.0014, corr=+0.083, dir_acc=0.557
[FAIL] 2021-09-30 to 2021-11-24 (  38 days): STRONG_COLLAPSE      - std=0.0015, corr=+0.116, dir_acc=0.586
[WEAK] 2021-11-26 to 2022-01-26 (  42 days): WEAK_COLLAPSE        - std=0.0028, corr=+0.016, dir_acc=0.579
[WEAK] 2022-02-03 to 2022-02-14 (   8 days): WEAK_COLLAPSE        - std=0.0017, corr=+0.156, dir_acc=0.456
[UNI ] 2022-02-15 to 2022-02-23 (   6 days): UNIDIRECTIONAL       - std=0.0019, corr=+0.136, dir_acc=0.450
[WEAK] 2022-02-24 to 2022-03-08 (   9 days): WEAK_COLLAPSE        - std=0.0004, corr=+0.068, dir_acc=0.430
[UNI ] 2022-03-09 to 2022-04-11 (  24 days): UNIDIRECTIONAL       - std=0.0022, corr=+0.177, dir_acc=0.429
[WEAK] 2022-04-12 to 2024-02-16 ( 462 days): WEAK_COLLAPSE        - std=0.0074, corr=+0.117, dir_acc=0.493
[FAIL] 2024-02-20 to 2024-04-22 (  44 days): STRONG_COLLAPSE      - std=0.0016, corr=-0.072, dir_acc=0.578
[WEAK] 2024-04-23 to 2024-06-11 (  35 days): WEAK_COLLAPSE        - std=0.0018, corr=+0.021, dir_acc=0.517
[FAIL] 2024-06-12 to 2024-06-21 (   7 days): STRONG_COLLAPSE      - std=0.0007, corr=+0.184, dir_acc=0.562
[WEAK] 2024-06-24 to 2024-08-05 (  30 days): WEAK_COLLAPSE        - std=0.0037, corr=+0.108, dir_acc=0.620
[UNI ] 2024-08-06 to 2024-11-04 (  63 days): UNIDIRECTIONAL       - std=0.0061, corr=+0.216, dir_acc=0.589
[WEAK] 2024-11-05 to 2024-12-18 (  30 days): WEAK_COLLAPSE        - std=0.0020, corr=+0.066, dir_acc=0.581
[WEAK] 2024-12-26 to 2025-03-11 (  50 days): WEAK_COLLAPSE        - std=0.0023, corr=+0.158, dir_acc=0.549
[UNI ] 2025-03-12 to 2025-03-19 (   6 days): UNIDIRECTIONAL       - std=0.0037, corr=+0.102, dir_acc=0.497
[WEAK] 2025-03-20 to 2025-04-03 (  11 days): WEAK_COLLAPSE        - std=0.0008, corr=+0.083, dir_acc=0.526
[UNI ] 2025-04-04 to 2025-08-05 (  84 days): UNIDIRECTIONAL       - std=0.0212, corr=+0.125, dir_acc=0.576
[WEAK] 2025-08-06 to 2025-09-16 (  29 days): WEAK_COLLAPSE        - std=0.0019, corr=-0.016, dir_acc=0.564
[WEAK] 2025-09-24 to 2025-10-06 (   9 days): WEAK_COLLAPSE        - std=0.0018, corr=+0.031, dir_acc=0.569
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    335 days ( 26.2%)
  WEAK_COLLAPSE:     814 days ( 63.6%)
  STRONG_COLLAPSE:   101 days (  7.9%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.212376
  RMSE:             1.101080
  MAE:              0.787900
  Out-of-sample RÂ²: -0.0303

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4745

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:03:44
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr5
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr5/checkpoints/tft-epoch=03-val_loss=0.1603.ckpt
  Validation loss: 0.160338

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr5/evaluation/evaluation_20251027_120345.log
Evaluation started at: 2025-10-27 12:03:45
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.261072
    Max: 0.349449
    Mean: 0.288051
    Std: 0.014342
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.2611, max: 0.3494, mean: 0.2881
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   26 days (  2.0%)
2. Range-based                 [WARN]  922 days ( 72.0%)
3. Consecutive-similarity      [WARN]  975 days ( 76.2%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    235 days ( 18.4%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 119 days (  9.3%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0041, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-02 to 2020-10-09 (   6 days): WEAK_COLLAPSE        - std=0.0010, corr=-0.080, dir_acc=0.603
[WEAK] 2020-10-14 to 2020-10-27 (  10 days): WEAK_COLLAPSE        - std=0.0022, corr=-0.047, dir_acc=0.577
[UNI ] 2020-10-28 to 2021-02-11 (  72 days): UNIDIRECTIONAL       - std=0.0077, corr=+0.205, dir_acc=0.548
[WEAK] 2021-02-12 to 2021-02-25 (   9 days): WEAK_COLLAPSE        - std=0.0011, corr=+0.249, dir_acc=0.567
[UNI ] 2021-02-26 to 2021-04-23 (  40 days): UNIDIRECTIONAL       - std=0.0024, corr=+0.224, dir_acc=0.549
[WEAK] 2021-04-26 to 2021-10-15 ( 121 days): WEAK_COLLAPSE        - std=0.0037, corr=+0.067, dir_acc=0.562
[FAIL] 2021-10-18 to 2021-11-23 (  26 days): STRONG_COLLAPSE      - std=0.0012, corr=+0.132, dir_acc=0.601
[WEAK] 2021-11-24 to 2022-02-15 (  57 days): WEAK_COLLAPSE        - std=0.0035, corr=+0.023, dir_acc=0.550
[WEAK] 2022-02-25 to 2022-03-08 (   8 days): WEAK_COLLAPSE        - std=0.0005, corr=+0.005, dir_acc=0.429
[UNI ] 2022-03-09 to 2022-04-12 (  25 days): UNIDIRECTIONAL       - std=0.0014, corr=+0.148, dir_acc=0.429
[WEAK] 2022-04-13 to 2023-10-20 ( 380 days): WEAK_COLLAPSE        - std=0.0082, corr=+0.121, dir_acc=0.475
[UNI ] 2023-10-23 to 2024-01-19 (  61 days): UNIDIRECTIONAL       - std=0.0066, corr=+0.021, dir_acc=0.552
[WEAK] 2024-01-22 to 2024-06-28 ( 111 days): WEAK_COLLAPSE        - std=0.0036, corr=+0.043, dir_acc=0.571
[UNI ] 2024-07-01 to 2024-11-04 (  88 days): UNIDIRECTIONAL       - std=0.0078, corr=+0.185, dir_acc=0.601
[WEAK] 2024-11-05 to 2025-03-11 (  84 days): WEAK_COLLAPSE        - std=0.0031, corr=+0.117, dir_acc=0.561
[UNI ] 2025-03-12 to 2025-03-19 (   6 days): UNIDIRECTIONAL       - std=0.0019, corr=+0.154, dir_acc=0.497
[WEAK] 2025-03-20 to 2025-04-03 (  11 days): WEAK_COLLAPSE        - std=0.0011, corr=+0.138, dir_acc=0.526
[UNI ] 2025-04-04 to 2025-08-07 (  86 days): UNIDIRECTIONAL       - std=0.0198, corr=+0.128, dir_acc=0.576
[WEAK] 2025-08-08 to 2025-10-03 (  40 days): WEAK_COLLAPSE        - std=0.0055, corr=-0.007, dir_acc=0.564
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    385 days ( 30.1%)
  WEAK_COLLAPSE:     839 days ( 65.5%)
  STRONG_COLLAPSE:    26 days (  2.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.230036
  RMSE:             1.109070
  MAE:              0.795923
  Out-of-sample RÂ²: -0.0453

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4713

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:03:46
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr3
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr3/checkpoints/tft-epoch=05-val_loss=0.1607.ckpt
  Validation loss: 0.160732

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr3/evaluation/evaluation_20251027_120348.log
Evaluation started at: 2025-10-27 12:03:48
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.234190
    Max: 0.319956
    Mean: 0.259631
    Std: 0.012917
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.2342, max: 0.3200, mean: 0.2596
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   56 days (  4.4%)
2. Range-based                 [WARN] 1040 days ( 81.2%)
3. Consecutive-similarity      [WARN] 1006 days ( 78.6%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    231 days ( 18.0%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 112 days (  8.8%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0038, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-02 to 2020-10-27 (  17 days): WEAK_COLLAPSE        - std=0.0020, corr=-0.050, dir_acc=0.588
[UNI ] 2020-10-28 to 2021-02-10 (  71 days): UNIDIRECTIONAL       - std=0.0075, corr=+0.206, dir_acc=0.547
[WEAK] 2021-02-11 to 2021-02-25 (  10 days): WEAK_COLLAPSE        - std=0.0011, corr=+0.240, dir_acc=0.568
[UNI ] 2021-02-26 to 2021-04-23 (  40 days): UNIDIRECTIONAL       - std=0.0024, corr=+0.214, dir_acc=0.549
[WEAK] 2021-04-26 to 2021-10-05 ( 114 days): WEAK_COLLAPSE        - std=0.0033, corr=+0.077, dir_acc=0.562
[FAIL] 2021-10-06 to 2021-11-23 (  33 days): STRONG_COLLAPSE      - std=0.0012, corr=+0.078, dir_acc=0.592
[WEAK] 2021-11-24 to 2024-03-07 ( 570 days): WEAK_COLLAPSE        - std=0.0072, corr=+0.109, dir_acc=0.497
[FAIL] 2024-03-08 to 2024-04-10 (  23 days): STRONG_COLLAPSE      - std=0.0008, corr=-0.038, dir_acc=0.570
[WEAK] 2024-04-11 to 2024-08-05 (  80 days): WEAK_COLLAPSE        - std=0.0062, corr=+0.036, dir_acc=0.560
[UNI ] 2024-08-06 to 2024-11-04 (  63 days): UNIDIRECTIONAL       - std=0.0053, corr=+0.224, dir_acc=0.589
[WEAK] 2024-11-05 to 2025-03-17 (  88 days): WEAK_COLLAPSE        - std=0.0033, corr=+0.108, dir_acc=0.557
[WEAK] 2025-03-20 to 2025-04-04 (  12 days): WEAK_COLLAPSE        - std=0.0024, corr=+0.092, dir_acc=0.526
[UNI ] 2025-04-07 to 2025-08-05 (  83 days): UNIDIRECTIONAL       - std=0.0191, corr=+0.133, dir_acc=0.576
[WEAK] 2025-08-06 to 2025-10-06 (  43 days): WEAK_COLLAPSE        - std=0.0041, corr=-0.003, dir_acc=0.566
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    260 days ( 20.3%)
  WEAK_COLLAPSE:     934 days ( 73.0%)
  STRONG_COLLAPSE:    56 days (  4.4%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.217601
  RMSE:             1.103449
  MAE:              0.790316
  Out-of-sample RÂ²: -0.0347

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4738

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:03:49
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr5
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr5/checkpoints/tft-epoch=04-val_loss=0.1603.ckpt
  Validation loss: 0.160339

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr5/evaluation/evaluation_20251027_120351.log
Evaluation started at: 2025-10-27 12:03:51
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.154588
    Max: 0.259001
    Mean: 0.177510
    Std: 0.014580
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1546, max: 0.2590, mean: 0.1775
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  239 days ( 18.7%)
2. Range-based                 [WARN]  783 days ( 61.2%)
3. Consecutive-similarity      [WARN]  804 days ( 62.8%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    197 days ( 15.4%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                  70 days (  5.5%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0053, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2021-05-03 ( 145 days): UNIDIRECTIONAL       - std=0.0089, corr=+0.181, dir_acc=0.554
[WEAK] 2021-05-04 to 2021-05-12 (   7 days): WEAK_COLLAPSE        - std=0.0009, corr=+0.101, dir_acc=0.510
[UNI ] 2021-05-13 to 2021-05-25 (   9 days): UNIDIRECTIONAL       - std=0.0023, corr=+0.131, dir_acc=0.524
[WEAK] 2021-05-26 to 2021-07-21 (  39 days): WEAK_COLLAPSE        - std=0.0013, corr=+0.109, dir_acc=0.549
[FAIL] 2021-07-22 to 2021-11-26 (  88 days): STRONG_COLLAPSE      - std=0.0020, corr=+0.161, dir_acc=0.590
[WEAK] 2021-12-28 to 2022-01-19 (  16 days): WEAK_COLLAPSE        - std=0.0015, corr=+0.057, dir_acc=0.581
[UNI ] 2022-01-20 to 2022-05-11 (  78 days): UNIDIRECTIONAL       - std=0.0052, corr=+0.183, dir_acc=0.446
[WEAK] 2022-05-12 to 2022-05-20 (   7 days): WEAK_COLLAPSE        - std=0.0011, corr=+0.257, dir_acc=0.443
[UNI ] 2022-05-23 to 2022-07-20 (  40 days): UNIDIRECTIONAL       - std=0.0032, corr=+0.296, dir_acc=0.465
[WEAK] 2022-07-21 to 2022-10-21 (  65 days): WEAK_COLLAPSE        - std=0.0051, corr=+0.116, dir_acc=0.453
[UNI ] 2022-10-24 to 2022-11-16 (  17 days): UNIDIRECTIONAL       - std=0.0044, corr=+0.186, dir_acc=0.402
[WEAK] 2022-11-17 to 2022-12-01 (  10 days): WEAK_COLLAPSE        - std=0.0008, corr=+0.171, dir_acc=0.412
[UNI ] 2022-12-02 to 2023-01-26 (  37 days): UNIDIRECTIONAL       - std=0.0025, corr=+0.161, dir_acc=0.405
[WEAK] 2023-01-27 to 2023-04-21 (  59 days): WEAK_COLLAPSE        - std=0.0044, corr=+0.109, dir_acc=0.480
[UNI ] 2023-04-24 to 2023-06-20 (  40 days): UNIDIRECTIONAL       - std=0.0022, corr=+0.139, dir_acc=0.528
[WEAK] 2023-06-21 to 2023-08-29 (  49 days): WEAK_COLLAPSE        - std=0.0013, corr=+0.083, dir_acc=0.551
[FAIL] 2023-08-30 to 2023-10-04 (  25 days): STRONG_COLLAPSE      - std=0.0016, corr=-0.012, dir_acc=0.509
[WEAK] 2023-10-05 to 2023-12-21 (  54 days): WEAK_COLLAPSE        - std=0.0045, corr=+0.046, dir_acc=0.514
[UNI ] 2023-12-22 to 2024-01-18 (  17 days): UNIDIRECTIONAL       - std=0.0006, corr=-0.061, dir_acc=0.616
[WEAK] 2024-01-19 to 2024-02-12 (  17 days): WEAK_COLLAPSE        - std=0.0006, corr=+0.137, dir_acc=0.660
[FAIL] 2024-02-13 to 2024-07-01 (  96 days): STRONG_COLLAPSE      - std=0.0021, corr=-0.047, dir_acc=0.556
[WEAK] 2024-07-02 to 2024-08-05 (  24 days): WEAK_COLLAPSE        - std=0.0032, corr=+0.101, dir_acc=0.633
[UNI ] 2024-08-06 to 2024-11-05 (  64 days): UNIDIRECTIONAL       - std=0.0082, corr=+0.207, dir_acc=0.589
[WEAK] 2024-11-06 to 2024-12-18 (  29 days): WEAK_COLLAPSE        - std=0.0019, corr=+0.105, dir_acc=0.581
[UNI ] 2024-12-19 to 2025-01-06 (  11 days): UNIDIRECTIONAL       - std=0.0054, corr=+0.217, dir_acc=0.550
[WEAK] 2025-01-07 to 2025-03-10 (  42 days): WEAK_COLLAPSE        - std=0.0028, corr=+0.197, dir_acc=0.551
[UNI ] 2025-03-11 to 2025-08-06 ( 103 days): UNIDIRECTIONAL       - std=0.0259, corr=+0.117, dir_acc=0.565
[WEAK] 2025-08-07 to 2025-08-19 (   9 days): WEAK_COLLAPSE        - std=0.0004, corr=-0.014, dir_acc=0.570
[FAIL] 2025-08-20 to 2025-10-01 (  30 days): STRONG_COLLAPSE      - std=0.0021, corr=+0.006, dir_acc=0.562
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    568 days ( 44.4%)
  WEAK_COLLAPSE:     443 days ( 34.6%)
  STRONG_COLLAPSE:   239 days ( 18.7%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.190733
  RMSE:             1.091207
  MAE:              0.777959
  Out-of-sample RÂ²: -0.0119

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4700

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:03:52
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr3
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr3/checkpoints/tft-epoch=05-val_loss=0.1624.ckpt
  Validation loss: 0.162382

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr3/evaluation/evaluation_20251027_120353.log
Evaluation started at: 2025-10-27 12:03:53
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.246444
    Max: 0.329035
    Mean: 0.273959
    Std: 0.013361
    Unique values: 1277

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.2464, max: 0.3290, mean: 0.2740
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   25 days (  2.0%)
2. Range-based                 [WARN] 1016 days ( 79.4%)
3. Consecutive-similarity      [WARN] 1071 days ( 83.7%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    278 days ( 21.7%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 126 days (  9.8%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0032, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2020-10-28 (  19 days): WEAK_COLLAPSE        - std=0.0022, corr=-0.047, dir_acc=0.588
[UNI ] 2020-10-29 to 2021-02-04 (  66 days): UNIDIRECTIONAL       - std=0.0064, corr=+0.211, dir_acc=0.545
[WEAK] 2021-02-05 to 2021-03-10 (  23 days): WEAK_COLLAPSE        - std=0.0016, corr=+0.243, dir_acc=0.558
[WEAK] 2021-03-16 to 2021-10-15 ( 149 days): WEAK_COLLAPSE        - std=0.0046, corr=+0.055, dir_acc=0.560
[FAIL] 2021-10-18 to 2021-11-22 (  25 days): STRONG_COLLAPSE      - std=0.0011, corr=+0.022, dir_acc=0.602
[WEAK] 2021-11-23 to 2022-03-23 (  83 days): WEAK_COLLAPSE        - std=0.0070, corr=+0.016, dir_acc=0.512
[UNI ] 2022-03-24 to 2022-03-31 (   6 days): UNIDIRECTIONAL       - std=0.0009, corr=+0.226, dir_acc=0.431
[WEAK] 2022-04-01 to 2024-07-10 ( 567 days): WEAK_COLLAPSE        - std=0.0064, corr=+0.098, dir_acc=0.503
[UNI ] 2024-07-11 to 2024-11-04 (  81 days): UNIDIRECTIONAL       - std=0.0056, corr=+0.205, dir_acc=0.601
[WEAK] 2024-11-05 to 2025-04-04 ( 102 days): WEAK_COLLAPSE        - std=0.0035, corr=+0.093, dir_acc=0.553
[UNI ] 2025-04-07 to 2025-08-06 (  84 days): UNIDIRECTIONAL       - std=0.0174, corr=+0.140, dir_acc=0.576
[WEAK] 2025-08-07 to 2025-10-06 (  42 days): WEAK_COLLAPSE        - std=0.0048, corr=-0.013, dir_acc=0.565
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    240 days ( 18.8%)
  WEAK_COLLAPSE:     985 days ( 77.0%)
  STRONG_COLLAPSE:    25 days (  2.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.223708
  RMSE:             1.106213
  MAE:              0.793116
  Out-of-sample RÂ²: -0.0399

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4743

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:03:55
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr5
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr5/checkpoints/tft-epoch=04-val_loss=0.1606.ckpt
  Validation loss: 0.160617

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr5/evaluation/evaluation_20251027_120356.log
Evaluation started at: 2025-10-27 12:03:56
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.153271
    Max: 0.250513
    Mean: 0.181241
    Std: 0.013976
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1533, max: 0.2505, mean: 0.1812
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   62 days (  4.8%)
2. Range-based                 [WARN]  956 days ( 74.7%)
3. Consecutive-similarity      [WARN]  965 days ( 75.4%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    204 days ( 15.9%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                  88 days (  6.9%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0040, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2020-10-23 (  16 days): UNIDIRECTIONAL       - std=0.0016, corr=-0.047, dir_acc=0.592
[UNI ] 2020-10-27 to 2021-02-19 (  78 days): UNIDIRECTIONAL       - std=0.0080, corr=+0.207, dir_acc=0.550
[UNI ] 2021-02-23 to 2021-04-27 (  45 days): UNIDIRECTIONAL       - std=0.0029, corr=+0.223, dir_acc=0.549
[WEAK] 2021-04-28 to 2021-09-15 (  98 days): WEAK_COLLAPSE        - std=0.0029, corr=+0.091, dir_acc=0.563
[WEAK] 2021-09-21 to 2021-10-15 (  18 days): WEAK_COLLAPSE        - std=0.0013, corr=+0.046, dir_acc=0.553
[FAIL] 2021-10-18 to 2021-10-28 (   9 days): STRONG_COLLAPSE      - std=0.0019, corr=+0.071, dir_acc=0.583
[FAIL] 2021-11-05 to 2021-11-23 (  12 days): STRONG_COLLAPSE      - std=0.0014, corr=+0.097, dir_acc=0.606
[WEAK] 2021-11-24 to 2022-01-26 (  43 days): WEAK_COLLAPSE        - std=0.0027, corr=+0.003, dir_acc=0.579
[UNI ] 2022-01-27 to 2022-02-07 (   8 days): UNIDIRECTIONAL       - std=0.0022, corr=+0.101, dir_acc=0.460
[UNI ] 2022-02-25 to 2022-04-12 (  33 days): UNIDIRECTIONAL       - std=0.0017, corr=+0.164, dir_acc=0.429
[WEAK] 2022-04-13 to 2023-10-20 ( 380 days): WEAK_COLLAPSE        - std=0.0075, corr=+0.144, dir_acc=0.475
[WEAK] 2023-10-24 to 2023-12-21 (  42 days): WEAK_COLLAPSE        - std=0.0047, corr=+0.027, dir_acc=0.527
[UNI ] 2023-12-22 to 2024-01-18 (  17 days): UNIDIRECTIONAL       - std=0.0006, corr=-0.038, dir_acc=0.616
[WEAK] 2024-01-19 to 2024-02-16 (  21 days): WEAK_COLLAPSE        - std=0.0006, corr=+0.155, dir_acc=0.654
[FAIL] 2024-02-20 to 2024-04-12 (  38 days): STRONG_COLLAPSE      - std=0.0016, corr=-0.073, dir_acc=0.589
[WEAK] 2024-04-15 to 2024-07-12 (  62 days): WEAK_COLLAPSE        - std=0.0059, corr=+0.009, dir_acc=0.539
[UNI ] 2024-07-15 to 2024-11-04 (  79 days): UNIDIRECTIONAL       - std=0.0066, corr=+0.198, dir_acc=0.600
[WEAK] 2024-11-05 to 2024-12-18 (  30 days): WEAK_COLLAPSE        - std=0.0021, corr=+0.059, dir_acc=0.581
[WEAK] 2024-12-23 to 2025-03-11 (  52 days): WEAK_COLLAPSE        - std=0.0023, corr=+0.179, dir_acc=0.549
[UNI ] 2025-03-12 to 2025-03-19 (   6 days): UNIDIRECTIONAL       - std=0.0028, corr=+0.139, dir_acc=0.497
[WEAK] 2025-03-20 to 2025-04-03 (  11 days): WEAK_COLLAPSE        - std=0.0010, corr=+0.107, dir_acc=0.526
[UNI ] 2025-04-04 to 2025-08-06 (  85 days): UNIDIRECTIONAL       - std=0.0218, corr=+0.133, dir_acc=0.576
[WEAK] 2025-08-07 to 2025-10-06 (  42 days): WEAK_COLLAPSE        - std=0.0045, corr=+0.021, dir_acc=0.565
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    375 days ( 29.3%)
  WEAK_COLLAPSE:     813 days ( 63.5%)
  STRONG_COLLAPSE:    62 days (  4.8%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.191905
  RMSE:             1.091744
  MAE:              0.778634
  Out-of-sample RÂ²: -0.0129

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4737

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:03:57
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr3
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr3/checkpoints/tft-epoch=06-val_loss=0.1620.ckpt
  Validation loss: 0.162025

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr3/evaluation/evaluation_20251027_120359.log
Evaluation started at: 2025-10-27 12:03:59
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.159282
    Max: 0.248428
    Mean: 0.187797
    Std: 0.013679
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1593, max: 0.2484, mean: 0.1878
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   59 days (  4.6%)
2. Range-based                 [WARN]  967 days ( 75.5%)
3. Consecutive-similarity      [WARN] 1016 days ( 79.4%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    265 days ( 20.7%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                  86 days (  6.7%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0033, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2020-10-28 (  19 days): WEAK_COLLAPSE        - std=0.0026, corr=-0.037, dir_acc=0.588
[UNI ] 2020-10-29 to 2021-02-09 (  69 days): UNIDIRECTIONAL       - std=0.0070, corr=+0.213, dir_acc=0.547
[WEAK] 2021-02-10 to 2021-03-01 (  13 days): WEAK_COLLAPSE        - std=0.0021, corr=+0.239, dir_acc=0.567
[UNI ] 2021-03-02 to 2021-04-23 (  38 days): UNIDIRECTIONAL       - std=0.0024, corr=+0.193, dir_acc=0.549
[WEAK] 2021-04-26 to 2021-10-18 ( 122 days): WEAK_COLLAPSE        - std=0.0034, corr=+0.054, dir_acc=0.562
[WEAK] 2021-10-22 to 2022-02-14 (  78 days): WEAK_COLLAPSE        - std=0.0057, corr=+0.015, dir_acc=0.567
[WEAK] 2022-02-16 to 2022-03-01 (   9 days): WEAK_COLLAPSE        - std=0.0029, corr=+0.124, dir_acc=0.446
[UNI ] 2022-03-02 to 2022-04-13 (  31 days): UNIDIRECTIONAL       - std=0.0016, corr=+0.175, dir_acc=0.428
[WEAK] 2022-04-14 to 2023-04-21 ( 254 days): WEAK_COLLAPSE        - std=0.0043, corr=+0.185, dir_acc=0.448
[UNI ] 2023-04-24 to 2023-06-20 (  40 days): UNIDIRECTIONAL       - std=0.0027, corr=+0.127, dir_acc=0.528
[WEAK] 2023-06-21 to 2024-02-26 ( 171 days): WEAK_COLLAPSE        - std=0.0036, corr=+0.050, dir_acc=0.554
[FAIL] 2024-02-27 to 2024-04-10 (  31 days): STRONG_COLLAPSE      - std=0.0010, corr=-0.145, dir_acc=0.585
[WEAK] 2024-04-11 to 2024-06-03 (  37 days): WEAK_COLLAPSE        - std=0.0011, corr=-0.086, dir_acc=0.514
[FAIL] 2024-06-04 to 2024-06-25 (  15 days): STRONG_COLLAPSE      - std=0.0018, corr=+0.227, dir_acc=0.553
[WEAK] 2024-06-26 to 2024-08-05 (  28 days): WEAK_COLLAPSE        - std=0.0029, corr=+0.109, dir_acc=0.625
[UNI ] 2024-08-06 to 2024-11-04 (  63 days): UNIDIRECTIONAL       - std=0.0056, corr=+0.176, dir_acc=0.589
[WEAK] 2024-11-05 to 2024-12-18 (  30 days): WEAK_COLLAPSE        - std=0.0010, corr=+0.031, dir_acc=0.581
[WEAK] 2024-12-20 to 2025-04-04 (  71 days): WEAK_COLLAPSE        - std=0.0033, corr=+0.086, dir_acc=0.541
[UNI ] 2025-04-07 to 2025-08-05 (  83 days): UNIDIRECTIONAL       - std=0.0192, corr=+0.134, dir_acc=0.576
[WEAK] 2025-08-06 to 2025-08-20 (  11 days): WEAK_COLLAPSE        - std=0.0005, corr=-0.023, dir_acc=0.573
[WEAK] 2025-08-25 to 2025-09-10 (  12 days): WEAK_COLLAPSE        - std=0.0001, corr=-0.101, dir_acc=0.554
[FAIL] 2025-09-11 to 2025-09-22 (   8 days): STRONG_COLLAPSE      - std=0.0007, corr=-0.081, dir_acc=0.575
[WEAK] 2025-09-23 to 2025-10-06 (  10 days): WEAK_COLLAPSE        - std=0.0016, corr=+0.000, dir_acc=0.568
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    326 days ( 25.5%)
  WEAK_COLLAPSE:     865 days ( 67.6%)
  STRONG_COLLAPSE:    59 days (  4.6%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.193701
  RMSE:             1.092566
  MAE:              0.779463
  Out-of-sample RÂ²: -0.0144

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4728

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:04:00
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr5
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr5/checkpoints/tft-epoch=04-val_loss=0.1633.ckpt
  Validation loss: 0.163338

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr5/evaluation/evaluation_20251027_120401.log
Evaluation started at: 2025-10-27 12:04:01
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.167534
    Max: 0.257809
    Mean: 0.195517
    Std: 0.013163
    Unique values: 1278

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1675, max: 0.2578, mean: 0.1955
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   28 days (  2.2%)
2. Range-based                 [WARN]  988 days ( 77.2%)
3. Consecutive-similarity      [WARN] 1022 days ( 79.8%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    262 days ( 20.5%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                  97 days (  7.6%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0033, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2020-10-28 (  19 days): WEAK_COLLAPSE        - std=0.0025, corr=-0.037, dir_acc=0.588
[UNI ] 2020-10-29 to 2021-02-05 (  67 days): UNIDIRECTIONAL       - std=0.0068, corr=+0.214, dir_acc=0.546
[WEAK] 2021-02-08 to 2021-03-03 (  17 days): WEAK_COLLAPSE        - std=0.0020, corr=+0.237, dir_acc=0.565
[UNI ] 2021-03-04 to 2021-04-19 (  32 days): UNIDIRECTIONAL       - std=0.0021, corr=+0.197, dir_acc=0.551
[WEAK] 2021-04-20 to 2021-10-18 ( 126 days): WEAK_COLLAPSE        - std=0.0037, corr=+0.043, dir_acc=0.561
[FAIL] 2021-10-19 to 2021-10-26 (   6 days): STRONG_COLLAPSE      - std=0.0018, corr=+0.000, dir_acc=0.581
[WEAK] 2021-10-27 to 2022-03-23 ( 101 days): WEAK_COLLAPSE        - std=0.0083, corr=+0.038, dir_acc=0.530
[UNI ] 2022-03-24 to 2022-04-08 (  12 days): UNIDIRECTIONAL       - std=0.0017, corr=+0.238, dir_acc=0.446
[WEAK] 2022-04-11 to 2023-04-24 ( 258 days): WEAK_COLLAPSE        - std=0.0040, corr=+0.181, dir_acc=0.449
[UNI ] 2023-04-25 to 2023-06-20 (  39 days): UNIDIRECTIONAL       - std=0.0026, corr=+0.127, dir_acc=0.528
[WEAK] 2023-06-21 to 2024-03-05 ( 177 days): WEAK_COLLAPSE        - std=0.0038, corr=+0.051, dir_acc=0.557
[FAIL] 2024-03-06 to 2024-04-05 (  22 days): STRONG_COLLAPSE      - std=0.0007, corr=-0.125, dir_acc=0.578
[WEAK] 2024-04-08 to 2024-08-05 (  83 days): WEAK_COLLAPSE        - std=0.0059, corr=+0.022, dir_acc=0.560
[UNI ] 2024-08-06 to 2024-11-04 (  63 days): UNIDIRECTIONAL       - std=0.0056, corr=+0.187, dir_acc=0.589
[WEAK] 2024-11-05 to 2025-04-04 ( 102 days): WEAK_COLLAPSE        - std=0.0035, corr=+0.099, dir_acc=0.553
[UNI ] 2025-04-07 to 2025-08-06 (  84 days): UNIDIRECTIONAL       - std=0.0194, corr=+0.141, dir_acc=0.576
[WEAK] 2025-08-07 to 2025-10-06 (  42 days): WEAK_COLLAPSE        - std=0.0045, corr=-0.013, dir_acc=0.565
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    297 days ( 23.2%)
  WEAK_COLLAPSE:     925 days ( 72.3%)
  STRONG_COLLAPSE:    28 days (  2.2%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.195700
  RMSE:             1.093481
  MAE:              0.780391
  Out-of-sample RÂ²: -0.0161

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4747

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:04:03
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr3
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr3/checkpoints/tft-epoch=01-val_loss=0.1297.ckpt
  Validation loss: 0.129664

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr3/evaluation/evaluation_20251027_120404.log
Evaluation started at: 2025-10-27 12:04:04
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.003992
    Max: 0.128361
    Mean: 0.082437
    Std: 0.024640
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0040, max: 0.1284, mean: 0.0824
Negative predictions: 4/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  549 days ( 42.9%)
3. Consecutive-similarity      [WARN]  432 days ( 33.8%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    993 days ( 77.6%)
  Directional acc < 52%                489 days ( 38.2%)
  Combined (BOTH poor)                 361 days ( 28.2%)
  Unidirectional (>98%)        [WARN]  1189 days ( 92.9%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0022, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2021-04-30 ( 144 days): UNIDIRECTIONAL       - std=0.0058, corr=-0.106, dir_acc=0.554
[WEAK] 2021-05-03 to 2021-05-11 (   7 days): WEAK_COLLAPSE        - std=0.0006, corr=+0.033, dir_acc=0.512
[UNI ] 2021-05-12 to 2021-05-19 (   6 days): UNIDIRECTIONAL       - std=0.0016, corr=-0.024, dir_acc=0.522
[WEAK] 2021-05-20 to 2021-12-03 ( 136 days): WEAK_COLLAPSE        - std=0.0054, corr=-0.145, dir_acc=0.575
[UNI ] 2021-12-06 to 2022-05-10 ( 108 days): UNIDIRECTIONAL       - std=0.0121, corr=-0.042, dir_acc=0.488
[WEAK] 2022-05-11 to 2022-06-16 (  26 days): WEAK_COLLAPSE        - std=0.0013, corr=-0.194, dir_acc=0.468
[UNI ] 2022-06-17 to 2022-07-19 (  21 days): UNIDIRECTIONAL       - std=0.0014, corr=-0.139, dir_acc=0.452
[WEAK] 2022-07-20 to 2022-10-11 (  58 days): WEAK_COLLAPSE        - std=0.0050, corr=-0.148, dir_acc=0.460
[UNI ] 2022-10-12 to 2023-03-16 ( 106 days): UNIDIRECTIONAL       - std=0.0179, corr=-0.109, dir_acc=0.421
[WEAK] 2023-03-17 to 2023-04-06 (  15 days): WEAK_COLLAPSE        - std=0.0051, corr=-0.035, dir_acc=0.511
[UNI ] 2023-04-10 to 2023-07-10 (  63 days): UNIDIRECTIONAL       - std=0.0042, corr=-0.027, dir_acc=0.528
[WEAK] 2023-07-11 to 2023-08-21 (  30 days): WEAK_COLLAPSE        - std=0.0036, corr=+0.044, dir_acc=0.563
[UNI ] 2023-08-22 to 2024-02-20 ( 124 days): UNIDIRECTIONAL       - std=0.0088, corr=-0.072, dir_acc=0.552
[UNI ] 2024-02-23 to 2024-03-20 (  19 days): UNIDIRECTIONAL       - std=0.0019, corr=-0.029, dir_acc=0.609
[UNI ] 2024-03-25 to 2024-05-17 (  39 days): UNIDIRECTIONAL       - std=0.0044, corr=+0.081, dir_acc=0.526
[UNI ] 2024-05-22 to 2025-04-30 ( 233 days): UNIDIRECTIONAL       - std=0.0192, corr=-0.147, dir_acc=0.566
[DEGD] 2025-05-01 to 2025-05-15 (  11 days): DEGRADED             - std=0.0123, corr=-0.200, dir_acc=0.506
[ OK ] 2025-05-16 to 2025-07-29 (  50 days): HEALTHY              - std=0.0075, corr=-0.175, dir_acc=0.575
[UNI ] 2025-07-30 to 2025-09-17 (  35 days): UNIDIRECTIONAL       - std=0.0033, corr=-0.136, dir_acc=0.570
[UNI ] 2025-09-24 to 2025-10-06 (   9 days): UNIDIRECTIONAL       - std=0.0027, corr=-0.078, dir_acc=0.569
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            79 days (  6.2%)
  DEGRADED:           12 days (  0.9%)
  UNIDIRECTIONAL:    907 days ( 70.9%)
  WEAK_COLLAPSE:     282 days ( 22.0%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1201 days (93.8%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.178543
  RMSE:             1.085607
  MAE:              0.772332
  Out-of-sample RÂ²: -0.0015

FINANCIAL METRICS:
  Directional Acc:  53.52%
  Sharpe Ratio:     0.7986
  Total Return:     86.29%
  Max Drawdown:     -25.25%
  Hit Rate:         53.44%
  Number of Trades: 1276

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5361
  Recall:           0.9956
  F1 Score:         0.6969
  AUC-ROC:          0.5221

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          1             592
  Actual Up:            3             684

ALPHA (vs Buy-and-Hold):
  Excess Return:    -5.87%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:04:05
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr5
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr5/checkpoints/tft-epoch=01-val_loss=0.1464.ckpt
  Validation loss: 0.146359

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr5/evaluation/evaluation_20251027_120407.log
Evaluation started at: 2025-10-27 12:04:07
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.040311
    Max: 0.125946
    Mean: 0.092592
    Std: 0.016964
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0403, max: 0.1259, mean: 0.0926
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  719 days ( 56.2%)
3. Consecutive-similarity      [WARN]  742 days ( 58.0%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    970 days ( 75.8%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 344 days ( 26.9%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0017, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-02 to 2021-02-02 (  82 days): WEAK_COLLAPSE        - std=0.0026, corr=-0.080, dir_acc=0.553
[WEAK] 2021-02-04 to 2021-03-02 (  18 days): WEAK_COLLAPSE        - std=0.0018, corr=-0.108, dir_acc=0.568
[UNI ] 2021-03-03 to 2021-04-21 (  35 days): UNIDIRECTIONAL       - std=0.0035, corr=-0.067, dir_acc=0.550
[WEAK] 2021-04-22 to 2021-12-14 ( 163 days): WEAK_COLLAPSE        - std=0.0060, corr=-0.114, dir_acc=0.570
[UNI ] 2021-12-15 to 2022-03-10 (  59 days): UNIDIRECTIONAL       - std=0.0060, corr=+0.036, dir_acc=0.509
[UNI ] 2022-03-14 to 2022-04-28 (  33 days): UNIDIRECTIONAL       - std=0.0028, corr=-0.118, dir_acc=0.440
[WEAK] 2022-04-29 to 2022-10-20 ( 120 days): WEAK_COLLAPSE        - std=0.0040, corr=-0.164, dir_acc=0.456
[UNI ] 2022-10-21 to 2023-03-06 (  91 days): UNIDIRECTIONAL       - std=0.0125, corr=-0.120, dir_acc=0.417
[WEAK] 2023-03-07 to 2023-04-18 (  30 days): WEAK_COLLAPSE        - std=0.0060, corr=+0.009, dir_acc=0.503
[UNI ] 2023-04-19 to 2023-06-27 (  48 days): UNIDIRECTIONAL       - std=0.0027, corr=-0.024, dir_acc=0.529
[WEAK] 2023-06-28 to 2023-08-21 (  38 days): WEAK_COLLAPSE        - std=0.0033, corr=+0.061, dir_acc=0.555
[UNI ] 2023-08-22 to 2024-02-20 ( 124 days): UNIDIRECTIONAL       - std=0.0066, corr=-0.069, dir_acc=0.552
[UNI ] 2024-02-26 to 2024-03-20 (  18 days): UNIDIRECTIONAL       - std=0.0016, corr=-0.029, dir_acc=0.607
[UNI ] 2024-03-27 to 2024-04-18 (  16 days): UNIDIRECTIONAL       - std=0.0021, corr=+0.133, dir_acc=0.552
[UNI ] 2024-04-23 to 2024-05-17 (  19 days): UNIDIRECTIONAL       - std=0.0012, corr=+0.007, dir_acc=0.508
[UNI ] 2024-05-23 to 2024-06-18 (  18 days): UNIDIRECTIONAL       - std=0.0013, corr=-0.166, dir_acc=0.538
[UNI ] 2024-06-26 to 2024-08-16 (  37 days): UNIDIRECTIONAL       - std=0.0055, corr=-0.130, dir_acc=0.620
[UNI ] 2024-08-22 to 2025-08-19 ( 246 days): UNIDIRECTIONAL       - std=0.0127, corr=-0.150, dir_acc=0.568
[UNI ] 2025-08-22 to 2025-09-17 (  18 days): UNIDIRECTIONAL       - std=0.0021, corr=-0.195, dir_acc=0.560
[WEAK] 2025-09-18 to 2025-09-29 (   8 days): WEAK_COLLAPSE        - std=0.0027, corr=-0.143, dir_acc=0.562
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    769 days ( 60.1%)
  WEAK_COLLAPSE:     481 days ( 37.6%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.178450
  RMSE:             1.085564
  MAE:              0.772292
  Out-of-sample RÂ²: -0.0014

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5242

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:04:08
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr3
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr3/checkpoints/tft-epoch=01-val_loss=0.1304.ckpt
  Validation loss: 0.130372

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr3/evaluation/evaluation_20251027_120410.log
Evaluation started at: 2025-10-27 12:04:10
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.012220
    Max: 0.124330
    Mean: 0.077817
    Std: 0.025158
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0122, max: 0.1243, mean: 0.0778
Negative predictions: 13/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  548 days ( 42.8%)
3. Consecutive-similarity      [WARN]  437 days ( 34.1%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    998 days ( 78.0%)
  Directional acc < 52%                534 days ( 41.7%)
  Combined (BOTH poor)                 408 days ( 31.9%)
  Unidirectional (>98%)        [WARN]  1180 days ( 92.2%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0022, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2021-05-03 ( 145 days): UNIDIRECTIONAL       - std=0.0060, corr=-0.107, dir_acc=0.554
[UNI ] 2021-05-11 to 2021-05-19 (   7 days): UNIDIRECTIONAL       - std=0.0016, corr=-0.020, dir_acc=0.519
[WEAK] 2021-05-26 to 2021-12-06 ( 133 days): WEAK_COLLAPSE        - std=0.0052, corr=-0.156, dir_acc=0.577
[UNI ] 2021-12-07 to 2022-05-10 ( 107 days): UNIDIRECTIONAL       - std=0.0123, corr=-0.041, dir_acc=0.488
[WEAK] 2022-05-11 to 2022-06-15 (  25 days): WEAK_COLLAPSE        - std=0.0012, corr=-0.193, dir_acc=0.469
[UNI ] 2022-06-16 to 2022-07-19 (  22 days): UNIDIRECTIONAL       - std=0.0015, corr=-0.135, dir_acc=0.452
[WEAK] 2022-07-20 to 2022-10-11 (  58 days): WEAK_COLLAPSE        - std=0.0051, corr=-0.149, dir_acc=0.460
[UNI ] 2022-10-12 to 2023-03-16 ( 106 days): UNIDIRECTIONAL       - std=0.0180, corr=-0.109, dir_acc=0.421
[WEAK] 2023-03-17 to 2023-04-06 (  15 days): WEAK_COLLAPSE        - std=0.0051, corr=-0.034, dir_acc=0.511
[UNI ] 2023-04-10 to 2023-07-05 (  60 days): UNIDIRECTIONAL       - std=0.0043, corr=-0.030, dir_acc=0.528
[WEAK] 2023-07-06 to 2023-08-21 (  33 days): WEAK_COLLAPSE        - std=0.0037, corr=+0.033, dir_acc=0.559
[UNI ] 2023-08-22 to 2024-02-20 ( 124 days): UNIDIRECTIONAL       - std=0.0088, corr=-0.072, dir_acc=0.552
[UNI ] 2024-02-23 to 2024-03-20 (  19 days): UNIDIRECTIONAL       - std=0.0019, corr=-0.028, dir_acc=0.609
[UNI ] 2024-03-25 to 2024-04-18 (  18 days): UNIDIRECTIONAL       - std=0.0024, corr=+0.130, dir_acc=0.551
[UNI ] 2024-04-22 to 2024-05-17 (  20 days): UNIDIRECTIONAL       - std=0.0016, corr=+0.029, dir_acc=0.507
[UNI ] 2024-05-22 to 2024-06-18 (  19 days): UNIDIRECTIONAL       - std=0.0019, corr=-0.166, dir_acc=0.537
[UNI ] 2024-06-21 to 2025-04-22 ( 207 days): UNIDIRECTIONAL       - std=0.0167, corr=-0.145, dir_acc=0.571
[DEGD] 2025-04-23 to 2025-07-21 (  61 days): DEGRADED             - std=0.0281, corr=-0.178, dir_acc=0.443
[ OK ] 2025-07-22 to 2025-08-01 (   9 days): HEALTHY              - std=0.0025, corr=-0.168, dir_acc=0.576
[UNI ] 2025-08-04 to 2025-09-17 (  32 days): UNIDIRECTIONAL       - std=0.0034, corr=-0.130, dir_acc=0.566
[UNI ] 2025-09-24 to 2025-10-06 (   9 days): UNIDIRECTIONAL       - std=0.0027, corr=-0.075, dir_acc=0.569
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            38 days (  3.0%)
  DEGRADED:           62 days (  4.8%)
  UNIDIRECTIONAL:    896 days ( 70.0%)
  WEAK_COLLAPSE:     284 days ( 22.2%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1242 days (97.0%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.178474
  RMSE:             1.085575
  MAE:              0.772343
  Out-of-sample RÂ²: -0.0015

FINANCIAL METRICS:
  Directional Acc:  52.97%
  Sharpe Ratio:     0.7292
  Total Return:     75.00%
  Max Drawdown:     -25.25%
  Hit Rate:         52.81%
  Number of Trades: 1267

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5335
  Recall:           0.9840
  F1 Score:         0.6919
  AUC-ROC:          0.5209

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          2             591
  Actual Up:           11             676

ALPHA (vs Buy-and-Hold):
  Excess Return:    -17.16%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:04:11
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr5
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr5/checkpoints/tft-epoch=01-val_loss=0.1479.ckpt
  Validation loss: 0.147934

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr5/evaluation/evaluation_20251027_120412.log
Evaluation started at: 2025-10-27 12:04:12
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.029642
    Max: 0.120058
    Mean: 0.086199
    Std: 0.017458
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0296, max: 0.1201, mean: 0.0862
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  718 days ( 56.1%)
3. Consecutive-similarity      [WARN]  753 days ( 58.8%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    975 days ( 76.2%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 345 days ( 27.0%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0017, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-02 to 2020-11-06 (  25 days): WEAK_COLLAPSE        - std=0.0028, corr=+0.104, dir_acc=0.580
[WEAK] 2020-11-10 to 2021-02-02 (  56 days): WEAK_COLLAPSE        - std=0.0023, corr=-0.174, dir_acc=0.541
[WEAK] 2021-02-08 to 2021-03-01 (  15 days): WEAK_COLLAPSE        - std=0.0019, corr=-0.118, dir_acc=0.569
[UNI ] 2021-03-02 to 2021-04-21 (  36 days): UNIDIRECTIONAL       - std=0.0036, corr=-0.081, dir_acc=0.549
[WEAK] 2021-04-22 to 2021-12-14 ( 163 days): WEAK_COLLAPSE        - std=0.0056, corr=-0.124, dir_acc=0.570
[UNI ] 2021-12-15 to 2022-04-29 (  94 days): UNIDIRECTIONAL       - std=0.0078, corr=-0.019, dir_acc=0.483
[WEAK] 2022-05-02 to 2022-10-19 ( 118 days): WEAK_COLLAPSE        - std=0.0039, corr=-0.161, dir_acc=0.457
[UNI ] 2022-10-20 to 2023-03-06 (  92 days): UNIDIRECTIONAL       - std=0.0126, corr=-0.120, dir_acc=0.417
[WEAK] 2023-03-07 to 2023-04-19 (  31 days): WEAK_COLLAPSE        - std=0.0062, corr=+0.012, dir_acc=0.504
[UNI ] 2023-04-20 to 2023-06-26 (  46 days): UNIDIRECTIONAL       - std=0.0028, corr=-0.029, dir_acc=0.529
[WEAK] 2023-06-27 to 2023-08-21 (  39 days): WEAK_COLLAPSE        - std=0.0033, corr=+0.052, dir_acc=0.555
[UNI ] 2023-08-22 to 2024-02-20 ( 124 days): UNIDIRECTIONAL       - std=0.0065, corr=-0.070, dir_acc=0.552
[UNI ] 2024-02-26 to 2024-03-19 (  17 days): UNIDIRECTIONAL       - std=0.0015, corr=-0.028, dir_acc=0.609
[WEAK] 2024-03-20 to 2024-04-05 (  12 days): WEAK_COLLAPSE        - std=0.0023, corr=+0.043, dir_acc=0.562
[UNI ] 2024-04-08 to 2024-04-18 (   9 days): UNIDIRECTIONAL       - std=0.0016, corr=+0.172, dir_acc=0.544
[UNI ] 2024-04-23 to 2024-05-16 (  18 days): UNIDIRECTIONAL       - std=0.0013, corr=+0.021, dir_acc=0.507
[UNI ] 2024-05-23 to 2024-06-17 (  17 days): UNIDIRECTIONAL       - std=0.0013, corr=-0.161, dir_acc=0.536
[WEAK] 2024-06-18 to 2024-06-26 (   6 days): WEAK_COLLAPSE        - std=0.0031, corr=-0.207, dir_acc=0.561
[UNI ] 2024-06-27 to 2024-08-20 (  38 days): UNIDIRECTIONAL       - std=0.0059, corr=-0.135, dir_acc=0.622
[UNI ] 2024-08-22 to 2025-08-19 ( 246 days): UNIDIRECTIONAL       - std=0.0135, corr=-0.151, dir_acc=0.568
[UNI ] 2025-08-22 to 2025-09-17 (  18 days): UNIDIRECTIONAL       - std=0.0021, corr=-0.190, dir_acc=0.560
[WEAK] 2025-09-18 to 2025-09-29 (   8 days): WEAK_COLLAPSE        - std=0.0028, corr=-0.141, dir_acc=0.562
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    765 days ( 59.8%)
  WEAK_COLLAPSE:     485 days ( 37.9%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.178185
  RMSE:             1.085443
  MAE:              0.772264
  Out-of-sample RÂ²: -0.0012

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5222

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:04:13
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h16_drop0.25_lr3
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h16_drop0.25_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.25_lr3/checkpoints/tft-epoch=01-val_loss=0.1392.ckpt
  Validation loss: 0.139167

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.25_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.25_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.25_lr3/evaluation/evaluation_20251027_120415.log
Evaluation started at: 2025-10-27 12:04:15
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.026538
    Max: 0.117295
    Mean: 0.071116
    Std: 0.025664
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0265, max: 0.1173, mean: 0.0711
Negative predictions: 17/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    3 days (  0.2%)
2. Range-based                 [WARN]  541 days ( 42.3%)
3. Consecutive-similarity      [WARN]  403 days ( 31.5%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                   1003 days ( 78.4%)
  Directional acc < 52%                534 days ( 41.7%)
  Combined (BOTH poor)                 409 days ( 32.0%)
  Unidirectional (>98%)        [WARN]  1176 days ( 91.9%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0024, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2021-05-20 ( 158 days): UNIDIRECTIONAL       - std=0.0064, corr=-0.096, dir_acc=0.551
[WEAK] 2021-05-26 to 2021-09-20 (  81 days): WEAK_COLLAPSE        - std=0.0019, corr=-0.161, dir_acc=0.575
[WEAK] 2021-09-29 to 2021-12-06 (  46 days): WEAK_COLLAPSE        - std=0.0042, corr=-0.209, dir_acc=0.583
[UNI ] 2021-12-07 to 2022-05-10 ( 107 days): UNIDIRECTIONAL       - std=0.0129, corr=-0.042, dir_acc=0.488
[WEAK] 2022-05-11 to 2022-06-15 (  25 days): WEAK_COLLAPSE        - std=0.0013, corr=-0.188, dir_acc=0.469
[UNI ] 2022-06-16 to 2022-07-21 (  24 days): UNIDIRECTIONAL       - std=0.0016, corr=-0.136, dir_acc=0.454
[WEAK] 2022-07-22 to 2022-10-11 (  56 days): WEAK_COLLAPSE        - std=0.0050, corr=-0.151, dir_acc=0.459
[UNI ] 2022-10-12 to 2023-03-16 ( 106 days): UNIDIRECTIONAL       - std=0.0184, corr=-0.109, dir_acc=0.421
[WEAK] 2023-03-17 to 2023-04-05 (  14 days): WEAK_COLLAPSE        - std=0.0046, corr=-0.036, dir_acc=0.510
[UNI ] 2023-04-06 to 2023-07-05 (  61 days): UNIDIRECTIONAL       - std=0.0045, corr=-0.031, dir_acc=0.528
[WEAK] 2023-07-06 to 2023-08-21 (  33 days): WEAK_COLLAPSE        - std=0.0037, corr=+0.034, dir_acc=0.559
[UNI ] 2023-08-22 to 2024-02-20 ( 124 days): UNIDIRECTIONAL       - std=0.0088, corr=-0.072, dir_acc=0.552
[UNI ] 2024-02-23 to 2024-03-20 (  19 days): UNIDIRECTIONAL       - std=0.0019, corr=-0.026, dir_acc=0.609
[UNI ] 2024-03-25 to 2024-04-18 (  18 days): UNIDIRECTIONAL       - std=0.0024, corr=+0.133, dir_acc=0.551
[UNI ] 2024-04-22 to 2024-05-17 (  20 days): UNIDIRECTIONAL       - std=0.0016, corr=+0.027, dir_acc=0.507
[UNI ] 2024-05-22 to 2025-04-17 ( 225 days): UNIDIRECTIONAL       - std=0.0153, corr=-0.149, dir_acc=0.569
[DEGD] 2025-04-22 to 2025-07-21 (  62 days): DEGRADED             - std=0.0313, corr=-0.176, dir_acc=0.444
[ OK ] 2025-07-22 to 2025-08-05 (  11 days): HEALTHY              - std=0.0023, corr=-0.186, dir_acc=0.577
[UNI ] 2025-08-06 to 2025-09-17 (  30 days): UNIDIRECTIONAL       - std=0.0034, corr=-0.122, dir_acc=0.564
[UNI ] 2025-09-24 to 2025-10-06 (   9 days): UNIDIRECTIONAL       - std=0.0028, corr=-0.077, dir_acc=0.569
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            41 days (  3.2%)
  DEGRADED:           63 days (  4.9%)
  UNIDIRECTIONAL:    903 days ( 70.5%)
  WEAK_COLLAPSE:     270 days ( 21.1%)
  STRONG_COLLAPSE:     3 days (  0.2%)

  Total problematic: 1239 days (96.8%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.25_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.178447
  RMSE:             1.085563
  MAE:              0.772411
  Out-of-sample RÂ²: -0.0014

FINANCIAL METRICS:
  Directional Acc:  52.97%
  Sharpe Ratio:     0.7220
  Total Return:     73.47%
  Max Drawdown:     -25.25%
  Hit Rate:         52.66%
  Number of Trades: 1263

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5337
  Recall:           0.9811
  F1 Score:         0.6913
  AUC-ROC:          0.5201

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          4             589
  Actual Up:           13             674

ALPHA (vs Buy-and-Hold):
  Excess Return:    -18.69%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.25_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:04:16
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h16_drop0.25_lr5
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h16_drop0.25_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.25_lr5/checkpoints/tft-epoch=01-val_loss=0.1476.ckpt
  Validation loss: 0.147566

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.25_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.25_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.25_lr5/evaluation/evaluation_20251027_120418.log
Evaluation started at: 2025-10-27 12:04:18
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.019630
    Max: 0.122707
    Mean: 0.087928
    Std: 0.018846
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0196, max: 0.1227, mean: 0.0879
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  681 days ( 53.2%)
3. Consecutive-similarity      [WARN]  643 days ( 50.2%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    982 days ( 76.7%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 347 days ( 27.1%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0021, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2020-11-19 (  34 days): UNIDIRECTIONAL       - std=0.0027, corr=+0.075, dir_acc=0.578
[UNI ] 2020-11-23 to 2020-12-18 (  19 days): UNIDIRECTIONAL       - std=0.0025, corr=-0.130, dir_acc=0.528
[UNI ] 2020-12-22 to 2021-01-21 (  20 days): UNIDIRECTIONAL       - std=0.0015, corr=-0.191, dir_acc=0.537
[UNI ] 2021-01-26 to 2021-04-27 (  64 days): UNIDIRECTIONAL       - std=0.0048, corr=-0.108, dir_acc=0.556
[WEAK] 2021-04-28 to 2021-12-14 ( 159 days): WEAK_COLLAPSE        - std=0.0053, corr=-0.147, dir_acc=0.571
[UNI ] 2021-12-15 to 2022-05-03 (  96 days): UNIDIRECTIONAL       - std=0.0087, corr=-0.025, dir_acc=0.482
[WEAK] 2022-05-04 to 2022-10-17 ( 114 days): WEAK_COLLAPSE        - std=0.0040, corr=-0.160, dir_acc=0.458
[UNI ] 2022-10-18 to 2023-03-08 (  96 days): UNIDIRECTIONAL       - std=0.0139, corr=-0.117, dir_acc=0.418
[WEAK] 2023-03-09 to 2023-04-14 (  26 days): WEAK_COLLAPSE        - std=0.0059, corr=+0.003, dir_acc=0.503
[UNI ] 2023-04-17 to 2023-06-28 (  51 days): UNIDIRECTIONAL       - std=0.0030, corr=-0.027, dir_acc=0.529
[WEAK] 2023-06-29 to 2023-08-21 (  37 days): WEAK_COLLAPSE        - std=0.0034, corr=+0.058, dir_acc=0.556
[UNI ] 2023-08-22 to 2024-02-20 ( 124 days): UNIDIRECTIONAL       - std=0.0070, corr=-0.068, dir_acc=0.552
[UNI ] 2024-02-26 to 2024-03-20 (  18 days): UNIDIRECTIONAL       - std=0.0016, corr=-0.029, dir_acc=0.607
[WEAK] 2024-03-21 to 2024-04-04 (  10 days): WEAK_COLLAPSE        - std=0.0025, corr=+0.047, dir_acc=0.560
[UNI ] 2024-04-05 to 2024-04-18 (  10 days): UNIDIRECTIONAL       - std=0.0018, corr=+0.168, dir_acc=0.547
[UNI ] 2024-04-23 to 2024-05-17 (  19 days): UNIDIRECTIONAL       - std=0.0012, corr=+0.009, dir_acc=0.508
[UNI ] 2024-05-23 to 2024-06-18 (  18 days): UNIDIRECTIONAL       - std=0.0013, corr=-0.168, dir_acc=0.538
[UNI ] 2024-06-25 to 2025-08-19 ( 287 days): UNIDIRECTIONAL       - std=0.0163, corr=-0.151, dir_acc=0.575
[UNI ] 2025-08-22 to 2025-09-17 (  18 days): UNIDIRECTIONAL       - std=0.0021, corr=-0.184, dir_acc=0.560
[WEAK] 2025-09-18 to 2025-09-26 (   7 days): WEAK_COLLAPSE        - std=0.0027, corr=-0.138, dir_acc=0.564
[UNI ] 2025-09-29 to 2025-10-06 (   6 days): UNIDIRECTIONAL       - std=0.0013, corr=-0.075, dir_acc=0.578
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    880 days ( 68.8%)
  WEAK_COLLAPSE:     370 days ( 28.9%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.25_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.178549
  RMSE:             1.085610
  MAE:              0.772370
  Out-of-sample RÂ²: -0.0015

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5214

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.25_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:04:19
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h16_drop0.30_lr3
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h16_drop0.30_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.30_lr3/checkpoints/tft-epoch=01-val_loss=0.1483.ckpt
  Validation loss: 0.148253

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.30_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.30_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.30_lr3/evaluation/evaluation_20251027_120420.log
Evaluation started at: 2025-10-27 12:04:20
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.047484
    Max: 0.112398
    Mean: 0.063958
    Std: 0.027757
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0475, max: 0.1124, mean: 0.0640
Negative predictions: 23/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   13 days (  1.0%)
2. Range-based                 [WARN]  481 days ( 37.6%)
3. Consecutive-similarity      [WARN]  352 days ( 27.5%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                   1008 days ( 78.8%)
  Directional acc < 52%                536 days ( 41.9%)
  Combined (BOTH poor)                 417 days ( 32.6%)
  Unidirectional (>98%)        [WARN]  1170 days ( 91.4%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0027, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2021-05-25 ( 161 days): UNIDIRECTIONAL       - std=0.0066, corr=-0.094, dir_acc=0.550
[WEAK] 2021-05-26 to 2021-09-13 (  76 days): WEAK_COLLAPSE        - std=0.0017, corr=-0.194, dir_acc=0.573
[FAIL] 2021-09-14 to 2021-09-30 (  13 days): STRONG_COLLAPSE      - std=0.0013, corr=-0.124, dir_acc=0.573
[WEAK] 2021-10-01 to 2021-12-06 (  44 days): WEAK_COLLAPSE        - std=0.0041, corr=-0.216, dir_acc=0.584
[UNI ] 2021-12-07 to 2022-05-16 ( 111 days): UNIDIRECTIONAL       - std=0.0141, corr=-0.048, dir_acc=0.486
[UNI ] 2022-05-20 to 2022-07-22 (  43 days): UNIDIRECTIONAL       - std=0.0021, corr=-0.157, dir_acc=0.465
[WEAK] 2022-07-25 to 2022-10-07 (  54 days): WEAK_COLLAPSE        - std=0.0052, corr=-0.154, dir_acc=0.459
[UNI ] 2022-10-11 to 2023-07-05 ( 182 days): UNIDIRECTIONAL       - std=0.0227, corr=-0.078, dir_acc=0.464
[WEAK] 2023-07-06 to 2023-08-18 (  32 days): WEAK_COLLAPSE        - std=0.0034, corr=+0.026, dir_acc=0.559
[UNI ] 2023-08-21 to 2024-02-21 ( 126 days): UNIDIRECTIONAL       - std=0.0093, corr=-0.069, dir_acc=0.553
[UNI ] 2024-02-23 to 2024-03-20 (  19 days): UNIDIRECTIONAL       - std=0.0019, corr=-0.025, dir_acc=0.609
[UNI ] 2024-03-22 to 2024-05-20 (  41 days): UNIDIRECTIONAL       - std=0.0045, corr=+0.073, dir_acc=0.527
[UNI ] 2024-05-22 to 2025-04-11 ( 221 days): UNIDIRECTIONAL       - std=0.0143, corr=-0.152, dir_acc=0.570
[DEGD] 2025-04-22 to 2025-07-23 (  64 days): DEGRADED             - std=0.0354, corr=-0.176, dir_acc=0.422
[ OK ] 2025-07-24 to 2025-08-07 (  11 days): HEALTHY              - std=0.0008, corr=-0.193, dir_acc=0.552
[UNI ] 2025-08-08 to 2025-09-17 (  28 days): UNIDIRECTIONAL       - std=0.0034, corr=-0.113, dir_acc=0.562
[UNI ] 2025-09-23 to 2025-10-06 (  10 days): UNIDIRECTIONAL       - std=0.0034, corr=-0.076, dir_acc=0.568
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            41 days (  3.2%)
  DEGRADED:           69 days (  5.4%)
  UNIDIRECTIONAL:    942 days ( 73.6%)
  WEAK_COLLAPSE:     215 days ( 16.8%)
  STRONG_COLLAPSE:    13 days (  1.0%)

  Total problematic: 1239 days (96.8%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.30_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.178687
  RMSE:             1.085673
  MAE:              0.772603
  Out-of-sample RÂ²: -0.0016

FINANCIAL METRICS:
  Directional Acc:  52.81%
  Sharpe Ratio:     0.7126
  Total Return:     71.79%
  Max Drawdown:     -25.25%
  Hit Rate:         52.34%
  Number of Trades: 1257

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5330
  Recall:           0.9753
  F1 Score:         0.6893
  AUC-ROC:          0.5173

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          6             587
  Actual Up:           17             670

ALPHA (vs Buy-and-Hold):
  Excess Return:    -20.37%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.30_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:04:21
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h16_drop0.30_lr5
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h16_drop0.30_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.30_lr5/checkpoints/tft-epoch=01-val_loss=0.1494.ckpt
  Validation loss: 0.149428

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.30_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.30_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.30_lr5/evaluation/evaluation_20251027_120423.log
Evaluation started at: 2025-10-27 12:04:23
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.001652
    Max: 0.117202
    Mean: 0.079559
    Std: 0.021264
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0017, max: 0.1172, mean: 0.0796
Negative predictions: 1/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    2 days (  0.2%)
2. Range-based                 [WARN]  635 days ( 49.6%)
3. Consecutive-similarity      [WARN]  575 days ( 44.9%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    995 days ( 77.7%)
  Directional acc < 52%                484 days ( 37.8%)
  Combined (BOTH poor)                 359 days ( 28.0%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0024, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2021-04-29 ( 143 days): UNIDIRECTIONAL       - std=0.0050, corr=-0.082, dir_acc=0.554
[WEAK] 2021-04-30 to 2021-05-13 (  10 days): WEAK_COLLAPSE        - std=0.0010, corr=+0.018, dir_acc=0.512
[WEAK] 2021-05-19 to 2021-09-20 (  86 days): WEAK_COLLAPSE        - std=0.0016, corr=-0.181, dir_acc=0.572
[WEAK] 2021-09-23 to 2021-12-14 (  56 days): WEAK_COLLAPSE        - std=0.0047, corr=-0.203, dir_acc=0.583
[UNI ] 2021-12-15 to 2022-05-06 (  99 days): UNIDIRECTIONAL       - std=0.0100, corr=-0.034, dir_acc=0.481
[WEAK] 2022-05-09 to 2022-10-13 ( 109 days): WEAK_COLLAPSE        - std=0.0043, corr=-0.157, dir_acc=0.459
[UNI ] 2022-10-14 to 2023-03-10 ( 100 days): UNIDIRECTIONAL       - std=0.0153, corr=-0.113, dir_acc=0.419
[WEAK] 2023-03-13 to 2023-04-13 (  23 days): WEAK_COLLAPSE        - std=0.0063, corr=-0.004, dir_acc=0.504
[UNI ] 2023-04-14 to 2023-06-29 (  53 days): UNIDIRECTIONAL       - std=0.0034, corr=-0.029, dir_acc=0.529
[WEAK] 2023-06-30 to 2023-08-21 (  36 days): WEAK_COLLAPSE        - std=0.0037, corr=+0.053, dir_acc=0.557
[UNI ] 2023-08-22 to 2024-02-20 ( 124 days): UNIDIRECTIONAL       - std=0.0077, corr=-0.069, dir_acc=0.552
[UNI ] 2024-02-26 to 2024-03-20 (  18 days): UNIDIRECTIONAL       - std=0.0016, corr=-0.029, dir_acc=0.607
[UNI ] 2024-03-26 to 2024-04-18 (  17 days): UNIDIRECTIONAL       - std=0.0023, corr=+0.131, dir_acc=0.551
[UNI ] 2024-04-22 to 2024-05-17 (  20 days): UNIDIRECTIONAL       - std=0.0017, corr=+0.014, dir_acc=0.507
[UNI ] 2024-05-22 to 2024-06-18 (  19 days): UNIDIRECTIONAL       - std=0.0020, corr=-0.171, dir_acc=0.537
[UNI ] 2024-06-21 to 2025-09-17 ( 309 days): UNIDIRECTIONAL       - std=0.0186, corr=-0.154, dir_acc=0.571
[WEAK] 2025-09-18 to 2025-09-25 (   6 days): WEAK_COLLAPSE        - std=0.0028, corr=-0.128, dir_acc=0.567
[UNI ] 2025-09-26 to 2025-10-06 (   7 days): UNIDIRECTIONAL       - std=0.0017, corr=-0.073, dir_acc=0.574
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    912 days ( 71.2%)
  WEAK_COLLAPSE:     336 days ( 26.2%)
  STRONG_COLLAPSE:     2 days (  0.2%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.30_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.178475
  RMSE:             1.085576
  MAE:              0.772407
  Out-of-sample RÂ²: -0.0015

FINANCIAL METRICS:
  Directional Acc:  53.59%
  Sharpe Ratio:     0.8146
  Total Return:     89.01%
  Max Drawdown:     -25.25%
  Hit Rate:         53.59%
  Number of Trades: 1279

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5364
  Recall:           0.9985
  F1 Score:         0.6979
  AUC-ROC:          0.5176

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            1             686

ALPHA (vs Buy-and-Hold):
  Excess Return:    -3.15%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.30_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:04:24
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h16_drop0.35_lr3
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h16_drop0.35_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.35_lr3/checkpoints/tft-epoch=02-val_loss=0.1556.ckpt
  Validation loss: 0.155615

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.35_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.35_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.35_lr3/evaluation/evaluation_20251027_120426.log
Evaluation started at: 2025-10-27 12:04:26
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.016755
    Max: 0.105941
    Mean: 0.067893
    Std: 0.021703
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0168, max: 0.1059, mean: 0.0679
Negative predictions: 15/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   44 days (  3.4%)
2. Range-based                 [WARN]  640 days ( 50.0%)
3. Consecutive-similarity      [WARN]  572 days ( 44.7%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                   1001 days ( 78.2%)
  Directional acc < 52%                533 days ( 41.6%)
  Combined (BOTH poor)                 411 days ( 32.1%)
  Unidirectional (>98%)        [WARN]  1178 days ( 92.0%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0023, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2021-04-29 ( 143 days): UNIDIRECTIONAL       - std=0.0052, corr=-0.095, dir_acc=0.554
[WEAK] 2021-04-30 to 2021-05-12 (   9 days): WEAK_COLLAPSE        - std=0.0004, corr=+0.022, dir_acc=0.511
[WEAK] 2021-05-19 to 2021-07-30 (  51 days): WEAK_COLLAPSE        - std=0.0011, corr=-0.215, dir_acc=0.550
[FAIL] 2021-08-02 to 2021-10-01 (  44 days): STRONG_COLLAPSE      - std=0.0011, corr=-0.209, dir_acc=0.594
[WEAK] 2021-10-04 to 2021-12-14 (  49 days): WEAK_COLLAPSE        - std=0.0044, corr=-0.221, dir_acc=0.588
[UNI ] 2021-12-15 to 2022-05-06 (  99 days): UNIDIRECTIONAL       - std=0.0106, corr=-0.035, dir_acc=0.481
[WEAK] 2022-05-09 to 2022-10-12 ( 108 days): WEAK_COLLAPSE        - std=0.0044, corr=-0.159, dir_acc=0.459
[UNI ] 2022-10-13 to 2023-03-10 ( 101 days): UNIDIRECTIONAL       - std=0.0150, corr=-0.114, dir_acc=0.419
[WEAK] 2023-03-13 to 2023-04-14 (  24 days): WEAK_COLLAPSE        - std=0.0062, corr=-0.005, dir_acc=0.505
[UNI ] 2023-04-17 to 2023-06-28 (  51 days): UNIDIRECTIONAL       - std=0.0035, corr=-0.035, dir_acc=0.529
[WEAK] 2023-06-29 to 2023-08-21 (  37 days): WEAK_COLLAPSE        - std=0.0037, corr=+0.057, dir_acc=0.556
[UNI ] 2023-08-22 to 2024-02-20 ( 124 days): UNIDIRECTIONAL       - std=0.0073, corr=-0.071, dir_acc=0.552
[UNI ] 2024-02-23 to 2024-03-20 (  19 days): UNIDIRECTIONAL       - std=0.0019, corr=-0.021, dir_acc=0.609
[UNI ] 2024-03-22 to 2024-04-18 (  19 days): UNIDIRECTIONAL       - std=0.0024, corr=+0.123, dir_acc=0.552
[UNI ] 2024-04-22 to 2024-05-17 (  20 days): UNIDIRECTIONAL       - std=0.0017, corr=+0.014, dir_acc=0.507
[UNI ] 2024-05-22 to 2024-06-18 (  19 days): UNIDIRECTIONAL       - std=0.0021, corr=-0.169, dir_acc=0.537
[UNI ] 2024-06-21 to 2025-04-21 ( 206 days): UNIDIRECTIONAL       - std=0.0142, corr=-0.147, dir_acc=0.571
[DEGD] 2025-04-22 to 2025-07-18 (  61 days): DEGRADED             - std=0.0255, corr=-0.182, dir_acc=0.471
[ OK ] 2025-07-21 to 2025-08-04 (  11 days): HEALTHY              - std=0.0024, corr=-0.182, dir_acc=0.588
[UNI ] 2025-08-05 to 2025-09-17 (  31 days): UNIDIRECTIONAL       - std=0.0029, corr=-0.144, dir_acc=0.566
[UNI ] 2025-09-25 to 2025-10-06 (   8 days): UNIDIRECTIONAL       - std=0.0022, corr=-0.097, dir_acc=0.571
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            40 days (  3.1%)
  DEGRADED:           62 days (  4.8%)
  UNIDIRECTIONAL:    844 days ( 65.9%)
  WEAK_COLLAPSE:     290 days ( 22.7%)
  STRONG_COLLAPSE:    44 days (  3.4%)

  Total problematic: 1240 days (96.9%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.35_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.178280
  RMSE:             1.085486
  MAE:              0.772517
  Out-of-sample RÂ²: -0.0013

FINANCIAL METRICS:
  Directional Acc:  53.12%
  Sharpe Ratio:     0.7586
  Total Return:     79.35%
  Max Drawdown:     -25.25%
  Hit Rate:         52.81%
  Number of Trades: 1265

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5344
  Recall:           0.9840
  F1 Score:         0.6926
  AUC-ROC:          0.5145

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          4             589
  Actual Up:           11             676

ALPHA (vs Buy-and-Hold):
  Excess Return:    -12.81%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.35_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:04:27
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h16_drop0.35_lr5
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h16_drop0.35_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.35_lr5/checkpoints/tft-epoch=01-val_loss=0.1506.ckpt
  Validation loss: 0.150578

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.35_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.35_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.35_lr5/evaluation/evaluation_20251027_120428.log
Evaluation started at: 2025-10-27 12:04:28
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.020740
    Max: 0.111505
    Mean: 0.070937
    Std: 0.023263
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0207, max: 0.1115, mean: 0.0709
Negative predictions: 16/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   17 days (  1.3%)
2. Range-based                 [WARN]  617 days ( 48.2%)
3. Consecutive-similarity      [WARN]  523 days ( 40.9%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    999 days ( 78.0%)
  Directional acc < 52%                533 days ( 41.6%)
  Combined (BOTH poor)                 412 days ( 32.2%)
  Unidirectional (>98%)        [WARN]  1177 days ( 92.0%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0025, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-01 to 2021-05-03 ( 145 days): UNIDIRECTIONAL       - std=0.0054, corr=-0.089, dir_acc=0.554
[WEAK] 2021-05-04 to 2021-05-11 (   6 days): WEAK_COLLAPSE        - std=0.0005, corr=+0.027, dir_acc=0.511
[WEAK] 2021-05-19 to 2021-08-16 (  62 days): WEAK_COLLAPSE        - std=0.0014, corr=-0.213, dir_acc=0.555
[WEAK] 2021-08-19 to 2021-09-09 (  15 days): WEAK_COLLAPSE        - std=0.0010, corr=-0.185, dir_acc=0.623
[FAIL] 2021-09-10 to 2021-09-30 (  15 days): STRONG_COLLAPSE      - std=0.0011, corr=-0.120, dir_acc=0.578
[WEAK] 2021-10-01 to 2021-12-13 (  49 days): WEAK_COLLAPSE        - std=0.0046, corr=-0.215, dir_acc=0.587
[UNI ] 2021-12-14 to 2022-05-09 ( 101 days): UNIDIRECTIONAL       - std=0.0111, corr=-0.036, dir_acc=0.482
[WEAK] 2022-05-10 to 2022-07-12 (  43 days): WEAK_COLLAPSE        - std=0.0018, corr=-0.160, dir_acc=0.461
[WEAK] 2022-07-20 to 2022-10-11 (  58 days): WEAK_COLLAPSE        - std=0.0048, corr=-0.152, dir_acc=0.460
[UNI ] 2022-10-12 to 2023-03-13 ( 103 days): UNIDIRECTIONAL       - std=0.0162, corr=-0.111, dir_acc=0.419
[WEAK] 2023-03-14 to 2023-04-12 (  21 days): WEAK_COLLAPSE        - std=0.0061, corr=-0.016, dir_acc=0.506
[UNI ] 2023-04-13 to 2023-06-30 (  55 days): UNIDIRECTIONAL       - std=0.0037, corr=-0.032, dir_acc=0.528
[WEAK] 2023-07-03 to 2023-08-21 (  35 days): WEAK_COLLAPSE        - std=0.0038, corr=+0.048, dir_acc=0.558
[UNI ] 2023-08-22 to 2024-02-20 ( 124 days): UNIDIRECTIONAL       - std=0.0080, corr=-0.071, dir_acc=0.552
[UNI ] 2024-02-23 to 2024-03-20 (  19 days): UNIDIRECTIONAL       - std=0.0019, corr=-0.027, dir_acc=0.609
[UNI ] 2024-03-25 to 2024-04-18 (  18 days): UNIDIRECTIONAL       - std=0.0022, corr=+0.127, dir_acc=0.551
[UNI ] 2024-04-22 to 2024-05-17 (  20 days): UNIDIRECTIONAL       - std=0.0017, corr=+0.016, dir_acc=0.507
[UNI ] 2024-05-22 to 2024-06-18 (  19 days): UNIDIRECTIONAL       - std=0.0020, corr=-0.171, dir_acc=0.537
[UNI ] 2024-06-21 to 2025-04-17 ( 205 days): UNIDIRECTIONAL       - std=0.0148, corr=-0.150, dir_acc=0.572
[DEGD] 2025-04-22 to 2025-07-18 (  61 days): DEGRADED             - std=0.0283, corr=-0.179, dir_acc=0.455
[ OK ] 2025-07-21 to 2025-08-04 (  11 days): HEALTHY              - std=0.0024, corr=-0.182, dir_acc=0.588
[UNI ] 2025-08-05 to 2025-09-17 (  31 days): UNIDIRECTIONAL       - std=0.0031, corr=-0.136, dir_acc=0.566
[UNI ] 2025-09-25 to 2025-10-06 (   8 days): UNIDIRECTIONAL       - std=0.0022, corr=-0.086, dir_acc=0.571
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            41 days (  3.2%)
  DEGRADED:           62 days (  4.8%)
  UNIDIRECTIONAL:    858 days ( 67.0%)
  WEAK_COLLAPSE:     302 days ( 23.6%)
  STRONG_COLLAPSE:    17 days (  1.3%)

  Total problematic: 1239 days (96.8%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.35_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.178451
  RMSE:             1.085565
  MAE:              0.772492
  Out-of-sample RÂ²: -0.0014

FINANCIAL METRICS:
  Directional Acc:  53.05%
  Sharpe Ratio:     0.7571
  Total Return:     79.12%
  Max Drawdown:     -25.25%
  Hit Rate:         52.73%
  Number of Trades: 1264

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5340
  Recall:           0.9825
  F1 Score:         0.6920
  AUC-ROC:          0.5155

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          4             589
  Actual Up:           12             675

ALPHA (vs Buy-and-Hold):
  Excess Return:    -13.04%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.35_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:04:30
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h18_drop0.15_lr3
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h18_drop0.15_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.15_lr3/checkpoints/tft-epoch=01-val_loss=0.0787.ckpt
  Validation loss: 0.078688

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.15_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.15_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.15_lr3/evaluation/evaluation_20251027_120431.log
Evaluation started at: 2025-10-27 12:04:31
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.168021
    Max: 0.209109
    Mean: 0.186797
    Std: 0.010000
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1680, max: 0.2091, mean: 0.1868
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    3 days (  0.2%)
2. Range-based                 [WARN] 1037 days ( 81.0%)
3. Consecutive-similarity      [WARN] 1186 days ( 92.7%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    739 days ( 57.7%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 158 days ( 12.3%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0008, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-05 to 2022-01-21 ( 324 days): WEAK_COLLAPSE        - std=0.0060, corr=-0.073, dir_acc=0.565
[UNI ] 2022-01-24 to 2022-02-03 (   9 days): UNIDIRECTIONAL       - std=0.0024, corr=+0.108, dir_acc=0.474
[WEAK] 2022-02-04 to 2022-03-17 (  29 days): WEAK_COLLAPSE        - std=0.0038, corr=-0.018, dir_acc=0.434
[UNI ] 2022-03-18 to 2022-07-29 (  92 days): UNIDIRECTIONAL       - std=0.0080, corr=+0.113, dir_acc=0.456
[WEAK] 2022-08-01 to 2022-08-22 (  16 days): WEAK_COLLAPSE        - std=0.0033, corr=-0.071, dir_acc=0.475
[UNI ] 2022-08-23 to 2022-12-05 (  71 days): UNIDIRECTIONAL       - std=0.0080, corr=+0.139, dir_acc=0.426
[UNI ] 2022-12-09 to 2023-02-10 (  43 days): UNIDIRECTIONAL       - std=0.0008, corr=+0.106, dir_acc=0.419
[WEAK] 2023-02-13 to 2025-10-06 ( 661 days): WEAK_COLLAPSE        - std=0.0044, corr=-0.053, dir_acc=0.557
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            0 days (  0.0%)
  UNIDIRECTIONAL:    215 days ( 16.8%)
  WEAK_COLLAPSE:    1034 days ( 80.8%)
  STRONG_COLLAPSE:     2 days (  0.2%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.15_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.193072
  RMSE:             1.092278
  MAE:              0.779063
  Out-of-sample RÂ²: -0.0139

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5196

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.15_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:04:32
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h18_drop0.15_lr5
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h18_drop0.15_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.15_lr5/checkpoints/tft-epoch=00-val_loss=0.0768.ckpt
  Validation loss: 0.076763

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.15_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.15_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.15_lr5/evaluation/evaluation_20251027_120434.log
Evaluation started at: 2025-10-27 12:04:34
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.203520
    Max: 0.247037
    Mean: 0.223481
    Std: 0.010300
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.2035, max: 0.2470, mean: 0.2235
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    1 days (  0.1%)
2. Range-based                 [WARN] 1027 days ( 80.2%)
3. Consecutive-similarity      [WARN] 1183 days ( 92.4%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    674 days ( 52.7%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 128 days ( 10.0%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0009, corr=+0.000, dir_acc=0.500
[WEAK] 2020-09-30 to 2022-01-24 ( 328 days): WEAK_COLLAPSE        - std=0.0063, corr=-0.049, dir_acc=0.565
[WEAK] 2022-01-31 to 2022-03-17 (  33 days): WEAK_COLLAPSE        - std=0.0041, corr=+0.031, dir_acc=0.438
[UNI ] 2022-03-18 to 2022-07-29 (  92 days): UNIDIRECTIONAL       - std=0.0088, corr=+0.129, dir_acc=0.456
[WEAK] 2022-08-01 to 2022-08-11 (   9 days): WEAK_COLLAPSE        - std=0.0026, corr=-0.042, dir_acc=0.470
[UNI ] 2022-08-12 to 2023-02-16 ( 128 days): UNIDIRECTIONAL       - std=0.0098, corr=+0.113, dir_acc=0.426
[WEAK] 2023-02-17 to 2025-10-06 ( 657 days): WEAK_COLLAPSE        - std=0.0041, corr=-0.040, dir_acc=0.557
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            0 days (  0.0%)
  UNIDIRECTIONAL:    224 days ( 17.5%)
  WEAK_COLLAPSE:    1027 days ( 80.2%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.15_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.203847
  RMSE:             1.097200
  MAE:              0.784147
  Out-of-sample RÂ²: -0.0230

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5166

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.15_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:04:35
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h18_drop0.20_lr3
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h18_drop0.20_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.20_lr3/checkpoints/tft-epoch=01-val_loss=0.0761.ckpt
  Validation loss: 0.076118

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.20_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.20_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.20_lr3/evaluation/evaluation_20251027_120436.log
Evaluation started at: 2025-10-27 12:04:36
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.162121
    Max: 0.203772
    Mean: 0.181504
    Std: 0.010188
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1621, max: 0.2038, mean: 0.1815
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   14 days (  1.1%)
2. Range-based                 [WARN] 1038 days ( 81.1%)
3. Consecutive-similarity      [WARN] 1189 days ( 92.9%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    751 days ( 58.7%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 161 days ( 12.6%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0008, corr=+0.000, dir_acc=0.500
[FAIL] 2020-10-08 to 2020-10-22 (  10 days): STRONG_COLLAPSE      - std=0.0006, corr=+0.039, dir_acc=0.589
[WEAK] 2020-10-23 to 2022-01-21 ( 311 days): WEAK_COLLAPSE        - std=0.0058, corr=-0.084, dir_acc=0.564
[UNI ] 2022-01-24 to 2022-02-07 (  11 days): UNIDIRECTIONAL       - std=0.0032, corr=+0.077, dir_acc=0.470
[WEAK] 2022-02-08 to 2022-03-18 (  28 days): WEAK_COLLAPSE        - std=0.0042, corr=-0.017, dir_acc=0.433
[UNI ] 2022-03-23 to 2022-07-29 (  89 days): UNIDIRECTIONAL       - std=0.0078, corr=+0.109, dir_acc=0.457
[WEAK] 2022-08-01 to 2022-08-23 (  17 days): WEAK_COLLAPSE        - std=0.0034, corr=-0.072, dir_acc=0.474
[UNI ] 2022-08-24 to 2022-12-05 (  70 days): UNIDIRECTIONAL       - std=0.0078, corr=+0.142, dir_acc=0.425
[UNI ] 2022-12-09 to 2023-02-10 (  43 days): UNIDIRECTIONAL       - std=0.0008, corr=+0.106, dir_acc=0.419
[WEAK] 2023-02-13 to 2025-10-06 ( 661 days): WEAK_COLLAPSE        - std=0.0046, corr=-0.055, dir_acc=0.557
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            0 days (  0.0%)
  UNIDIRECTIONAL:    214 days ( 16.7%)
  WEAK_COLLAPSE:    1024 days ( 80.0%)
  STRONG_COLLAPSE:    13 days (  1.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.20_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.191725
  RMSE:             1.091661
  MAE:              0.778374
  Out-of-sample RÂ²: -0.0127

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5213

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.20_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:04:38
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h18_drop0.20_lr5
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h18_drop0.20_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.20_lr5/checkpoints/tft-epoch=00-val_loss=0.0746.ckpt
  Validation loss: 0.074607

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.20_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.20_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.20_lr5/evaluation/evaluation_20251027_120439.log
Evaluation started at: 2025-10-27 12:04:39
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.199337
    Max: 0.242056
    Mean: 0.219196
    Std: 0.010095
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1993, max: 0.2421, mean: 0.2192
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    1 days (  0.1%)
2. Range-based                 [WARN] 1029 days ( 80.4%)
3. Consecutive-similarity      [WARN] 1187 days ( 92.7%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    677 days ( 52.9%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 130 days ( 10.2%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0009, corr=+0.000, dir_acc=0.500
[WEAK] 2020-09-30 to 2022-01-24 ( 328 days): WEAK_COLLAPSE        - std=0.0061, corr=-0.050, dir_acc=0.565
[WEAK] 2022-01-28 to 2022-03-18 (  35 days): WEAK_COLLAPSE        - std=0.0045, corr=+0.034, dir_acc=0.439
[UNI ] 2022-03-21 to 2022-07-29 (  91 days): UNIDIRECTIONAL       - std=0.0087, corr=+0.126, dir_acc=0.456
[WEAK] 2022-08-01 to 2022-08-11 (   9 days): WEAK_COLLAPSE        - std=0.0026, corr=-0.044, dir_acc=0.470
[UNI ] 2022-08-12 to 2023-02-16 ( 128 days): UNIDIRECTIONAL       - std=0.0096, corr=+0.113, dir_acc=0.426
[WEAK] 2023-02-17 to 2025-10-06 ( 657 days): WEAK_COLLAPSE        - std=0.0041, corr=-0.041, dir_acc=0.557
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            0 days (  0.0%)
  UNIDIRECTIONAL:    222 days ( 17.3%)
  WEAK_COLLAPSE:    1029 days ( 80.4%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.20_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.202451
  RMSE:             1.096563
  MAE:              0.783507
  Out-of-sample RÂ²: -0.0218

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5175

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.20_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:04:40
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h18_drop0.25_lr3
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h18_drop0.25_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.25_lr3/checkpoints/tft-epoch=01-val_loss=0.0734.ckpt
  Validation loss: 0.073441

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.25_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.25_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.25_lr3/evaluation/evaluation_20251027_120442.log
Evaluation started at: 2025-10-27 12:04:42
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.159620
    Max: 0.198253
    Mean: 0.177999
    Std: 0.009476
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1596, max: 0.1983, mean: 0.1780
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    2 days (  0.2%)
2. Range-based                 [WARN] 1066 days ( 83.3%)
3. Consecutive-similarity      [WARN] 1190 days ( 93.0%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    753 days ( 58.8%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 159 days ( 12.4%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0007, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-02 to 2022-01-24 ( 326 days): WEAK_COLLAPSE        - std=0.0053, corr=-0.077, dir_acc=0.565
[UNI ] 2022-01-25 to 2022-02-04 (   9 days): UNIDIRECTIONAL       - std=0.0028, corr=+0.055, dir_acc=0.469
[WEAK] 2022-02-07 to 2022-03-18 (  29 days): WEAK_COLLAPSE        - std=0.0039, corr=-0.038, dir_acc=0.434
[WEAK] 2022-03-22 to 2022-04-06 (  12 days): WEAK_COLLAPSE        - std=0.0026, corr=+0.069, dir_acc=0.438
[UNI ] 2022-04-07 to 2022-07-28 (  77 days): UNIDIRECTIONAL       - std=0.0072, corr=+0.100, dir_acc=0.459
[WEAK] 2022-07-29 to 2022-08-23 (  18 days): WEAK_COLLAPSE        - std=0.0034, corr=-0.076, dir_acc=0.474
[UNI ] 2022-08-24 to 2022-10-12 (  34 days): UNIDIRECTIONAL       - std=0.0045, corr=+0.129, dir_acc=0.447
[UNI ] 2022-10-19 to 2022-12-02 (  31 days): UNIDIRECTIONAL       - std=0.0042, corr=+0.151, dir_acc=0.405
[WEAK] 2022-12-05 to 2022-12-12 (   6 days): WEAK_COLLAPSE        - std=0.0019, corr=+0.169, dir_acc=0.375
[UNI ] 2022-12-13 to 2023-02-07 (  38 days): UNIDIRECTIONAL       - std=0.0008, corr=+0.106, dir_acc=0.419
[WEAK] 2023-02-08 to 2025-10-06 ( 664 days): WEAK_COLLAPSE        - std=0.0044, corr=-0.056, dir_acc=0.556
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            0 days (  0.0%)
  UNIDIRECTIONAL:    190 days ( 14.8%)
  WEAK_COLLAPSE:    1060 days ( 82.8%)
  STRONG_COLLAPSE:     1 days (  0.1%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.25_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.190931
  RMSE:             1.091298
  MAE:              0.777958
  Out-of-sample RÂ²: -0.0120

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5218

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.25_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:04:43
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h18_drop0.25_lr5
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h18_drop0.25_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.25_lr5/checkpoints/tft-epoch=00-val_loss=0.0740.ckpt
  Validation loss: 0.073955

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.25_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.25_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.25_lr5/evaluation/evaluation_20251027_120444.log
Evaluation started at: 2025-10-27 12:04:44
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.199558
    Max: 0.242114
    Mean: 0.219458
    Std: 0.010042
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1996, max: 0.2421, mean: 0.2195
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    1 days (  0.1%)
2. Range-based                 [WARN] 1029 days ( 80.4%)
3. Consecutive-similarity      [WARN] 1187 days ( 92.7%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    679 days ( 53.0%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 130 days ( 10.2%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0009, corr=+0.000, dir_acc=0.500
[WEAK] 2020-09-30 to 2022-01-24 ( 328 days): WEAK_COLLAPSE        - std=0.0060, corr=-0.049, dir_acc=0.565
[WEAK] 2022-01-28 to 2022-03-18 (  35 days): WEAK_COLLAPSE        - std=0.0045, corr=+0.030, dir_acc=0.439
[UNI ] 2022-03-21 to 2022-07-29 (  91 days): UNIDIRECTIONAL       - std=0.0087, corr=+0.124, dir_acc=0.456
[WEAK] 2022-08-01 to 2022-08-11 (   9 days): WEAK_COLLAPSE        - std=0.0026, corr=-0.045, dir_acc=0.470
[UNI ] 2022-08-12 to 2023-02-16 ( 128 days): UNIDIRECTIONAL       - std=0.0095, corr=+0.113, dir_acc=0.426
[WEAK] 2023-02-17 to 2025-10-06 ( 657 days): WEAK_COLLAPSE        - std=0.0041, corr=-0.041, dir_acc=0.557
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            0 days (  0.0%)
  UNIDIRECTIONAL:    222 days ( 17.3%)
  WEAK_COLLAPSE:    1029 days ( 80.4%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.25_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.202539
  RMSE:             1.096604
  MAE:              0.783549
  Out-of-sample RÂ²: -0.0219

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5179

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.25_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:04:46
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h18_drop0.30_lr3
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h18_drop0.30_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.30_lr3/checkpoints/tft-epoch=01-val_loss=0.0715.ckpt
  Validation loss: 0.071549

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.30_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.30_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.30_lr3/evaluation/evaluation_20251027_120447.log
Evaluation started at: 2025-10-27 12:04:47
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.158608
    Max: 0.195595
    Mean: 0.176999
    Std: 0.009006
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1586, max: 0.1956, mean: 0.1770
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    1 days (  0.1%)
2. Range-based                 [WARN] 1078 days ( 84.2%)
3. Consecutive-similarity      [WARN] 1191 days ( 93.0%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    757 days ( 59.1%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 158 days ( 12.3%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0007, corr=+0.000, dir_acc=0.500
[WEAK] 2020-09-30 to 2022-01-24 ( 328 days): WEAK_COLLAPSE        - std=0.0049, corr=-0.078, dir_acc=0.565
[UNI ] 2022-01-25 to 2022-02-03 (   8 days): UNIDIRECTIONAL       - std=0.0023, corr=+0.054, dir_acc=0.471
[WEAK] 2022-02-04 to 2022-02-22 (  12 days): WEAK_COLLAPSE        - std=0.0013, corr=-0.080, dir_acc=0.456
[WEAK] 2022-02-24 to 2022-04-06 (  30 days): WEAK_COLLAPSE        - std=0.0063, corr=-0.000, dir_acc=0.427
[UNI ] 2022-04-07 to 2022-07-28 (  77 days): UNIDIRECTIONAL       - std=0.0069, corr=+0.091, dir_acc=0.459
[WEAK] 2022-07-29 to 2022-08-24 (  19 days): WEAK_COLLAPSE        - std=0.0035, corr=-0.083, dir_acc=0.473
[UNI ] 2022-08-25 to 2022-10-05 (  29 days): UNIDIRECTIONAL       - std=0.0036, corr=+0.128, dir_acc=0.449
[WEAK] 2022-10-06 to 2022-10-20 (  10 days): WEAK_COLLAPSE        - std=0.0025, corr=+0.163, dir_acc=0.413
[UNI ] 2022-10-21 to 2022-12-01 (  28 days): UNIDIRECTIONAL       - std=0.0036, corr=+0.151, dir_acc=0.405
[WEAK] 2022-12-02 to 2022-12-13 (   8 days): WEAK_COLLAPSE        - std=0.0024, corr=+0.146, dir_acc=0.381
[UNI ] 2022-12-14 to 2023-02-06 (  36 days): UNIDIRECTIONAL       - std=0.0009, corr=+0.105, dir_acc=0.419
[WEAK] 2023-02-07 to 2025-10-06 ( 665 days): WEAK_COLLAPSE        - std=0.0044, corr=-0.058, dir_acc=0.556
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            0 days (  0.0%)
  UNIDIRECTIONAL:    179 days ( 14.0%)
  WEAK_COLLAPSE:    1072 days ( 83.8%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.30_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.190728
  RMSE:             1.091205
  MAE:              0.777851
  Out-of-sample RÂ²: -0.0119

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5222

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.30_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:04:48
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h18_drop0.30_lr5
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h18_drop0.30_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.30_lr5/checkpoints/tft-epoch=00-val_loss=0.0764.ckpt
  Validation loss: 0.076393

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.30_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.30_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.30_lr5/evaluation/evaluation_20251027_120450.log
Evaluation started at: 2025-10-27 12:04:50
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.199230
    Max: 0.240603
    Mean: 0.219013
    Std: 0.009735
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1992, max: 0.2406, mean: 0.2190
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    1 days (  0.1%)
2. Range-based                 [WARN] 1031 days ( 80.5%)
3. Consecutive-similarity      [WARN] 1187 days ( 92.7%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    681 days ( 53.2%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 134 days ( 10.5%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0008, corr=+0.000, dir_acc=0.500
[WEAK] 2020-09-30 to 2022-01-24 ( 328 days): WEAK_COLLAPSE        - std=0.0056, corr=-0.050, dir_acc=0.565
[WEAK] 2022-01-27 to 2022-03-18 (  36 days): WEAK_COLLAPSE        - std=0.0045, corr=+0.032, dir_acc=0.439
[UNI ] 2022-03-21 to 2022-07-29 (  91 days): UNIDIRECTIONAL       - std=0.0086, corr=+0.121, dir_acc=0.456
[WEAK] 2022-08-01 to 2022-08-12 (  10 days): WEAK_COLLAPSE        - std=0.0029, corr=-0.058, dir_acc=0.470
[UNI ] 2022-08-15 to 2023-02-16 ( 127 days): UNIDIRECTIONAL       - std=0.0094, corr=+0.115, dir_acc=0.426
[WEAK] 2023-02-17 to 2025-10-06 ( 657 days): WEAK_COLLAPSE        - std=0.0041, corr=-0.041, dir_acc=0.557
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            0 days (  0.0%)
  UNIDIRECTIONAL:    220 days ( 17.2%)
  WEAK_COLLAPSE:    1031 days ( 80.5%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.30_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.202408
  RMSE:             1.096544
  MAE:              0.783494
  Out-of-sample RÂ²: -0.0218

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5187

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.30_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:04:51
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h18_drop0.35_lr3
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h18_drop0.35_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.35_lr3/checkpoints/tft-epoch=01-val_loss=0.0697.ckpt
  Validation loss: 0.069704

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.35_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.35_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.35_lr3/evaluation/evaluation_20251027_120452.log
Evaluation started at: 2025-10-27 12:04:52
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.159187
    Max: 0.195389
    Mean: 0.177584
    Std: 0.008741
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1592, max: 0.1954, mean: 0.1776
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN] 1088 days ( 85.0%)
3. Consecutive-similarity      [WARN] 1187 days ( 92.7%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    762 days ( 59.5%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 160 days ( 12.5%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0007, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2022-01-24 ( 327 days): WEAK_COLLAPSE        - std=0.0046, corr=-0.077, dir_acc=0.565
[UNI ] 2022-01-25 to 2022-02-03 (   8 days): UNIDIRECTIONAL       - std=0.0023, corr=+0.044, dir_acc=0.471
[WEAK] 2022-02-04 to 2022-02-14 (   7 days): WEAK_COLLAPSE        - std=0.0012, corr=-0.081, dir_acc=0.457
[WEAK] 2022-02-28 to 2022-03-18 (  15 days): WEAK_COLLAPSE        - std=0.0044, corr=-0.033, dir_acc=0.417
[WEAK] 2022-03-22 to 2022-04-06 (  12 days): WEAK_COLLAPSE        - std=0.0022, corr=+0.027, dir_acc=0.438
[UNI ] 2022-04-07 to 2022-07-28 (  77 days): UNIDIRECTIONAL       - std=0.0067, corr=+0.085, dir_acc=0.459
[WEAK] 2022-07-29 to 2022-08-29 (  22 days): WEAK_COLLAPSE        - std=0.0040, corr=-0.083, dir_acc=0.471
[UNI ] 2022-08-30 to 2022-10-05 (  26 days): UNIDIRECTIONAL       - std=0.0033, corr=+0.148, dir_acc=0.448
[WEAK] 2022-10-06 to 2022-10-25 (  13 days): WEAK_COLLAPSE        - std=0.0028, corr=+0.167, dir_acc=0.410
[UNI ] 2022-10-26 to 2022-11-30 (  24 days): UNIDIRECTIONAL       - std=0.0031, corr=+0.147, dir_acc=0.406
[WEAK] 2022-12-01 to 2022-12-16 (  12 days): WEAK_COLLAPSE        - std=0.0031, corr=+0.137, dir_acc=0.382
[UNI ] 2022-12-19 to 2023-02-06 (  33 days): UNIDIRECTIONAL       - std=0.0010, corr=+0.100, dir_acc=0.424
[WEAK] 2023-02-07 to 2025-10-06 ( 665 days): WEAK_COLLAPSE        - std=0.0043, corr=-0.060, dir_acc=0.556
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    173 days ( 13.5%)
  WEAK_COLLAPSE:    1077 days ( 84.1%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.35_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.190896
  RMSE:             1.091282
  MAE:              0.777937
  Out-of-sample RÂ²: -0.0120

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5222

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.35_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:04:54
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h18_drop0.35_lr5
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h18_drop0.35_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.35_lr5/checkpoints/tft-epoch=00-val_loss=0.0784.ckpt
  Validation loss: 0.078393

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.35_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.35_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.35_lr5/evaluation/evaluation_20251027_120455.log
Evaluation started at: 2025-10-27 12:04:55
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.199013
    Max: 0.239104
    Mean: 0.218394
    Std: 0.009414
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1990, max: 0.2391, mean: 0.2184
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    1 days (  0.1%)
2. Range-based                 [WARN] 1035 days ( 80.9%)
3. Consecutive-similarity      [WARN] 1189 days ( 92.9%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    682 days ( 53.3%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 135 days ( 10.5%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0008, corr=+0.000, dir_acc=0.500
[WEAK] 2020-09-30 to 2022-01-24 ( 328 days): WEAK_COLLAPSE        - std=0.0052, corr=-0.048, dir_acc=0.565
[WEAK] 2022-01-26 to 2022-03-21 (  38 days): WEAK_COLLAPSE        - std=0.0048, corr=+0.035, dir_acc=0.440
[UNI ] 2022-03-22 to 2022-07-29 (  90 days): UNIDIRECTIONAL       - std=0.0084, corr=+0.118, dir_acc=0.457
[WEAK] 2022-08-01 to 2022-08-15 (  11 days): WEAK_COLLAPSE        - std=0.0031, corr=-0.067, dir_acc=0.471
[UNI ] 2022-08-16 to 2023-02-15 ( 125 days): UNIDIRECTIONAL       - std=0.0092, corr=+0.117, dir_acc=0.425
[WEAK] 2023-02-16 to 2025-10-06 ( 658 days): WEAK_COLLAPSE        - std=0.0040, corr=-0.041, dir_acc=0.557
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            0 days (  0.0%)
  UNIDIRECTIONAL:    216 days ( 16.9%)
  WEAK_COLLAPSE:    1035 days ( 80.9%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.35_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.202228
  RMSE:             1.096462
  MAE:              0.783412
  Out-of-sample RÂ²: -0.0216

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5189

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h18_drop0.35_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:04:56
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h20_drop0.15_lr3
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h20_drop0.15_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.15_lr3/checkpoints/tft-epoch=02-val_loss=0.1697.ckpt
  Validation loss: 0.169655

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.15_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.15_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.15_lr3/evaluation/evaluation_20251027_120458.log
Evaluation started at: 2025-10-27 12:04:58
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.148865
    Max: -0.088861
    Mean: -0.119870
    Std: 0.015407
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.1489, max: -0.0889, mean: -0.1199
Negative predictions: 1280/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN] 1183 days ( 92.4%)
3. Consecutive-similarity      [WARN] 1250 days ( 97.7%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    842 days ( 65.8%)
  Directional acc < 52%                986 days ( 77.0%)
  Combined (BOTH poor)                 681 days ( 53.2%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0025, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-03-24 ( 118 days): WEAK_COLLAPSE        - std=0.0045, corr=-0.050, dir_acc=0.444
[UNI ] 2021-03-25 to 2021-06-30 (  68 days): UNIDIRECTIONAL       - std=0.0077, corr=+0.003, dir_acc=0.463
[WEAK] 2021-07-01 to 2025-10-06 (1064 days): WEAK_COLLAPSE        - std=0.0148, corr=-0.063, dir_acc=0.468
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:     68 days (  5.3%)
  WEAK_COLLAPSE:    1182 days ( 92.3%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.15_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.209536
  RMSE:             1.099789
  MAE:              0.793905
  Out-of-sample RÂ²: -0.0279

FINANCIAL METRICS:
  Directional Acc:  46.33%
  Sharpe Ratio:     0.0000
  Total Return:     0.00%
  Max Drawdown:     0.00%
  Hit Rate:         0.00%
  Number of Trades: 0

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.0000
  Recall:           0.0000
  F1 Score:         0.0000
  AUC-ROC:          0.4604

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        593               0
  Actual Up:          687               0

ALPHA (vs Buy-and-Hold):
  Excess Return:    -92.16%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.15_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:04:59
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h20_drop0.15_lr5
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h20_drop0.15_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.15_lr5/checkpoints/tft-epoch=01-val_loss=0.1696.ckpt
  Validation loss: 0.169611

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.15_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.15_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.15_lr5/evaluation/evaluation_20251027_120501.log
Evaluation started at: 2025-10-27 12:05:01
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.198550
    Max: -0.135380
    Mean: -0.168982
    Std: 0.016093
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.1985, max: -0.1354, mean: -0.1690
Negative predictions: 1280/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN] 1186 days ( 92.7%)
3. Consecutive-similarity      [WARN] 1250 days ( 97.7%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    817 days ( 63.8%)
  Directional acc < 52%                986 days ( 77.0%)
  Combined (BOTH poor)                 660 days ( 51.6%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0026, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-03-25 ( 119 days): WEAK_COLLAPSE        - std=0.0046, corr=-0.021, dir_acc=0.444
[UNI ] 2021-03-26 to 2021-06-28 (  65 days): UNIDIRECTIONAL       - std=0.0071, corr=+0.004, dir_acc=0.464
[WEAK] 2021-06-29 to 2025-10-06 (1066 days): WEAK_COLLAPSE        - std=0.0156, corr=-0.060, dir_acc=0.468
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:     65 days (  5.1%)
  WEAK_COLLAPSE:    1185 days ( 92.6%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.15_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.229317
  RMSE:             1.108746
  MAE:              0.805395
  Out-of-sample RÂ²: -0.0447

FINANCIAL METRICS:
  Directional Acc:  46.33%
  Sharpe Ratio:     0.0000
  Total Return:     0.00%
  Max Drawdown:     0.00%
  Hit Rate:         0.00%
  Number of Trades: 0

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.0000
  Recall:           0.0000
  F1 Score:         0.0000
  AUC-ROC:          0.4585

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        593               0
  Actual Up:          687               0

ALPHA (vs Buy-and-Hold):
  Excess Return:    -92.16%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.15_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:05:02
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h20_drop0.20_lr3
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h20_drop0.20_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.20_lr3/checkpoints/tft-epoch=02-val_loss=0.1701.ckpt
  Validation loss: 0.170126

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.20_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.20_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.20_lr3/evaluation/evaluation_20251027_120503.log
Evaluation started at: 2025-10-27 12:05:03
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.160287
    Max: -0.107984
    Mean: -0.136338
    Std: 0.014300
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.1603, max: -0.1080, mean: -0.1363
Negative predictions: 1280/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN] 1189 days ( 92.9%)
3. Consecutive-similarity      [WARN] 1250 days ( 97.7%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    826 days ( 64.5%)
  Directional acc < 52%                986 days ( 77.0%)
  Combined (BOTH poor)                 660 days ( 51.6%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0023, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-03-29 ( 121 days): WEAK_COLLAPSE        - std=0.0046, corr=-0.041, dir_acc=0.444
[UNI ] 2021-03-30 to 2021-06-25 (  62 days): UNIDIRECTIONAL       - std=0.0064, corr=+0.005, dir_acc=0.465
[WEAK] 2021-06-28 to 2025-10-06 (1067 days): WEAK_COLLAPSE        - std=0.0141, corr=-0.062, dir_acc=0.468
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:     62 days (  4.8%)
  WEAK_COLLAPSE:    1188 days ( 92.8%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.20_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.215480
  RMSE:             1.102488
  MAE:              0.797267
  Out-of-sample RÂ²: -0.0329

FINANCIAL METRICS:
  Directional Acc:  46.33%
  Sharpe Ratio:     0.0000
  Total Return:     0.00%
  Max Drawdown:     0.00%
  Hit Rate:         0.00%
  Number of Trades: 0

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.0000
  Recall:           0.0000
  F1 Score:         0.0000
  AUC-ROC:          0.4617

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        593               0
  Actual Up:          687               0

ALPHA (vs Buy-and-Hold):
  Excess Return:    -92.16%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.20_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:05:04
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h20_drop0.20_lr5
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h20_drop0.20_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.20_lr5/checkpoints/tft-epoch=01-val_loss=0.1715.ckpt
  Validation loss: 0.171544

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.20_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.20_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.20_lr5/evaluation/evaluation_20251027_120506.log
Evaluation started at: 2025-10-27 12:05:06
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.217367
    Max: -0.162886
    Mean: -0.193303
    Std: 0.014867
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.2174, max: -0.1629, mean: -0.1933
Negative predictions: 1280/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN] 1190 days ( 93.0%)
3. Consecutive-similarity      [WARN] 1250 days ( 97.7%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    808 days ( 63.1%)
  Directional acc < 52%                986 days ( 77.0%)
  Combined (BOTH poor)                 640 days ( 50.0%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0024, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-03-29 ( 121 days): WEAK_COLLAPSE        - std=0.0046, corr=-0.010, dir_acc=0.444
[UNI ] 2021-03-30 to 2021-06-24 (  61 days): UNIDIRECTIONAL       - std=0.0063, corr=+0.008, dir_acc=0.465
[WEAK] 2021-06-25 to 2025-10-06 (1068 days): WEAK_COLLAPSE        - std=0.0147, corr=-0.061, dir_acc=0.468
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:     61 days (  4.8%)
  WEAK_COLLAPSE:    1189 days ( 92.9%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.20_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.240750
  RMSE:             1.113890
  MAE:              0.811814
  Out-of-sample RÂ²: -0.0544

FINANCIAL METRICS:
  Directional Acc:  46.33%
  Sharpe Ratio:     0.0000
  Total Return:     0.00%
  Max Drawdown:     0.00%
  Hit Rate:         0.00%
  Number of Trades: 0

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.0000
  Recall:           0.0000
  F1 Score:         0.0000
  AUC-ROC:          0.4603

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        593               0
  Actual Up:          687               0

ALPHA (vs Buy-and-Hold):
  Excess Return:    -92.16%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.20_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:05:07
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h20_drop0.25_lr3
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h20_drop0.25_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.25_lr3/checkpoints/tft-epoch=02-val_loss=0.1715.ckpt
  Validation loss: 0.171476

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.25_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.25_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.25_lr3/evaluation/evaluation_20251027_120509.log
Evaluation started at: 2025-10-27 12:05:09
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.181101
    Max: -0.126836
    Mean: -0.157273
    Std: 0.014584
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.1811, max: -0.1268, mean: -0.1573
Negative predictions: 1280/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN] 1172 days ( 91.6%)
3. Consecutive-similarity      [WARN] 1250 days ( 97.7%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    809 days ( 63.2%)
  Directional acc < 52%                986 days ( 77.0%)
  Combined (BOTH poor)                 623 days ( 48.7%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0023, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-03-30 ( 122 days): WEAK_COLLAPSE        - std=0.0043, corr=-0.010, dir_acc=0.444
[UNI ] 2021-03-31 to 2021-06-24 (  60 days): UNIDIRECTIONAL       - std=0.0061, corr=+0.010, dir_acc=0.465
[WEAK] 2021-06-25 to 2022-11-03 ( 341 days): WEAK_COLLAPSE        - std=0.0050, corr=+0.006, dir_acc=0.494
[UNI ] 2022-11-04 to 2022-12-02 (  19 days): UNIDIRECTIONAL       - std=0.0013, corr=-0.174, dir_acc=0.591
[WEAK] 2022-12-05 to 2025-10-06 ( 708 days): WEAK_COLLAPSE        - std=0.0083, corr=-0.087, dir_acc=0.453
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:     79 days (  6.2%)
  WEAK_COLLAPSE:    1171 days ( 91.5%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.25_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.223941
  RMSE:             1.106319
  MAE:              0.801938
  Out-of-sample RÂ²: -0.0401

FINANCIAL METRICS:
  Directional Acc:  46.33%
  Sharpe Ratio:     0.0000
  Total Return:     0.00%
  Max Drawdown:     0.00%
  Hit Rate:         0.00%
  Number of Trades: 0

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.0000
  Recall:           0.0000
  F1 Score:         0.0000
  AUC-ROC:          0.4656

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        593               0
  Actual Up:          687               0

ALPHA (vs Buy-and-Hold):
  Excess Return:    -92.16%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.25_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:05:10
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h20_drop0.25_lr5
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h20_drop0.25_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.25_lr5/checkpoints/tft-epoch=02-val_loss=0.1718.ckpt
  Validation loss: 0.171803

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.25_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.25_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.25_lr5/evaluation/evaluation_20251027_120511.log
Evaluation started at: 2025-10-27 12:05:11
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.026622
    Max: 0.085191
    Mean: 0.055739
    Std: 0.013353
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0266, max: 0.0852, mean: 0.0557
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN] 1160 days ( 90.6%)
3. Consecutive-similarity      [WARN] 1238 days ( 96.7%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    926 days ( 72.3%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 346 days ( 27.0%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0018, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-04-01 ( 124 days): WEAK_COLLAPSE        - std=0.0052, corr=-0.152, dir_acc=0.556
[UNI ] 2021-04-05 to 2021-06-24 (  58 days): UNIDIRECTIONAL       - std=0.0053, corr=+0.003, dir_acc=0.534
[WEAK] 2021-06-25 to 2022-11-07 ( 343 days): WEAK_COLLAPSE        - std=0.0057, corr=-0.037, dir_acc=0.506
[UNI ] 2022-11-08 to 2022-11-23 (  11 days): UNIDIRECTIONAL       - std=0.0010, corr=-0.202, dir_acc=0.405
[WEAK] 2022-11-25 to 2025-04-25 ( 602 days): WEAK_COLLAPSE        - std=0.0076, corr=-0.096, dir_acc=0.539
[UNI ] 2025-04-28 to 2025-05-20 (  17 days): UNIDIRECTIONAL       - std=0.0023, corr=-0.224, dir_acc=0.546
[UNI ] 2025-05-22 to 2025-06-09 (  12 days): UNIDIRECTIONAL       - std=0.0008, corr=-0.239, dir_acc=0.583
[WEAK] 2025-06-10 to 2025-07-22 (  29 days): WEAK_COLLAPSE        - std=0.0017, corr=-0.184, dir_acc=0.614
[WEAK] 2025-07-30 to 2025-10-06 (  48 days): WEAK_COLLAPSE        - std=0.0016, corr=+0.005, dir_acc=0.569
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    103 days (  8.0%)
  WEAK_COLLAPSE:    1147 days ( 89.6%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.25_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.178249
  RMSE:             1.085472
  MAE:              0.773317
  Out-of-sample RÂ²: -0.0013

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4652

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.25_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:05:13
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h20_drop0.30_lr3
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h20_drop0.30_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.30_lr3/checkpoints/tft-epoch=02-val_loss=0.1731.ckpt
  Validation loss: 0.173075

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.30_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.30_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.30_lr3/evaluation/evaluation_20251027_120514.log
Evaluation started at: 2025-10-27 12:05:14
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.202824
    Max: -0.145395
    Mean: -0.178424
    Std: 0.015359
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.2028, max: -0.1454, mean: -0.1784
Negative predictions: 1280/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN] 1156 days ( 90.3%)
3. Consecutive-similarity      [WARN] 1250 days ( 97.7%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    800 days ( 62.5%)
  Directional acc < 52%                986 days ( 77.0%)
  Combined (BOTH poor)                 606 days ( 47.3%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0021, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-04-05 ( 125 days): WEAK_COLLAPSE        - std=0.0045, corr=+0.001, dir_acc=0.444
[UNI ] 2021-04-06 to 2021-06-18 (  53 days): UNIDIRECTIONAL       - std=0.0053, corr=+0.018, dir_acc=0.466
[WEAK] 2021-06-21 to 2022-10-20 ( 335 days): WEAK_COLLAPSE        - std=0.0061, corr=+0.005, dir_acc=0.490
[UNI ] 2022-10-21 to 2022-12-21 (  42 days): UNIDIRECTIONAL       - std=0.0033, corr=-0.165, dir_acc=0.603
[WEAK] 2022-12-22 to 2025-10-06 ( 695 days): WEAK_COLLAPSE        - std=0.0078, corr=-0.084, dir_acc=0.450
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:     95 days (  7.4%)
  WEAK_COLLAPSE:    1155 days ( 90.2%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.30_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.233445
  RMSE:             1.110606
  MAE:              0.807346
  Out-of-sample RÂ²: -0.0482

FINANCIAL METRICS:
  Directional Acc:  46.33%
  Sharpe Ratio:     0.0000
  Total Return:     0.00%
  Max Drawdown:     0.00%
  Hit Rate:         0.00%
  Number of Trades: 0

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.0000
  Recall:           0.0000
  F1 Score:         0.0000
  AUC-ROC:          0.4685

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        593               0
  Actual Up:          687               0

ALPHA (vs Buy-and-Hold):
  Excess Return:    -92.16%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.30_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:05:15
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h20_drop0.30_lr5
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h20_drop0.30_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.30_lr5/checkpoints/tft-epoch=02-val_loss=0.1727.ckpt
  Validation loss: 0.172741

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.30_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.30_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.30_lr5/evaluation/evaluation_20251027_120517.log
Evaluation started at: 2025-10-27 12:05:17
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.016944
    Max: 0.083104
    Mean: 0.048409
    Std: 0.015221
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0169, max: 0.0831, mean: 0.0484
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN] 1132 days ( 88.4%)
3. Consecutive-similarity      [WARN] 1235 days ( 96.5%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    907 days ( 70.9%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 338 days ( 26.4%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0018, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-04-01 ( 124 days): WEAK_COLLAPSE        - std=0.0047, corr=-0.126, dir_acc=0.556
[UNI ] 2021-04-05 to 2021-06-25 (  59 days): UNIDIRECTIONAL       - std=0.0057, corr=+0.001, dir_acc=0.534
[WEAK] 2021-06-28 to 2022-02-14 ( 159 days): WEAK_COLLAPSE        - std=0.0052, corr=+0.015, dir_acc=0.573
[UNI ] 2022-02-15 to 2022-02-23 (   6 days): UNIDIRECTIONAL       - std=0.0003, corr=+0.000, dir_acc=0.450
[WEAK] 2022-02-24 to 2022-10-19 ( 164 days): WEAK_COLLAPSE        - std=0.0049, corr=-0.074, dir_acc=0.451
[UNI ] 2022-10-20 to 2022-12-06 (  32 days): UNIDIRECTIONAL       - std=0.0023, corr=-0.171, dir_acc=0.405
[WEAK] 2022-12-07 to 2025-04-28 ( 595 days): WEAK_COLLAPSE        - std=0.0077, corr=-0.090, dir_acc=0.541
[UNI ] 2025-04-29 to 2025-06-09 (  29 days): UNIDIRECTIONAL       - std=0.0046, corr=-0.227, dir_acc=0.564
[WEAK] 2025-06-10 to 2025-07-22 (  29 days): WEAK_COLLAPSE        - std=0.0019, corr=-0.175, dir_acc=0.614
[WEAK] 2025-07-30 to 2025-10-06 (  48 days): WEAK_COLLAPSE        - std=0.0018, corr=-0.007, dir_acc=0.569
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    131 days ( 10.2%)
  WEAK_COLLAPSE:    1119 days ( 87.4%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.30_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.178367
  RMSE:             1.085526
  MAE:              0.773435
  Out-of-sample RÂ²: -0.0014

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4679

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.30_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:05:18
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h20_drop0.35_lr3
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h20_drop0.35_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.35_lr3/checkpoints/tft-epoch=03-val_loss=0.1762.ckpt
  Validation loss: 0.176180

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.35_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.35_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.35_lr3/evaluation/evaluation_20251027_120519.log
Evaluation started at: 2025-10-27 12:05:19
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.020558
    Max: 0.039931
    Mean: 0.005847
    Std: 0.014793
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0206, max: 0.0399, mean: 0.0058
Negative predictions: 588/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN] 1146 days ( 89.5%)
3. Consecutive-similarity      [WARN] 1250 days ( 97.7%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    868 days ( 67.8%)
  Directional acc < 52%                943 days ( 73.7%)
  Combined (BOTH poor)                 746 days ( 58.3%)
  Unidirectional (>98%)        [WARN]  1046 days ( 81.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0023, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-03-29 ( 121 days): WEAK_COLLAPSE        - std=0.0041, corr=-0.066, dir_acc=0.493
[DEGD] 2021-03-30 to 2021-04-19 (  14 days): DEGRADED             - std=0.0023, corr=+0.099, dir_acc=0.544
[UNI ] 2021-04-20 to 2021-06-25 (  48 days): UNIDIRECTIONAL       - std=0.0042, corr=-0.022, dir_acc=0.532
[WEAK] 2021-06-28 to 2022-10-18 ( 328 days): WEAK_COLLAPSE        - std=0.0066, corr=-0.015, dir_acc=0.510
[UNI ] 2022-10-19 to 2022-12-20 (  43 days): UNIDIRECTIONAL       - std=0.0028, corr=-0.170, dir_acc=0.397
[WEAK] 2022-12-21 to 2025-10-06 ( 696 days): WEAK_COLLAPSE        - std=0.0064, corr=-0.079, dir_acc=0.450
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:           15 days (  1.2%)
  UNIDIRECTIONAL:     91 days (  7.1%)
  WEAK_COLLAPSE:    1145 days ( 89.5%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.35_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.180729
  RMSE:             1.086613
  MAE:              0.775546
  Out-of-sample RÂ²: -0.0034

FINANCIAL METRICS:
  Directional Acc:  46.95%
  Sharpe Ratio:     0.2882
  Total Return:     16.50%
  Max Drawdown:     -25.25%
  Hit Rate:         27.34%
  Number of Trades: 692

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5058
  Recall:           0.5095
  F1 Score:         0.5076
  AUC-ROC:          0.4687

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        251             342
  Actual Up:          337             350

ALPHA (vs Buy-and-Hold):
  Excess Return:    -75.66%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.35_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:05:21
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h20_drop0.35_lr5
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h20_drop0.35_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.35_lr5/checkpoints/tft-epoch=02-val_loss=0.1713.ckpt
  Validation loss: 0.171344

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.35_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.35_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.35_lr5/evaluation/evaluation_20251027_120522.log
Evaluation started at: 2025-10-27 12:05:22
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.020276
    Max: 0.081861
    Mean: 0.047605
    Std: 0.014836
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0203, max: 0.0819, mean: 0.0476
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN] 1168 days ( 91.2%)
3. Consecutive-similarity      [WARN] 1250 days ( 97.7%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    881 days ( 68.8%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 332 days ( 25.9%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0020, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-04-06 ( 126 days): WEAK_COLLAPSE        - std=0.0044, corr=-0.074, dir_acc=0.556
[UNI ] 2021-04-07 to 2021-04-20 (  10 days): UNIDIRECTIONAL       - std=0.0010, corr=+0.114, dir_acc=0.543
[UNI ] 2021-04-23 to 2021-06-17 (  39 days): UNIDIRECTIONAL       - std=0.0030, corr=-0.008, dir_acc=0.531
[WEAK] 2021-06-18 to 2022-10-18 ( 334 days): WEAK_COLLAPSE        - std=0.0075, corr=-0.021, dir_acc=0.511
[UNI ] 2022-10-19 to 2022-12-07 (  34 days): UNIDIRECTIONAL       - std=0.0022, corr=-0.171, dir_acc=0.403
[WEAK] 2022-12-08 to 2025-10-06 ( 705 days): WEAK_COLLAPSE        - std=0.0065, corr=-0.090, dir_acc=0.548
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:     83 days (  6.5%)
  WEAK_COLLAPSE:    1167 days ( 91.2%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.35_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.178194
  RMSE:             1.085446
  MAE:              0.773318
  Out-of-sample RÂ²: -0.0012

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4695

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h20_drop0.35_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:05:23
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h22_drop0.15_lr3
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h22_drop0.15_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.15_lr3/checkpoints/tft-epoch=02-val_loss=0.1253.ckpt
  Validation loss: 0.125342

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.15_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.15_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.15_lr3/evaluation/evaluation_20251027_120525.log
Evaluation started at: 2025-10-27 12:05:25
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.025137
    Max: 0.114258
    Mean: 0.045279
    Std: 0.039080
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0251, max: 0.1143, mean: 0.0453
Negative predictions: 232/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  308 days ( 24.1%)
3. Consecutive-similarity      [WARN]  203 days ( 15.9%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    794 days ( 62.0%)
  Directional acc < 52%                704 days ( 55.0%)
  Combined (BOTH poor)                 370 days ( 28.9%)
  Unidirectional (>98%)        [WARN]  1000 days ( 78.1%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0032, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-03-25 ( 119 days): WEAK_COLLAPSE        - std=0.0047, corr=+0.064, dir_acc=0.444
[UNI ] 2021-03-26 to 2021-04-14 (  13 days): UNIDIRECTIONAL       - std=0.0060, corr=+0.016, dir_acc=0.453
[DEGD] 2021-05-10 to 2021-07-01 (  38 days): DEGRADED             - std=0.0057, corr=-0.145, dir_acc=0.469
[WEAK] 2021-07-02 to 2021-09-29 (  62 days): WEAK_COLLAPSE        - std=0.0046, corr=-0.047, dir_acc=0.572
[DEGD] 2021-09-30 to 2021-10-08 (   7 days): DEGRADED             - std=0.0024, corr=-0.008, dir_acc=0.521
[DEGD] 2021-10-14 to 2022-01-24 (  69 days): DEGRADED             - std=0.0066, corr=-0.151, dir_acc=0.467
[DEGD] 2022-01-31 to 2022-03-08 (  26 days): DEGRADED             - std=0.0067, corr=-0.037, dir_acc=0.431
[ OK ] 2022-03-15 to 2022-04-21 (  27 days): HEALTHY              - std=0.0033, corr=+0.136, dir_acc=0.464
[ OK ] 2022-04-26 to 2022-05-09 (  10 days): HEALTHY              - std=0.0043, corr=+0.050, dir_acc=0.485
[UNI ] 2022-05-11 to 2022-09-16 (  89 days): UNIDIRECTIONAL       - std=0.0032, corr=+0.134, dir_acc=0.465
[UNI ] 2022-09-26 to 2025-10-06 ( 755 days): UNIDIRECTIONAL       - std=0.0236, corr=-0.066, dir_acc=0.539
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            79 days (  6.2%)
  DEGRADED:          158 days ( 12.3%)
  UNIDIRECTIONAL:    857 days ( 67.0%)
  WEAK_COLLAPSE:     186 days ( 14.5%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1201 days (93.8%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.15_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.178258
  RMSE:             1.085476
  MAE:              0.773862
  Out-of-sample RÂ²: -0.0013

FINANCIAL METRICS:
  Directional Acc:  51.48%
  Sharpe Ratio:     0.5900
  Total Return:     50.46%
  Max Drawdown:     -23.66%
  Hit Rate:         43.52%
  Number of Trades: 1048

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5315
  Recall:           0.8108
  F1 Score:         0.6421
  AUC-ROC:          0.5071

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        102             491
  Actual Up:          130             557

ALPHA (vs Buy-and-Hold):
  Excess Return:    -41.70%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.15_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:05:26
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h22_drop0.15_lr5
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h22_drop0.15_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.15_lr5/checkpoints/tft-epoch=01-val_loss=0.1330.ckpt
  Validation loss: 0.132995

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.15_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.15_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.15_lr5/evaluation/evaluation_20251027_120527.log
Evaluation started at: 2025-10-27 12:05:27
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.061842
    Max: 0.083589
    Mean: 0.012875
    Std: 0.040691
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0618, max: 0.0836, mean: 0.0129
Negative predictions: 441/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  298 days ( 23.3%)
3. Consecutive-similarity      [WARN]  188 days ( 14.7%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    757 days ( 59.1%)
  Directional acc < 52%                680 days ( 53.1%)
  Combined (BOTH poor)                 380 days ( 29.7%)
  Unidirectional (>98%)        [WARN]  1103 days ( 86.2%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0029, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-03-22 ( 116 days): WEAK_COLLAPSE        - std=0.0052, corr=+0.108, dir_acc=0.444
[UNI ] 2021-03-23 to 2021-07-02 (  72 days): UNIDIRECTIONAL       - std=0.0086, corr=-0.077, dir_acc=0.462
[WEAK] 2021-07-06 to 2021-09-28 (  60 days): WEAK_COLLAPSE        - std=0.0043, corr=-0.050, dir_acc=0.413
[UNI ] 2021-09-29 to 2022-05-09 ( 152 days): UNIDIRECTIONAL       - std=0.0135, corr=-0.040, dir_acc=0.483
[ OK ] 2022-05-10 to 2022-05-17 (   6 days): HEALTHY              - std=0.0010, corr=+0.005, dir_acc=0.539
[ OK ] 2022-05-26 to 2022-07-25 (  40 days): HEALTHY              - std=0.0044, corr=+0.119, dir_acc=0.516
[DEGD] 2022-07-26 to 2022-09-02 (  29 days): DEGRADED             - std=0.0017, corr=+0.248, dir_acc=0.502
[UNI ] 2022-09-06 to 2022-09-16 (   9 days): UNIDIRECTIONAL       - std=0.0008, corr=+0.096, dir_acc=0.470
[UNI ] 2022-09-23 to 2025-04-29 ( 646 days): UNIDIRECTIONAL       - std=0.0240, corr=-0.053, dir_acc=0.532
[DEGD] 2025-04-30 to 2025-05-16 (  13 days): DEGRADED             - std=0.0034, corr=-0.077, dir_acc=0.494
[ OK ] 2025-06-02 to 2025-08-04 (  44 days): HEALTHY              - std=0.0095, corr=-0.084, dir_acc=0.579
[UNI ] 2025-08-05 to 2025-10-06 (  44 days): UNIDIRECTIONAL       - std=0.0052, corr=-0.176, dir_acc=0.567
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           124 days (  9.7%)
  DEGRADED:           53 days (  4.1%)
  UNIDIRECTIONAL:    923 days ( 72.1%)
  WEAK_COLLAPSE:     180 days ( 14.1%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1156 days (90.3%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.15_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.180155
  RMSE:             1.086349
  MAE:              0.774937
  Out-of-sample RÂ²: -0.0029

FINANCIAL METRICS:
  Directional Acc:  51.09%
  Sharpe Ratio:     0.7824
  Total Return:     66.51%
  Max Drawdown:     -20.31%
  Hit Rate:         35.16%
  Number of Trades: 839

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5364
  Recall:           0.6550
  F1 Score:         0.5898
  AUC-ROC:          0.5066

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        204             389
  Actual Up:          237             450

ALPHA (vs Buy-and-Hold):
  Excess Return:    -25.65%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.15_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:05:29
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h22_drop0.20_lr3
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h22_drop0.20_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.20_lr3/checkpoints/tft-epoch=02-val_loss=0.1255.ckpt
  Validation loss: 0.125482

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.20_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.20_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.20_lr3/evaluation/evaluation_20251027_120530.log
Evaluation started at: 2025-10-27 12:05:30
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.020417
    Max: 0.118852
    Mean: 0.050229
    Std: 0.039384
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0204, max: 0.1189, mean: 0.0502
Negative predictions: 171/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  327 days ( 25.5%)
3. Consecutive-similarity      [WARN]  214 days ( 16.7%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    796 days ( 62.2%)
  Directional acc < 52%                680 days ( 53.1%)
  Combined (BOTH poor)                 366 days ( 28.6%)
  Unidirectional (>98%)        [WARN]  1008 days ( 78.8%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0031, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-03-26 ( 120 days): WEAK_COLLAPSE        - std=0.0045, corr=+0.062, dir_acc=0.474
[UNI ] 2021-03-29 to 2021-04-09 (   9 days): UNIDIRECTIONAL       - std=0.0042, corr=+0.009, dir_acc=0.457
[ OK ] 2021-04-12 to 2021-04-19 (   6 days): HEALTHY              - std=0.0018, corr=+0.050, dir_acc=0.469
[DEGD] 2021-05-10 to 2021-07-01 (  38 days): DEGRADED             - std=0.0057, corr=-0.145, dir_acc=0.479
[WEAK] 2021-07-02 to 2021-09-28 (  61 days): WEAK_COLLAPSE        - std=0.0044, corr=-0.043, dir_acc=0.578
[DEGD] 2021-09-30 to 2021-10-08 (   7 days): DEGRADED             - std=0.0024, corr=-0.006, dir_acc=0.521
[DEGD] 2021-10-14 to 2022-01-24 (  69 days): DEGRADED             - std=0.0067, corr=-0.152, dir_acc=0.481
[DEGD] 2022-01-31 to 2022-03-08 (  26 days): DEGRADED             - std=0.0065, corr=-0.046, dir_acc=0.446
[ OK ] 2022-03-15 to 2022-04-21 (  27 days): HEALTHY              - std=0.0033, corr=+0.133, dir_acc=0.467
[ OK ] 2022-04-26 to 2022-05-03 (   6 days): HEALTHY              - std=0.0041, corr=+0.037, dir_acc=0.458
[UNI ] 2022-05-04 to 2022-08-18 (  74 days): UNIDIRECTIONAL       - std=0.0036, corr=+0.114, dir_acc=0.464
[UNI ] 2022-08-22 to 2022-09-15 (  18 days): UNIDIRECTIONAL       - std=0.0022, corr=+0.182, dir_acc=0.458
[WEAK] 2022-09-16 to 2022-09-26 (   7 days): WEAK_COLLAPSE        - std=0.0025, corr=+0.068, dir_acc=0.455
[UNI ] 2022-09-27 to 2024-03-20 ( 369 days): UNIDIRECTIONAL       - std=0.0248, corr=-0.039, dir_acc=0.509
[UNI ] 2024-03-22 to 2025-10-06 ( 384 days): UNIDIRECTIONAL       - std=0.0220, corr=-0.094, dir_acc=0.567
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            78 days (  6.1%)
  DEGRADED:          157 days ( 12.3%)
  UNIDIRECTIONAL:    855 days ( 66.8%)
  WEAK_COLLAPSE:     190 days ( 14.8%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1202 days (93.9%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.20_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.178208
  RMSE:             1.085453
  MAE:              0.773794
  Out-of-sample RÂ²: -0.0012

FINANCIAL METRICS:
  Directional Acc:  52.03%
  Sharpe Ratio:     0.6586
  Total Return:     60.25%
  Max Drawdown:     -22.99%
  Hit Rate:         46.17%
  Number of Trades: 1109

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5329
  Recall:           0.8603
  F1 Score:         0.6581
  AUC-ROC:          0.5074

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:         75             518
  Actual Up:           96             591

ALPHA (vs Buy-and-Hold):
  Excess Return:    -31.91%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.20_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:05:31
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h22_drop0.20_lr5
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h22_drop0.20_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.20_lr5/checkpoints/tft-epoch=01-val_loss=0.1373.ckpt
  Validation loss: 0.137295

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.20_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.20_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.20_lr5/evaluation/evaluation_20251027_120533.log
Evaluation started at: 2025-10-27 12:05:33
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.050565
    Max: 0.094128
    Mean: 0.023874
    Std: 0.040735
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0506, max: 0.0941, mean: 0.0239
Negative predictions: 401/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  302 days ( 23.6%)
3. Consecutive-similarity      [WARN]  198 days ( 15.5%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    769 days ( 60.1%)
  Directional acc < 52%                717 days ( 56.0%)
  Combined (BOTH poor)                 388 days ( 30.3%)
  Unidirectional (>98%)        [WARN]  1160 days ( 90.6%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0029, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-03-24 ( 118 days): WEAK_COLLAPSE        - std=0.0052, corr=+0.097, dir_acc=0.444
[UNI ] 2021-03-25 to 2021-07-01 (  69 days): UNIDIRECTIONAL       - std=0.0079, corr=-0.081, dir_acc=0.463
[WEAK] 2021-07-02 to 2021-09-28 (  61 days): WEAK_COLLAPSE        - std=0.0044, corr=-0.045, dir_acc=0.413
[UNI ] 2021-09-29 to 2022-03-10 ( 111 days): UNIDIRECTIONAL       - std=0.0083, corr=-0.096, dir_acc=0.455
[ OK ] 2022-03-11 to 2022-04-21 (  29 days): HEALTHY              - std=0.0030, corr=+0.132, dir_acc=0.543
[ OK ] 2022-04-26 to 2022-05-09 (  10 days): HEALTHY              - std=0.0047, corr=+0.065, dir_acc=0.518
[ OK ] 2022-05-26 to 2022-07-20 (  37 days): HEALTHY              - std=0.0042, corr=+0.113, dir_acc=0.478
[UNI ] 2022-07-21 to 2022-09-16 (  41 days): UNIDIRECTIONAL       - std=0.0020, corr=+0.211, dir_acc=0.469
[UNI ] 2022-09-26 to 2025-10-06 ( 755 days): UNIDIRECTIONAL       - std=0.0235, corr=-0.065, dir_acc=0.539
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           109 days (  8.5%)
  DEGRADED:           11 days (  0.9%)
  UNIDIRECTIONAL:    976 days ( 76.2%)
  WEAK_COLLAPSE:     184 days ( 14.4%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1171 days (91.5%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.20_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.179300
  RMSE:             1.085956
  MAE:              0.774446
  Out-of-sample RÂ²: -0.0022

FINANCIAL METRICS:
  Directional Acc:  50.94%
  Sharpe Ratio:     0.6666
  Total Return:     55.88%
  Max Drawdown:     -18.90%
  Hit Rate:         36.64%
  Number of Trades: 879

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5336
  Recall:           0.6827
  F1 Score:         0.5990
  AUC-ROC:          0.5072

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        183             410
  Actual Up:          218             469

ALPHA (vs Buy-and-Hold):
  Excess Return:    -36.28%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.20_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:05:34
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h22_drop0.25_lr3
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h22_drop0.25_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.25_lr3/checkpoints/tft-epoch=02-val_loss=0.1241.ckpt
  Validation loss: 0.124112

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.25_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.25_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.25_lr3/evaluation/evaluation_20251027_120535.log
Evaluation started at: 2025-10-27 12:05:35
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.012448
    Max: 0.128583
    Mean: 0.059855
    Std: 0.040096
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0124, max: 0.1286, mean: 0.0599
Negative predictions: 81/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  348 days ( 27.2%)
3. Consecutive-similarity      [WARN]  221 days ( 17.3%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    780 days ( 60.9%)
  Directional acc < 52%                561 days ( 43.8%)
  Combined (BOTH poor)                 262 days ( 20.5%)
  Unidirectional (>98%)        [WARN]  1038 days ( 81.1%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0027, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-03-25 ( 119 days): WEAK_COLLAPSE        - std=0.0045, corr=+0.098, dir_acc=0.503
[UNI ] 2021-03-26 to 2021-04-05 (   6 days): UNIDIRECTIONAL       - std=0.0021, corr=-0.002, dir_acc=0.453
[ OK ] 2021-04-09 to 2021-04-19 (   7 days): HEALTHY              - std=0.0023, corr=+0.058, dir_acc=0.502
[ OK ] 2021-05-03 to 2021-05-14 (  10 days): HEALTHY              - std=0.0022, corr=-0.039, dir_acc=0.542
[DEGD] 2021-05-17 to 2021-06-07 (  15 days): DEGRADED             - std=0.0014, corr=-0.120, dir_acc=0.504
[ OK ] 2021-06-08 to 2021-06-16 (   7 days): HEALTHY              - std=0.0027, corr=-0.135, dir_acc=0.538
[WEAK] 2021-07-01 to 2021-09-29 (  63 days): WEAK_COLLAPSE        - std=0.0046, corr=-0.042, dir_acc=0.586
[ OK ] 2021-10-12 to 2022-01-05 (  59 days): HEALTHY              - std=0.0074, corr=-0.158, dir_acc=0.583
[UNI ] 2022-01-06 to 2022-08-18 ( 155 days): UNIDIRECTIONAL       - std=0.0151, corr=+0.068, dir_acc=0.461
[UNI ] 2022-08-22 to 2022-09-15 (  18 days): UNIDIRECTIONAL       - std=0.0022, corr=+0.181, dir_acc=0.458
[WEAK] 2022-09-16 to 2022-09-26 (   7 days): WEAK_COLLAPSE        - std=0.0025, corr=+0.064, dir_acc=0.455
[UNI ] 2022-09-27 to 2024-03-20 ( 369 days): UNIDIRECTIONAL       - std=0.0246, corr=-0.039, dir_acc=0.509
[UNI ] 2024-03-22 to 2025-10-06 ( 384 days): UNIDIRECTIONAL       - std=0.0216, corr=-0.093, dir_acc=0.567
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           115 days (  9.0%)
  DEGRADED:           34 days (  2.7%)
  UNIDIRECTIONAL:    940 days ( 73.4%)
  WEAK_COLLAPSE:     191 days ( 14.9%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1165 days (91.0%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.25_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.178211
  RMSE:             1.085454
  MAE:              0.773739
  Out-of-sample RÂ²: -0.0012

FINANCIAL METRICS:
  Directional Acc:  52.97%
  Sharpe Ratio:     0.7162
  Total Return:     71.45%
  Max Drawdown:     -25.25%
  Hit Rate:         50.16%
  Number of Trades: 1199

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5354
  Recall:           0.9345
  F1 Score:         0.6808
  AUC-ROC:          0.5073

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:         36             557
  Actual Up:           45             642

ALPHA (vs Buy-and-Hold):
  Excess Return:    -20.71%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.25_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:05:36
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h22_drop0.25_lr5
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h22_drop0.25_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.25_lr5/checkpoints/tft-epoch=02-val_loss=0.1447.ckpt
  Validation loss: 0.144690

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.25_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.25_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.25_lr5/evaluation/evaluation_20251027_120538.log
Evaluation started at: 2025-10-27 12:05:38
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.023078
    Max: 0.088477
    Mean: 0.032312
    Std: 0.033228
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0231, max: 0.0885, mean: 0.0323
Negative predictions: 254/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  578 days ( 45.2%)
3. Consecutive-similarity      [WARN]  471 days ( 36.8%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    851 days ( 66.5%)
  Directional acc < 52%                712 days ( 55.6%)
  Combined (BOTH poor)                 422 days ( 33.0%)
  Unidirectional (>98%)        [WARN]   972 days ( 75.9%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0024, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-04-09 ( 129 days): WEAK_COLLAPSE        - std=0.0033, corr=+0.020, dir_acc=0.444
[ OK ] 2021-04-16 to 2021-04-26 (   7 days): HEALTHY              - std=0.0013, corr=+0.048, dir_acc=0.476
[DEGD] 2021-04-30 to 2021-06-25 (  40 days): DEGRADED             - std=0.0042, corr=-0.113, dir_acc=0.486
[WEAK] 2021-06-28 to 2021-09-30 (  67 days): WEAK_COLLAPSE        - std=0.0046, corr=-0.042, dir_acc=0.567
[DEGD] 2021-10-01 to 2022-02-24 (  99 days): DEGRADED             - std=0.0068, corr=-0.138, dir_acc=0.468
[WEAK] 2022-03-04 to 2022-03-16 (   9 days): WEAK_COLLAPSE        - std=0.0014, corr=-0.119, dir_acc=0.465
[DEGD] 2022-03-22 to 2022-04-04 (  10 days): DEGRADED             - std=0.0037, corr=+0.113, dir_acc=0.478
[ OK ] 2022-04-05 to 2022-04-20 (  11 days): HEALTHY              - std=0.0008, corr=+0.047, dir_acc=0.488
[DEGD] 2022-05-09 to 2022-05-24 (  12 days): DEGRADED             - std=0.0011, corr=-0.086, dir_acc=0.464
[UNI ] 2022-05-25 to 2022-06-15 (  15 days): UNIDIRECTIONAL       - std=0.0015, corr=-0.066, dir_acc=0.468
[UNI ] 2022-06-23 to 2022-07-20 (  19 days): UNIDIRECTIONAL       - std=0.0028, corr=+0.165, dir_acc=0.452
[WEAK] 2022-07-28 to 2023-02-07 ( 132 days): WEAK_COLLAPSE        - std=0.0044, corr=+0.139, dir_acc=0.429
[UNI ] 2023-02-28 to 2023-09-21 ( 143 days): UNIDIRECTIONAL       - std=0.0201, corr=-0.096, dir_acc=0.527
[UNI ] 2023-09-25 to 2024-02-16 ( 100 days): UNIDIRECTIONAL       - std=0.0091, corr=-0.145, dir_acc=0.559
[WEAK] 2024-02-20 to 2024-04-22 (  44 days): WEAK_COLLAPSE        - std=0.0028, corr=+0.121, dir_acc=0.578
[UNI ] 2024-04-23 to 2024-07-22 (  62 days): UNIDIRECTIONAL       - std=0.0066, corr=-0.104, dir_acc=0.554
[WEAK] 2024-07-23 to 2024-08-02 (   9 days): WEAK_COLLAPSE        - std=0.0010, corr=+0.029, dir_acc=0.630
[UNI ] 2024-08-05 to 2025-10-06 ( 292 days): UNIDIRECTIONAL       - std=0.0166, corr=-0.125, dir_acc=0.569
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            53 days (  4.1%)
  DEGRADED:          175 days ( 13.7%)
  UNIDIRECTIONAL:    642 days ( 50.2%)
  WEAK_COLLAPSE:     410 days ( 32.0%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1227 days (95.9%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.25_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.178566
  RMSE:             1.085618
  MAE:              0.773860
  Out-of-sample RÂ²: -0.0015

FINANCIAL METRICS:
  Directional Acc:  51.64%
  Sharpe Ratio:     0.5427
  Total Return:     44.41%
  Max Drawdown:     -26.70%
  Hit Rate:         42.73%
  Number of Trades: 1026

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5331
  Recall:           0.7962
  F1 Score:         0.6386
  AUC-ROC:          0.5070

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        114             479
  Actual Up:          140             547

ALPHA (vs Buy-and-Hold):
  Excess Return:    -47.75%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.25_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:05:39
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h22_drop0.30_lr3
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h22_drop0.30_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.30_lr3/checkpoints/tft-epoch=02-val_loss=0.1321.ckpt
  Validation loss: 0.132056

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.30_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.30_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.30_lr3/evaluation/evaluation_20251027_120541.log
Evaluation started at: 2025-10-27 12:05:41
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.015240
    Max: 0.127793
    Mean: 0.058820
    Std: 0.040719
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0152, max: 0.1278, mean: 0.0588
Negative predictions: 136/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  355 days ( 27.7%)
3. Consecutive-similarity      [WARN]  229 days ( 17.9%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    788 days ( 61.6%)
  Directional acc < 52%                557 days ( 43.5%)
  Combined (BOTH poor)                 279 days ( 21.8%)
  Unidirectional (>98%)        [WARN]  1046 days ( 81.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0027, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-03-22 ( 116 days): WEAK_COLLAPSE        - std=0.0044, corr=+0.106, dir_acc=0.538
[UNI ] 2021-03-23 to 2021-04-06 (  10 days): UNIDIRECTIONAL       - std=0.0033, corr=+0.001, dir_acc=0.448
[ OK ] 2021-04-09 to 2021-04-21 (   9 days): HEALTHY              - std=0.0034, corr=+0.056, dir_acc=0.487
[DEGD] 2021-05-12 to 2021-06-10 (  21 days): DEGRADED             - std=0.0022, corr=-0.109, dir_acc=0.496
[DEGD] 2021-06-15 to 2021-06-25 (   9 days): DEGRADED             - std=0.0012, corr=-0.258, dir_acc=0.506
[WEAK] 2021-07-01 to 2021-09-29 (  63 days): WEAK_COLLAPSE        - std=0.0047, corr=-0.044, dir_acc=0.586
[ OK ] 2021-10-08 to 2022-01-06 (  61 days): HEALTHY              - std=0.0076, corr=-0.156, dir_acc=0.581
[UNI ] 2022-01-07 to 2022-08-17 ( 153 days): UNIDIRECTIONAL       - std=0.0147, corr=+0.063, dir_acc=0.460
[UNI ] 2022-08-22 to 2022-09-15 (  18 days): UNIDIRECTIONAL       - std=0.0020, corr=+0.161, dir_acc=0.458
[WEAK] 2022-09-16 to 2022-09-27 (   8 days): WEAK_COLLAPSE        - std=0.0025, corr=+0.033, dir_acc=0.452
[UNI ] 2022-09-28 to 2022-12-20 (  57 days): UNIDIRECTIONAL       - std=0.0054, corr=+0.166, dir_acc=0.402
[UNI ] 2022-12-22 to 2024-03-20 ( 310 days): UNIDIRECTIONAL       - std=0.0245, corr=-0.079, dir_acc=0.530
[UNI ] 2024-03-22 to 2025-10-06 ( 384 days): UNIDIRECTIONAL       - std=0.0216, corr=-0.093, dir_acc=0.567
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           109 days (  8.5%)
  DEGRADED:           42 days (  3.3%)
  UNIDIRECTIONAL:    938 days ( 73.3%)
  WEAK_COLLAPSE:     191 days ( 14.9%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1171 days (91.5%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.30_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.178324
  RMSE:             1.085506
  MAE:              0.773784
  Out-of-sample RÂ²: -0.0013

FINANCIAL METRICS:
  Directional Acc:  53.20%
  Sharpe Ratio:     0.7761
  Total Return:     78.66%
  Max Drawdown:     -25.25%
  Hit Rate:         48.12%
  Number of Trades: 1144

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5385
  Recall:           0.8967
  F1 Score:         0.6729
  AUC-ROC:          0.5077

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:         65             528
  Actual Up:           71             616

ALPHA (vs Buy-and-Hold):
  Excess Return:    -13.50%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.30_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:05:42
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h22_drop0.30_lr5
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h22_drop0.30_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.30_lr5/checkpoints/tft-epoch=02-val_loss=0.1429.ckpt
  Validation loss: 0.142863

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.30_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.30_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.30_lr5/evaluation/evaluation_20251027_120543.log
Evaluation started at: 2025-10-27 12:05:43
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.014349
    Max: 0.095595
    Mean: 0.041062
    Std: 0.032774
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0143, max: 0.0956, mean: 0.0411
Negative predictions: 166/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  602 days ( 47.0%)
3. Consecutive-similarity      [WARN]  590 days ( 46.1%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    857 days ( 67.0%)
  Directional acc < 52%                662 days ( 51.7%)
  Combined (BOTH poor)                 387 days ( 30.2%)
  Unidirectional (>98%)        [WARN]  1125 days ( 87.9%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0022, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-04-09 ( 129 days): WEAK_COLLAPSE        - std=0.0033, corr=+0.018, dir_acc=0.445
[ OK ] 2021-04-12 to 2021-04-26 (  11 days): HEALTHY              - std=0.0022, corr=+0.065, dir_acc=0.488
[DEGD] 2021-04-30 to 2021-06-25 (  40 days): DEGRADED             - std=0.0041, corr=-0.113, dir_acc=0.506
[WEAK] 2021-06-28 to 2021-09-30 (  67 days): WEAK_COLLAPSE        - std=0.0045, corr=-0.042, dir_acc=0.583
[DEGD] 2021-10-04 to 2021-10-20 (  12 days): DEGRADED             - std=0.0025, corr=-0.097, dir_acc=0.510
[WEAK] 2021-10-21 to 2021-10-29 (   7 days): WEAK_COLLAPSE        - std=0.0024, corr=-0.231, dir_acc=0.512
[DEGD] 2021-11-17 to 2021-12-07 (  14 days): DEGRADED             - std=0.0043, corr=-0.157, dir_acc=0.495
[ OK ] 2021-12-23 to 2022-01-06 (  10 days): HEALTHY              - std=0.0030, corr=-0.162, dir_acc=0.543
[UNI ] 2022-01-12 to 2022-02-16 (  25 days): UNIDIRECTIONAL       - std=0.0038, corr=-0.119, dir_acc=0.484
[WEAK] 2022-02-17 to 2022-03-22 (  23 days): WEAK_COLLAPSE        - std=0.0042, corr=-0.105, dir_acc=0.424
[UNI ] 2022-03-29 to 2022-06-01 (  45 days): UNIDIRECTIONAL       - std=0.0026, corr=-0.021, dir_acc=0.452
[WEAK] 2022-06-02 to 2022-06-13 (   8 days): WEAK_COLLAPSE        - std=0.0005, corr=-0.108, dir_acc=0.496
[WEAK] 2022-06-16 to 2023-03-14 ( 184 days): WEAK_COLLAPSE        - std=0.0042, corr=+0.094, dir_acc=0.436
[UNI ] 2023-03-15 to 2023-09-18 ( 129 days): UNIDIRECTIONAL       - std=0.0187, corr=-0.088, dir_acc=0.532
[UNI ] 2023-09-25 to 2023-10-18 (  17 days): UNIDIRECTIONAL       - std=0.0021, corr=-0.314, dir_acc=0.488
[UNI ] 2023-10-20 to 2024-02-15 (  81 days): UNIDIRECTIONAL       - std=0.0089, corr=-0.111, dir_acc=0.575
[WEAK] 2024-02-16 to 2024-05-08 (  57 days): WEAK_COLLAPSE        - std=0.0036, corr=+0.077, dir_acc=0.563
[UNI ] 2024-05-09 to 2024-07-18 (  48 days): UNIDIRECTIONAL       - std=0.0036, corr=-0.101, dir_acc=0.563
[WEAK] 2024-07-19 to 2024-08-02 (  11 days): WEAK_COLLAPSE        - std=0.0045, corr=+0.021, dir_acc=0.633
[UNI ] 2024-08-05 to 2025-10-06 ( 292 days): UNIDIRECTIONAL       - std=0.0163, corr=-0.126, dir_acc=0.569
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            65 days (  5.1%)
  DEGRADED:           80 days (  6.2%)
  UNIDIRECTIONAL:    642 days ( 50.2%)
  WEAK_COLLAPSE:     493 days ( 38.5%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1215 days (94.9%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.30_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.178264
  RMSE:             1.085479
  MAE:              0.773658
  Out-of-sample RÂ²: -0.0013

FINANCIAL METRICS:
  Directional Acc:  51.95%
  Sharpe Ratio:     0.6239
  Total Return:     56.00%
  Max Drawdown:     -25.25%
  Hit Rate:         46.33%
  Number of Trades: 1114

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5323
  Recall:           0.8632
  F1 Score:         0.6585
  AUC-ROC:          0.5064

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:         72             521
  Actual Up:           94             593

ALPHA (vs Buy-and-Hold):
  Excess Return:    -36.16%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.30_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:05:45
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h22_drop0.35_lr3
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h22_drop0.35_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.35_lr3/checkpoints/tft-epoch=03-val_loss=0.1329.ckpt
  Validation loss: 0.132873

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.35_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.35_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.35_lr3/evaluation/evaluation_20251027_120546.log
Evaluation started at: 2025-10-27 12:05:46
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.011371
    Max: 0.124530
    Mean: 0.068637
    Std: 0.033632
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0114, max: 0.1245, mean: 0.0686
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  586 days ( 45.8%)
3. Consecutive-similarity      [WARN]  552 days ( 43.1%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    870 days ( 68.0%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)                 285 days ( 22.3%)
  Unidirectional (>98%)        [WARN]  1250 days ( 97.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0024, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-04-08 ( 128 days): WEAK_COLLAPSE        - std=0.0032, corr=+0.007, dir_acc=0.556
[UNI ] 2021-04-09 to 2021-06-28 (  56 days): UNIDIRECTIONAL       - std=0.0041, corr=-0.071, dir_acc=0.534
[WEAK] 2021-06-29 to 2021-09-30 (  66 days): WEAK_COLLAPSE        - std=0.0047, corr=-0.034, dir_acc=0.584
[UNI ] 2021-10-01 to 2022-02-18 (  96 days): UNIDIRECTIONAL       - std=0.0073, corr=-0.144, dir_acc=0.561
[WEAK] 2022-02-25 to 2022-03-22 (  18 days): WEAK_COLLAPSE        - std=0.0029, corr=-0.092, dir_acc=0.419
[UNI ] 2022-03-29 to 2022-05-31 (  44 days): UNIDIRECTIONAL       - std=0.0023, corr=-0.031, dir_acc=0.452
[WEAK] 2022-06-01 to 2022-06-14 (  10 days): WEAK_COLLAPSE        - std=0.0011, corr=-0.123, dir_acc=0.490
[WEAK] 2022-06-16 to 2023-03-14 ( 184 days): WEAK_COLLAPSE        - std=0.0044, corr=+0.089, dir_acc=0.436
[UNI ] 2023-03-15 to 2023-09-18 ( 129 days): UNIDIRECTIONAL       - std=0.0193, corr=-0.090, dir_acc=0.532
[UNI ] 2023-09-25 to 2023-10-18 (  17 days): UNIDIRECTIONAL       - std=0.0023, corr=-0.324, dir_acc=0.488
[UNI ] 2023-10-20 to 2024-02-15 (  81 days): UNIDIRECTIONAL       - std=0.0090, corr=-0.111, dir_acc=0.575
[WEAK] 2024-02-16 to 2024-05-08 (  57 days): WEAK_COLLAPSE        - std=0.0034, corr=+0.077, dir_acc=0.563
[UNI ] 2024-05-09 to 2024-05-17 (   7 days): UNIDIRECTIONAL       - std=0.0021, corr=-0.112, dir_acc=0.517
[UNI ] 2024-05-21 to 2024-07-18 (  40 days): UNIDIRECTIONAL       - std=0.0021, corr=-0.088, dir_acc=0.573
[WEAK] 2024-07-19 to 2024-08-02 (  11 days): WEAK_COLLAPSE        - std=0.0045, corr=+0.021, dir_acc=0.633
[UNI ] 2024-08-05 to 2025-10-06 ( 292 days): UNIDIRECTIONAL       - std=0.0171, corr=-0.127, dir_acc=0.569
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:            1 days (  0.1%)
  UNIDIRECTIONAL:    767 days ( 59.9%)
  WEAK_COLLAPSE:     483 days ( 37.7%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1251 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.35_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.178240
  RMSE:             1.085468
  MAE:              0.773357
  Out-of-sample RÂ²: -0.0013

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5067

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.35_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:05:47
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_h22_drop0.35_lr5
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h22_drop0.35_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.35_lr5/checkpoints/tft-epoch=02-val_loss=0.1391.ckpt
  Validation loss: 0.139108

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.35_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.35_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.35_lr5/evaluation/evaluation_20251027_120549.log
Evaluation started at: 2025-10-27 12:05:49
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.005280
    Max: 0.103610
    Mean: 0.049871
    Std: 0.032699
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0053, max: 0.1036, mean: 0.0499
Negative predictions: 109/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  641 days ( 50.1%)
3. Consecutive-similarity      [WARN]  627 days ( 49.0%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    867 days ( 67.7%)
  Directional acc < 52%                563 days ( 44.0%)
  Combined (BOTH poor)                 322 days ( 25.2%)
  Unidirectional (>98%)        [WARN]  1076 days ( 84.1%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0023, corr=+0.000, dir_acc=0.500
[WEAK] 2020-10-01 to 2021-04-09 ( 129 days): WEAK_COLLAPSE        - std=0.0033, corr=+0.013, dir_acc=0.492
[ OK ] 2021-04-12 to 2021-04-26 (  11 days): HEALTHY              - std=0.0022, corr=+0.063, dir_acc=0.488
[DEGD] 2021-04-30 to 2021-06-14 (  31 days): DEGRADED             - std=0.0033, corr=-0.073, dir_acc=0.516
[UNI ] 2021-06-15 to 2021-06-25 (   9 days): UNIDIRECTIONAL       - std=0.0011, corr=-0.252, dir_acc=0.537
[WEAK] 2021-06-28 to 2021-09-30 (  67 days): WEAK_COLLAPSE        - std=0.0045, corr=-0.042, dir_acc=0.584
[UNI ] 2021-10-01 to 2021-10-20 (  13 days): UNIDIRECTIONAL       - std=0.0024, corr=-0.091, dir_acc=0.555
[WEAK] 2021-10-21 to 2021-10-29 (   7 days): WEAK_COLLAPSE        - std=0.0024, corr=-0.232, dir_acc=0.595
[UNI ] 2021-11-01 to 2022-02-15 (  73 days): UNIDIRECTIONAL       - std=0.0061, corr=-0.144, dir_acc=0.563
[WEAK] 2022-02-16 to 2022-04-04 (  33 days): WEAK_COLLAPSE        - std=0.0045, corr=-0.061, dir_acc=0.428
[WEAK] 2022-04-08 to 2022-04-19 (   7 days): WEAK_COLLAPSE        - std=0.0003, corr=+0.014, dir_acc=0.450
[UNI ] 2022-04-20 to 2022-05-19 (  22 days): UNIDIRECTIONAL       - std=0.0023, corr=-0.056, dir_acc=0.447
[WEAK] 2022-05-26 to 2023-03-16 ( 200 days): WEAK_COLLAPSE        - std=0.0049, corr=+0.069, dir_acc=0.440
[UNI ] 2023-03-23 to 2023-09-18 ( 123 days): UNIDIRECTIONAL       - std=0.0177, corr=-0.084, dir_acc=0.535
[UNI ] 2023-09-25 to 2023-10-18 (  17 days): UNIDIRECTIONAL       - std=0.0019, corr=-0.317, dir_acc=0.488
[UNI ] 2023-10-20 to 2024-02-15 (  81 days): UNIDIRECTIONAL       - std=0.0084, corr=-0.109, dir_acc=0.575
[WEAK] 2024-02-16 to 2024-05-13 (  60 days): WEAK_COLLAPSE        - std=0.0032, corr=+0.069, dir_acc=0.561
[UNI ] 2024-05-22 to 2024-06-17 (  18 days): UNIDIRECTIONAL       - std=0.0023, corr=-0.117, dir_acc=0.535
[UNI ] 2024-06-21 to 2024-07-17 (  18 days): UNIDIRECTIONAL       - std=0.0008, corr=-0.053, dir_acc=0.607
[WEAK] 2024-07-18 to 2024-08-02 (  12 days): WEAK_COLLAPSE        - std=0.0049, corr=+0.012, dir_acc=0.636
[UNI ] 2024-08-05 to 2025-10-06 ( 292 days): UNIDIRECTIONAL       - std=0.0162, corr=-0.128, dir_acc=0.569
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            41 days (  3.2%)
  DEGRADED:           34 days (  2.7%)
  UNIDIRECTIONAL:    679 days ( 53.0%)
  WEAK_COLLAPSE:     526 days ( 41.1%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1239 days (96.8%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.35_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.178053
  RMSE:             1.085382
  MAE:              0.773463
  Out-of-sample RÂ²: -0.0011

FINANCIAL METRICS:
  Directional Acc:  52.97%
  Sharpe Ratio:     0.7717
  Total Return:     78.28%
  Max Drawdown:     -25.25%
  Hit Rate:         49.06%
  Number of Trades: 1171

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5363
  Recall:           0.9141
  F1 Score:         0.6760
  AUC-ROC:          0.5071

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:         50             543
  Actual Up:           59             628

ALPHA (vs Buy-and-Hold):
  Excess Return:    -13.88%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h22_drop0.35_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:05:50
======================================================================
---
Processing: 01_staleness_features_fixed/sweep_stale_monthly_h16_drop0.25
/Users/samufrank/.venvs/598-dl-final-py310/lib/python3.10/site-packages/numpy/core/fromnumeric.py:3715: RuntimeWarning: Degrees of freedom <= 0 for slice
  return _methods._var(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/samufrank/.venvs/598-dl-final-py310/lib/python3.10/site-packages/numpy/core/_methods.py:223: RuntimeWarning: invalid value encountered in divide
  arrmean = um.true_divide(arrmean, div, out=arrmean, casting='unsafe',
/Users/samufrank/.venvs/598-dl-final-py310/lib/python3.10/site-packages/numpy/core/_methods.py:257: RuntimeWarning: invalid value encountered in divide
  ret = ret.dtype.type(ret / rcount)
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_monthly_h16_drop0.25
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_monthly_h16_drop0.25/checkpoints/tft-epoch=49-val_loss=2.7655.ckpt
  Validation loss: 2.765523

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_monthly_h16_drop0.25/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_monthly_h16_drop0.25/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_monthly_h16_drop0.25/evaluation/evaluation_20251027_120551.log
Evaluation started at: 2025-10-27 12:05:51
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_monthly_fixed_test.csv
  Train: data/splits/fixed/core_proposal_monthly_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 63
Preparing test dataset...
Expected test predictions: 52 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 51, Total actuals: 51

Prediction Generation Summary:
  Total predictions: 51
  Test dataset size: 51
  Test dataloader batches: 1
  Prediction statistics:
    Min: 0.991389
    Max: 1.140990
    Mean: 1.065432
    Std: 0.036023
    Unique values: 51

WARNING: Predictions (51) < Test samples (63)
Date range: 2021-08-31T00:00:00.000000000 to 2025-10-31T00:00:00.000000000

Prediction period: 2021-08-31T00:00:00.000000000 to 2025-10-31T00:00:00.000000000 (51 samples)
Computing metrics...
Predictions - min: 0.9914, max: 1.1410, mean: 1.0654
Negative predictions: 0/51
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [ OK ]    0 days (  0.0%)
3. Consecutive-similarity      [ OK ]    0 days (  0.0%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                     21 days ( 41.2%)
  Directional acc < 52%                  0 days (  0.0%)
  Combined (BOTH poor)                   0 days (  0.0%)
  Unidirectional (>98%)        [WARN]    21 days ( 41.2%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2021-08-31 to 2024-01-31 (  30 days): HEALTHY              - std=0.0413, corr=+0.000, dir_acc=0.500
[UNI ] 2024-02-29 to 2025-10-31 (  21 days): UNIDIRECTIONAL       - std=0.0223, corr=-0.132, dir_acc=0.604
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            30 days ( 58.8%)
  DEGRADED:            0 days (  0.0%)
  UNIDIRECTIONAL:     21 days ( 41.2%)
  WEAK_COLLAPSE:       0 days (  0.0%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic:   21 days (41.2%)
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_monthly_h16_drop0.25/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              21.184710
  RMSE:             4.602685
  MAE:              3.813380
  Out-of-sample RÂ²: -0.0030

FINANCIAL METRICS:
  Directional Acc:  62.75%
  Sharpe Ratio:     3.2745
  Total Return:     53.35%
  Max Drawdown:     -24.77%
  Hit Rate:         62.75%
  Number of Trades: 51

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.6275
  Recall:           1.0000
  F1 Score:         0.7711
  AUC-ROC:          0.4276

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0              19
  Actual Up:            0              32

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_monthly_h16_drop0.25/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-27 12:05:52
======================================================================
---
All evaluations complete!
