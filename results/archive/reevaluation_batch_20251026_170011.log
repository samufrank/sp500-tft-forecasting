Batch re-evaluation started at Sun Oct 26 17:00:11 MST 2025
========================================
========================================================================
PHASE: 00_baseline_exploration
========================================================================
Processing: 00_baseline_exploration/exp001_baseline
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 00_baseline_exploration/exp001_baseline
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/exp001_baseline/checkpoints/tft-epoch=00-val_loss=0.1371.ckpt
  Validation loss: 0.137105

Loading configuration...
Loading config from: experiments/00_baseline_exploration/exp001_baseline/config.json
Output directory: experiments/00_baseline_exploration/exp001_baseline/evaluation
Logging to: experiments/00_baseline_exploration/exp001_baseline/evaluation/evaluation_20251026_170012.log
Evaluation started at: 2025-10-26 17:00:12
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.104103
    Max: 0.177552
    Mean: 0.151518
    Std: 0.015194
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1041, max: 0.1776, mean: 0.1515
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  596 days ( 46.6%)
3. Consecutive-similarity      [WARN]  507 days ( 39.6%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   729 days ( 57.0%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)         [WARN]   304 days ( 23.8%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0008, corr=+nan, dir_acc=nan
[WEAK] 2020-10-01 to 2021-03-18 ( 114 days): WEAK_COLLAPSE        - std=0.0042, corr=-0.020, dir_acc=0.556
[DEGD] 2021-03-19 to 2021-03-30 (   8 days): DEGRADED             - std=0.0006, corr=+0.052, dir_acc=0.558
[WEAK] 2021-03-31 to 2021-12-02 ( 170 days): WEAK_COLLAPSE        - std=0.0032, corr=-0.086, dir_acc=0.566
[DEGD] 2021-12-03 to 2021-12-20 (  12 days): DEGRADED             - std=0.0016, corr=+0.229, dir_acc=0.603
[WEAK] 2021-12-21 to 2022-01-18 (  19 days): WEAK_COLLAPSE        - std=0.0020, corr=+0.196, dir_acc=0.591
[DEGD] 2022-01-19 to 2022-03-02 (  30 days): DEGRADED             - std=0.0035, corr=+0.278, dir_acc=0.464
[WEAK] 2022-03-03 to 2022-03-10 (   6 days): WEAK_COLLAPSE        - std=0.0015, corr=+0.245, dir_acc=0.408
[DEGD] 2022-03-11 to 2022-04-13 (  24 days): DEGRADED             - std=0.0047, corr=-0.004, dir_acc=0.433
[ OK ] 2022-04-14 to 2022-04-26 (   8 days): HEALTHY              - std=0.0009, corr=+0.020, dir_acc=0.454
[DEGD] 2022-04-27 to 2022-05-09 (   9 days): DEGRADED             - std=0.0020, corr=-0.025, dir_acc=0.446
[DEGD] 2022-05-23 to 2022-06-10 (  14 days): DEGRADED             - std=0.0015, corr=-0.056, dir_acc=0.485
[DEGD] 2022-07-05 to 2022-07-12 (   6 days): DEGRADED             - std=0.0029, corr=-0.008, dir_acc=0.458
[WEAK] 2022-08-12 to 2022-10-17 (  45 days): WEAK_COLLAPSE        - std=0.0060, corr=-0.025, dir_acc=0.449
[DEGD] 2022-10-18 to 2023-02-27 (  89 days): DEGRADED             - std=0.0123, corr=-0.118, dir_acc=0.415
[WEAK] 2023-02-28 to 2023-04-17 (  34 days): WEAK_COLLAPSE        - std=0.0024, corr=-0.136, dir_acc=0.495
[DEGD] 2023-04-18 to 2023-06-06 (  35 days): DEGRADED             - std=0.0028, corr=-0.121, dir_acc=0.517
[ OK ] 2023-06-07 to 2023-06-27 (  14 days): HEALTHY              - std=0.0018, corr=-0.144, dir_acc=0.561
[DEGD] 2023-07-06 to 2023-08-30 (  40 days): DEGRADED             - std=0.0044, corr=-0.079, dir_acc=0.555
[DEGD] 2023-09-06 to 2023-09-25 (  14 days): DEGRADED             - std=0.0075, corr=-0.060, dir_acc=0.506
[ OK ] 2023-10-03 to 2023-10-19 (  12 days): HEALTHY              - std=0.0069, corr=+0.039, dir_acc=0.479
[ OK ] 2023-11-01 to 2024-01-31 (  62 days): HEALTHY              - std=0.0131, corr=+0.154, dir_acc=0.582
[DEGD] 2024-02-01 to 2024-02-26 (  17 days): DEGRADED             - std=0.0015, corr=-0.014, dir_acc=0.635
[WEAK] 2024-02-27 to 2024-04-23 (  40 days): WEAK_COLLAPSE        - std=0.0040, corr=-0.134, dir_acc=0.571
[ OK ] 2024-05-02 to 2024-08-14 (  72 days): HEALTHY              - std=0.0092, corr=+0.141, dir_acc=0.574
[ OK ] 2024-08-19 to 2025-02-24 ( 127 days): HEALTHY              - std=0.0086, corr=+0.044, dir_acc=0.577
[DEGD] 2025-02-28 to 2025-03-20 (  15 days): DEGRADED             - std=0.0029, corr=-0.024, dir_acc=0.494
[ OK ] 2025-03-21 to 2025-04-02 (   9 days): HEALTHY              - std=0.0010, corr=+0.048, dir_acc=0.526
[ OK ] 2025-04-09 to 2025-08-12 (  86 days): HEALTHY              - std=0.0130, corr=-0.064, dir_acc=0.578
[DEGD] 2025-08-13 to 2025-08-21 (   7 days): DEGRADED             - std=0.0011, corr=-0.022, dir_acc=0.564
[DEGD] 2025-08-25 to 2025-09-19 (  19 days): DEGRADED             - std=0.0040, corr=-0.062, dir_acc=0.561
[DEGD] 2025-09-25 to 2025-10-06 (   8 days): DEGRADED             - std=0.0008, corr=-0.163, dir_acc=0.571
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           461 days ( 36.0%)
  DEGRADED:          390 days ( 30.5%)
  WEAK_COLLAPSE:     429 days ( 33.5%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic:  819 days (64.0%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/exp001_baseline/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.185179
  RMSE:             1.088659
  MAE:              0.774865
  Out-of-sample RÂ²: -0.0072

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5421

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/exp001_baseline/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:00:14
======================================================================
  ✓ Success

Processing: 00_baseline_exploration/exp004_attn1
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 00_baseline_exploration/exp004_attn1
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/exp004_attn1/checkpoints/tft-epoch=00-val_loss=0.1191.ckpt
  Validation loss: 0.119101

Loading configuration...
Loading config from: experiments/00_baseline_exploration/exp004_attn1/config.json
Output directory: experiments/00_baseline_exploration/exp004_attn1/evaluation
Logging to: experiments/00_baseline_exploration/exp004_attn1/evaluation/evaluation_20251026_170015.log
Evaluation started at: 2025-10-26 17:00:15
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.316659
    Max: 0.416546
    Mean: 0.351856
    Std: 0.025734
    Unique values: 1278

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.3167, max: 0.4165, mean: 0.3519
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   81 days (  6.3%)
2. Range-based                 [WARN]  173 days ( 13.5%)
3. Consecutive-similarity      [WARN]  199 days ( 15.5%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   197 days ( 15.4%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)         [ OK ]    79 days (  6.2%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0062, corr=+nan, dir_acc=nan
[WEAK] 2020-10-01 to 2020-10-20 (  13 days): WEAK_COLLAPSE        - std=0.0013, corr=-0.067, dir_acc=0.596
[DEGD] 2020-10-21 to 2020-11-04 (  11 days): DEGRADED             - std=0.0060, corr=-0.078, dir_acc=0.566
[ OK ] 2020-11-05 to 2021-02-08 (  63 days): HEALTHY              - std=0.0069, corr=+0.189, dir_acc=0.545
[DEGD] 2021-02-09 to 2021-02-25 (  12 days): DEGRADED             - std=0.0029, corr=+0.059, dir_acc=0.571
[ OK ] 2021-03-09 to 2021-04-13 (  25 days): HEALTHY              - std=0.0013, corr=+0.065, dir_acc=0.555
[DEGD] 2021-04-14 to 2021-05-11 (  20 days): DEGRADED             - std=0.0022, corr=+0.142, dir_acc=0.530
[ OK ] 2021-05-12 to 2021-08-30 (  77 days): HEALTHY              - std=0.0094, corr=+0.142, dir_acc=0.561
[DEGD] 2021-08-31 to 2021-09-15 (  11 days): DEGRADED             - std=0.0036, corr=+0.349, dir_acc=0.620
[ OK ] 2021-09-21 to 2022-07-27 ( 212 days): HEALTHY              - std=0.0139, corr=+0.205, dir_acc=0.504
[DEGD] 2022-07-28 to 2022-08-19 (  17 days): DEGRADED             - std=0.0071, corr=-0.050, dir_acc=0.476
[DEGD] 2022-08-23 to 2022-09-06 (  10 days): DEGRADED             - std=0.0063, corr=-0.038, dir_acc=0.447
[ OK ] 2022-09-07 to 2022-09-29 (  17 days): HEALTHY              - std=0.0063, corr=+0.081, dir_acc=0.458
[ OK ] 2022-10-03 to 2022-10-13 (   8 days): HEALTHY              - std=0.0029, corr=+0.047, dir_acc=0.425
[ OK ] 2022-10-17 to 2023-07-03 ( 177 days): HEALTHY              - std=0.0187, corr=+0.193, dir_acc=0.465
[DEGD] 2023-07-05 to 2023-08-01 (  20 days): DEGRADED             - std=0.0017, corr=+0.195, dir_acc=0.557
[WEAK] 2023-08-02 to 2023-08-17 (  12 days): WEAK_COLLAPSE        - std=0.0019, corr=+0.144, dir_acc=0.562
[FAIL] 2023-08-25 to 2023-09-21 (  19 days): STRONG_COLLAPSE      - std=0.0022, corr=+0.039, dir_acc=0.518
[ OK ] 2023-10-04 to 2023-10-26 (  16 days): HEALTHY              - std=0.0082, corr=+0.095, dir_acc=0.461
[ OK ] 2023-10-30 to 2024-01-24 (  59 days): HEALTHY              - std=0.0073, corr=-0.009, dir_acc=0.569
[FAIL] 2024-01-31 to 2024-04-16 (  53 days): STRONG_COLLAPSE      - std=0.0030, corr=+0.143, dir_acc=0.600
[WEAK] 2024-04-17 to 2024-05-03 (  13 days): WEAK_COLLAPSE        - std=0.0074, corr=-0.077, dir_acc=0.501
[DEGD] 2024-05-06 to 2024-05-14 (   7 days): DEGRADED             - std=0.0008, corr=-0.090, dir_acc=0.507
[DEGD] 2024-05-16 to 2024-06-03 (  12 days): DEGRADED             - std=0.0022, corr=-0.135, dir_acc=0.518
[ OK ] 2024-06-04 to 2024-07-01 (  19 days): HEALTHY              - std=0.0007, corr=-0.134, dir_acc=0.558
[DEGD] 2024-07-02 to 2024-07-17 (  11 days): DEGRADED             - std=0.0003, corr=-0.098, dir_acc=0.633
[FAIL] 2024-07-18 to 2024-07-25 (   6 days): STRONG_COLLAPSE      - std=0.0030, corr=-0.060, dir_acc=0.644
[DEGD] 2024-07-26 to 2024-08-02 (   6 days): DEGRADED             - std=0.0025, corr=-0.031, dir_acc=0.628
[ OK ] 2024-08-05 to 2025-03-10 ( 147 days): HEALTHY              - std=0.0165, corr=+0.193, dir_acc=0.574
[ OK ] 2025-03-14 to 2025-03-27 (  10 days): HEALTHY              - std=0.0133, corr=+0.033, dir_acc=0.512
[DEGD] 2025-04-07 to 2025-04-21 (  10 days): DEGRADED             - std=0.0075, corr=-0.055, dir_acc=0.500
[ OK ] 2025-04-22 to 2025-09-17 ( 103 days): HEALTHY              - std=0.0256, corr=+0.190, dir_acc=0.580
[DEGD] 2025-09-18 to 2025-10-06 (  13 days): DEGRADED             - std=0.0012, corr=+0.378, dir_acc=0.571
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           977 days ( 76.3%)
  DEGRADED:          176 days ( 13.8%)
  WEAK_COLLAPSE:      49 days (  3.8%)
  STRONG_COLLAPSE:    78 days (  6.1%)

  Total problematic:  303 days (23.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/exp004_attn1/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.262526
  RMSE:             1.123622
  MAE:              0.809745
  Out-of-sample RÂ²: -0.0729

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4934

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/exp004_attn1/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:00:16
======================================================================
  ✓ Success

Processing: 00_baseline_exploration/exp005_attn4
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 00_baseline_exploration/exp005_attn4
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/exp005_attn4/checkpoints/tft-epoch=01-val_loss=0.1768.ckpt
  Validation loss: 0.176837

Loading configuration...
Loading config from: experiments/00_baseline_exploration/exp005_attn4/config.json
Output directory: experiments/00_baseline_exploration/exp005_attn4/evaluation
Logging to: experiments/00_baseline_exploration/exp005_attn4/evaluation/evaluation_20251026_170018.log
Evaluation started at: 2025-10-26 17:00:18
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.040436
    Max: 0.150005
    Mean: 0.081615
    Std: 0.020986
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0404, max: 0.1500, mean: 0.0816
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  231 days ( 18.0%)
3. Consecutive-similarity      [WARN]  191 days ( 14.9%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   330 days ( 25.8%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)         [ OK ]   124 days (  9.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0015, corr=+nan, dir_acc=nan
[WEAK] 2020-10-01 to 2021-05-14 ( 154 days): WEAK_COLLAPSE        - std=0.0034, corr=+0.064, dir_acc=0.551
[DEGD] 2021-05-17 to 2021-05-26 (   8 days): DEGRADED             - std=0.0029, corr=+0.148, dir_acc=0.525
[ OK ] 2021-05-27 to 2021-06-24 (  20 days): HEALTHY              - std=0.0020, corr=+0.173, dir_acc=0.542
[ OK ] 2021-06-28 to 2021-08-17 (  36 days): HEALTHY              - std=0.0046, corr=+0.139, dir_acc=0.569
[DEGD] 2021-08-18 to 2021-09-21 (  24 days): DEGRADED             - std=0.0031, corr=+0.266, dir_acc=0.615
[ OK ] 2021-09-22 to 2022-08-09 ( 220 days): HEALTHY              - std=0.0133, corr=+0.143, dir_acc=0.503
[DEGD] 2022-08-10 to 2022-08-18 (   7 days): DEGRADED             - std=0.0009, corr=-0.022, dir_acc=0.479
[DEGD] 2022-08-23 to 2022-09-06 (  10 days): DEGRADED             - std=0.0045, corr=-0.030, dir_acc=0.447
[ OK ] 2022-09-07 to 2022-09-26 (  14 days): HEALTHY              - std=0.0044, corr=+0.053, dir_acc=0.464
[ OK ] 2022-10-17 to 2023-01-26 (  69 days): HEALTHY              - std=0.0280, corr=+0.154, dir_acc=0.405
[ OK ] 2023-01-30 to 2023-02-08 (   8 days): HEALTHY              - std=0.0019, corr=+0.137, dir_acc=0.456
[DEGD] 2023-02-24 to 2023-03-13 (  12 days): DEGRADED             - std=0.0051, corr=-0.028, dir_acc=0.460
[ OK ] 2023-03-14 to 2023-08-23 ( 113 days): HEALTHY              - std=0.0112, corr=+0.119, dir_acc=0.534
[ OK ] 2023-08-25 to 2023-09-05 (   7 days): HEALTHY              - std=0.0047, corr=-0.107, dir_acc=0.538
[ OK ] 2023-09-07 to 2023-09-20 (  10 days): HEALTHY              - std=0.0041, corr=+0.034, dir_acc=0.507
[DEGD] 2023-09-26 to 2023-10-18 (  16 days): DEGRADED             - std=0.0114, corr=-0.047, dir_acc=0.488
[ OK ] 2023-10-19 to 2023-10-31 (   9 days): HEALTHY              - std=0.0027, corr=+0.052, dir_acc=0.430
[DEGD] 2023-11-01 to 2023-11-13 (   9 days): DEGRADED             - std=0.0045, corr=-0.101, dir_acc=0.491
[ OK ] 2023-11-14 to 2024-02-26 (  70 days): HEALTHY              - std=0.0135, corr=-0.111, dir_acc=0.606
[WEAK] 2024-02-28 to 2024-04-19 (  37 days): WEAK_COLLAPSE        - std=0.0050, corr=+0.127, dir_acc=0.574
[DEGD] 2024-04-22 to 2024-04-29 (   6 days): DEGRADED             - std=0.0083, corr=-0.047, dir_acc=0.503
[DEGD] 2024-05-02 to 2024-05-14 (   9 days): DEGRADED             - std=0.0023, corr=-0.129, dir_acc=0.506
[DEGD] 2024-05-22 to 2024-06-03 (   8 days): DEGRADED             - std=0.0054, corr=-0.230, dir_acc=0.517
[ OK ] 2024-06-04 to 2025-03-07 ( 188 days): HEALTHY              - std=0.0167, corr=+0.030, dir_acc=0.580
[DEGD] 2025-03-19 to 2025-03-28 (   8 days): DEGRADED             - std=0.0094, corr=-0.085, dir_acc=0.517
[DEGD] 2025-04-07 to 2025-04-28 (  15 days): DEGRADED             - std=0.0024, corr=-0.049, dir_acc=0.501
[ OK ] 2025-04-29 to 2025-10-06 ( 111 days): HEALTHY              - std=0.0228, corr=+0.104, dir_acc=0.582
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           931 days ( 72.7%)
  DEGRADED:          158 days ( 12.3%)
  WEAK_COLLAPSE:     191 days ( 14.9%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic:  349 days (27.3%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/exp005_attn4/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.175106
  RMSE:             1.084023
  MAE:              0.771611
  Out-of-sample RÂ²: 0.0014

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5263

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/exp005_attn4/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:00:19
======================================================================
  ✓ Success

Processing: 00_baseline_exploration/exp006_monthly
/Users/samufrank/.venvs/598-dl-final-py310/lib/python3.10/site-packages/numpy/core/fromnumeric.py:3715: RuntimeWarning: Degrees of freedom <= 0 for slice
  return _methods._var(a, axis=axis, dtype=dtype, out=out, ddof=ddof,
/Users/samufrank/.venvs/598-dl-final-py310/lib/python3.10/site-packages/numpy/core/_methods.py:223: RuntimeWarning: invalid value encountered in divide
  arrmean = um.true_divide(arrmean, div, out=arrmean, casting='unsafe',
/Users/samufrank/.venvs/598-dl-final-py310/lib/python3.10/site-packages/numpy/core/_methods.py:257: RuntimeWarning: invalid value encountered in divide
  ret = ret.dtype.type(ret / rcount)
======================================================================
Evaluating TFT: 00_baseline_exploration/exp006_monthly
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/exp006_monthly/checkpoints/tft-epoch=48-val_loss=1.9104.ckpt
  Validation loss: 1.910372

Loading configuration...
Loading config from: experiments/00_baseline_exploration/exp006_monthly/config.json
Output directory: experiments/00_baseline_exploration/exp006_monthly/evaluation
Logging to: experiments/00_baseline_exploration/exp006_monthly/evaluation/evaluation_20251026_170020.log
Evaluation started at: 2025-10-26 17:00:20
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_monthly_fixed_test.csv
  Train: data/splits/fixed/core_proposal_monthly_fixed_train.csv
Test samples: 63
Preparing test dataset...
Expected test predictions: 52 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 51, Total actuals: 51

Prediction Generation Summary:
  Total predictions: 51
  Test dataset size: 51
  Test dataloader batches: 1
  Prediction statistics:
    Min: 1.042747
    Max: 1.226326
    Mean: 1.124869
    Std: 0.039392
    Unique values: 51

WARNING: Predictions (51) < Test samples (63)
Date range: 2021-08-31T00:00:00.000000000 to 2025-10-31T00:00:00.000000000

Prediction period: 2021-08-31T00:00:00.000000000 to 2025-10-31T00:00:00.000000000 (51 samples)
Computing metrics...
Predictions - min: 1.0427, max: 1.2263, mean: 1.1249
Negative predictions: 0/51
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [ OK ]    0 days (  0.0%)
3. Consecutive-similarity      [ OK ]    0 days (  0.0%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                    21 days ( 41.2%)
  Directional acc < 52%                  0 days (  0.0%)
  Combined (BOTH poor)         [ OK ]     0 days (  0.0%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2021-08-31 to 2025-10-31 (  51 days): HEALTHY              - std=0.0394, corr=-0.129, dir_acc=0.604
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            51 days (100.0%)
  DEGRADED:            0 days (  0.0%)
  WEAK_COLLAPSE:       0 days (  0.0%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic:    0 days (0.0%)

[ OK ] NO SIGNIFICANT ISSUES DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/exp006_monthly/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              21.188587
  RMSE:             4.603106
  MAE:              3.803275
  Out-of-sample RÂ²: -0.0032

FINANCIAL METRICS:
  Directional Acc:  62.75%
  Sharpe Ratio:     3.2745
  Total Return:     53.35%
  Max Drawdown:     -24.77%
  Hit Rate:         62.75%
  Number of Trades: 51

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.6275
  Recall:           1.0000
  F1 Score:         0.7711
  AUC-ROC:          0.5033

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0              19
  Actual Up:            0              32

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/exp006_monthly/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:00:21
======================================================================
  ✓ Success

Processing: 00_baseline_exploration/sweep_hidden_16
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep_hidden_16
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep_hidden_16/checkpoints/tft-epoch=01-val_loss=0.1324.ckpt
  Validation loss: 0.132447

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep_hidden_16/config.json
Output directory: experiments/00_baseline_exploration/sweep_hidden_16/evaluation
Logging to: experiments/00_baseline_exploration/sweep_hidden_16/evaluation/evaluation_20251026_170022.log
Evaluation started at: 2025-10-26 17:00:22
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.103241
    Max: 0.152375
    Mean: -0.003492
    Std: 0.076916
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.1032, max: 0.1524, mean: -0.0035
Negative predictions: 694/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   89 days (  7.0%)
2. Range-based                 [WARN]  187 days ( 14.6%)
3. Consecutive-similarity      [WARN]  294 days ( 23.0%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   758 days ( 59.2%)
  Directional acc < 52%                585 days ( 45.7%)
  Combined (BOTH poor)         [WARN]   374 days ( 29.2%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-11-04 (  54 days): HEALTHY              - std=0.0078, corr=+0.070, dir_acc=0.418
[DEGD] 2020-11-05 to 2020-11-13 (   6 days): DEGRADED             - std=0.0038, corr=-0.012, dir_acc=0.429
[DEGD] 2020-11-18 to 2021-04-05 (  93 days): DEGRADED             - std=0.0151, corr=-0.171, dir_acc=0.452
[ OK ] 2021-04-06 to 2021-04-13 (   6 days): HEALTHY              - std=0.0088, corr=+0.022, dir_acc=0.489
[ OK ] 2021-05-03 to 2021-05-13 (   9 days): HEALTHY              - std=0.0122, corr=+0.016, dir_acc=0.544
[DEGD] 2021-05-26 to 2021-06-08 (   9 days): DEGRADED             - std=0.0053, corr=-0.112, dir_acc=0.502
[DEGD] 2021-06-10 to 2021-09-13 (  66 days): DEGRADED             - std=0.0163, corr=-0.136, dir_acc=0.435
[DEGD] 2021-09-15 to 2021-11-03 (  35 days): DEGRADED             - std=0.0152, corr=-0.133, dir_acc=0.426
[ OK ] 2021-11-12 to 2021-12-06 (  16 days): HEALTHY              - std=0.0158, corr=+0.048, dir_acc=0.416
[DEGD] 2021-12-07 to 2021-12-16 (   8 days): DEGRADED             - std=0.0055, corr=-0.033, dir_acc=0.392
[DEGD] 2021-12-22 to 2022-01-04 (   9 days): DEGRADED             - std=0.0028, corr=-0.030, dir_acc=0.383
[ OK ] 2022-01-18 to 2022-05-26 (  91 days): HEALTHY              - std=0.0082, corr=-0.159, dir_acc=0.552
[DEGD] 2022-05-27 to 2022-06-15 (  13 days): DEGRADED             - std=0.0018, corr=-0.170, dir_acc=0.513
[WEAK] 2022-06-16 to 2022-07-22 (  25 days): WEAK_COLLAPSE        - std=0.0057, corr=-0.059, dir_acc=0.545
[DEGD] 2022-07-25 to 2022-09-23 (  44 days): DEGRADED             - std=0.0019, corr=-0.099, dir_acc=0.534
[WEAK] 2022-09-26 to 2022-10-06 (   9 days): WEAK_COLLAPSE        - std=0.0014, corr=+0.081, dir_acc=0.572
[FAIL] 2022-10-07 to 2022-12-20 (  50 days): STRONG_COLLAPSE      - std=0.0029, corr=+0.122, dir_acc=0.601
[WEAK] 2022-12-21 to 2022-12-29 (   6 days): WEAK_COLLAPSE        - std=0.0017, corr=+0.111, dir_acc=0.594
[FAIL] 2022-12-30 to 2023-02-06 (  25 days): STRONG_COLLAPSE      - std=0.0018, corr=+0.063, dir_acc=0.568
[WEAK] 2023-02-07 to 2023-03-10 (  23 days): WEAK_COLLAPSE        - std=0.0017, corr=+0.075, dir_acc=0.548
[FAIL] 2023-03-13 to 2023-03-30 (  14 days): STRONG_COLLAPSE      - std=0.0038, corr=-0.000, dir_acc=0.511
[WEAK] 2023-03-31 to 2023-04-10 (   6 days): WEAK_COLLAPSE        - std=0.0019, corr=+0.088, dir_acc=0.464
[DEGD] 2023-04-11 to 2023-06-27 (  54 days): DEGRADED             - std=0.0100, corr=+0.006, dir_acc=0.472
[ OK ] 2023-07-11 to 2023-07-28 (  14 days): HEALTHY              - std=0.0159, corr=+0.050, dir_acc=0.463
[DEGD] 2023-07-31 to 2023-11-09 (  72 days): DEGRADED             - std=0.0106, corr=-0.137, dir_acc=0.451
[ OK ] 2023-11-10 to 2024-02-26 (  72 days): HEALTHY              - std=0.0122, corr=+0.076, dir_acc=0.604
[WEAK] 2024-02-27 to 2024-04-08 (  29 days): WEAK_COLLAPSE        - std=0.0033, corr=+0.006, dir_acc=0.587
[ OK ] 2024-04-16 to 2025-03-04 ( 219 days): HEALTHY              - std=0.0282, corr=-0.050, dir_acc=0.570
[ OK ] 2025-03-06 to 2025-04-07 (  23 days): HEALTHY              - std=0.0316, corr=+0.059, dir_acc=0.511
[ OK ] 2025-04-09 to 2025-10-06 ( 124 days): HEALTHY              - std=0.0345, corr=-0.122, dir_acc=0.574
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           659 days ( 51.5%)
  DEGRADED:          434 days ( 33.9%)
  WEAK_COLLAPSE:      98 days (  7.7%)
  STRONG_COLLAPSE:    89 days (  7.0%)

  Total problematic:  621 days (48.5%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep_hidden_16/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.183202
  RMSE:             1.087751
  MAE:              0.773713
  Out-of-sample RÂ²: -0.0055

FINANCIAL METRICS:
  Directional Acc:  52.42%
  Sharpe Ratio:     0.8480
  Total Return:     52.05%
  Max Drawdown:     -18.90%
  Hit Rate:         25.94%
  Number of Trades: 586

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5666
  Recall:           0.4833
  F1 Score:         0.5216
  AUC-ROC:          0.5439

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        339             254
  Actual Up:          355             332

ALPHA (vs Buy-and-Hold):
  Excess Return:    -40.11%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep_hidden_16/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:00:23
======================================================================
  ✓ Success

Processing: 00_baseline_exploration/sweep_hidden_24
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep_hidden_24
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep_hidden_24/checkpoints/tft-epoch=00-val_loss=0.1056.ckpt
  Validation loss: 0.105576

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep_hidden_24/config.json
Output directory: experiments/00_baseline_exploration/sweep_hidden_24/evaluation
Logging to: experiments/00_baseline_exploration/sweep_hidden_24/evaluation/evaluation_20251026_170025.log
Evaluation started at: 2025-10-26 17:00:25
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.183870
    Max: 0.381522
    Mean: 0.296765
    Std: 0.046850
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1839, max: 0.3815, mean: 0.2968
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  196 days ( 15.3%)
2. Range-based                 [ OK ]    0 days (  0.0%)
3. Consecutive-similarity      [ OK ]    0 days (  0.0%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   303 days ( 23.7%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)         [ OK ]   124 days (  9.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-11-24 (  67 days): HEALTHY              - std=0.0174, corr=-0.152, dir_acc=0.574
[ OK ] 2020-12-02 to 2020-12-09 (   6 days): HEALTHY              - std=0.0102, corr=-0.124, dir_acc=0.539
[ OK ] 2021-01-05 to 2021-02-26 (  37 days): HEALTHY              - std=0.0057, corr=-0.089, dir_acc=0.562
[DEGD] 2021-03-01 to 2021-03-09 (   7 days): DEGRADED             - std=0.0063, corr=-0.142, dir_acc=0.531
[ OK ] 2021-03-10 to 2021-05-11 (  44 days): HEALTHY              - std=0.0068, corr=+0.061, dir_acc=0.544
[DEGD] 2021-05-12 to 2021-06-22 (  29 days): DEGRADED             - std=0.0123, corr=+0.247, dir_acc=0.534
[ OK ] 2021-06-23 to 2021-08-25 (  45 days): HEALTHY              - std=0.0076, corr=+0.112, dir_acc=0.574
[DEGD] 2021-08-26 to 2021-09-22 (  19 days): DEGRADED             - std=0.0127, corr=+0.247, dir_acc=0.611
[ OK ] 2021-09-23 to 2022-04-18 ( 141 days): HEALTHY              - std=0.0298, corr=+0.139, dir_acc=0.525
[DEGD] 2022-04-19 to 2022-06-03 (  33 days): DEGRADED             - std=0.0083, corr=-0.005, dir_acc=0.455
[DEGD] 2022-06-10 to 2022-06-23 (   9 days): DEGRADED             - std=0.0030, corr=-0.058, dir_acc=0.461
[DEGD] 2022-07-01 to 2022-08-19 (  35 days): DEGRADED             - std=0.0143, corr=-0.053, dir_acc=0.470
[ OK ] 2022-08-22 to 2022-10-21 (  43 days): HEALTHY              - std=0.0095, corr=+0.115, dir_acc=0.440
[DEGD] 2022-10-24 to 2022-11-07 (  11 days): DEGRADED             - std=0.0071, corr=-0.027, dir_acc=0.402
[DEGD] 2022-11-16 to 2023-01-06 (  35 days): DEGRADED             - std=0.0106, corr=+0.031, dir_acc=0.396
[ OK ] 2023-01-09 to 2023-06-28 ( 118 days): HEALTHY              - std=0.0286, corr=+0.145, dir_acc=0.494
[ OK ] 2023-06-30 to 2023-09-11 (  50 days): HEALTHY              - std=0.0142, corr=+0.068, dir_acc=0.549
[ OK ] 2023-09-13 to 2023-10-26 (  31 days): HEALTHY              - std=0.0273, corr=+0.115, dir_acc=0.482
[ OK ] 2023-10-30 to 2024-02-20 (  77 days): HEALTHY              - std=0.0343, corr=+0.121, dir_acc=0.588
[DEGD] 2024-02-21 to 2024-04-22 (  43 days): DEGRADED             - std=0.0114, corr=+0.080, dir_acc=0.578
[ OK ] 2024-05-03 to 2025-04-04 ( 229 days): HEALTHY              - std=0.0388, corr=+0.146, dir_acc=0.568
[DEGD] 2025-04-07 to 2025-04-28 (  15 days): DEGRADED             - std=0.0052, corr=-0.054, dir_acc=0.501
[ OK ] 2025-04-29 to 2025-10-06 ( 111 days): HEALTHY              - std=0.0312, corr=+0.057, dir_acc=0.582
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:          1020 days ( 79.7%)
  DEGRADED:          260 days ( 20.3%)
  WEAK_COLLAPSE:       0 days (  0.0%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic:  260 days (20.3%)
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep_hidden_24/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.237303
  RMSE:             1.112341
  MAE:              0.797365
  Out-of-sample RÂ²: -0.0514

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4735

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep_hidden_24/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:00:26
======================================================================
  ✓ Success

Processing: 00_baseline_exploration/sweep_lr_0.001
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep_lr_0.001
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep_lr_0.001/checkpoints/tft-epoch=00-val_loss=0.1370.ckpt
  Validation loss: 0.137026

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep_lr_0.001/config.json
Output directory: experiments/00_baseline_exploration/sweep_lr_0.001/evaluation
Logging to: experiments/00_baseline_exploration/sweep_lr_0.001/evaluation/evaluation_20251026_170027.log
Evaluation started at: 2025-10-26 17:00:27
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.103587
    Max: 0.177104
    Mean: 0.151069
    Std: 0.015213
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1036, max: 0.1771, mean: 0.1511
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  597 days ( 46.6%)
3. Consecutive-similarity      [WARN]  507 days ( 39.6%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   730 days ( 57.0%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)         [WARN]   304 days ( 23.8%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0008, corr=+nan, dir_acc=nan
[WEAK] 2020-10-01 to 2021-03-18 ( 114 days): WEAK_COLLAPSE        - std=0.0042, corr=-0.020, dir_acc=0.556
[DEGD] 2021-03-19 to 2021-03-30 (   8 days): DEGRADED             - std=0.0006, corr=+0.052, dir_acc=0.558
[WEAK] 2021-03-31 to 2021-12-02 ( 170 days): WEAK_COLLAPSE        - std=0.0032, corr=-0.087, dir_acc=0.566
[DEGD] 2021-12-03 to 2021-12-20 (  12 days): DEGRADED             - std=0.0016, corr=+0.229, dir_acc=0.603
[WEAK] 2021-12-21 to 2022-01-18 (  19 days): WEAK_COLLAPSE        - std=0.0020, corr=+0.196, dir_acc=0.591
[DEGD] 2022-01-19 to 2022-03-02 (  30 days): DEGRADED             - std=0.0035, corr=+0.277, dir_acc=0.464
[WEAK] 2022-03-03 to 2022-03-10 (   6 days): WEAK_COLLAPSE        - std=0.0015, corr=+0.243, dir_acc=0.408
[DEGD] 2022-03-11 to 2022-04-13 (  24 days): DEGRADED             - std=0.0047, corr=-0.004, dir_acc=0.433
[ OK ] 2022-04-14 to 2022-04-26 (   8 days): HEALTHY              - std=0.0009, corr=+0.020, dir_acc=0.454
[DEGD] 2022-04-27 to 2022-05-09 (   9 days): DEGRADED             - std=0.0020, corr=-0.025, dir_acc=0.446
[DEGD] 2022-05-23 to 2022-06-10 (  14 days): DEGRADED             - std=0.0015, corr=-0.056, dir_acc=0.485
[DEGD] 2022-07-05 to 2022-07-12 (   6 days): DEGRADED             - std=0.0029, corr=-0.008, dir_acc=0.458
[WEAK] 2022-08-12 to 2022-10-17 (  45 days): WEAK_COLLAPSE        - std=0.0060, corr=-0.025, dir_acc=0.449
[DEGD] 2022-10-18 to 2023-02-27 (  89 days): DEGRADED             - std=0.0124, corr=-0.118, dir_acc=0.415
[WEAK] 2023-02-28 to 2023-04-17 (  34 days): WEAK_COLLAPSE        - std=0.0024, corr=-0.136, dir_acc=0.495
[DEGD] 2023-04-18 to 2023-06-06 (  35 days): DEGRADED             - std=0.0028, corr=-0.121, dir_acc=0.517
[ OK ] 2023-06-07 to 2023-06-27 (  14 days): HEALTHY              - std=0.0018, corr=-0.143, dir_acc=0.561
[DEGD] 2023-07-06 to 2023-08-30 (  40 days): DEGRADED             - std=0.0043, corr=-0.079, dir_acc=0.555
[DEGD] 2023-09-06 to 2023-09-25 (  14 days): DEGRADED             - std=0.0075, corr=-0.060, dir_acc=0.506
[ OK ] 2023-10-03 to 2023-10-19 (  12 days): HEALTHY              - std=0.0069, corr=+0.038, dir_acc=0.479
[ OK ] 2023-11-01 to 2024-01-31 (  62 days): HEALTHY              - std=0.0130, corr=+0.154, dir_acc=0.582
[DEGD] 2024-02-01 to 2024-02-26 (  17 days): DEGRADED             - std=0.0015, corr=-0.014, dir_acc=0.635
[WEAK] 2024-02-27 to 2024-04-23 (  40 days): WEAK_COLLAPSE        - std=0.0040, corr=-0.135, dir_acc=0.571
[ OK ] 2024-05-02 to 2024-08-14 (  72 days): HEALTHY              - std=0.0092, corr=+0.141, dir_acc=0.574
[ OK ] 2024-08-19 to 2025-02-24 ( 127 days): HEALTHY              - std=0.0086, corr=+0.043, dir_acc=0.577
[DEGD] 2025-02-28 to 2025-03-20 (  15 days): DEGRADED             - std=0.0028, corr=-0.024, dir_acc=0.494
[ OK ] 2025-03-21 to 2025-04-02 (   9 days): HEALTHY              - std=0.0010, corr=+0.048, dir_acc=0.526
[ OK ] 2025-04-09 to 2025-08-12 (  86 days): HEALTHY              - std=0.0130, corr=-0.064, dir_acc=0.578
[DEGD] 2025-08-13 to 2025-08-21 (   7 days): DEGRADED             - std=0.0011, corr=-0.023, dir_acc=0.564
[DEGD] 2025-08-25 to 2025-09-22 (  20 days): DEGRADED             - std=0.0040, corr=-0.067, dir_acc=0.562
[DEGD] 2025-09-25 to 2025-10-06 (   8 days): DEGRADED             - std=0.0008, corr=-0.163, dir_acc=0.571
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           460 days ( 35.9%)
  DEGRADED:          391 days ( 30.5%)
  WEAK_COLLAPSE:     429 days ( 33.5%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic:  820 days (64.1%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep_lr_0.001/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.185095
  RMSE:             1.088621
  MAE:              0.774826
  Out-of-sample RÂ²: -0.0071

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5422

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep_lr_0.001/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:00:28
======================================================================
  ✓ Success

Processing: 00_baseline_exploration/sweep2_combo1
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_combo1
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_combo1/checkpoints/tft-epoch=04-val_loss=0.1253.ckpt
  Validation loss: 0.125286

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_combo1/config.json
Output directory: experiments/00_baseline_exploration/sweep2_combo1/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_combo1/evaluation/evaluation_20251026_170030.log
Evaluation started at: 2025-10-26 17:00:30
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1261 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1260, Total actuals: 1260

Prediction Generation Summary:
  Total predictions: 1260
  Test dataset size: 1260
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.026537
    Max: 0.126190
    Mean: 0.075311
    Std: 0.019504
    Unique values: 1260

WARNING: Predictions (1260) < Test samples (1300)
Date range: 2020-09-17T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-09-17T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1260 samples)
Computing metrics...
Predictions - min: 0.0265, max: 0.1262, mean: 0.0753
Negative predictions: 0/1260
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  301 days ( 23.9%)
2. Range-based                 [WARN]  488 days ( 38.7%)
3. Consecutive-similarity      [WARN]  618 days ( 49.0%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                  1059 days ( 84.0%)
  Directional acc < 52%                480 days ( 38.1%)
  Combined (BOTH poor)         [WARN]   388 days ( 30.8%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-09-17 to 2020-10-28 (  29 days): HEALTHY              - std=0.0024, corr=+nan, dir_acc=nan
[FAIL] 2020-10-30 to 2020-12-01 (  21 days): STRONG_COLLAPSE      - std=0.0032, corr=-0.144, dir_acc=0.522
[WEAK] 2020-12-02 to 2021-01-04 (  22 days): WEAK_COLLAPSE        - std=0.0060, corr=-0.089, dir_acc=0.525
[DEGD] 2021-01-05 to 2021-01-15 (   9 days): DEGRADED             - std=0.0017, corr=-0.112, dir_acc=0.543
[ OK ] 2021-01-19 to 2021-03-03 (  31 days): HEALTHY              - std=0.0039, corr=-0.060, dir_acc=0.565
[ OK ] 2021-03-09 to 2021-04-29 (  37 days): HEALTHY              - std=0.0053, corr=-0.177, dir_acc=0.551
[ OK ] 2021-05-26 to 2021-06-28 (  23 days): HEALTHY              - std=0.0017, corr=+0.026, dir_acc=0.542
[DEGD] 2021-06-29 to 2021-07-20 (  15 days): DEGRADED             - std=0.0007, corr=-0.055, dir_acc=0.559
[WEAK] 2021-07-21 to 2021-08-11 (  16 days): WEAK_COLLAPSE        - std=0.0012, corr=-0.123, dir_acc=0.569
[FAIL] 2021-08-12 to 2021-12-01 (  76 days): STRONG_COLLAPSE      - std=0.0034, corr=-0.237, dir_acc=0.593
[DEGD] 2021-12-08 to 2021-12-17 (   8 days): DEGRADED             - std=0.0030, corr=-0.174, dir_acc=0.610
[WEAK] 2021-12-20 to 2021-12-31 (   9 days): WEAK_COLLAPSE        - std=0.0021, corr=-0.109, dir_acc=0.615
[DEGD] 2022-01-03 to 2022-05-06 (  87 days): DEGRADED             - std=0.0101, corr=-0.147, dir_acc=0.463
[DEGD] 2022-05-23 to 2022-07-28 (  46 days): DEGRADED             - std=0.0028, corr=-0.099, dir_acc=0.467
[WEAK] 2022-08-05 to 2022-08-12 (   6 days): WEAK_COLLAPSE        - std=0.0013, corr=-0.115, dir_acc=0.467
[DEGD] 2022-08-15 to 2022-09-26 (  30 days): DEGRADED             - std=0.0079, corr=-0.096, dir_acc=0.462
[DEGD] 2022-10-17 to 2023-02-14 (  82 days): DEGRADED             - std=0.0099, corr=-0.144, dir_acc=0.412
[WEAK] 2023-02-15 to 2023-03-30 (  31 days): WEAK_COLLAPSE        - std=0.0031, corr=-0.057, dir_acc=0.470
[FAIL] 2023-03-31 to 2023-04-28 (  20 days): STRONG_COLLAPSE      - std=0.0021, corr=-0.233, dir_acc=0.525
[WEAK] 2023-05-01 to 2023-06-02 (  24 days): WEAK_COLLAPSE        - std=0.0018, corr=-0.175, dir_acc=0.512
[DEGD] 2023-06-05 to 2023-06-14 (   8 days): DEGRADED             - std=0.0004, corr=-0.102, dir_acc=0.560
[WEAK] 2023-06-15 to 2023-07-13 (  19 days): WEAK_COLLAPSE        - std=0.0005, corr=-0.009, dir_acc=0.542
[FAIL] 2023-07-14 to 2023-10-02 (  56 days): STRONG_COLLAPSE      - std=0.0035, corr=-0.038, dir_acc=0.539
[WEAK] 2023-10-03 to 2023-10-19 (  12 days): WEAK_COLLAPSE        - std=0.0015, corr=-0.087, dir_acc=0.479
[DEGD] 2023-10-20 to 2023-11-13 (  17 days): DEGRADED             - std=0.0046, corr=-0.078, dir_acc=0.462
[ OK ] 2023-11-14 to 2023-11-27 (   9 days): HEALTHY              - std=0.0006, corr=-0.119, dir_acc=0.546
[WEAK] 2023-12-01 to 2023-12-19 (  13 days): WEAK_COLLAPSE        - std=0.0011, corr=-0.089, dir_acc=0.568
[DEGD] 2023-12-20 to 2024-01-26 (  25 days): DEGRADED             - std=0.0009, corr=-0.056, dir_acc=0.629
[WEAK] 2024-01-29 to 2024-02-13 (  12 days): WEAK_COLLAPSE        - std=0.0002, corr=-0.145, dir_acc=0.651
[FAIL] 2024-02-14 to 2024-08-06 ( 120 days): STRONG_COLLAPSE      - std=0.0029, corr=-0.032, dir_acc=0.571
[DEGD] 2024-08-07 to 2024-08-14 (   6 days): DEGRADED             - std=0.0040, corr=-0.056, dir_acc=0.603
[ OK ] 2024-08-15 to 2025-02-24 ( 129 days): HEALTHY              - std=0.0052, corr=-0.250, dir_acc=0.578
[DEGD] 2025-02-25 to 2025-03-10 (  10 days): DEGRADED             - std=0.0070, corr=-0.227, dir_acc=0.498
[DEGD] 2025-03-14 to 2025-03-27 (  10 days): DEGRADED             - std=0.0052, corr=-0.045, dir_acc=0.512
[ OK ] 2025-03-28 to 2025-04-22 (  17 days): HEALTHY              - std=0.0077, corr=+0.057, dir_acc=0.512
[ OK ] 2025-04-29 to 2025-09-12 (  95 days): HEALTHY              - std=0.0131, corr=-0.136, dir_acc=0.584
[WEAK] 2025-09-19 to 2025-10-02 (  10 days): WEAK_COLLAPSE        - std=0.0004, corr=-0.114, dir_acc=0.567
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           392 days ( 31.1%)
  DEGRADED:          389 days ( 30.9%)
  WEAK_COLLAPSE:     179 days ( 14.2%)
  STRONG_COLLAPSE:   300 days ( 23.8%)

  Total problematic:  868 days (68.9%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_combo1/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.168689
  RMSE:             1.081059
  MAE:              0.769293
  Out-of-sample RÂ²: -0.0016

FINANCIAL METRICS:
  Directional Acc:  53.49%
  Sharpe Ratio:     0.8492
  Total Return:     92.40%
  Max Drawdown:     -25.25%
  Hit Rate:         53.49%
  Number of Trades: 1260

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5349
  Recall:           1.0000
  F1 Score:         0.6970
  AUC-ROC:          0.4990

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             586
  Actual Up:            0             674

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_combo1/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:00:31
======================================================================
  ✓ Success

Processing: 00_baseline_exploration/sweep2_combo2
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_combo2
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_combo2/checkpoints/tft-epoch=03-val_loss=0.1249.ckpt
  Validation loss: 0.124887

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_combo2/config.json
Output directory: experiments/00_baseline_exploration/sweep2_combo2/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_combo2/evaluation/evaluation_20251026_170032.log
Evaluation started at: 2025-10-26 17:00:32
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1271 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1270, Total actuals: 1270

Prediction Generation Summary:
  Total predictions: 1270
  Test dataset size: 1270
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.071648
    Max: -0.024248
    Mean: -0.044235
    Std: 0.011009
    Unique values: 1266

WARNING: Predictions (1270) < Test samples (1300)
Date range: 2020-09-02T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-09-02T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1270 samples)
Computing metrics...
Predictions - min: -0.0716, max: -0.0242, mean: -0.0442
Negative predictions: 1270/1270
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  297 days ( 23.4%)
2. Range-based                 [WARN] 1176 days ( 92.6%)
3. Consecutive-similarity      [WARN] 1230 days ( 96.9%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   778 days ( 61.3%)
  Directional acc < 52%                976 days ( 76.9%)
  Combined (BOTH poor)         [WARN]   612 days ( 48.2%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-09-02 to 2020-10-14 (  29 days): HEALTHY              - std=0.0019, corr=+nan, dir_acc=nan
[WEAK] 2020-10-16 to 2021-03-10 (  98 days): WEAK_COLLAPSE        - std=0.0045, corr=-0.086, dir_acc=0.464
[FAIL] 2021-03-11 to 2021-03-26 (  12 days): STRONG_COLLAPSE      - std=0.0009, corr=+0.061, dir_acc=0.432
[WEAK] 2021-03-29 to 2021-07-20 (  79 days): WEAK_COLLAPSE        - std=0.0027, corr=-0.013, dir_acc=0.460
[FAIL] 2021-07-21 to 2021-12-14 ( 101 days): STRONG_COLLAPSE      - std=0.0009, corr=+0.015, dir_acc=0.411
[WEAK] 2021-12-15 to 2022-03-17 (  64 days): WEAK_COLLAPSE        - std=0.0044, corr=+0.126, dir_acc=0.499
[DEGD] 2022-03-18 to 2022-06-21 (  65 days): DEGRADED             - std=0.0060, corr=-0.108, dir_acc=0.545
[WEAK] 2022-06-22 to 2023-07-24 ( 271 days): WEAK_COLLAPSE        - std=0.0099, corr=-0.045, dir_acc=0.534
[FAIL] 2023-07-25 to 2023-09-18 (  39 days): STRONG_COLLAPSE      - std=0.0013, corr=-0.050, dir_acc=0.456
[WEAK] 2023-09-27 to 2024-02-14 (  96 days): WEAK_COLLAPSE        - std=0.0029, corr=-0.143, dir_acc=0.441
[FAIL] 2024-02-15 to 2024-04-18 (  44 days): STRONG_COLLAPSE      - std=0.0011, corr=-0.168, dir_acc=0.415
[WEAK] 2024-04-19 to 2024-06-24 (  45 days): WEAK_COLLAPSE        - std=0.0010, corr=-0.023, dir_acc=0.477
[FAIL] 2024-06-25 to 2024-08-06 (  30 days): STRONG_COLLAPSE      - std=0.0012, corr=-0.024, dir_acc=0.378
[WEAK] 2024-08-07 to 2024-11-01 (  61 days): WEAK_COLLAPSE        - std=0.0016, corr=+0.138, dir_acc=0.411
[FAIL] 2024-11-04 to 2024-12-18 (  31 days): STRONG_COLLAPSE      - std=0.0008, corr=+0.159, dir_acc=0.420
[WEAK] 2024-12-19 to 2025-05-16 ( 101 days): WEAK_COLLAPSE        - std=0.0039, corr=-0.010, dir_acc=0.465
[DEGD] 2025-05-19 to 2025-06-02 (  10 days): DEGRADED             - std=0.0022, corr=-0.005, dir_acc=0.425
[WEAK] 2025-06-03 to 2025-08-14 (  51 days): WEAK_COLLAPSE        - std=0.0005, corr=+0.009, dir_acc=0.392
[FAIL] 2025-08-15 to 2025-10-06 (  36 days): STRONG_COLLAPSE      - std=0.0004, corr=-0.191, dir_acc=0.436
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            29 days (  2.3%)
  DEGRADED:           76 days (  6.0%)
  WEAK_COLLAPSE:     868 days ( 68.3%)
  STRONG_COLLAPSE:   297 days ( 23.4%)

  Total problematic: 1241 days (97.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_combo2/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.192757
  RMSE:             1.092134
  MAE:              0.780820
  Out-of-sample RÂ²: -0.0079

FINANCIAL METRICS:
  Directional Acc:  46.54%
  Sharpe Ratio:     0.0000
  Total Return:     0.00%
  Max Drawdown:     0.00%
  Hit Rate:         0.00%
  Number of Trades: 0

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.0000
  Recall:           0.0000
  F1 Score:         0.0000
  AUC-ROC:          0.5398

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        591               0
  Actual Up:          679               0

ALPHA (vs Buy-and-Hold):
  Excess Return:    -84.70%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_combo2/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:00:34
======================================================================
  ✓ Success

Processing: 00_baseline_exploration/sweep2_combo3
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_combo3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_combo3/checkpoints/tft-epoch=03-val_loss=0.1409.ckpt
  Validation loss: 0.140893

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_combo3/config.json
Output directory: experiments/00_baseline_exploration/sweep2_combo3/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_combo3/evaluation/evaluation_20251026_170035.log
Evaluation started at: 2025-10-26 17:00:35
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1271 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1270, Total actuals: 1270

Prediction Generation Summary:
  Total predictions: 1270
  Test dataset size: 1270
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.081186
    Max: 0.507954
    Mean: 0.192054
    Std: 0.113448
    Unique values: 1270

WARNING: Predictions (1270) < Test samples (1300)
Date range: 2020-09-02T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-09-02T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1270 samples)
Computing metrics...
Predictions - min: 0.0812, max: 0.5080, mean: 0.1921
Negative predictions: 0/1270
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   97 days (  7.6%)
2. Range-based                 [WARN]  181 days ( 14.3%)
3. Consecutive-similarity      [ OK ]   94 days (  7.4%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   167 days ( 13.1%)
  Directional acc < 52%                495 days ( 39.0%)
  Combined (BOTH poor)         [ OK ]    61 days (  4.8%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-09-02 to 2020-10-22 (  35 days): HEALTHY              - std=0.0104, corr=+0.208, dir_acc=0.509
[DEGD] 2020-10-23 to 2020-11-30 (  25 days): DEGRADED             - std=0.0040, corr=+0.188, dir_acc=0.515
[ OK ] 2020-12-01 to 2021-03-04 (  64 days): HEALTHY              - std=0.0078, corr=+0.071, dir_acc=0.547
[ OK ] 2021-03-08 to 2021-04-30 (  39 days): HEALTHY              - std=0.0397, corr=+0.057, dir_acc=0.549
[ OK ] 2021-05-07 to 2021-09-08 (  86 days): HEALTHY              - std=0.0193, corr=+0.108, dir_acc=0.564
[DEGD] 2021-09-09 to 2021-09-20 (   8 days): DEGRADED             - std=0.0040, corr=+0.203, dir_acc=0.604
[ OK ] 2021-09-21 to 2022-08-03 ( 217 days): HEALTHY              - std=0.1305, corr=+0.152, dir_acc=0.503
[DEGD] 2022-08-04 to 2022-08-19 (  12 days): DEGRADED             - std=0.0355, corr=-0.066, dir_acc=0.476
[ OK ] 2022-08-22 to 2023-01-23 ( 104 days): HEALTHY              - std=0.0863, corr=+0.181, dir_acc=0.419
[DEGD] 2023-02-09 to 2023-02-23 (  10 days): DEGRADED             - std=0.0059, corr=-0.045, dir_acc=0.443
[ OK ] 2023-03-06 to 2023-06-27 (  79 days): HEALTHY              - std=0.0703, corr=+0.152, dir_acc=0.519
[ OK ] 2023-07-10 to 2023-07-27 (  14 days): HEALTHY              - std=0.0028, corr=-0.050, dir_acc=0.557
[DEGD] 2023-07-28 to 2023-08-25 (  21 days): DEGRADED             - std=0.0022, corr=+0.086, dir_acc=0.559
[WEAK] 2023-08-28 to 2023-10-04 (  27 days): WEAK_COLLAPSE        - std=0.0042, corr=+0.001, dir_acc=0.511
[ OK ] 2023-10-05 to 2023-10-24 (  13 days): HEALTHY              - std=0.0116, corr=+0.161, dir_acc=0.465
[ OK ] 2023-10-31 to 2024-02-08 (  69 days): HEALTHY              - std=0.0173, corr=+0.191, dir_acc=0.585
[FAIL] 2024-02-13 to 2024-04-22 (  48 days): STRONG_COLLAPSE      - std=0.0024, corr=-0.198, dir_acc=0.583
[DEGD] 2024-04-30 to 2024-05-07 (   6 days): DEGRADED             - std=0.0019, corr=+0.032, dir_acc=0.500
[DEGD] 2024-05-15 to 2024-07-08 (  36 days): DEGRADED             - std=0.0032, corr=+0.094, dir_acc=0.549
[WEAK] 2024-07-09 to 2024-07-18 (   8 days): WEAK_COLLAPSE        - std=0.0006, corr=+0.039, dir_acc=0.654
[FAIL] 2024-07-19 to 2024-08-02 (  11 days): STRONG_COLLAPSE      - std=0.0019, corr=-0.061, dir_acc=0.633
[ OK ] 2024-08-05 to 2025-04-04 ( 166 days): HEALTHY              - std=0.0479, corr=+0.161, dir_acc=0.567
[ OK ] 2025-04-22 to 2025-09-30 ( 112 days): HEALTHY              - std=0.1156, corr=+0.105, dir_acc=0.579
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:          1016 days ( 80.0%)
  DEGRADED:          148 days ( 11.7%)
  WEAK_COLLAPSE:      47 days (  3.7%)
  STRONG_COLLAPSE:    59 days (  4.6%)

  Total problematic:  254 days (20.0%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_combo3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.212385
  RMSE:             1.101084
  MAE:              0.785103
  Out-of-sample RÂ²: -0.0245

FINANCIAL METRICS:
  Directional Acc:  53.46%
  Sharpe Ratio:     0.7915
  Total Return:     84.70%
  Max Drawdown:     -25.25%
  Hit Rate:         53.46%
  Number of Trades: 1270

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5346
  Recall:           1.0000
  F1 Score:         0.6968
  AUC-ROC:          0.4733

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             591
  Actual Up:            0             679

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_combo3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:00:36
======================================================================
  ✓ Success

Processing: 00_baseline_exploration/sweep2_h16_drop_0.2
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_h16_drop_0.2
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_h16_drop_0.2/checkpoints/tft-epoch=01-val_loss=0.1284.ckpt
  Validation loss: 0.128439

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_h16_drop_0.2/config.json
Output directory: experiments/00_baseline_exploration/sweep2_h16_drop_0.2/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_h16_drop_0.2/evaluation/evaluation_20251026_170038.log
Evaluation started at: 2025-10-26 17:00:38
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.083295
    Max: 0.170167
    Mean: 0.017215
    Std: 0.077218
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0833, max: 0.1702, mean: 0.0172
Negative predictions: 646/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   83 days (  6.5%)
2. Range-based                 [WARN]  186 days ( 14.5%)
3. Consecutive-similarity      [WARN]  290 days ( 22.7%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   766 days ( 59.8%)
  Directional acc < 52%                551 days ( 43.0%)
  Combined (BOTH poor)         [WARN]   344 days ( 26.9%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-11-04 (  54 days): HEALTHY              - std=0.0077, corr=+0.070, dir_acc=0.418
[DEGD] 2020-11-05 to 2020-11-13 (   6 days): DEGRADED             - std=0.0036, corr=-0.009, dir_acc=0.429
[DEGD] 2020-11-18 to 2021-04-05 (  93 days): DEGRADED             - std=0.0152, corr=-0.169, dir_acc=0.449
[ OK ] 2021-04-06 to 2021-04-13 (   6 days): HEALTHY              - std=0.0087, corr=+0.023, dir_acc=0.472
[ OK ] 2021-05-03 to 2021-05-12 (   8 days): HEALTHY              - std=0.0079, corr=+0.018, dir_acc=0.527
[DEGD] 2021-05-13 to 2021-06-10 (  20 days): DEGRADED             - std=0.0085, corr=-0.077, dir_acc=0.497
[ OK ] 2021-06-21 to 2021-07-23 (  24 days): HEALTHY              - std=0.0116, corr=-0.138, dir_acc=0.548
[DEGD] 2021-08-11 to 2021-09-13 (  23 days): DEGRADED             - std=0.0046, corr=-0.120, dir_acc=0.478
[DEGD] 2021-09-15 to 2021-11-03 (  35 days): DEGRADED             - std=0.0155, corr=-0.135, dir_acc=0.440
[ OK ] 2021-11-15 to 2021-12-06 (  15 days): HEALTHY              - std=0.0161, corr=+0.048, dir_acc=0.418
[DEGD] 2021-12-07 to 2021-12-17 (   9 days): DEGRADED             - std=0.0054, corr=-0.032, dir_acc=0.391
[DEGD] 2021-12-22 to 2022-01-04 (   9 days): DEGRADED             - std=0.0030, corr=-0.032, dir_acc=0.383
[ OK ] 2022-01-18 to 2022-05-26 (  91 days): HEALTHY              - std=0.0084, corr=-0.163, dir_acc=0.552
[DEGD] 2022-05-27 to 2022-06-15 (  13 days): DEGRADED             - std=0.0019, corr=-0.177, dir_acc=0.513
[WEAK] 2022-06-16 to 2022-07-22 (  25 days): WEAK_COLLAPSE        - std=0.0057, corr=-0.063, dir_acc=0.545
[DEGD] 2022-07-25 to 2022-09-23 (  44 days): DEGRADED             - std=0.0019, corr=-0.099, dir_acc=0.534
[WEAK] 2022-09-26 to 2022-10-06 (   9 days): WEAK_COLLAPSE        - std=0.0014, corr=+0.081, dir_acc=0.572
[FAIL] 2022-10-07 to 2022-12-20 (  50 days): STRONG_COLLAPSE      - std=0.0029, corr=+0.125, dir_acc=0.601
[WEAK] 2022-12-21 to 2022-12-30 (   7 days): WEAK_COLLAPSE        - std=0.0018, corr=+0.110, dir_acc=0.595
[FAIL] 2023-01-03 to 2023-02-01 (  21 days): STRONG_COLLAPSE      - std=0.0020, corr=+0.059, dir_acc=0.571
[WEAK] 2023-02-02 to 2023-03-14 (  28 days): WEAK_COLLAPSE        - std=0.0020, corr=+0.079, dir_acc=0.546
[FAIL] 2023-03-15 to 2023-03-30 (  12 days): STRONG_COLLAPSE      - std=0.0038, corr=-0.020, dir_acc=0.506
[DEGD] 2023-04-10 to 2023-06-27 (  55 days): DEGRADED             - std=0.0107, corr=+0.004, dir_acc=0.472
[ OK ] 2023-07-11 to 2023-07-28 (  14 days): HEALTHY              - std=0.0153, corr=+0.048, dir_acc=0.510
[DEGD] 2023-07-31 to 2023-09-08 (  29 days): DEGRADED             - std=0.0067, corr=-0.169, dir_acc=0.484
[DEGD] 2023-09-19 to 2023-11-09 (  37 days): DEGRADED             - std=0.0112, corr=-0.129, dir_acc=0.474
[ OK ] 2023-11-10 to 2024-02-26 (  72 days): HEALTHY              - std=0.0122, corr=+0.075, dir_acc=0.604
[WEAK] 2024-02-27 to 2024-04-08 (  29 days): WEAK_COLLAPSE        - std=0.0033, corr=+0.004, dir_acc=0.587
[ OK ] 2024-04-16 to 2025-02-27 ( 216 days): HEALTHY              - std=0.0277, corr=-0.051, dir_acc=0.571
[ OK ] 2025-03-06 to 2025-04-07 (  23 days): HEALTHY              - std=0.0310, corr=+0.058, dir_acc=0.511
[ OK ] 2025-04-09 to 2025-10-06 ( 124 days): HEALTHY              - std=0.0343, corr=-0.128, dir_acc=0.574
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           691 days ( 54.0%)
  DEGRADED:          403 days ( 31.5%)
  WEAK_COLLAPSE:     103 days (  8.0%)
  STRONG_COLLAPSE:    83 days (  6.5%)

  Total problematic:  589 days (46.0%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_h16_drop_0.2/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.181262
  RMSE:             1.086859
  MAE:              0.772644
  Out-of-sample RÂ²: -0.0038

FINANCIAL METRICS:
  Directional Acc:  53.05%
  Sharpe Ratio:     0.9282
  Total Return:     60.09%
  Max Drawdown:     -18.90%
  Hit Rate:         28.12%
  Number of Trades: 634

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5678
  Recall:           0.5240
  F1 Score:         0.5450
  AUC-ROC:          0.5435

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        319             274
  Actual Up:          327             360

ALPHA (vs Buy-and-Hold):
  Excess Return:    -32.08%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_h16_drop_0.2/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:00:39
======================================================================
  ✓ Success

Processing: 00_baseline_exploration/sweep2_h16_drop_0.25
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_h16_drop_0.25
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_h16_drop_0.25/checkpoints/tft-epoch=01-val_loss=0.1260.ckpt
  Validation loss: 0.125999

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_h16_drop_0.25/config.json
Output directory: experiments/00_baseline_exploration/sweep2_h16_drop_0.25/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_h16_drop_0.25/evaluation/evaluation_20251026_170040.log
Evaluation started at: 2025-10-26 17:00:40
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.060714
    Max: 0.193351
    Mean: 0.039860
    Std: 0.077330
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0607, max: 0.1934, mean: 0.0399
Negative predictions: 582/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   49 days (  3.8%)
2. Range-based                 [WARN]  184 days ( 14.4%)
3. Consecutive-similarity      [WARN]  286 days ( 22.3%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   767 days ( 59.9%)
  Directional acc < 52%                499 days ( 39.0%)
  Combined (BOTH poor)         [WARN]   313 days ( 24.5%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-11-04 (  54 days): HEALTHY              - std=0.0077, corr=+0.069, dir_acc=0.418
[DEGD] 2020-11-05 to 2020-11-13 (   6 days): DEGRADED             - std=0.0036, corr=-0.007, dir_acc=0.429
[DEGD] 2020-11-18 to 2021-04-05 (  93 days): DEGRADED             - std=0.0151, corr=-0.167, dir_acc=0.448
[ OK ] 2021-04-06 to 2021-04-13 (   6 days): HEALTHY              - std=0.0086, corr=+0.024, dir_acc=0.472
[ OK ] 2021-05-03 to 2021-05-12 (   8 days): HEALTHY              - std=0.0078, corr=+0.018, dir_acc=0.527
[DEGD] 2021-05-13 to 2021-06-09 (  19 days): DEGRADED             - std=0.0086, corr=-0.079, dir_acc=0.494
[ OK ] 2021-06-10 to 2021-07-23 (  31 days): HEALTHY              - std=0.0126, corr=-0.130, dir_acc=0.548
[ OK ] 2021-08-11 to 2021-08-20 (   8 days): HEALTHY              - std=0.0053, corr=-0.111, dir_acc=0.552
[DEGD] 2021-08-23 to 2021-09-13 (  15 days): DEGRADED             - std=0.0042, corr=-0.130, dir_acc=0.481
[DEGD] 2021-09-15 to 2021-11-03 (  35 days): DEGRADED             - std=0.0158, corr=-0.136, dir_acc=0.433
[ OK ] 2021-11-15 to 2022-02-03 (  56 days): HEALTHY              - std=0.0138, corr=-0.005, dir_acc=0.557
[ OK ] 2022-02-10 to 2022-05-26 (  74 days): HEALTHY              - std=0.0090, corr=-0.192, dir_acc=0.559
[DEGD] 2022-05-27 to 2022-06-17 (  15 days): DEGRADED             - std=0.0024, corr=-0.178, dir_acc=0.517
[WEAK] 2022-06-21 to 2022-07-22 (  23 days): WEAK_COLLAPSE        - std=0.0053, corr=-0.058, dir_acc=0.545
[DEGD] 2022-07-25 to 2022-09-23 (  44 days): DEGRADED             - std=0.0020, corr=-0.097, dir_acc=0.534
[WEAK] 2022-09-26 to 2022-10-07 (  10 days): WEAK_COLLAPSE        - std=0.0014, corr=+0.092, dir_acc=0.572
[WEAK] 2022-10-14 to 2022-11-18 (  25 days): WEAK_COLLAPSE        - std=0.0017, corr=+0.146, dir_acc=0.597
[FAIL] 2022-11-21 to 2022-12-19 (  20 days): STRONG_COLLAPSE      - std=0.0030, corr=+0.121, dir_acc=0.608
[WEAK] 2022-12-20 to 2023-01-10 (  14 days): WEAK_COLLAPSE        - std=0.0019, corr=+0.111, dir_acc=0.595
[FAIL] 2023-01-11 to 2023-01-31 (  14 days): STRONG_COLLAPSE      - std=0.0014, corr=+0.046, dir_acc=0.565
[WEAK] 2023-02-01 to 2023-03-14 (  29 days): WEAK_COLLAPSE        - std=0.0021, corr=+0.081, dir_acc=0.545
[FAIL] 2023-03-15 to 2023-03-30 (  12 days): STRONG_COLLAPSE      - std=0.0038, corr=-0.008, dir_acc=0.506
[DEGD] 2023-04-10 to 2023-06-14 (  47 days): DEGRADED             - std=0.0064, corr=+0.013, dir_acc=0.477
[DEGD] 2023-06-16 to 2023-06-27 (   7 days): DEGRADED             - std=0.0071, corr=-0.072, dir_acc=0.448
[ OK ] 2023-07-11 to 2023-07-20 (   8 days): HEALTHY              - std=0.0083, corr=+0.068, dir_acc=0.500
[DEGD] 2023-07-31 to 2023-09-08 (  29 days): DEGRADED             - std=0.0064, corr=-0.169, dir_acc=0.484
[DEGD] 2023-09-15 to 2023-11-09 (  39 days): DEGRADED             - std=0.0117, corr=-0.137, dir_acc=0.477
[ OK ] 2023-11-10 to 2024-02-26 (  72 days): HEALTHY              - std=0.0129, corr=+0.078, dir_acc=0.604
[WEAK] 2024-02-27 to 2024-04-08 (  29 days): WEAK_COLLAPSE        - std=0.0033, corr=+0.004, dir_acc=0.587
[ OK ] 2024-04-16 to 2025-03-04 ( 219 days): HEALTHY              - std=0.0277, corr=-0.047, dir_acc=0.570
[ OK ] 2025-03-06 to 2025-04-07 (  23 days): HEALTHY              - std=0.0314, corr=+0.061, dir_acc=0.511
[ OK ] 2025-04-09 to 2025-10-06 ( 124 days): HEALTHY              - std=0.0338, corr=-0.129, dir_acc=0.574
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           722 days ( 56.4%)
  DEGRADED:          374 days ( 29.2%)
  WEAK_COLLAPSE:     135 days ( 10.5%)
  STRONG_COLLAPSE:    49 days (  3.8%)

  Total problematic:  558 days (43.6%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_h16_drop_0.25/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.180080
  RMSE:             1.086315
  MAE:              0.772187
  Out-of-sample RÂ²: -0.0028

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     1.0193
  Total Return:     69.87%
  Max Drawdown:     -18.90%
  Hit Rate:         30.94%
  Number of Trades: 698

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5673
  Recall:           0.5764
  F1 Score:         0.5718
  AUC-ROC:          0.5429

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        291             302
  Actual Up:          291             396

ALPHA (vs Buy-and-Hold):
  Excess Return:    -22.29%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_h16_drop_0.25/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:00:41
======================================================================
  ✓ Success

Processing: 00_baseline_exploration/sweep2_h16_enc_40
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_h16_enc_40
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_h16_enc_40/checkpoints/tft-epoch=01-val_loss=0.1277.ckpt
  Validation loss: 0.127670

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_h16_enc_40/config.json
Output directory: experiments/00_baseline_exploration/sweep2_h16_enc_40/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_h16_enc_40/evaluation/evaluation_20251026_170043.log
Evaluation started at: 2025-10-26 17:00:43
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1261 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1260, Total actuals: 1260

Prediction Generation Summary:
  Total predictions: 1260
  Test dataset size: 1260
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.096524
    Max: 0.132057
    Mean: -0.008205
    Std: 0.069638
    Unique values: 1260

WARNING: Predictions (1260) < Test samples (1300)
Date range: 2020-09-17T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-09-17T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1260 samples)
Computing metrics...
Predictions - min: -0.0965, max: 0.1321, mean: -0.0082
Negative predictions: 723/1260
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  129 days ( 10.2%)
2. Range-based                 [WARN]  244 days ( 19.4%)
3. Consecutive-similarity      [WARN]  333 days ( 26.4%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   865 days ( 68.7%)
  Directional acc < 52%                590 days ( 46.8%)
  Combined (BOTH poor)         [WARN]   443 days ( 35.2%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-09-17 to 2020-10-28 (  29 days): HEALTHY              - std=0.0028, corr=+nan, dir_acc=nan
[DEGD] 2020-10-29 to 2021-04-08 ( 109 days): DEGRADED             - std=0.0174, corr=-0.194, dir_acc=0.456
[DEGD] 2021-04-22 to 2021-04-30 (   7 days): DEGRADED             - std=0.0013, corr=-0.039, dir_acc=0.490
[DEGD] 2021-05-12 to 2021-09-13 (  86 days): DEGRADED             - std=0.0182, corr=-0.144, dir_acc=0.436
[DEGD] 2021-09-22 to 2021-11-04 (  31 days): DEGRADED             - std=0.0134, corr=-0.085, dir_acc=0.427
[ OK ] 2021-11-17 to 2021-11-24 (   6 days): HEALTHY              - std=0.0023, corr=+0.012, dir_acc=0.414
[DEGD] 2021-12-06 to 2022-01-20 (  32 days): DEGRADED             - std=0.0053, corr=-0.072, dir_acc=0.408
[ OK ] 2022-01-25 to 2022-04-18 (  58 days): HEALTHY              - std=0.0052, corr=-0.181, dir_acc=0.558
[ OK ] 2022-04-20 to 2022-05-06 (  13 days): HEALTHY              - std=0.0027, corr=-0.219, dir_acc=0.550
[DEGD] 2022-05-11 to 2022-06-03 (  17 days): DEGRADED             - std=0.0020, corr=-0.200, dir_acc=0.540
[WEAK] 2022-06-06 to 2022-06-21 (  11 days): WEAK_COLLAPSE        - std=0.0021, corr=-0.301, dir_acc=0.520
[FAIL] 2022-06-22 to 2022-07-07 (  11 days): STRONG_COLLAPSE      - std=0.0026, corr=-0.147, dir_acc=0.555
[WEAK] 2022-07-08 to 2022-08-26 (  36 days): WEAK_COLLAPSE        - std=0.0019, corr=-0.197, dir_acc=0.530
[DEGD] 2022-08-29 to 2022-09-16 (  14 days): DEGRADED             - std=0.0010, corr=+0.006, dir_acc=0.542
[WEAK] 2022-09-19 to 2022-10-25 (  26 days): WEAK_COLLAPSE        - std=0.0020, corr=+0.177, dir_acc=0.576
[FAIL] 2022-10-26 to 2023-04-03 ( 108 days): STRONG_COLLAPSE      - std=0.0027, corr=-0.023, dir_acc=0.568
[WEAK] 2023-04-04 to 2023-05-08 (  24 days): WEAK_COLLAPSE        - std=0.0017, corr=+0.032, dir_acc=0.483
[DEGD] 2023-05-09 to 2023-06-26 (  33 days): DEGRADED             - std=0.0047, corr=-0.027, dir_acc=0.464
[DEGD] 2023-06-28 to 2023-07-10 (   8 days): DEGRADED             - std=0.0069, corr=+0.032, dir_acc=0.473
[ OK ] 2023-07-11 to 2023-07-28 (  14 days): HEALTHY              - std=0.0078, corr=+0.052, dir_acc=0.439
[DEGD] 2023-07-31 to 2023-10-12 (  52 days): DEGRADED             - std=0.0058, corr=-0.151, dir_acc=0.452
[ OK ] 2023-10-20 to 2024-03-21 ( 105 days): HEALTHY              - std=0.0252, corr=+0.069, dir_acc=0.575
[FAIL] 2024-03-25 to 2024-04-05 (   9 days): STRONG_COLLAPSE      - std=0.0020, corr=-0.060, dir_acc=0.557
[WEAK] 2024-04-08 to 2024-04-15 (   6 days): WEAK_COLLAPSE        - std=0.0016, corr=+0.051, dir_acc=0.558
[DEGD] 2024-04-16 to 2024-06-03 (  34 days): DEGRADED             - std=0.0094, corr=+0.027, dir_acc=0.510
[ OK ] 2024-06-04 to 2025-02-24 ( 179 days): HEALTHY              - std=0.0264, corr=-0.145, dir_acc=0.584
[DEGD] 2025-02-25 to 2025-03-10 (  10 days): DEGRADED             - std=0.0150, corr=-0.115, dir_acc=0.498
[DEGD] 2025-03-14 to 2025-03-28 (  11 days): DEGRADED             - std=0.0070, corr=-0.078, dir_acc=0.512
[ OK ] 2025-03-31 to 2025-10-06 ( 131 days): HEALTHY              - std=0.0296, corr=+0.044, dir_acc=0.572
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           561 days ( 44.5%)
  DEGRADED:          466 days ( 37.0%)
  WEAK_COLLAPSE:     105 days (  8.3%)
  STRONG_COLLAPSE:   128 days ( 10.2%)

  Total problematic:  699 days (55.5%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_h16_enc_40/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.172904
  RMSE:             1.083007
  MAE:              0.770170
  Out-of-sample RÂ²: -0.0052

FINANCIAL METRICS:
  Directional Acc:  52.46%
  Sharpe Ratio:     0.8151
  Total Return:     47.55%
  Max Drawdown:     -18.90%
  Hit Rate:         24.29%
  Number of Trades: 537

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5698
  Recall:           0.4540
  F1 Score:         0.5054
  AUC-ROC:          0.5443

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        355             231
  Actual Up:          368             306

ALPHA (vs Buy-and-Hold):
  Excess Return:    -44.86%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_h16_enc_40/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:00:44
======================================================================
  ✓ Success

Processing: 00_baseline_exploration/sweep2_h16_enc_50
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_h16_enc_50
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_h16_enc_50/checkpoints/tft-epoch=01-val_loss=0.1314.ckpt
  Validation loss: 0.131412

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_h16_enc_50/config.json
Output directory: experiments/00_baseline_exploration/sweep2_h16_enc_50/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_h16_enc_50/evaluation/evaluation_20251026_170045.log
Evaluation started at: 2025-10-26 17:00:45
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1251 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1250, Total actuals: 1250

Prediction Generation Summary:
  Total predictions: 1250
  Test dataset size: 1250
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.104499
    Max: 0.127710
    Mean: -0.015148
    Std: 0.069373
    Unique values: 1250

WARNING: Predictions (1250) < Test samples (1300)
Date range: 2020-10-01T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-10-01T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1250 samples)
Computing metrics...
Predictions - min: -0.1045, max: 0.1277, mean: -0.0151
Negative predictions: 744/1250
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  226 days ( 18.1%)
2. Range-based                 [WARN]  242 days ( 19.4%)
3. Consecutive-similarity      [WARN]  369 days ( 29.5%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   960 days ( 76.8%)
  Directional acc < 52%                542 days ( 43.4%)
  Combined (BOTH poor)         [WARN]   434 days ( 34.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-10-01 to 2020-11-12 (  29 days): HEALTHY              - std=0.0054, corr=+nan, dir_acc=nan
[DEGD] 2020-11-13 to 2021-04-14 ( 103 days): DEGRADED             - std=0.0173, corr=-0.193, dir_acc=0.454
[DEGD] 2021-04-20 to 2021-05-04 (  11 days): DEGRADED             - std=0.0033, corr=-0.034, dir_acc=0.479
[DEGD] 2021-05-10 to 2021-09-13 (  88 days): DEGRADED             - std=0.0179, corr=-0.151, dir_acc=0.420
[DEGD] 2021-09-23 to 2021-10-12 (  13 days): DEGRADED             - std=0.0039, corr=-0.064, dir_acc=0.453
[DEGD] 2021-10-14 to 2021-11-17 (  24 days): DEGRADED             - std=0.0047, corr=-0.065, dir_acc=0.399
[DEGD] 2021-11-19 to 2021-11-30 (   7 days): DEGRADED             - std=0.0062, corr=-0.017, dir_acc=0.424
[DEGD] 2021-12-06 to 2022-01-20 (  32 days): DEGRADED             - std=0.0038, corr=-0.090, dir_acc=0.408
[ OK ] 2022-01-25 to 2022-05-11 (  75 days): HEALTHY              - std=0.0059, corr=-0.161, dir_acc=0.556
[DEGD] 2022-05-25 to 2022-06-02 (   6 days): DEGRADED             - std=0.0008, corr=-0.215, dir_acc=0.519
[FAIL] 2022-06-06 to 2022-09-02 (  63 days): STRONG_COLLAPSE      - std=0.0049, corr=-0.198, dir_acc=0.535
[FAIL] 2022-09-14 to 2023-04-18 ( 147 days): STRONG_COLLAPSE      - std=0.0039, corr=-0.018, dir_acc=0.562
[WEAK] 2023-04-19 to 2023-05-15 (  19 days): WEAK_COLLAPSE        - std=0.0009, corr=+0.012, dir_acc=0.492
[DEGD] 2023-05-16 to 2023-06-26 (  28 days): DEGRADED             - std=0.0049, corr=-0.041, dir_acc=0.457
[DEGD] 2023-06-28 to 2023-07-10 (   8 days): DEGRADED             - std=0.0064, corr=+0.029, dir_acc=0.473
[ OK ] 2023-07-11 to 2023-07-28 (  14 days): HEALTHY              - std=0.0034, corr=+0.053, dir_acc=0.439
[DEGD] 2023-07-31 to 2023-09-25 (  40 days): DEGRADED             - std=0.0101, corr=-0.158, dir_acc=0.468
[ OK ] 2023-10-12 to 2023-11-01 (  15 days): HEALTHY              - std=0.0049, corr=-0.055, dir_acc=0.572
[ OK ] 2023-11-08 to 2024-04-01 (  98 days): HEALTHY              - std=0.0167, corr=-0.035, dir_acc=0.605
[FAIL] 2024-04-08 to 2024-04-16 (   7 days): STRONG_COLLAPSE      - std=0.0025, corr=+0.102, dir_acc=0.555
[DEGD] 2024-04-18 to 2024-06-12 (  39 days): DEGRADED             - std=0.0084, corr=+0.014, dir_acc=0.516
[DEGD] 2024-06-27 to 2024-08-06 (  28 days): DEGRADED             - std=0.0050, corr=-0.048, dir_acc=0.626
[ OK ] 2024-08-07 to 2025-02-24 ( 135 days): HEALTHY              - std=0.0273, corr=-0.195, dir_acc=0.579
[DEGD] 2025-02-25 to 2025-03-07 (   9 days): DEGRADED             - std=0.0114, corr=-0.102, dir_acc=0.500
[DEGD] 2025-03-14 to 2025-03-28 (  11 days): DEGRADED             - std=0.0047, corr=-0.055, dir_acc=0.512
[ OK ] 2025-03-31 to 2025-10-06 ( 131 days): HEALTHY              - std=0.0324, corr=-0.035, dir_acc=0.572
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           526 days ( 42.1%)
  DEGRADED:          478 days ( 38.2%)
  WEAK_COLLAPSE:      29 days (  2.3%)
  STRONG_COLLAPSE:   217 days ( 17.4%)

  Total problematic:  724 days (57.9%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_h16_enc_50/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.170961
  RMSE:             1.082109
  MAE:              0.768010
  Out-of-sample RÂ²: -0.0067

FINANCIAL METRICS:
  Directional Acc:  52.72%
  Sharpe Ratio:     0.9140
  Total Return:     53.48%
  Max Drawdown:     -18.90%
  Hit Rate:         23.36%
  Number of Trades: 506

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5771
  Recall:           0.4365
  F1 Score:         0.4970
  AUC-ROC:          0.5424

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        367             214
  Actual Up:          377             292

ALPHA (vs Buy-and-Hold):
  Excess Return:    -40.21%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_h16_enc_50/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:00:47
======================================================================
  ✓ Success

Processing: 00_baseline_exploration/sweep2_h16_lr_0.0002
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_h16_lr_0.0002
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_h16_lr_0.0002/checkpoints/tft-epoch=03-val_loss=0.1154.ckpt
  Validation loss: 0.115431

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_h16_lr_0.0002/config.json
Output directory: experiments/00_baseline_exploration/sweep2_h16_lr_0.0002/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_h16_lr_0.0002/evaluation/evaluation_20251026_170048.log
Evaluation started at: 2025-10-26 17:00:48
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.109191
    Max: 0.128515
    Mean: -0.011445
    Std: 0.070952
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.1092, max: 0.1285, mean: -0.0114
Negative predictions: 711/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  145 days ( 11.3%)
2. Range-based                 [WARN]  239 days ( 18.7%)
3. Consecutive-similarity      [WARN]  335 days ( 26.2%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   753 days ( 58.8%)
  Directional acc < 52%                608 days ( 47.5%)
  Combined (BOTH poor)         [WARN]   368 days ( 28.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-11-03 (  53 days): HEALTHY              - std=0.0089, corr=+0.068, dir_acc=0.418
[DEGD] 2020-11-04 to 2021-04-06 ( 103 days): DEGRADED             - std=0.0176, corr=-0.168, dir_acc=0.450
[ OK ] 2021-05-03 to 2021-05-13 (   9 days): HEALTHY              - std=0.0127, corr=+0.017, dir_acc=0.544
[DEGD] 2021-05-26 to 2021-06-08 (   9 days): DEGRADED             - std=0.0045, corr=-0.100, dir_acc=0.502
[DEGD] 2021-06-10 to 2021-09-13 (  66 days): DEGRADED             - std=0.0164, corr=-0.118, dir_acc=0.435
[DEGD] 2021-09-21 to 2021-11-02 (  30 days): DEGRADED             - std=0.0144, corr=-0.133, dir_acc=0.432
[ OK ] 2021-11-03 to 2021-12-06 (  22 days): HEALTHY              - std=0.0173, corr=+0.049, dir_acc=0.405
[DEGD] 2021-12-07 to 2021-12-16 (   8 days): DEGRADED             - std=0.0058, corr=-0.030, dir_acc=0.392
[DEGD] 2021-12-22 to 2022-01-04 (   9 days): DEGRADED             - std=0.0023, corr=-0.022, dir_acc=0.383
[ OK ] 2022-01-18 to 2022-05-26 (  91 days): HEALTHY              - std=0.0083, corr=-0.169, dir_acc=0.552
[DEGD] 2022-05-27 to 2022-06-13 (  11 days): DEGRADED             - std=0.0014, corr=-0.214, dir_acc=0.508
[FAIL] 2022-06-22 to 2022-07-14 (  16 days): STRONG_COLLAPSE      - std=0.0030, corr=-0.106, dir_acc=0.551
[WEAK] 2022-07-15 to 2022-08-30 (  33 days): WEAK_COLLAPSE        - std=0.0017, corr=-0.192, dir_acc=0.529
[DEGD] 2022-08-31 to 2022-09-09 (   7 days): DEGRADED             - std=0.0012, corr=-0.072, dir_acc=0.552
[WEAK] 2022-09-12 to 2022-09-26 (  11 days): WEAK_COLLAPSE        - std=0.0008, corr=+0.012, dir_acc=0.536
[FAIL] 2022-09-27 to 2023-04-04 ( 129 days): STRONG_COLLAPSE      - std=0.0029, corr=+0.051, dir_acc=0.570
[WEAK] 2023-04-05 to 2023-04-19 (  10 days): WEAK_COLLAPSE        - std=0.0014, corr=+0.080, dir_acc=0.477
[DEGD] 2023-04-20 to 2023-06-29 (  49 days): DEGRADED             - std=0.0100, corr=+0.004, dir_acc=0.471
[ OK ] 2023-07-11 to 2023-07-26 (  12 days): HEALTHY              - std=0.0141, corr=+0.058, dir_acc=0.454
[DEGD] 2023-07-31 to 2023-11-03 (  68 days): DEGRADED             - std=0.0094, corr=-0.129, dir_acc=0.415
[ OK ] 2023-11-06 to 2024-02-23 (  75 days): HEALTHY              - std=0.0132, corr=+0.076, dir_acc=0.564
[WEAK] 2024-02-26 to 2024-04-12 (  34 days): WEAK_COLLAPSE        - std=0.0045, corr=+0.017, dir_acc=0.585
[DEGD] 2024-04-15 to 2024-05-02 (  14 days): DEGRADED             - std=0.0047, corr=+0.156, dir_acc=0.507
[ OK ] 2024-05-03 to 2024-07-31 (  61 days): HEALTHY              - std=0.0056, corr=+0.020, dir_acc=0.570
[ OK ] 2024-08-09 to 2025-03-04 ( 139 days): HEALTHY              - std=0.0257, corr=-0.090, dir_acc=0.576
[ OK ] 2025-03-06 to 2025-04-04 (  22 days): HEALTHY              - std=0.0247, corr=+0.055, dir_acc=0.511
[ OK ] 2025-04-09 to 2025-10-06 ( 124 days): HEALTHY              - std=0.0304, corr=-0.104, dir_acc=0.574
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           638 days ( 49.8%)
  DEGRADED:          403 days ( 31.5%)
  WEAK_COLLAPSE:      94 days (  7.3%)
  STRONG_COLLAPSE:   145 days ( 11.3%)

  Total problematic:  642 days (50.2%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_h16_lr_0.0002/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.183532
  RMSE:             1.087903
  MAE:              0.774261
  Out-of-sample RÂ²: -0.0058

FINANCIAL METRICS:
  Directional Acc:  52.03%
  Sharpe Ratio:     0.7923
  Total Return:     47.32%
  Max Drawdown:     -18.90%
  Hit Rate:         25.08%
  Number of Trades: 569

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5641
  Recall:           0.4672
  F1 Score:         0.5111
  AUC-ROC:          0.5427

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        345             248
  Actual Up:          366             321

ALPHA (vs Buy-and-Hold):
  Excess Return:    -44.84%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_h16_lr_0.0002/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:00:49
======================================================================
  ✓ Success

Processing: 00_baseline_exploration/sweep2_hidden_10
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_hidden_10
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_hidden_10/checkpoints/tft-epoch=03-val_loss=0.1229.ckpt
  Validation loss: 0.122900

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_hidden_10/config.json
Output directory: experiments/00_baseline_exploration/sweep2_hidden_10/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_hidden_10/evaluation/evaluation_20251026_170051.log
Evaluation started at: 2025-10-26 17:00:51
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.072671
    Max: -0.022862
    Mean: -0.041874
    Std: 0.011204
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0727, max: -0.0229, mean: -0.0419
Negative predictions: 1280/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  480 days ( 37.5%)
2. Range-based                 [WARN] 1179 days ( 92.1%)
3. Consecutive-similarity      [WARN] 1226 days ( 95.8%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   838 days ( 65.5%)
  Directional acc < 52%                986 days ( 77.0%)
  Combined (BOTH poor)         [WARN]   664 days ( 51.9%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0024, corr=+nan, dir_acc=nan
[WEAK] 2020-10-01 to 2021-02-24 (  98 days): WEAK_COLLAPSE        - std=0.0048, corr=-0.114, dir_acc=0.443
[FAIL] 2021-02-25 to 2021-03-31 (  25 days): STRONG_COLLAPSE      - std=0.0011, corr=+0.032, dir_acc=0.447
[WEAK] 2021-04-01 to 2021-06-24 (  59 days): WEAK_COLLAPSE        - std=0.0018, corr=+0.017, dir_acc=0.466
[FAIL] 2021-06-25 to 2021-12-20 ( 122 days): STRONG_COLLAPSE      - std=0.0014, corr=+0.014, dir_acc=0.414
[WEAK] 2021-12-21 to 2022-03-10 (  55 days): WEAK_COLLAPSE        - std=0.0044, corr=+0.044, dir_acc=0.498
[DEGD] 2022-03-11 to 2022-05-17 (  47 days): DEGRADED             - std=0.0082, corr=-0.164, dir_acc=0.560
[ OK ] 2022-05-18 to 2022-05-26 (   7 days): HEALTHY              - std=0.0010, corr=-0.201, dir_acc=0.545
[DEGD] 2022-05-27 to 2022-06-23 (  18 days): DEGRADED             - std=0.0038, corr=-0.187, dir_acc=0.521
[WEAK] 2022-06-24 to 2023-03-30 ( 191 days): WEAK_COLLAPSE        - std=0.0086, corr=-0.043, dir_acc=0.561
[FAIL] 2023-03-31 to 2023-04-28 (  20 days): STRONG_COLLAPSE      - std=0.0024, corr=-0.125, dir_acc=0.475
[WEAK] 2023-05-01 to 2023-07-05 (  45 days): WEAK_COLLAPSE        - std=0.0012, corr=-0.086, dir_acc=0.469
[FAIL] 2023-07-06 to 2023-10-17 (  72 days): STRONG_COLLAPSE      - std=0.0016, corr=-0.069, dir_acc=0.469
[WEAK] 2023-10-18 to 2024-02-02 (  74 days): WEAK_COLLAPSE        - std=0.0035, corr=-0.127, dir_acc=0.437
[FAIL] 2024-02-05 to 2024-08-08 ( 129 days): STRONG_COLLAPSE      - std=0.0016, corr=-0.081, dir_acc=0.424
[WEAK] 2024-08-09 to 2024-10-28 (  55 days): WEAK_COLLAPSE        - std=0.0012, corr=+0.087, dir_acc=0.410
[FAIL] 2024-10-29 to 2025-01-14 (  51 days): STRONG_COLLAPSE      - std=0.0019, corr=+0.052, dir_acc=0.431
[WEAK] 2025-01-15 to 2025-03-03 (  32 days): WEAK_COLLAPSE        - std=0.0009, corr=-0.012, dir_acc=0.436
[WEAK] 2025-03-07 to 2025-05-12 (  46 days): WEAK_COLLAPSE        - std=0.0039, corr=-0.084, dir_acc=0.486
[DEGD] 2025-05-13 to 2025-06-02 (  14 days): DEGRADED             - std=0.0008, corr=-0.024, dir_acc=0.431
[WEAK] 2025-06-03 to 2025-07-15 (  29 days): WEAK_COLLAPSE        - std=0.0005, corr=-0.031, dir_acc=0.392
[FAIL] 2025-07-16 to 2025-10-06 (  58 days): STRONG_COLLAPSE      - std=0.0006, corr=-0.113, dir_acc=0.420
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            36 days (  2.8%)
  DEGRADED:           80 days (  6.2%)
  WEAK_COLLAPSE:     684 days ( 53.4%)
  STRONG_COLLAPSE:   480 days ( 37.5%)

  Total problematic: 1244 days (97.2%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_hidden_10/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.186440
  RMSE:             1.089238
  MAE:              0.778930
  Out-of-sample RÂ²: -0.0082

FINANCIAL METRICS:
  Directional Acc:  46.33%
  Sharpe Ratio:     0.0000
  Total Return:     0.00%
  Max Drawdown:     0.00%
  Hit Rate:         0.00%
  Number of Trades: 0

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.0000
  Recall:           0.0000
  F1 Score:         0.0000
  AUC-ROC:          0.5312

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        593               0
  Actual Up:          687               0

ALPHA (vs Buy-and-Hold):
  Excess Return:    -92.16%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_hidden_10/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:00:52
======================================================================
  ✓ Success

Processing: 00_baseline_exploration/sweep2_hidden_12
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_hidden_12
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_hidden_12/checkpoints/tft-epoch=03-val_loss=0.1119.ckpt
  Validation loss: 0.111938

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_hidden_12/config.json
Output directory: experiments/00_baseline_exploration/sweep2_hidden_12/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_hidden_12/evaluation/evaluation_20251026_170053.log
Evaluation started at: 2025-10-26 17:00:53
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.025467
    Max: 0.130225
    Mean: 0.075131
    Std: 0.021607
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0255, max: 0.1302, mean: 0.0751
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  319 days ( 24.9%)
2. Range-based                 [WARN]  410 days ( 32.0%)
3. Consecutive-similarity      [WARN]  520 days ( 40.6%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                  1004 days ( 78.4%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)         [WARN]   328 days ( 25.6%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0056, corr=+nan, dir_acc=nan
[DEGD] 2020-09-30 to 2020-10-14 (  10 days): DEGRADED             - std=0.0012, corr=+0.235, dir_acc=0.603
[WEAK] 2020-10-15 to 2020-12-09 (  38 days): WEAK_COLLAPSE        - std=0.0038, corr=+0.089, dir_acc=0.556
[ OK ] 2021-01-05 to 2021-03-03 (  40 days): HEALTHY              - std=0.0057, corr=-0.068, dir_acc=0.560
[ OK ] 2021-03-09 to 2021-04-29 (  37 days): HEALTHY              - std=0.0075, corr=-0.185, dir_acc=0.551
[ OK ] 2021-05-26 to 2021-06-08 (   9 days): HEALTHY              - std=0.0011, corr=-0.135, dir_acc=0.548
[ OK ] 2021-06-10 to 2021-06-22 (   9 days): HEALTHY              - std=0.0007, corr=-0.049, dir_acc=0.537
[FAIL] 2021-06-23 to 2021-07-29 (  26 days): STRONG_COLLAPSE      - std=0.0010, corr=-0.129, dir_acc=0.561
[WEAK] 2021-07-30 to 2021-08-06 (   6 days): WEAK_COLLAPSE        - std=0.0005, corr=-0.156, dir_acc=0.561
[FAIL] 2021-08-09 to 2021-12-07 (  83 days): STRONG_COLLAPSE      - std=0.0042, corr=-0.217, dir_acc=0.592
[WEAK] 2021-12-08 to 2021-12-15 (   6 days): WEAK_COLLAPSE        - std=0.0034, corr=-0.248, dir_acc=0.608
[DEGD] 2021-12-28 to 2022-01-04 (   6 days): DEGRADED             - std=0.0028, corr=-0.074, dir_acc=0.617
[DEGD] 2022-01-07 to 2022-01-20 (   9 days): DEGRADED             - std=0.0023, corr=-0.063, dir_acc=0.550
[DEGD] 2022-01-28 to 2022-03-15 (  32 days): DEGRADED             - std=0.0051, corr=-0.066, dir_acc=0.440
[ OK ] 2022-03-24 to 2022-04-18 (  17 days): HEALTHY              - std=0.0126, corr=+0.042, dir_acc=0.446
[ OK ] 2022-04-22 to 2022-06-22 (  42 days): HEALTHY              - std=0.0049, corr=+0.099, dir_acc=0.462
[DEGD] 2022-06-23 to 2022-09-19 (  61 days): DEGRADED             - std=0.0091, corr=-0.091, dir_acc=0.463
[ OK ] 2022-09-20 to 2022-10-03 (  10 days): HEALTHY              - std=0.0042, corr=+0.071, dir_acc=0.435
[ OK ] 2022-10-06 to 2022-10-17 (   7 days): HEALTHY              - std=0.0011, corr=+0.048, dir_acc=0.417
[DEGD] 2022-10-21 to 2023-03-01 (  88 days): DEGRADED             - std=0.0128, corr=-0.149, dir_acc=0.416
[WEAK] 2023-03-02 to 2023-03-13 (   8 days): WEAK_COLLAPSE        - std=0.0023, corr=-0.057, dir_acc=0.471
[DEGD] 2023-03-14 to 2023-06-22 (  70 days): DEGRADED             - std=0.0084, corr=-0.125, dir_acc=0.522
[FAIL] 2023-06-29 to 2023-10-03 (  67 days): STRONG_COLLAPSE      - std=0.0038, corr=-0.036, dir_acc=0.537
[WEAK] 2023-10-04 to 2023-10-19 (  11 days): WEAK_COLLAPSE        - std=0.0018, corr=-0.119, dir_acc=0.477
[DEGD] 2023-10-20 to 2023-11-13 (  17 days): DEGRADED             - std=0.0052, corr=-0.074, dir_acc=0.462
[ OK ] 2023-11-14 to 2023-12-29 (  32 days): HEALTHY              - std=0.0038, corr=-0.068, dir_acc=0.571
[DEGD] 2024-01-02 to 2024-01-29 (  19 days): DEGRADED             - std=0.0004, corr=-0.091, dir_acc=0.634
[WEAK] 2024-01-30 to 2024-02-07 (   7 days): WEAK_COLLAPSE        - std=0.0002, corr=-0.175, dir_acc=0.648
[FAIL] 2024-02-08 to 2024-08-06 ( 124 days): STRONG_COLLAPSE      - std=0.0030, corr=-0.046, dir_acc=0.574
[ OK ] 2024-08-14 to 2025-02-24 ( 130 days): HEALTHY              - std=0.0066, corr=-0.221, dir_acc=0.578
[DEGD] 2025-02-25 to 2025-03-10 (  10 days): DEGRADED             - std=0.0077, corr=-0.243, dir_acc=0.498
[DEGD] 2025-03-14 to 2025-03-28 (  11 days): DEGRADED             - std=0.0037, corr=-0.069, dir_acc=0.512
[ OK ] 2025-03-31 to 2025-04-23 (  17 days): HEALTHY              - std=0.0038, corr=+0.058, dir_acc=0.511
[ OK ] 2025-04-29 to 2025-09-11 (  94 days): HEALTHY              - std=0.0133, corr=-0.102, dir_acc=0.584
[FAIL] 2025-09-19 to 2025-10-06 (  12 days): STRONG_COLLAPSE      - std=0.0005, corr=-0.112, dir_acc=0.571
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           502 days ( 39.2%)
  DEGRADED:          383 days ( 29.9%)
  WEAK_COLLAPSE:      83 days (  6.5%)
  STRONG_COLLAPSE:   312 days ( 24.4%)

  Total problematic:  778 days (60.8%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_hidden_12/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.178435
  RMSE:             1.085557
  MAE:              0.772422
  Out-of-sample RÂ²: -0.0014

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5004

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_hidden_12/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:00:54
======================================================================
  ✓ Success

Processing: 00_baseline_exploration/sweep2_hidden_14
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_hidden_14
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_hidden_14/checkpoints/tft-epoch=01-val_loss=0.1377.ckpt
  Validation loss: 0.137691

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_hidden_14/config.json
Output directory: experiments/00_baseline_exploration/sweep2_hidden_14/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_hidden_14/evaluation/evaluation_20251026_170056.log
Evaluation started at: 2025-10-26 17:00:56
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.289786
    Max: -0.230790
    Mean: -0.267436
    Std: 0.017006
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.2898, max: -0.2308, mean: -0.2674
Negative predictions: 1280/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  255 days ( 19.9%)
2. Range-based                 [WARN]  324 days ( 25.3%)
3. Consecutive-similarity      [WARN]  412 days ( 32.2%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   258 days ( 20.2%)
  Directional acc < 52%                986 days ( 77.0%)
  Combined (BOTH poor)         [WARN]   203 days ( 15.9%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0047, corr=+nan, dir_acc=nan
[WEAK] 2020-10-01 to 2020-11-13 (  30 days): WEAK_COLLAPSE        - std=0.0040, corr=-0.194, dir_acc=0.420
[DEGD] 2020-11-16 to 2020-12-16 (  22 days): DEGRADED             - std=0.0043, corr=-0.098, dir_acc=0.467
[DEGD] 2021-01-04 to 2021-01-11 (   6 days): DEGRADED             - std=0.0029, corr=-0.018, dir_acc=0.469
[ OK ] 2021-01-12 to 2021-08-17 ( 151 days): HEALTHY              - std=0.0129, corr=+0.154, dir_acc=0.448
[WEAK] 2021-08-19 to 2021-09-20 (  22 days): WEAK_COLLAPSE        - std=0.0035, corr=+0.460, dir_acc=0.383
[ OK ] 2021-09-21 to 2022-07-05 ( 196 days): HEALTHY              - std=0.0175, corr=+0.141, dir_acc=0.493
[DEGD] 2022-07-06 to 2022-07-19 (  10 days): DEGRADED             - std=0.0008, corr=+0.077, dir_acc=0.543
[FAIL] 2022-07-20 to 2022-08-11 (  17 days): STRONG_COLLAPSE      - std=0.0050, corr=+0.026, dir_acc=0.525
[DEGD] 2022-08-15 to 2022-08-23 (   7 days): DEGRADED             - std=0.0024, corr=+0.005, dir_acc=0.521
[ OK ] 2022-08-24 to 2022-11-18 (  60 days): HEALTHY              - std=0.0053, corr=+0.060, dir_acc=0.572
[WEAK] 2022-11-23 to 2022-12-21 (  20 days): WEAK_COLLAPSE        - std=0.0040, corr=-0.130, dir_acc=0.609
[WEAK] 2022-12-23 to 2023-01-03 (   6 days): WEAK_COLLAPSE        - std=0.0006, corr=+0.060, dir_acc=0.597
[ OK ] 2023-01-13 to 2023-02-01 (  13 days): HEALTHY              - std=0.0040, corr=+0.047, dir_acc=0.564
[ OK ] 2023-02-03 to 2023-06-28 ( 100 days): HEALTHY              - std=0.0146, corr=+0.125, dir_acc=0.496
[FAIL] 2023-07-10 to 2023-10-20 (  73 days): STRONG_COLLAPSE      - std=0.0033, corr=+0.063, dir_acc=0.472
[DEGD] 2023-10-23 to 2023-12-14 (  38 days): DEGRADED             - std=0.0074, corr=+0.113, dir_acc=0.486
[DEGD] 2023-12-19 to 2024-01-29 (  27 days): DEGRADED             - std=0.0005, corr=+0.073, dir_acc=0.370
[FAIL] 2024-01-31 to 2024-08-05 ( 129 days): STRONG_COLLAPSE      - std=0.0020, corr=-0.047, dir_acc=0.423
[ OK ] 2024-08-13 to 2025-03-07 ( 140 days): HEALTHY              - std=0.0090, corr=+0.281, dir_acc=0.427
[ OK ] 2025-03-14 to 2025-04-02 (  14 days): HEALTHY              - std=0.0101, corr=+0.040, dir_acc=0.481
[ OK ] 2025-04-17 to 2025-09-10 ( 100 days): HEALTHY              - std=0.0164, corr=+0.128, dir_acc=0.422
[FAIL] 2025-09-18 to 2025-10-06 (  13 days): STRONG_COLLAPSE      - std=0.0004, corr=+0.174, dir_acc=0.429
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           814 days ( 63.6%)
  DEGRADED:          149 days ( 11.6%)
  WEAK_COLLAPSE:      85 days (  6.6%)
  STRONG_COLLAPSE:   232 days ( 18.1%)

  Total problematic:  466 days (36.4%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_hidden_14/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.281640
  RMSE:             1.132096
  MAE:              0.836103
  Out-of-sample RÂ²: -0.0891

FINANCIAL METRICS:
  Directional Acc:  46.33%
  Sharpe Ratio:     0.0000
  Total Return:     0.00%
  Max Drawdown:     0.00%
  Hit Rate:         0.00%
  Number of Trades: 0

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.0000
  Recall:           0.0000
  F1 Score:         0.0000
  AUC-ROC:          0.4853

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        593               0
  Actual Up:          687               0

ALPHA (vs Buy-and-Hold):
  Excess Return:    -92.16%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_hidden_14/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:00:57
======================================================================
  ✓ Success

Processing: 00_baseline_exploration/sweep2_hidden_16
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_hidden_16
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_hidden_16/checkpoints/tft-epoch=01-val_loss=0.1324.ckpt
  Validation loss: 0.132447

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_hidden_16/config.json
Output directory: experiments/00_baseline_exploration/sweep2_hidden_16/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_hidden_16/evaluation/evaluation_20251026_170059.log
Evaluation started at: 2025-10-26 17:00:59
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.103241
    Max: 0.152375
    Mean: -0.003492
    Std: 0.076916
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.1032, max: 0.1524, mean: -0.0035
Negative predictions: 694/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   89 days (  7.0%)
2. Range-based                 [WARN]  187 days ( 14.6%)
3. Consecutive-similarity      [WARN]  294 days ( 23.0%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   758 days ( 59.2%)
  Directional acc < 52%                585 days ( 45.7%)
  Combined (BOTH poor)         [WARN]   374 days ( 29.2%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-11-04 (  54 days): HEALTHY              - std=0.0078, corr=+0.070, dir_acc=0.418
[DEGD] 2020-11-05 to 2020-11-13 (   6 days): DEGRADED             - std=0.0038, corr=-0.012, dir_acc=0.429
[DEGD] 2020-11-18 to 2021-04-05 (  93 days): DEGRADED             - std=0.0151, corr=-0.171, dir_acc=0.452
[ OK ] 2021-04-06 to 2021-04-13 (   6 days): HEALTHY              - std=0.0088, corr=+0.022, dir_acc=0.489
[ OK ] 2021-05-03 to 2021-05-13 (   9 days): HEALTHY              - std=0.0122, corr=+0.016, dir_acc=0.544
[DEGD] 2021-05-26 to 2021-06-08 (   9 days): DEGRADED             - std=0.0053, corr=-0.112, dir_acc=0.502
[DEGD] 2021-06-10 to 2021-09-13 (  66 days): DEGRADED             - std=0.0163, corr=-0.136, dir_acc=0.435
[DEGD] 2021-09-15 to 2021-11-03 (  35 days): DEGRADED             - std=0.0152, corr=-0.133, dir_acc=0.426
[ OK ] 2021-11-12 to 2021-12-06 (  16 days): HEALTHY              - std=0.0158, corr=+0.048, dir_acc=0.416
[DEGD] 2021-12-07 to 2021-12-16 (   8 days): DEGRADED             - std=0.0055, corr=-0.033, dir_acc=0.392
[DEGD] 2021-12-22 to 2022-01-04 (   9 days): DEGRADED             - std=0.0028, corr=-0.030, dir_acc=0.383
[ OK ] 2022-01-18 to 2022-05-26 (  91 days): HEALTHY              - std=0.0082, corr=-0.159, dir_acc=0.552
[DEGD] 2022-05-27 to 2022-06-15 (  13 days): DEGRADED             - std=0.0018, corr=-0.170, dir_acc=0.513
[WEAK] 2022-06-16 to 2022-07-22 (  25 days): WEAK_COLLAPSE        - std=0.0057, corr=-0.059, dir_acc=0.545
[DEGD] 2022-07-25 to 2022-09-23 (  44 days): DEGRADED             - std=0.0019, corr=-0.099, dir_acc=0.534
[WEAK] 2022-09-26 to 2022-10-06 (   9 days): WEAK_COLLAPSE        - std=0.0014, corr=+0.081, dir_acc=0.572
[FAIL] 2022-10-07 to 2022-12-20 (  50 days): STRONG_COLLAPSE      - std=0.0029, corr=+0.122, dir_acc=0.601
[WEAK] 2022-12-21 to 2022-12-29 (   6 days): WEAK_COLLAPSE        - std=0.0017, corr=+0.111, dir_acc=0.594
[FAIL] 2022-12-30 to 2023-02-06 (  25 days): STRONG_COLLAPSE      - std=0.0018, corr=+0.063, dir_acc=0.568
[WEAK] 2023-02-07 to 2023-03-10 (  23 days): WEAK_COLLAPSE        - std=0.0017, corr=+0.075, dir_acc=0.548
[FAIL] 2023-03-13 to 2023-03-30 (  14 days): STRONG_COLLAPSE      - std=0.0038, corr=-0.000, dir_acc=0.511
[WEAK] 2023-03-31 to 2023-04-10 (   6 days): WEAK_COLLAPSE        - std=0.0019, corr=+0.088, dir_acc=0.464
[DEGD] 2023-04-11 to 2023-06-27 (  54 days): DEGRADED             - std=0.0100, corr=+0.006, dir_acc=0.472
[ OK ] 2023-07-11 to 2023-07-28 (  14 days): HEALTHY              - std=0.0159, corr=+0.050, dir_acc=0.463
[DEGD] 2023-07-31 to 2023-11-09 (  72 days): DEGRADED             - std=0.0106, corr=-0.137, dir_acc=0.451
[ OK ] 2023-11-10 to 2024-02-26 (  72 days): HEALTHY              - std=0.0122, corr=+0.076, dir_acc=0.604
[WEAK] 2024-02-27 to 2024-04-08 (  29 days): WEAK_COLLAPSE        - std=0.0033, corr=+0.006, dir_acc=0.587
[ OK ] 2024-04-16 to 2025-03-04 ( 219 days): HEALTHY              - std=0.0282, corr=-0.050, dir_acc=0.570
[ OK ] 2025-03-06 to 2025-04-07 (  23 days): HEALTHY              - std=0.0316, corr=+0.059, dir_acc=0.511
[ OK ] 2025-04-09 to 2025-10-06 ( 124 days): HEALTHY              - std=0.0345, corr=-0.122, dir_acc=0.574
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           659 days ( 51.5%)
  DEGRADED:          434 days ( 33.9%)
  WEAK_COLLAPSE:      98 days (  7.7%)
  STRONG_COLLAPSE:    89 days (  7.0%)

  Total problematic:  621 days (48.5%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_hidden_16/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.183202
  RMSE:             1.087751
  MAE:              0.773713
  Out-of-sample RÂ²: -0.0055

FINANCIAL METRICS:
  Directional Acc:  52.42%
  Sharpe Ratio:     0.8480
  Total Return:     52.05%
  Max Drawdown:     -18.90%
  Hit Rate:         25.94%
  Number of Trades: 586

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5666
  Recall:           0.4833
  F1 Score:         0.5216
  AUC-ROC:          0.5439

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        339             254
  Actual Up:          355             332

ALPHA (vs Buy-and-Hold):
  Excess Return:    -40.11%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_hidden_16/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:01:00
======================================================================
  ✓ Success

Processing: 00_baseline_exploration/sweep2_hidden_18
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_hidden_18
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_hidden_18/checkpoints/tft-epoch=03-val_loss=0.1477.ckpt
  Validation loss: 0.147669

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_hidden_18/config.json
Output directory: experiments/00_baseline_exploration/sweep2_hidden_18/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_hidden_18/evaluation/evaluation_20251026_170101.log
Evaluation started at: 2025-10-26 17:01:01
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.034599
    Max: 0.317420
    Mean: 0.074550
    Std: 0.103643
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0346, max: 0.3174, mean: 0.0746
Negative predictions: 518/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  206 days ( 16.1%)
2. Range-based                 [WARN]  149 days ( 11.6%)
3. Consecutive-similarity      [ OK ]   65 days (  5.1%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   187 days ( 14.6%)
  Directional acc < 52%                834 days ( 65.2%)
  Combined (BOTH poor)         [WARN]   149 days ( 11.6%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-11-24 (  67 days): HEALTHY              - std=0.0100, corr=+0.099, dir_acc=0.574
[ OK ] 2020-11-27 to 2021-03-01 (  63 days): HEALTHY              - std=0.0088, corr=+0.055, dir_acc=0.547
[DEGD] 2021-03-15 to 2021-03-24 (   8 days): DEGRADED             - std=0.0042, corr=+0.019, dir_acc=0.569
[ OK ] 2021-03-25 to 2021-04-23 (  21 days): HEALTHY              - std=0.0356, corr=-0.081, dir_acc=0.544
[DEGD] 2021-04-29 to 2021-05-11 (   9 days): DEGRADED             - std=0.0027, corr=-0.028, dir_acc=0.494
[ OK ] 2021-05-12 to 2021-12-17 ( 152 days): HEALTHY              - std=0.0441, corr=+0.158, dir_acc=0.506
[ OK ] 2021-12-21 to 2022-08-03 ( 155 days): HEALTHY              - std=0.0901, corr=+0.141, dir_acc=0.457
[DEGD] 2022-08-04 to 2022-08-18 (  11 days): DEGRADED             - std=0.0312, corr=-0.064, dir_acc=0.476
[ OK ] 2022-08-26 to 2023-01-26 ( 103 days): HEALTHY              - std=0.0684, corr=+0.146, dir_acc=0.418
[ OK ] 2023-01-30 to 2023-02-06 (   6 days): HEALTHY              - std=0.0112, corr=+0.029, dir_acc=0.458
[DEGD] 2023-02-09 to 2023-02-16 (   6 days): DEGRADED             - std=0.0051, corr=-0.023, dir_acc=0.450
[ OK ] 2023-03-03 to 2023-06-27 (  80 days): HEALTHY              - std=0.0724, corr=+0.139, dir_acc=0.506
[ OK ] 2023-07-03 to 2023-07-17 (  10 days): HEALTHY              - std=0.0025, corr=+0.035, dir_acc=0.448
[DEGD] 2023-07-18 to 2023-08-29 (  31 days): DEGRADED             - std=0.0033, corr=+0.113, dir_acc=0.440
[WEAK] 2023-08-30 to 2023-10-03 (  24 days): WEAK_COLLAPSE        - std=0.0040, corr=-0.001, dir_acc=0.490
[DEGD] 2023-10-04 to 2023-10-13 (   7 days): DEGRADED             - std=0.0019, corr=+0.199, dir_acc=0.512
[ OK ] 2023-10-16 to 2023-10-26 (   9 days): HEALTHY              - std=0.0220, corr=+0.089, dir_acc=0.543
[ OK ] 2023-10-31 to 2024-02-02 (  65 days): HEALTHY              - std=0.0182, corr=+0.178, dir_acc=0.469
[FAIL] 2024-02-09 to 2024-04-16 (  46 days): STRONG_COLLAPSE      - std=0.0022, corr=-0.190, dir_acc=0.407
[WEAK] 2024-04-17 to 2024-07-10 (  58 days): WEAK_COLLAPSE        - std=0.0034, corr=+0.029, dir_acc=0.464
[FAIL] 2024-07-11 to 2024-08-02 (  17 days): STRONG_COLLAPSE      - std=0.0019, corr=-0.120, dir_acc=0.356
[ OK ] 2024-08-08 to 2025-03-10 ( 144 days): HEALTHY              - std=0.0376, corr=+0.169, dir_acc=0.545
[ OK ] 2025-03-14 to 2025-04-04 (  16 days): HEALTHY              - std=0.0188, corr=+0.035, dir_acc=0.525
[DEGD] 2025-04-07 to 2025-04-21 (  10 days): DEGRADED             - std=0.0226, corr=-0.025, dir_acc=0.505
[ OK ] 2025-04-22 to 2025-08-11 (  77 days): HEALTHY              - std=0.0950, corr=+0.138, dir_acc=0.578
[ OK ] 2025-08-18 to 2025-09-26 (  29 days): HEALTHY              - std=0.0023, corr=+0.186, dir_acc=0.488
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:          1014 days ( 79.2%)
  DEGRADED:          116 days (  9.1%)
  WEAK_COLLAPSE:      87 days (  6.8%)
  STRONG_COLLAPSE:    63 days (  4.9%)

  Total problematic:  266 days (20.8%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_hidden_18/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.185299
  RMSE:             1.088714
  MAE:              0.778657
  Out-of-sample RÂ²: -0.0073

FINANCIAL METRICS:
  Directional Acc:  48.98%
  Sharpe Ratio:     0.5427
  Total Return:     44.95%
  Max Drawdown:     -25.25%
  Hit Rate:         31.09%
  Number of Trades: 762

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5223
  Recall:           0.5793
  F1 Score:         0.5493
  AUC-ROC:          0.4797

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        229             364
  Actual Up:          289             398

ALPHA (vs Buy-and-Hold):
  Excess Return:    -47.21%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_hidden_18/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:01:02
======================================================================
  ✓ Success

Processing: 00_baseline_exploration/sweep2_hidden_20
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_hidden_20
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_hidden_20/checkpoints/tft-epoch=01-val_loss=0.0671.ckpt
  Validation loss: 0.067114

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_hidden_20/config.json
Output directory: experiments/00_baseline_exploration/sweep2_hidden_20/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_hidden_20/evaluation/evaluation_20251026_170104.log
Evaluation started at: 2025-10-26 17:01:04
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.191917
    Max: 0.393936
    Mean: 0.245988
    Std: 0.051568
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1919, max: 0.3939, mean: 0.2460
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]  107 days (  8.4%)
2. Range-based                 [WARN]  141 days ( 11.0%)
3. Consecutive-similarity      [WARN]  225 days ( 17.6%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   233 days ( 18.2%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)         [ OK ]    87 days (  6.8%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-11-24 (  67 days): HEALTHY              - std=0.0108, corr=-0.113, dir_acc=0.574
[ OK ] 2020-12-02 to 2020-12-09 (   6 days): HEALTHY              - std=0.0050, corr=-0.160, dir_acc=0.539
[ OK ] 2021-01-05 to 2021-01-27 (  16 days): HEALTHY              - std=0.0010, corr=-0.060, dir_acc=0.551
[ OK ] 2021-02-02 to 2021-02-26 (  18 days): HEALTHY              - std=0.0044, corr=-0.037, dir_acc=0.570
[DEGD] 2021-03-01 to 2021-03-08 (   6 days): DEGRADED             - std=0.0045, corr=+0.046, dir_acc=0.531
[ OK ] 2021-03-09 to 2021-08-11 ( 109 days): HEALTHY              - std=0.0211, corr=+0.088, dir_acc=0.547
[DEGD] 2021-08-12 to 2021-08-23 (   8 days): DEGRADED             - std=0.0020, corr=+0.017, dir_acc=0.613
[ OK ] 2021-08-24 to 2021-08-31 (   6 days): HEALTHY              - std=0.0009, corr=+0.030, dir_acc=0.628
[FAIL] 2021-09-03 to 2021-09-27 (  16 days): STRONG_COLLAPSE      - std=0.0049, corr=+0.081, dir_acc=0.594
[ OK ] 2021-09-30 to 2022-02-22 (  98 days): HEALTHY              - std=0.0298, corr=+0.194, dir_acc=0.560
[ OK ] 2022-02-24 to 2022-04-18 (  37 days): HEALTHY              - std=0.0156, corr=+0.082, dir_acc=0.431
[ OK ] 2022-04-26 to 2022-05-10 (  11 days): HEALTHY              - std=0.0136, corr=+0.061, dir_acc=0.447
[ OK ] 2022-05-25 to 2022-06-09 (  11 days): HEALTHY              - std=0.0057, corr=+0.069, dir_acc=0.491
[DEGD] 2022-06-10 to 2022-06-22 (   8 days): DEGRADED             - std=0.0030, corr=-0.069, dir_acc=0.463
[ OK ] 2022-06-23 to 2022-08-03 (  29 days): HEALTHY              - std=0.0071, corr=+0.051, dir_acc=0.461
[DEGD] 2022-08-04 to 2022-08-19 (  12 days): DEGRADED             - std=0.0163, corr=-0.045, dir_acc=0.476
[ OK ] 2022-08-22 to 2022-11-28 (  67 days): HEALTHY              - std=0.0330, corr=+0.112, dir_acc=0.427
[ OK ] 2022-12-05 to 2022-12-12 (   6 days): HEALTHY              - std=0.0086, corr=+0.053, dir_acc=0.375
[ OK ] 2022-12-15 to 2023-02-10 (  39 days): HEALTHY              - std=0.0219, corr=+0.063, dir_acc=0.423
[ OK ] 2023-02-15 to 2023-06-27 (  91 days): HEALTHY              - std=0.0374, corr=+0.131, dir_acc=0.509
[ OK ] 2023-07-07 to 2023-07-19 (   9 days): HEALTHY              - std=0.0009, corr=-0.046, dir_acc=0.544
[DEGD] 2023-07-20 to 2023-08-28 (  28 days): DEGRADED             - std=0.0041, corr=+0.112, dir_acc=0.560
[FAIL] 2023-09-01 to 2023-10-03 (  22 days): STRONG_COLLAPSE      - std=0.0023, corr=+0.061, dir_acc=0.507
[DEGD] 2023-10-10 to 2023-10-19 (   8 days): DEGRADED             - std=0.0045, corr=+0.194, dir_acc=0.473
[ OK ] 2023-10-31 to 2024-02-12 (  71 days): HEALTHY              - std=0.0220, corr=+0.179, dir_acc=0.587
[FAIL] 2024-02-22 to 2024-04-30 (  48 days): STRONG_COLLAPSE      - std=0.0056, corr=+0.060, dir_acc=0.568
[WEAK] 2024-05-07 to 2024-07-12 (  46 days): WEAK_COLLAPSE        - std=0.0053, corr=+0.135, dir_acc=0.551
[DEGD] 2024-07-15 to 2024-07-29 (  11 days): DEGRADED             - std=0.0022, corr=+0.141, dir_acc=0.653
[ OK ] 2024-08-08 to 2025-03-12 ( 146 days): HEALTHY              - std=0.0189, corr=+0.167, dir_acc=0.572
[ OK ] 2025-03-14 to 2025-04-04 (  16 days): HEALTHY              - std=0.0176, corr=+0.071, dir_acc=0.521
[DEGD] 2025-04-07 to 2025-04-24 (  13 days): DEGRADED             - std=0.0111, corr=-0.065, dir_acc=0.499
[ OK ] 2025-04-25 to 2025-09-18 ( 101 days): HEALTHY              - std=0.0617, corr=+0.054, dir_acc=0.583
[DEGD] 2025-09-19 to 2025-10-06 (  12 days): DEGRADED             - std=0.0006, corr=+0.010, dir_acc=0.571
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           970 days ( 75.8%)
  DEGRADED:          162 days ( 12.7%)
  WEAK_COLLAPSE:      58 days (  4.5%)
  STRONG_COLLAPSE:    90 days (  7.0%)

  Total problematic:  310 days (24.2%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_hidden_20/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.215273
  RMSE:             1.102394
  MAE:              0.787636
  Out-of-sample RÂ²: -0.0327

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4737

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_hidden_20/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:01:05
======================================================================
  ✓ Success

Processing: 00_baseline_exploration/sweep2_hidden_8
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 00_baseline_exploration/sweep2_hidden_8
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/00_baseline_exploration/sweep2_hidden_8/checkpoints/tft-epoch=04-val_loss=0.1451.ckpt
  Validation loss: 0.145136

Loading configuration...
Loading config from: experiments/00_baseline_exploration/sweep2_hidden_8/config.json
Output directory: experiments/00_baseline_exploration/sweep2_hidden_8/evaluation
Logging to: experiments/00_baseline_exploration/sweep2_hidden_8/evaluation/evaluation_20251026_170106.log
Evaluation started at: 2025-10-26 17:01:06
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.164699
    Max: -0.089697
    Mean: -0.099073
    Std: 0.008907
    Unique values: 1278

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.1647, max: -0.0897, mean: -0.0991
Negative predictions: 1280/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    9 days (  0.7%)
2. Range-based                 [WARN] 1079 days ( 84.3%)
3. Consecutive-similarity      [WARN] 1128 days ( 88.1%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   921 days ( 72.0%)
  Directional acc < 52%                986 days ( 77.0%)
  Combined (BOTH poor)         [WARN]   728 days ( 56.9%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0003, corr=+nan, dir_acc=nan
[WEAK] 2020-10-01 to 2020-10-27 (  18 days): WEAK_COLLAPSE        - std=0.0001, corr=+0.111, dir_acc=0.410
[FAIL] 2020-10-28 to 2020-11-09 (   9 days): STRONG_COLLAPSE      - std=0.0003, corr=+0.041, dir_acc=0.434
[WEAK] 2020-11-10 to 2022-10-07 ( 478 days): WEAK_COLLAPSE        - std=0.0032, corr=-0.043, dir_acc=0.478
[DEGD] 2022-10-11 to 2022-11-16 (  26 days): DEGRADED             - std=0.0101, corr=-0.122, dir_acc=0.596
[ OK ] 2022-11-17 to 2023-02-01 (  51 days): HEALTHY              - std=0.0099, corr=-0.149, dir_acc=0.591
[DEGD] 2023-02-02 to 2023-03-01 (  19 days): DEGRADED             - std=0.0023, corr=-0.025, dir_acc=0.554
[WEAK] 2023-03-02 to 2025-03-19 ( 511 days): WEAK_COLLAPSE        - std=0.0043, corr=-0.055, dir_acc=0.444
[WEAK] 2025-03-21 to 2025-04-30 (  28 days): WEAK_COLLAPSE        - std=0.0058, corr=-0.012, dir_acc=0.486
[DEGD] 2025-05-01 to 2025-08-07 (  68 days): DEGRADED             - std=0.0180, corr=-0.135, dir_acc=0.406
[WEAK] 2025-08-19 to 2025-10-06 (  34 days): WEAK_COLLAPSE        - std=0.0002, corr=-0.079, dir_acc=0.436
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            83 days (  6.5%)
  DEGRADED:          119 days (  9.3%)
  WEAK_COLLAPSE:    1069 days ( 83.5%)
  STRONG_COLLAPSE:     9 days (  0.7%)

  Total problematic: 1197 days (93.5%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_hidden_8/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.202223
  RMSE:             1.096460
  MAE:              0.788696
  Out-of-sample RÂ²: -0.0216

FINANCIAL METRICS:
  Directional Acc:  46.33%
  Sharpe Ratio:     0.0000
  Total Return:     0.00%
  Max Drawdown:     0.00%
  Hit Rate:         0.00%
  Number of Trades: 0

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.0000
  Recall:           0.0000
  F1 Score:         0.0000
  AUC-ROC:          0.4901

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        593               0
  Actual Up:          687               0

ALPHA (vs Buy-and-Hold):
  Excess Return:    -92.16%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_hidden_8/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:01:07
======================================================================
  ✓ Success

========================================================================
PHASE: 01_staleness_features_fixed
========================================================================
Processing: 01_staleness_features_fixed/baseline_fixed_h16_drop0.25
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 01_staleness_features_fixed/baseline_fixed_h16_drop0.25
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/baseline_fixed_h16_drop0.25/checkpoints/tft-epoch=01-val_loss=0.1051.ckpt
  Validation loss: 0.105134

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/baseline_fixed_h16_drop0.25/config.json
Output directory: experiments/01_staleness_features_fixed/baseline_fixed_h16_drop0.25/evaluation
Logging to: experiments/01_staleness_features_fixed/baseline_fixed_h16_drop0.25/evaluation/evaluation_20251026_170109.log
Evaluation started at: 2025-10-26 17:01:09
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.031874
    Max: 0.041145
    Mean: 0.003011
    Std: 0.014727
    Unique values: 1278

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0319, max: 0.0411, mean: 0.0030
Negative predictions: 450/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  614 days ( 48.0%)
2. Range-based                 [WARN]  907 days ( 70.9%)
3. Consecutive-similarity      [WARN] 1177 days ( 92.0%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                  1017 days ( 79.5%)
  Directional acc < 52%                384 days ( 30.0%)
  Combined (BOTH poor)         [WARN]   345 days ( 27.0%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0017, corr=+nan, dir_acc=nan
[FAIL] 2020-10-01 to 2020-12-04 (  44 days): STRONG_COLLAPSE      - std=0.0032, corr=-0.225, dir_acc=0.433
[WEAK] 2020-12-07 to 2021-01-04 (  19 days): WEAK_COLLAPSE        - std=0.0011, corr=-0.125, dir_acc=0.475
[DEGD] 2021-01-05 to 2021-05-19 (  94 days): DEGRADED             - std=0.0184, corr=-0.048, dir_acc=0.461
[DEGD] 2021-05-21 to 2021-09-28 (  90 days): DEGRADED             - std=0.0074, corr=-0.060, dir_acc=0.572
[WEAK] 2021-09-29 to 2021-10-08 (   8 days): WEAK_COLLAPSE        - std=0.0016, corr=-0.083, dir_acc=0.544
[FAIL] 2021-10-12 to 2021-10-27 (  12 days): STRONG_COLLAPSE      - std=0.0048, corr=-0.153, dir_acc=0.575
[WEAK] 2021-10-28 to 2021-12-03 (  25 days): WEAK_COLLAPSE        - std=0.0047, corr=-0.006, dir_acc=0.599
[DEGD] 2021-12-06 to 2021-12-13 (   6 days): DEGRADED             - std=0.0032, corr=-0.056, dir_acc=0.583
[ OK ] 2021-12-14 to 2022-01-14 (  23 days): HEALTHY              - std=0.0033, corr=-0.014, dir_acc=0.609
[DEGD] 2022-01-18 to 2022-01-27 (   8 days): DEGRADED             - std=0.0013, corr=+0.044, dir_acc=0.594
[ OK ] 2022-02-10 to 2022-02-18 (   7 days): HEALTHY              - std=0.0006, corr=-0.078, dir_acc=0.540
[DEGD] 2022-02-22 to 2022-04-20 (  41 days): DEGRADED             - std=0.0024, corr=-0.087, dir_acc=0.567
[WEAK] 2022-04-21 to 2022-05-02 (   8 days): WEAK_COLLAPSE        - std=0.0010, corr=-0.044, dir_acc=0.550
[WEAK] 2022-05-05 to 2022-06-24 (  35 days): WEAK_COLLAPSE        - std=0.0013, corr=-0.149, dir_acc=0.537
[FAIL] 2022-06-27 to 2022-09-13 (  55 days): STRONG_COLLAPSE      - std=0.0033, corr=-0.134, dir_acc=0.537
[WEAK] 2022-09-14 to 2022-10-26 (  30 days): WEAK_COLLAPSE        - std=0.0023, corr=-0.137, dir_acc=0.572
[DEGD] 2022-10-27 to 2022-11-16 (  14 days): DEGRADED             - std=0.0008, corr=+0.074, dir_acc=0.585
[WEAK] 2022-11-17 to 2022-12-27 (  27 days): WEAK_COLLAPSE        - std=0.0014, corr=+0.081, dir_acc=0.589
[FAIL] 2022-12-28 to 2023-06-14 ( 116 days): STRONG_COLLAPSE      - std=0.0030, corr=-0.055, dir_acc=0.498
[WEAK] 2023-06-15 to 2023-08-18 (  45 days): WEAK_COLLAPSE        - std=0.0011, corr=-0.039, dir_acc=0.534
[FAIL] 2023-08-21 to 2024-08-26 ( 255 days): STRONG_COLLAPSE      - std=0.0021, corr=-0.121, dir_acc=0.564
[WEAK] 2024-08-27 to 2024-09-27 (  23 days): WEAK_COLLAPSE        - std=0.0010, corr=-0.061, dir_acc=0.597
[FAIL] 2024-09-30 to 2024-12-26 (  60 days): STRONG_COLLAPSE      - std=0.0031, corr=-0.111, dir_acc=0.573
[WEAK] 2024-12-27 to 2025-01-14 (  11 days): WEAK_COLLAPSE        - std=0.0005, corr=-0.137, dir_acc=0.539
[FAIL] 2025-01-15 to 2025-04-01 (  53 days): STRONG_COLLAPSE      - std=0.0033, corr=-0.087, dir_acc=0.540
[DEGD] 2025-04-09 to 2025-05-12 (  23 days): DEGRADED             - std=0.0028, corr=-0.235, dir_acc=0.516
[DEGD] 2025-05-19 to 2025-06-04 (  12 days): DEGRADED             - std=0.0013, corr=-0.347, dir_acc=0.578
[ OK ] 2025-06-05 to 2025-06-16 (   8 days): HEALTHY              - std=0.0005, corr=-0.262, dir_acc=0.608
[ OK ] 2025-06-24 to 2025-07-02 (   7 days): HEALTHY              - std=0.0016, corr=-0.222, dir_acc=0.602
[WEAK] 2025-07-11 to 2025-08-20 (  29 days): WEAK_COLLAPSE        - std=0.0014, corr=-0.155, dir_acc=0.604
[WEAK] 2025-08-28 to 2025-09-19 (  16 days): WEAK_COLLAPSE        - std=0.0007, corr=-0.147, dir_acc=0.561
[FAIL] 2025-09-22 to 2025-10-06 (  11 days): STRONG_COLLAPSE      - std=0.0008, corr=-0.039, dir_acc=0.570
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            87 days (  6.8%)
  DEGRADED:          298 days ( 23.3%)
  WEAK_COLLAPSE:     282 days ( 22.0%)
  STRONG_COLLAPSE:   613 days ( 47.9%)

  Total problematic: 1193 days (93.2%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/baseline_fixed_h16_drop0.25/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.179492
  RMSE:             1.086044
  MAE:              0.774347
  Out-of-sample RÂ²: -0.0023

FINANCIAL METRICS:
  Directional Acc:  54.61%
  Sharpe Ratio:     1.0594
  Total Return:     77.65%
  Max Drawdown:     -21.25%
  Hit Rate:         36.56%
  Number of Trades: 830

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5639
  Recall:           0.6812
  F1 Score:         0.6170
  AUC-ROC:          0.5323

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:        231             362
  Actual Up:          219             468

ALPHA (vs Buy-and-Hold):
  Excess Return:    -14.51%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/baseline_fixed_h16_drop0.25/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:01:10
======================================================================
  ✓ Success

Processing: 01_staleness_features_fixed/staleness_fixed_h16_drop0.25
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 01_staleness_features_fixed/staleness_fixed_h16_drop0.25
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/staleness_fixed_h16_drop0.25/checkpoints/tft-epoch=01-val_loss=0.1476.ckpt
  Validation loss: 0.147566

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/staleness_fixed_h16_drop0.25/config.json
Output directory: experiments/01_staleness_features_fixed/staleness_fixed_h16_drop0.25/evaluation
Logging to: experiments/01_staleness_features_fixed/staleness_fixed_h16_drop0.25/evaluation/evaluation_20251026_170112.log
Evaluation started at: 2025-10-26 17:01:12
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.019630
    Max: 0.122707
    Mean: 0.087928
    Std: 0.018846
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0196, max: 0.1227, mean: 0.0879
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  681 days ( 53.2%)
3. Consecutive-similarity      [WARN]  643 days ( 50.2%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   982 days ( 76.7%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)         [WARN]   347 days ( 27.1%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0021, corr=+nan, dir_acc=nan
[DEGD] 2020-09-30 to 2020-11-19 (  35 days): DEGRADED             - std=0.0028, corr=+0.075, dir_acc=0.578
[DEGD] 2020-11-23 to 2020-12-18 (  19 days): DEGRADED             - std=0.0025, corr=-0.130, dir_acc=0.528
[DEGD] 2020-12-22 to 2021-01-21 (  20 days): DEGRADED             - std=0.0015, corr=-0.191, dir_acc=0.537
[DEGD] 2021-01-26 to 2021-04-27 (  64 days): DEGRADED             - std=0.0048, corr=-0.108, dir_acc=0.556
[WEAK] 2021-04-28 to 2021-12-14 ( 159 days): WEAK_COLLAPSE        - std=0.0053, corr=-0.147, dir_acc=0.571
[DEGD] 2021-12-15 to 2022-05-03 (  96 days): DEGRADED             - std=0.0087, corr=-0.025, dir_acc=0.482
[WEAK] 2022-05-04 to 2022-10-17 ( 114 days): WEAK_COLLAPSE        - std=0.0040, corr=-0.160, dir_acc=0.458
[DEGD] 2022-10-18 to 2023-03-08 (  96 days): DEGRADED             - std=0.0139, corr=-0.117, dir_acc=0.418
[WEAK] 2023-03-09 to 2023-04-14 (  26 days): WEAK_COLLAPSE        - std=0.0059, corr=+0.003, dir_acc=0.503
[DEGD] 2023-04-17 to 2023-05-24 (  28 days): DEGRADED             - std=0.0030, corr=+0.006, dir_acc=0.513
[DEGD] 2023-05-30 to 2023-06-28 (  21 days): DEGRADED             - std=0.0016, corr=-0.071, dir_acc=0.551
[WEAK] 2023-06-29 to 2023-08-21 (  37 days): WEAK_COLLAPSE        - std=0.0034, corr=+0.058, dir_acc=0.556
[DEGD] 2023-08-22 to 2023-09-25 (  24 days): DEGRADED             - std=0.0020, corr=+0.070, dir_acc=0.518
[DEGD] 2023-09-28 to 2023-10-19 (  15 days): DEGRADED             - std=0.0040, corr=-0.017, dir_acc=0.484
[DEGD] 2023-11-01 to 2023-11-13 (   9 days): DEGRADED             - std=0.0001, corr=-0.103, dir_acc=0.491
[ OK ] 2023-11-14 to 2024-01-19 (  45 days): HEALTHY              - std=0.0067, corr=-0.133, dir_acc=0.584
[ OK ] 2024-01-24 to 2024-02-20 (  19 days): HEALTHY              - std=0.0021, corr=-0.158, dir_acc=0.652
[DEGD] 2024-02-26 to 2024-03-20 (  18 days): DEGRADED             - std=0.0016, corr=-0.029, dir_acc=0.607
[WEAK] 2024-03-21 to 2024-04-04 (  10 days): WEAK_COLLAPSE        - std=0.0025, corr=+0.047, dir_acc=0.560
[DEGD] 2024-04-05 to 2024-04-18 (  10 days): DEGRADED             - std=0.0018, corr=+0.168, dir_acc=0.547
[DEGD] 2024-04-23 to 2024-05-17 (  19 days): DEGRADED             - std=0.0012, corr=+0.009, dir_acc=0.508
[DEGD] 2024-05-23 to 2024-06-18 (  18 days): DEGRADED             - std=0.0013, corr=-0.168, dir_acc=0.538
[ OK ] 2024-07-01 to 2024-07-18 (  13 days): HEALTHY              - std=0.0028, corr=-0.056, dir_acc=0.632
[ OK ] 2024-07-23 to 2024-09-13 (  38 days): HEALTHY              - std=0.0053, corr=-0.207, dir_acc=0.610
[DEGD] 2024-09-16 to 2024-10-21 (  25 days): DEGRADED             - std=0.0036, corr=-0.203, dir_acc=0.581
[ OK ] 2024-10-22 to 2025-01-13 (  55 days): HEALTHY              - std=0.0028, corr=-0.047, dir_acc=0.569
[DEGD] 2025-01-14 to 2025-03-28 (  52 days): DEGRADED             - std=0.0045, corr=-0.214, dir_acc=0.540
[ OK ] 2025-03-31 to 2025-04-08 (   7 days): HEALTHY              - std=0.0046, corr=-0.046, dir_acc=0.533
[DEGD] 2025-04-09 to 2025-04-17 (   7 days): DEGRADED             - std=0.0067, corr=-0.094, dir_acc=0.500
[ OK ] 2025-04-29 to 2025-08-18 (  77 days): HEALTHY              - std=0.0174, corr=-0.170, dir_acc=0.590
[DEGD] 2025-08-22 to 2025-09-17 (  18 days): DEGRADED             - std=0.0021, corr=-0.184, dir_acc=0.560
[WEAK] 2025-09-18 to 2025-09-26 (   7 days): WEAK_COLLAPSE        - std=0.0027, corr=-0.138, dir_acc=0.564
[DEGD] 2025-09-29 to 2025-10-06 (   6 days): DEGRADED             - std=0.0013, corr=-0.075, dir_acc=0.578
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           294 days ( 23.0%)
  DEGRADED:          616 days ( 48.1%)
  WEAK_COLLAPSE:     370 days ( 28.9%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic:  986 days (77.0%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/staleness_fixed_h16_drop0.25/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.178549
  RMSE:             1.085610
  MAE:              0.772370
  Out-of-sample RÂ²: -0.0015

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5214

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/staleness_fixed_h16_drop0.25/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:01:13
======================================================================
  ✓ Success

Processing: 01_staleness_features_fixed/staleness_fixed_h16_drop0.25_seed999
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 01_staleness_features_fixed/staleness_fixed_h16_drop0.25_seed999
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/staleness_fixed_h16_drop0.25_seed999/checkpoints/tft-epoch=02-val_loss=0.1369.ckpt
  Validation loss: 0.136869

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/staleness_fixed_h16_drop0.25_seed999/config.json
Output directory: experiments/01_staleness_features_fixed/staleness_fixed_h16_drop0.25_seed999/evaluation
Logging to: experiments/01_staleness_features_fixed/staleness_fixed_h16_drop0.25_seed999/evaluation/evaluation_20251026_170114.log
Evaluation started at: 2025-10-26 17:01:14
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.242151
    Max: 0.304402
    Mean: 0.284554
    Std: 0.014566
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.2422, max: 0.3044, mean: 0.2846
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  176 days ( 13.8%)
2. Range-based                 [WARN] 1145 days ( 89.5%)
3. Consecutive-similarity      [WARN] 1190 days ( 93.0%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   704 days ( 55.0%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)         [WARN]   226 days ( 17.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0022, corr=+nan, dir_acc=nan
[WEAK] 2020-10-01 to 2021-04-22 ( 138 days): WEAK_COLLAPSE        - std=0.0048, corr=-0.031, dir_acc=0.555
[DEGD] 2021-04-23 to 2021-05-21 (  21 days): DEGRADED             - std=0.0054, corr=-0.195, dir_acc=0.523
[ OK ] 2021-05-26 to 2021-06-08 (   9 days): HEALTHY              - std=0.0004, corr=-0.119, dir_acc=0.548
[ OK ] 2021-06-10 to 2021-07-19 (  27 days): HEALTHY              - std=0.0031, corr=-0.029, dir_acc=0.550
[DEGD] 2021-07-20 to 2021-08-09 (  15 days): DEGRADED             - std=0.0016, corr=+0.088, dir_acc=0.567
[WEAK] 2021-08-10 to 2021-09-15 (  26 days): WEAK_COLLAPSE        - std=0.0012, corr=+0.065, dir_acc=0.615
[FAIL] 2021-09-16 to 2021-10-08 (  17 days): STRONG_COLLAPSE      - std=0.0014, corr=+0.037, dir_acc=0.558
[FAIL] 2021-10-15 to 2021-10-26 (   8 days): STRONG_COLLAPSE      - std=0.0019, corr=-0.179, dir_acc=0.577
[WEAK] 2021-10-27 to 2022-08-11 ( 198 days): WEAK_COLLAPSE        - std=0.0030, corr=+0.067, dir_acc=0.495
[FAIL] 2022-08-12 to 2022-08-23 (   8 days): STRONG_COLLAPSE      - std=0.0018, corr=+0.102, dir_acc=0.477
[WEAK] 2022-08-24 to 2023-09-11 ( 261 days): WEAK_COLLAPSE        - std=0.0033, corr=-0.025, dir_acc=0.477
[FAIL] 2023-09-12 to 2024-01-08 (  81 days): STRONG_COLLAPSE      - std=0.0013, corr=-0.080, dir_acc=0.524
[WEAK] 2024-01-09 to 2024-01-18 (   7 days): WEAK_COLLAPSE        - std=0.0001, corr=-0.076, dir_acc=0.614
[FAIL] 2024-01-19 to 2024-03-22 (  45 days): STRONG_COLLAPSE      - std=0.0015, corr=-0.028, dir_acc=0.629
[WEAK] 2024-03-25 to 2024-04-18 (  18 days): WEAK_COLLAPSE        - std=0.0008, corr=-0.104, dir_acc=0.551
[WEAK] 2024-04-22 to 2024-05-15 (  18 days): WEAK_COLLAPSE        - std=0.0016, corr=-0.026, dir_acc=0.506
[WEAK] 2024-05-22 to 2024-06-10 (  13 days): WEAK_COLLAPSE        - std=0.0008, corr=-0.050, dir_acc=0.526
[FAIL] 2024-06-11 to 2024-06-27 (  12 days): STRONG_COLLAPSE      - std=0.0014, corr=+0.026, dir_acc=0.562
[WEAK] 2024-06-28 to 2024-07-11 (   9 days): WEAK_COLLAPSE        - std=0.0036, corr=-0.029, dir_acc=0.604
[DEGD] 2024-07-12 to 2024-09-19 (  49 days): DEGRADED             - std=0.0034, corr=+0.150, dir_acc=0.618
[WEAK] 2024-09-20 to 2025-10-06 ( 259 days): WEAK_COLLAPSE        - std=0.0040, corr=-0.013, dir_acc=0.565
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            66 days (  5.2%)
  DEGRADED:           88 days (  6.9%)
  WEAK_COLLAPSE:     950 days ( 74.2%)
  STRONG_COLLAPSE:   176 days ( 13.8%)

  Total problematic: 1214 days (94.8%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/staleness_fixed_h16_drop0.25_seed999/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.229084
  RMSE:             1.108641
  MAE:              0.795938
  Out-of-sample RÂ²: -0.0445

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4949

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/staleness_fixed_h16_drop0.25_seed999/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:01:16
======================================================================
  ✓ Success

Processing: 01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr3
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr3/checkpoints/tft-epoch=04-val_loss=0.1419.ckpt
  Validation loss: 0.141882

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr3/evaluation/evaluation_20251026_170117.log
Evaluation started at: 2025-10-26 17:01:17
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.007867
    Max: 0.072061
    Mean: 0.047417
    Std: 0.013259
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0079, max: 0.0721, mean: 0.0474
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   86 days (  6.7%)
2. Range-based                 [WARN]  803 days ( 62.7%)
3. Consecutive-similarity      [WARN]  645 days ( 50.4%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   634 days ( 49.5%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)         [WARN]   306 days ( 23.9%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0030, corr=+nan, dir_acc=nan
[WEAK] 2020-10-01 to 2021-01-27 (  79 days): WEAK_COLLAPSE        - std=0.0051, corr=-0.051, dir_acc=0.554
[DEGD] 2021-01-28 to 2021-02-12 (  12 days): DEGRADED             - std=0.0028, corr=-0.056, dir_acc=0.575
[WEAK] 2021-02-16 to 2021-05-20 (  67 days): WEAK_COLLAPSE        - std=0.0029, corr=+0.098, dir_acc=0.543
[FAIL] 2021-05-21 to 2021-06-04 (  10 days): STRONG_COLLAPSE      - std=0.0009, corr=+0.118, dir_acc=0.543
[WEAK] 2021-06-07 to 2022-02-07 ( 169 days): WEAK_COLLAPSE        - std=0.0055, corr=+0.148, dir_acc=0.573
[DEGD] 2022-02-08 to 2022-02-15 (   6 days): DEGRADED             - std=0.0011, corr=+0.041, dir_acc=0.458
[ OK ] 2022-02-16 to 2022-03-01 (   9 days): HEALTHY              - std=0.0003, corr=+0.120, dir_acc=0.446
[DEGD] 2022-03-04 to 2022-03-11 (   6 days): DEGRADED             - std=0.0028, corr=+0.096, dir_acc=0.403
[DEGD] 2022-03-16 to 2022-07-22 (  89 days): DEGRADED             - std=0.0063, corr=-0.180, dir_acc=0.454
[WEAK] 2022-07-25 to 2022-10-14 (  58 days): WEAK_COLLAPSE        - std=0.0046, corr=-0.126, dir_acc=0.456
[DEGD] 2022-10-17 to 2023-02-13 (  81 days): DEGRADED             - std=0.0106, corr=-0.135, dir_acc=0.412
[WEAK] 2023-02-14 to 2023-03-07 (  15 days): WEAK_COLLAPSE        - std=0.0012, corr=+0.148, dir_acc=0.449
[FAIL] 2023-03-08 to 2023-04-20 (  31 days): STRONG_COLLAPSE      - std=0.0026, corr=+0.094, dir_acc=0.505
[WEAK] 2023-04-21 to 2023-05-22 (  22 days): WEAK_COLLAPSE        - std=0.0030, corr=+0.044, dir_acc=0.510
[DEGD] 2023-05-23 to 2023-06-15 (  17 days): DEGRADED             - std=0.0010, corr=+0.030, dir_acc=0.546
[ OK ] 2023-06-22 to 2023-07-20 (  20 days): HEALTHY              - std=0.0020, corr=+0.045, dir_acc=0.539
[ OK ] 2023-07-24 to 2023-08-18 (  20 days): HEALTHY              - std=0.0024, corr=-0.050, dir_acc=0.568
[DEGD] 2023-08-21 to 2023-09-18 (  20 days): DEGRADED             - std=0.0014, corr=-0.088, dir_acc=0.523
[DEGD] 2023-09-20 to 2023-10-18 (  20 days): DEGRADED             - std=0.0031, corr=-0.165, dir_acc=0.491
[DEGD] 2023-10-23 to 2024-02-20 (  82 days): DEGRADED             - std=0.0030, corr=-0.009, dir_acc=0.578
[DEGD] 2024-02-22 to 2024-03-20 (  20 days): DEGRADED             - std=0.0024, corr=+0.228, dir_acc=0.609
[WEAK] 2024-04-02 to 2024-04-12 (   9 days): WEAK_COLLAPSE        - std=0.0006, corr=+0.195, dir_acc=0.561
[FAIL] 2024-04-15 to 2024-05-20 (  26 days): STRONG_COLLAPSE      - std=0.0022, corr=+0.196, dir_acc=0.509
[DEGD] 2024-05-28 to 2024-06-17 (  15 days): DEGRADED             - std=0.0013, corr=+0.010, dir_acc=0.539
[DEGD] 2024-06-21 to 2024-07-16 (  17 days): DEGRADED             - std=0.0017, corr=+0.001, dir_acc=0.603
[ OK ] 2024-07-23 to 2024-10-23 (  65 days): HEALTHY              - std=0.0050, corr=-0.115, dir_acc=0.597
[DEGD] 2024-10-24 to 2024-11-20 (  19 days): DEGRADED             - std=0.0018, corr=+0.007, dir_acc=0.560
[ OK ] 2024-11-21 to 2025-01-21 (  39 days): HEALTHY              - std=0.0021, corr=+0.112, dir_acc=0.572
[DEGD] 2025-01-24 to 2025-02-20 (  19 days): DEGRADED             - std=0.0024, corr=+0.089, dir_acc=0.578
[WEAK] 2025-02-26 to 2025-03-18 (  15 days): WEAK_COLLAPSE        - std=0.0018, corr=+0.052, dir_acc=0.494
[DEGD] 2025-03-19 to 2025-03-28 (   8 days): DEGRADED             - std=0.0037, corr=-0.118, dir_acc=0.517
[DEGD] 2025-04-07 to 2025-04-28 (  15 days): DEGRADED             - std=0.0071, corr=-0.149, dir_acc=0.501
[ OK ] 2025-04-29 to 2025-08-11 (  72 days): HEALTHY              - std=0.0093, corr=-0.167, dir_acc=0.592
[DEGD] 2025-08-22 to 2025-09-17 (  18 days): DEGRADED             - std=0.0019, corr=-0.098, dir_acc=0.560
[WEAK] 2025-09-18 to 2025-10-06 (  13 days): WEAK_COLLAPSE        - std=0.0035, corr=-0.246, dir_acc=0.571
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           264 days ( 20.6%)
  DEGRADED:          479 days ( 37.4%)
  WEAK_COLLAPSE:     468 days ( 36.6%)
  STRONG_COLLAPSE:    69 days (  5.4%)

  Total problematic: 1016 days (79.4%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.176697
  RMSE:             1.084757
  MAE:              0.772140
  Out-of-sample RÂ²: 0.0001

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5417

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:01:18
======================================================================
  ✓ Success

Processing: 01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr5
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr5/checkpoints/tft-epoch=03-val_loss=0.1440.ckpt
  Validation loss: 0.144020

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr5/evaluation/evaluation_20251026_170120.log
Evaluation started at: 2025-10-26 17:01:20
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.009982
    Max: 0.049443
    Mean: 0.035727
    Std: 0.008089
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0100, max: 0.0494, mean: 0.0357
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    2 days (  0.2%)
2. Range-based                 [WARN] 1152 days ( 90.0%)
3. Consecutive-similarity      [WARN]  927 days ( 72.4%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   517 days ( 40.4%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)         [WARN]   264 days ( 20.6%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0020, corr=+nan, dir_acc=nan
[WEAK] 2020-10-01 to 2022-03-11 ( 360 days): WEAK_COLLAPSE        - std=0.0052, corr=+0.142, dir_acc=0.554
[DEGD] 2022-03-14 to 2022-04-27 (  32 days): DEGRADED             - std=0.0048, corr=-0.089, dir_acc=0.440
[WEAK] 2022-04-28 to 2022-12-20 ( 162 days): WEAK_COLLAPSE        - std=0.0045, corr=-0.148, dir_acc=0.441
[DEGD] 2022-12-21 to 2023-01-24 (  22 days): DEGRADED             - std=0.0012, corr=-0.100, dir_acc=0.418
[WEAK] 2023-01-25 to 2023-03-08 (  30 days): WEAK_COLLAPSE        - std=0.0010, corr=+0.119, dir_acc=0.449
[WEAK] 2023-03-13 to 2023-07-21 (  91 days): WEAK_COLLAPSE        - std=0.0033, corr=+0.133, dir_acc=0.525
[ OK ] 2023-07-26 to 2023-08-16 (  16 days): HEALTHY              - std=0.0009, corr=-0.038, dir_acc=0.571
[WEAK] 2023-08-17 to 2023-10-06 (  36 days): WEAK_COLLAPSE        - std=0.0022, corr=-0.112, dir_acc=0.514
[DEGD] 2023-10-10 to 2023-10-17 (   6 days): DEGRADED             - std=0.0006, corr=-0.052, dir_acc=0.483
[WEAK] 2023-10-18 to 2023-11-21 (  25 days): WEAK_COLLAPSE        - std=0.0024, corr=-0.008, dir_acc=0.481
[DEGD] 2023-11-22 to 2023-12-19 (  19 days): DEGRADED             - std=0.0019, corr=+0.033, dir_acc=0.561
[DEGD] 2023-12-21 to 2024-02-15 (  38 days): DEGRADED             - std=0.0019, corr=+0.065, dir_acc=0.637
[DEGD] 2024-02-23 to 2024-03-19 (  18 days): DEGRADED             - std=0.0014, corr=+0.187, dir_acc=0.610
[WEAK] 2024-03-20 to 2024-07-31 (  92 days): WEAK_COLLAPSE        - std=0.0037, corr=+0.077, dir_acc=0.559
[DEGD] 2024-08-01 to 2024-08-16 (  12 days): DEGRADED             - std=0.0042, corr=-0.050, dir_acc=0.606
[DEGD] 2024-08-22 to 2025-01-21 ( 101 days): DEGRADED             - std=0.0029, corr=+0.021, dir_acc=0.576
[DEGD] 2025-01-27 to 2025-02-21 (  19 days): DEGRADED             - std=0.0016, corr=+0.149, dir_acc=0.576
[WEAK] 2025-02-24 to 2025-03-17 (  16 days): WEAK_COLLAPSE        - std=0.0022, corr=+0.119, dir_acc=0.498
[DEGD] 2025-03-24 to 2025-06-20 (  62 days): DEGRADED             - std=0.0058, corr=-0.154, dir_acc=0.548
[ OK ] 2025-06-23 to 2025-07-18 (  19 days): HEALTHY              - std=0.0018, corr=-0.121, dir_acc=0.618
[ OK ] 2025-07-23 to 2025-07-30 (   6 days): HEALTHY              - std=0.0025, corr=-0.117, dir_acc=0.625
[WEAK] 2025-08-07 to 2025-10-06 (  42 days): WEAK_COLLAPSE        - std=0.0022, corr=-0.116, dir_acc=0.565
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            70 days (  5.5%)
  DEGRADED:          341 days ( 26.6%)
  WEAK_COLLAPSE:     867 days ( 67.7%)
  STRONG_COLLAPSE:     2 days (  0.2%)

  Total problematic: 1210 days (94.5%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.176891
  RMSE:             1.084846
  MAE:              0.772700
  Out-of-sample RÂ²: -0.0001

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5511

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.15_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:01:21
======================================================================
  ✓ Success

Processing: 01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr3
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr3/checkpoints/tft-epoch=04-val_loss=0.1416.ckpt
  Validation loss: 0.141599

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr3/evaluation/evaluation_20251026_170123.log
Evaluation started at: 2025-10-26 17:01:23
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.015881
    Max: 0.076112
    Mean: 0.053930
    Std: 0.011901
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0159, max: 0.0761, mean: 0.0539
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   69 days (  5.4%)
2. Range-based                 [WARN]  890 days ( 69.5%)
3. Consecutive-similarity      [WARN]  712 days ( 55.6%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   623 days ( 48.7%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)         [WARN]   300 days ( 23.4%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0027, corr=+nan, dir_acc=nan
[WEAK] 2020-10-01 to 2021-05-18 ( 156 days): WEAK_COLLAPSE        - std=0.0054, corr=+0.019, dir_acc=0.551
[FAIL] 2021-05-19 to 2021-06-07 (  13 days): STRONG_COLLAPSE      - std=0.0013, corr=+0.152, dir_acc=0.538
[WEAK] 2021-06-08 to 2022-02-14 ( 173 days): WEAK_COLLAPSE        - std=0.0052, corr=+0.156, dir_acc=0.570
[DEGD] 2022-03-04 to 2022-07-22 (  97 days): DEGRADED             - std=0.0059, corr=-0.153, dir_acc=0.449
[WEAK] 2022-07-25 to 2022-10-13 (  57 days): WEAK_COLLAPSE        - std=0.0044, corr=-0.117, dir_acc=0.457
[DEGD] 2022-10-14 to 2023-02-13 (  82 days): DEGRADED             - std=0.0103, corr=-0.134, dir_acc=0.412
[WEAK] 2023-02-14 to 2023-03-07 (  15 days): WEAK_COLLAPSE        - std=0.0012, corr=+0.162, dir_acc=0.449
[FAIL] 2023-03-08 to 2023-04-20 (  31 days): STRONG_COLLAPSE      - std=0.0023, corr=+0.131, dir_acc=0.505
[WEAK] 2023-04-21 to 2023-05-22 (  22 days): WEAK_COLLAPSE        - std=0.0029, corr=+0.062, dir_acc=0.510
[DEGD] 2023-05-23 to 2023-06-08 (  12 days): DEGRADED             - std=0.0009, corr=+0.034, dir_acc=0.533
[WEAK] 2023-06-09 to 2023-06-22 (   9 days): WEAK_COLLAPSE        - std=0.0035, corr=+0.008, dir_acc=0.570
[DEGD] 2023-06-23 to 2023-07-18 (  17 days): DEGRADED             - std=0.0018, corr=+0.045, dir_acc=0.536
[ OK ] 2023-07-25 to 2023-08-17 (  18 days): HEALTHY              - std=0.0015, corr=-0.045, dir_acc=0.569
[DEGD] 2023-08-18 to 2023-09-18 (  21 days): DEGRADED             - std=0.0015, corr=-0.090, dir_acc=0.523
[DEGD] 2023-09-25 to 2023-10-18 (  17 days): DEGRADED             - std=0.0015, corr=-0.149, dir_acc=0.488
[DEGD] 2023-10-24 to 2024-02-20 (  81 days): DEGRADED             - std=0.0028, corr=-0.006, dir_acc=0.580
[DEGD] 2024-02-22 to 2024-03-20 (  20 days): DEGRADED             - std=0.0023, corr=+0.222, dir_acc=0.609
[WEAK] 2024-03-21 to 2024-04-18 (  20 days): WEAK_COLLAPSE        - std=0.0013, corr=+0.191, dir_acc=0.553
[FAIL] 2024-04-19 to 2024-05-20 (  22 days): STRONG_COLLAPSE      - std=0.0022, corr=+0.197, dir_acc=0.506
[WEAK] 2024-05-21 to 2024-06-20 (  21 days): WEAK_COLLAPSE        - std=0.0025, corr=+0.012, dir_acc=0.538
[DEGD] 2024-06-21 to 2024-07-17 (  18 days): DEGRADED             - std=0.0019, corr=-0.004, dir_acc=0.607
[ OK ] 2024-07-23 to 2024-10-15 (  59 days): HEALTHY              - std=0.0049, corr=-0.117, dir_acc=0.600
[DEGD] 2024-10-16 to 2025-01-22 (  65 days): DEGRADED             - std=0.0025, corr=+0.066, dir_acc=0.568
[DEGD] 2025-01-24 to 2025-02-21 (  20 days): DEGRADED             - std=0.0024, corr=+0.106, dir_acc=0.577
[DEGD] 2025-03-07 to 2025-03-28 (  16 days): DEGRADED             - std=0.0044, corr=-0.050, dir_acc=0.503
[DEGD] 2025-04-07 to 2025-04-28 (  15 days): DEGRADED             - std=0.0069, corr=-0.169, dir_acc=0.501
[ OK ] 2025-04-29 to 2025-08-07 (  70 days): HEALTHY              - std=0.0089, corr=-0.172, dir_acc=0.593
[DEGD] 2025-08-08 to 2025-08-15 (   6 days): DEGRADED             - std=0.0007, corr=+0.013, dir_acc=0.569
[DEGD] 2025-08-22 to 2025-09-17 (  18 days): DEGRADED             - std=0.0019, corr=-0.086, dir_acc=0.560
[WEAK] 2025-09-18 to 2025-10-06 (  13 days): WEAK_COLLAPSE        - std=0.0034, corr=-0.237, dir_acc=0.571
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           185 days ( 14.5%)
  DEGRADED:          516 days ( 40.3%)
  WEAK_COLLAPSE:     513 days ( 40.1%)
  STRONG_COLLAPSE:    66 days (  5.2%)

  Total problematic: 1095 days (85.5%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.176676
  RMSE:             1.084747
  MAE:              0.772054
  Out-of-sample RÂ²: 0.0001

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5437

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:01:24
======================================================================
  ✓ Success

Processing: 01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr5
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr5/checkpoints/tft-epoch=03-val_loss=0.1432.ckpt
  Validation loss: 0.143209

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr5/evaluation/evaluation_20251026_170125.log
Evaluation started at: 2025-10-26 17:01:25
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.028134
    Max: 0.069326
    Mean: 0.054600
    Std: 0.007989
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0281, max: 0.0693, mean: 0.0546
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN] 1169 days ( 91.3%)
3. Consecutive-similarity      [WARN]  928 days ( 72.5%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   520 days ( 40.6%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)         [WARN]   266 days ( 20.8%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0019, corr=+nan, dir_acc=nan
[WEAK] 2020-10-01 to 2022-03-11 ( 360 days): WEAK_COLLAPSE        - std=0.0049, corr=+0.143, dir_acc=0.554
[DEGD] 2022-03-14 to 2022-04-27 (  32 days): DEGRADED             - std=0.0048, corr=-0.091, dir_acc=0.440
[WEAK] 2022-04-28 to 2022-12-20 ( 162 days): WEAK_COLLAPSE        - std=0.0049, corr=-0.144, dir_acc=0.441
[DEGD] 2022-12-21 to 2023-01-24 (  22 days): DEGRADED             - std=0.0012, corr=-0.101, dir_acc=0.418
[WEAK] 2023-01-25 to 2023-07-26 ( 126 days): WEAK_COLLAPSE        - std=0.0032, corr=+0.134, dir_acc=0.507
[DEGD] 2023-07-27 to 2023-08-10 (  11 days): DEGRADED             - std=0.0005, corr=-0.024, dir_acc=0.576
[WEAK] 2023-08-15 to 2023-10-10 (  39 days): WEAK_COLLAPSE        - std=0.0022, corr=-0.108, dir_acc=0.515
[WEAK] 2023-10-18 to 2023-11-21 (  25 days): WEAK_COLLAPSE        - std=0.0024, corr=-0.018, dir_acc=0.481
[DEGD] 2023-11-22 to 2023-12-19 (  19 days): DEGRADED             - std=0.0019, corr=+0.010, dir_acc=0.561
[DEGD] 2023-12-21 to 2024-02-15 (  38 days): DEGRADED             - std=0.0018, corr=+0.056, dir_acc=0.637
[DEGD] 2024-02-23 to 2024-03-19 (  18 days): DEGRADED             - std=0.0014, corr=+0.190, dir_acc=0.610
[WEAK] 2024-03-20 to 2024-07-24 (  87 days): WEAK_COLLAPSE        - std=0.0040, corr=+0.084, dir_acc=0.555
[DEGD] 2024-07-25 to 2024-08-16 (  17 days): DEGRADED             - std=0.0041, corr=-0.075, dir_acc=0.614
[DEGD] 2024-08-22 to 2025-01-21 ( 101 days): DEGRADED             - std=0.0029, corr=+0.019, dir_acc=0.576
[DEGD] 2025-01-27 to 2025-02-21 (  19 days): DEGRADED             - std=0.0016, corr=+0.148, dir_acc=0.576
[WEAK] 2025-02-24 to 2025-03-17 (  16 days): WEAK_COLLAPSE        - std=0.0022, corr=+0.112, dir_acc=0.498
[DEGD] 2025-03-25 to 2025-06-20 (  61 days): DEGRADED             - std=0.0062, corr=-0.157, dir_acc=0.548
[ OK ] 2025-06-23 to 2025-07-18 (  19 days): HEALTHY              - std=0.0018, corr=-0.120, dir_acc=0.618
[ OK ] 2025-07-23 to 2025-07-31 (   7 days): HEALTHY              - std=0.0023, corr=-0.113, dir_acc=0.621
[WEAK] 2025-08-06 to 2025-10-06 (  43 days): WEAK_COLLAPSE        - std=0.0023, corr=-0.113, dir_acc=0.566
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            55 days (  4.3%)
  DEGRADED:          353 days ( 27.6%)
  WEAK_COLLAPSE:     872 days ( 68.1%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1225 days (95.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.176543
  RMSE:             1.084686
  MAE:              0.772216
  Out-of-sample RÂ²: 0.0002

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5492

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.20_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:01:27
======================================================================
  ✓ Success

Processing: 01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr3
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr3/checkpoints/tft-epoch=04-val_loss=0.1415.ckpt
  Validation loss: 0.141453

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr3/evaluation/evaluation_20251026_170128.log
Evaluation started at: 2025-10-26 17:01:28
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.024672
    Max: 0.082473
    Mean: 0.061934
    Std: 0.011233
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0247, max: 0.0825, mean: 0.0619
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   69 days (  5.4%)
2. Range-based                 [WARN]  903 days ( 70.5%)
3. Consecutive-similarity      [WARN]  774 days ( 60.5%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   624 days ( 48.8%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)         [WARN]   300 days ( 23.4%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0026, corr=+nan, dir_acc=nan
[WEAK] 2020-10-01 to 2021-05-17 ( 155 days): WEAK_COLLAPSE        - std=0.0047, corr=+0.023, dir_acc=0.551
[FAIL] 2021-05-18 to 2021-06-10 (  17 days): STRONG_COLLAPSE      - std=0.0013, corr=+0.166, dir_acc=0.536
[WEAK] 2021-06-11 to 2022-03-03 ( 182 days): WEAK_COLLAPSE        - std=0.0061, corr=+0.159, dir_acc=0.563
[DEGD] 2022-03-04 to 2022-07-19 (  94 days): DEGRADED             - std=0.0059, corr=-0.150, dir_acc=0.448
[WEAK] 2022-07-20 to 2022-10-13 (  60 days): WEAK_COLLAPSE        - std=0.0045, corr=-0.114, dir_acc=0.458
[DEGD] 2022-10-14 to 2023-02-10 (  81 days): DEGRADED             - std=0.0101, corr=-0.137, dir_acc=0.411
[WEAK] 2023-02-13 to 2023-03-07 (  16 days): WEAK_COLLAPSE        - std=0.0011, corr=+0.159, dir_acc=0.449
[FAIL] 2023-03-08 to 2023-04-19 (  30 days): STRONG_COLLAPSE      - std=0.0018, corr=+0.143, dir_acc=0.504
[WEAK] 2023-04-20 to 2023-05-24 (  25 days): WEAK_COLLAPSE        - std=0.0027, corr=+0.061, dir_acc=0.511
[WEAK] 2023-05-31 to 2023-06-22 (  16 days): WEAK_COLLAPSE        - std=0.0027, corr=+0.018, dir_acc=0.556
[DEGD] 2023-06-23 to 2023-07-17 (  16 days): DEGRADED             - std=0.0017, corr=+0.041, dir_acc=0.534
[ OK ] 2023-07-25 to 2023-08-16 (  17 days): HEALTHY              - std=0.0015, corr=-0.039, dir_acc=0.572
[DEGD] 2023-08-23 to 2023-09-14 (  16 days): DEGRADED             - std=0.0013, corr=-0.077, dir_acc=0.521
[WEAK] 2023-09-15 to 2023-09-22 (   6 days): WEAK_COLLAPSE        - std=0.0052, corr=-0.082, dir_acc=0.511
[DEGD] 2023-09-25 to 2023-10-18 (  17 days): DEGRADED             - std=0.0015, corr=-0.143, dir_acc=0.488
[DEGD] 2023-10-24 to 2024-02-20 (  81 days): DEGRADED             - std=0.0026, corr=-0.014, dir_acc=0.580
[DEGD] 2024-02-23 to 2024-03-20 (  19 days): DEGRADED             - std=0.0014, corr=+0.221, dir_acc=0.609
[WEAK] 2024-03-21 to 2024-04-18 (  20 days): WEAK_COLLAPSE        - std=0.0012, corr=+0.191, dir_acc=0.553
[FAIL] 2024-04-19 to 2024-05-20 (  22 days): STRONG_COLLAPSE      - std=0.0021, corr=+0.196, dir_acc=0.506
[WEAK] 2024-05-21 to 2024-07-08 (  32 days): WEAK_COLLAPSE        - std=0.0050, corr=+0.001, dir_acc=0.552
[DEGD] 2024-07-09 to 2024-07-17 (   7 days): DEGRADED             - std=0.0006, corr=-0.011, dir_acc=0.652
[ OK ] 2024-07-23 to 2024-10-15 (  59 days): HEALTHY              - std=0.0048, corr=-0.121, dir_acc=0.600
[DEGD] 2024-10-16 to 2025-01-22 (  65 days): DEGRADED             - std=0.0025, corr=+0.071, dir_acc=0.568
[DEGD] 2025-01-27 to 2025-02-21 (  19 days): DEGRADED             - std=0.0017, corr=+0.114, dir_acc=0.576
[WEAK] 2025-02-24 to 2025-03-06 (   9 days): WEAK_COLLAPSE        - std=0.0020, corr=+0.117, dir_acc=0.506
[DEGD] 2025-03-07 to 2025-03-28 (  16 days): DEGRADED             - std=0.0043, corr=-0.054, dir_acc=0.503
[DEGD] 2025-04-07 to 2025-04-28 (  15 days): DEGRADED             - std=0.0067, corr=-0.167, dir_acc=0.501
[ OK ] 2025-04-29 to 2025-08-07 (  70 days): HEALTHY              - std=0.0086, corr=-0.169, dir_acc=0.593
[DEGD] 2025-08-08 to 2025-08-15 (   6 days): DEGRADED             - std=0.0007, corr=+0.020, dir_acc=0.569
[DEGD] 2025-08-25 to 2025-09-17 (  17 days): DEGRADED             - std=0.0018, corr=-0.080, dir_acc=0.560
[WEAK] 2025-09-18 to 2025-10-06 (  13 days): WEAK_COLLAPSE        - std=0.0034, corr=-0.231, dir_acc=0.571
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           180 days ( 14.1%)
  DEGRADED:          477 days ( 37.3%)
  WEAK_COLLAPSE:     554 days ( 43.3%)
  STRONG_COLLAPSE:    69 days (  5.4%)

  Total problematic: 1100 days (85.9%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.176735
  RMSE:             1.084774
  MAE:              0.771952
  Out-of-sample RÂ²: 0.0000

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5454

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:01:29
======================================================================
  ✓ Success

Processing: 01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr5
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr5/checkpoints/tft-epoch=03-val_loss=0.1437.ckpt
  Validation loss: 0.143697

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr5/evaluation/evaluation_20251026_170131.log
Evaluation started at: 2025-10-26 17:01:31
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.037576
    Max: 0.076257
    Mean: 0.062383
    Std: 0.007209
    Unique values: 1278

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0376, max: 0.0763, mean: 0.0624
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   12 days (  0.9%)
2. Range-based                 [WARN] 1194 days ( 93.3%)
3. Consecutive-similarity      [WARN]  979 days ( 76.5%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   523 days ( 40.9%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)         [WARN]   264 days ( 20.6%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0018, corr=+nan, dir_acc=nan
[WEAK] 2020-10-01 to 2021-06-01 ( 165 days): WEAK_COLLAPSE        - std=0.0022, corr=+0.078, dir_acc=0.550
[FAIL] 2021-06-02 to 2021-06-11 (   8 days): STRONG_COLLAPSE      - std=0.0006, corr=+0.189, dir_acc=0.540
[WEAK] 2021-06-14 to 2022-03-15 ( 189 days): WEAK_COLLAPSE        - std=0.0043, corr=+0.204, dir_acc=0.556
[DEGD] 2022-03-16 to 2022-04-27 (  30 days): DEGRADED             - std=0.0048, corr=-0.106, dir_acc=0.443
[WEAK] 2022-04-28 to 2023-03-07 ( 213 days): WEAK_COLLAPSE        - std=0.0051, corr=-0.101, dir_acc=0.440
[WEAK] 2023-03-14 to 2023-11-21 ( 175 days): WEAK_COLLAPSE        - std=0.0041, corr=+0.054, dir_acc=0.520
[DEGD] 2023-11-22 to 2023-12-19 (  19 days): DEGRADED             - std=0.0019, corr=+0.028, dir_acc=0.561
[DEGD] 2023-12-21 to 2024-01-19 (  19 days): DEGRADED             - std=0.0020, corr=+0.066, dir_acc=0.618
[DEGD] 2024-01-25 to 2024-02-15 (  16 days): DEGRADED             - std=0.0006, corr=+0.032, dir_acc=0.654
[WEAK] 2024-02-16 to 2024-02-26 (   6 days): WEAK_COLLAPSE        - std=0.0027, corr=+0.059, dir_acc=0.619
[DEGD] 2024-02-27 to 2024-03-05 (   6 days): DEGRADED             - std=0.0004, corr=+0.181, dir_acc=0.628
[WEAK] 2024-03-06 to 2024-08-05 ( 105 days): WEAK_COLLAPSE        - std=0.0037, corr=+0.076, dir_acc=0.564
[DEGD] 2024-08-06 to 2024-08-16 (   9 days): DEGRADED             - std=0.0047, corr=-0.063, dir_acc=0.606
[DEGD] 2024-08-22 to 2024-11-18 (  60 days): DEGRADED             - std=0.0030, corr=-0.061, dir_acc=0.579
[DEGD] 2024-11-22 to 2025-01-21 (  38 days): DEGRADED             - std=0.0014, corr=+0.148, dir_acc=0.572
[DEGD] 2025-01-28 to 2025-02-19 (  16 days): DEGRADED             - std=0.0012, corr=+0.169, dir_acc=0.578
[WEAK] 2025-02-20 to 2025-03-24 (  23 days): WEAK_COLLAPSE        - std=0.0032, corr=+0.095, dir_acc=0.507
[DEGD] 2025-03-25 to 2025-06-20 (  61 days): DEGRADED             - std=0.0060, corr=-0.152, dir_acc=0.548
[ OK ] 2025-06-23 to 2025-07-18 (  19 days): HEALTHY              - std=0.0017, corr=-0.117, dir_acc=0.618
[WEAK] 2025-08-04 to 2025-10-06 (  45 days): WEAK_COLLAPSE        - std=0.0021, corr=-0.108, dir_acc=0.567
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:            53 days (  4.1%)
  DEGRADED:          281 days ( 22.0%)
  WEAK_COLLAPSE:     934 days ( 73.0%)
  STRONG_COLLAPSE:    12 days (  0.9%)

  Total problematic: 1227 days (95.9%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.176626
  RMSE:             1.084724
  MAE:              0.772113
  Out-of-sample RÂ²: 0.0001

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5500

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.25_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:01:32
======================================================================
  ✓ Success

Processing: 01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr3
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr3/checkpoints/tft-epoch=04-val_loss=0.1421.ckpt
  Validation loss: 0.142120

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr3/evaluation/evaluation_20251026_170133.log
Evaluation started at: 2025-10-26 17:01:33
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.032921
    Max: 0.093685
    Mean: 0.071264
    Std: 0.011498
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0329, max: 0.0937, mean: 0.0713
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   86 days (  6.7%)
2. Range-based                 [WARN]  888 days ( 69.4%)
3. Consecutive-similarity      [WARN]  744 days ( 58.1%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   640 days ( 50.0%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)         [WARN]   306 days ( 23.9%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0027, corr=+nan, dir_acc=nan
[WEAK] 2020-10-01 to 2021-05-17 ( 155 days): WEAK_COLLAPSE        - std=0.0053, corr=+0.011, dir_acc=0.551
[FAIL] 2021-05-18 to 2021-06-16 (  21 days): STRONG_COLLAPSE      - std=0.0014, corr=+0.152, dir_acc=0.537
[WEAK] 2021-06-17 to 2022-02-15 ( 167 days): WEAK_COLLAPSE        - std=0.0050, corr=+0.155, dir_acc=0.571
[WEAK] 2022-02-17 to 2022-03-03 (  10 days): WEAK_COLLAPSE        - std=0.0006, corr=+0.131, dir_acc=0.443
[DEGD] 2022-03-04 to 2022-07-25 (  98 days): DEGRADED             - std=0.0061, corr=-0.154, dir_acc=0.450
[WEAK] 2022-07-26 to 2022-10-12 (  55 days): WEAK_COLLAPSE        - std=0.0045, corr=-0.111, dir_acc=0.457
[DEGD] 2022-10-13 to 2023-02-13 (  83 days): DEGRADED             - std=0.0107, corr=-0.133, dir_acc=0.412
[WEAK] 2023-02-14 to 2023-03-06 (  14 days): WEAK_COLLAPSE        - std=0.0011, corr=+0.156, dir_acc=0.446
[FAIL] 2023-03-07 to 2023-04-20 (  32 days): STRONG_COLLAPSE      - std=0.0022, corr=+0.130, dir_acc=0.504
[WEAK] 2023-04-21 to 2023-05-24 (  24 days): WEAK_COLLAPSE        - std=0.0027, corr=+0.046, dir_acc=0.510
[WEAK] 2023-05-31 to 2023-06-22 (  16 days): WEAK_COLLAPSE        - std=0.0028, corr=+0.010, dir_acc=0.556
[DEGD] 2023-06-23 to 2023-07-17 (  16 days): DEGRADED             - std=0.0016, corr=+0.035, dir_acc=0.534
[ OK ] 2023-07-25 to 2023-08-16 (  17 days): HEALTHY              - std=0.0015, corr=-0.041, dir_acc=0.572
[DEGD] 2023-08-22 to 2023-09-14 (  17 days): DEGRADED             - std=0.0013, corr=-0.086, dir_acc=0.522
[WEAK] 2023-09-15 to 2023-09-22 (   6 days): WEAK_COLLAPSE        - std=0.0057, corr=-0.085, dir_acc=0.511
[DEGD] 2023-09-25 to 2023-10-18 (  17 days): DEGRADED             - std=0.0014, corr=-0.152, dir_acc=0.488
[DEGD] 2023-10-24 to 2024-02-20 (  81 days): DEGRADED             - std=0.0027, corr=-0.024, dir_acc=0.580
[DEGD] 2024-02-22 to 2024-03-20 (  20 days): DEGRADED             - std=0.0023, corr=+0.235, dir_acc=0.609
[WEAK] 2024-03-21 to 2024-04-15 (  17 days): WEAK_COLLAPSE        - std=0.0013, corr=+0.205, dir_acc=0.560
[FAIL] 2024-04-16 to 2024-05-20 (  25 days): STRONG_COLLAPSE      - std=0.0022, corr=+0.207, dir_acc=0.507
[WEAK] 2024-05-21 to 2024-06-20 (  21 days): WEAK_COLLAPSE        - std=0.0026, corr=-0.003, dir_acc=0.538
[DEGD] 2024-06-21 to 2024-07-15 (  16 days): DEGRADED             - std=0.0020, corr=-0.005, dir_acc=0.598
[ OK ] 2024-07-23 to 2024-10-21 (  63 days): HEALTHY              - std=0.0050, corr=-0.125, dir_acc=0.598
[DEGD] 2024-10-22 to 2025-01-22 (  61 days): DEGRADED             - std=0.0027, corr=+0.083, dir_acc=0.568
[DEGD] 2025-01-24 to 2025-02-21 (  20 days): DEGRADED             - std=0.0024, corr=+0.113, dir_acc=0.577
[DEGD] 2025-03-10 to 2025-03-28 (  15 days): DEGRADED             - std=0.0042, corr=-0.065, dir_acc=0.504
[DEGD] 2025-04-07 to 2025-04-28 (  15 days): DEGRADED             - std=0.0075, corr=-0.181, dir_acc=0.501
[ OK ] 2025-04-29 to 2025-08-08 (  71 days): HEALTHY              - std=0.0099, corr=-0.171, dir_acc=0.592
[DEGD] 2025-08-22 to 2025-09-17 (  18 days): DEGRADED             - std=0.0019, corr=-0.072, dir_acc=0.560
[WEAK] 2025-09-18 to 2025-10-06 (  13 days): WEAK_COLLAPSE        - std=0.0037, corr=-0.225, dir_acc=0.571
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           188 days ( 14.7%)
  DEGRADED:          491 days ( 38.4%)
  WEAK_COLLAPSE:     519 days ( 40.5%)
  STRONG_COLLAPSE:    82 days (  6.4%)

  Total problematic: 1092 days (85.3%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.177050
  RMSE:             1.084920
  MAE:              0.771881
  Out-of-sample RÂ²: -0.0002

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5438

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:01:35
======================================================================
  ✓ Success

Processing: 01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr5
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr5/checkpoints/tft-epoch=03-val_loss=0.1437.ckpt
  Validation loss: 0.143750

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr5/evaluation/evaluation_20251026_170136.log
Evaluation started at: 2025-10-26 17:01:36
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.041770
    Max: 0.084537
    Mean: 0.068741
    Std: 0.007946
    Unique values: 1277

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0418, max: 0.0845, mean: 0.0687
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   27 days (  2.1%)
2. Range-based                 [WARN] 1059 days ( 82.7%)
3. Consecutive-similarity      [WARN]  913 days ( 71.3%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   548 days ( 42.8%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)         [WARN]   270 days ( 21.1%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0019, corr=+nan, dir_acc=nan
[WEAK] 2020-10-01 to 2021-05-17 ( 155 days): WEAK_COLLAPSE        - std=0.0031, corr=+0.059, dir_acc=0.551
[FAIL] 2021-05-18 to 2021-06-16 (  21 days): STRONG_COLLAPSE      - std=0.0013, corr=+0.174, dir_acc=0.537
[WEAK] 2021-06-17 to 2022-03-10 ( 183 days): WEAK_COLLAPSE        - std=0.0043, corr=+0.190, dir_acc=0.559
[DEGD] 2022-03-11 to 2022-04-27 (  33 days): DEGRADED             - std=0.0055, corr=-0.100, dir_acc=0.438
[WEAK] 2022-04-28 to 2022-10-20 ( 121 days): WEAK_COLLAPSE        - std=0.0045, corr=-0.134, dir_acc=0.456
[DEGD] 2022-10-21 to 2022-11-29 (  26 days): DEGRADED             - std=0.0048, corr=-0.205, dir_acc=0.404
[WEAK] 2022-11-30 to 2022-12-20 (  15 days): WEAK_COLLAPSE        - std=0.0013, corr=-0.171, dir_acc=0.383
[DEGD] 2022-12-21 to 2023-01-30 (  26 days): DEGRADED             - std=0.0012, corr=-0.083, dir_acc=0.420
[WEAK] 2023-01-31 to 2023-03-07 (  25 days): WEAK_COLLAPSE        - std=0.0010, corr=+0.127, dir_acc=0.451
[WEAK] 2023-03-22 to 2023-07-26 (  87 days): WEAK_COLLAPSE        - std=0.0036, corr=+0.111, dir_acc=0.531
[DEGD] 2023-07-27 to 2023-08-14 (  13 days): DEGRADED             - std=0.0007, corr=-0.040, dir_acc=0.574
[WEAK] 2023-08-15 to 2023-09-27 (  31 days): WEAK_COLLAPSE        - std=0.0023, corr=-0.101, dir_acc=0.520
[DEGD] 2023-10-04 to 2023-10-17 (   9 days): DEGRADED             - std=0.0009, corr=-0.090, dir_acc=0.485
[WEAK] 2023-10-18 to 2023-11-17 (  23 days): WEAK_COLLAPSE        - std=0.0018, corr=-0.045, dir_acc=0.474
[DEGD] 2023-11-20 to 2023-12-19 (  21 days): DEGRADED             - std=0.0030, corr=-0.010, dir_acc=0.560
[DEGD] 2023-12-21 to 2024-02-15 (  38 days): DEGRADED             - std=0.0018, corr=+0.053, dir_acc=0.637
[DEGD] 2024-02-23 to 2024-03-19 (  18 days): DEGRADED             - std=0.0013, corr=+0.210, dir_acc=0.610
[WEAK] 2024-03-20 to 2024-05-16 (  41 days): WEAK_COLLAPSE        - std=0.0012, corr=+0.178, dir_acc=0.530
[WEAK] 2024-05-20 to 2024-07-23 (  44 days): WEAK_COLLAPSE        - std=0.0048, corr=+0.011, dir_acc=0.577
[DEGD] 2024-07-24 to 2024-08-16 (  18 days): DEGRADED             - std=0.0043, corr=-0.080, dir_acc=0.615
[ OK ] 2024-08-22 to 2024-10-15 (  37 days): HEALTHY              - std=0.0029, corr=-0.101, dir_acc=0.589
[DEGD] 2024-10-16 to 2025-01-21 (  64 days): DEGRADED             - std=0.0022, corr=+0.081, dir_acc=0.568
[DEGD] 2025-01-27 to 2025-02-21 (  19 days): DEGRADED             - std=0.0016, corr=+0.155, dir_acc=0.576
[WEAK] 2025-02-24 to 2025-03-17 (  16 days): WEAK_COLLAPSE        - std=0.0021, corr=+0.111, dir_acc=0.498
[DEGD] 2025-03-25 to 2025-04-28 (  24 days): DEGRADED             - std=0.0060, corr=-0.148, dir_acc=0.512
[ OK ] 2025-04-29 to 2025-08-01 (  66 days): HEALTHY              - std=0.0069, corr=-0.162, dir_acc=0.593
[DEGD] 2025-08-04 to 2025-08-11 (   6 days): DEGRADED             - std=0.0008, corr=-0.115, dir_acc=0.586
[WEAK] 2025-08-12 to 2025-10-06 (  39 days): WEAK_COLLAPSE        - std=0.0027, corr=-0.109, dir_acc=0.565
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           132 days ( 10.3%)
  DEGRADED:          320 days ( 25.0%)
  WEAK_COLLAPSE:     801 days ( 62.6%)
  STRONG_COLLAPSE:    27 days (  2.1%)

  Total problematic: 1148 days (89.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.176815
  RMSE:             1.084811
  MAE:              0.772021
  Out-of-sample RÂ²: -0.0000

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5478

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.30_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:01:37
======================================================================
  ✓ Success

Processing: 01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr3
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr3/checkpoints/tft-epoch=04-val_loss=0.1437.ckpt
  Validation loss: 0.143721

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr3/evaluation/evaluation_20251026_170139.log
Evaluation started at: 2025-10-26 17:01:39
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.037222
    Max: 0.101782
    Mean: 0.076262
    Std: 0.012071
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0372, max: 0.1018, mean: 0.0763
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   96 days (  7.5%)
2. Range-based                 [WARN]  829 days ( 64.8%)
3. Consecutive-similarity      [WARN]  742 days ( 58.0%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   661 days ( 51.6%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)         [WARN]   314 days ( 24.5%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0028, corr=+nan, dir_acc=nan
[WEAK] 2020-10-01 to 2021-01-27 (  79 days): WEAK_COLLAPSE        - std=0.0046, corr=-0.067, dir_acc=0.554
[DEGD] 2021-01-28 to 2021-02-11 (  11 days): DEGRADED             - std=0.0029, corr=-0.060, dir_acc=0.574
[WEAK] 2021-02-12 to 2021-05-17 (  65 days): WEAK_COLLAPSE        - std=0.0026, corr=+0.101, dir_acc=0.545
[FAIL] 2021-05-18 to 2021-06-29 (  30 days): STRONG_COLLAPSE      - std=0.0013, corr=+0.145, dir_acc=0.538
[WEAK] 2021-06-30 to 2022-03-03 ( 169 days): WEAK_COLLAPSE        - std=0.0059, corr=+0.149, dir_acc=0.564
[DEGD] 2022-03-04 to 2022-07-25 (  98 days): DEGRADED             - std=0.0061, corr=-0.154, dir_acc=0.450
[WEAK] 2022-07-26 to 2022-10-12 (  55 days): WEAK_COLLAPSE        - std=0.0046, corr=-0.111, dir_acc=0.457
[DEGD] 2022-10-13 to 2023-02-13 (  83 days): DEGRADED             - std=0.0109, corr=-0.133, dir_acc=0.412
[WEAK] 2023-02-14 to 2023-03-07 (  15 days): WEAK_COLLAPSE        - std=0.0011, corr=+0.153, dir_acc=0.449
[FAIL] 2023-03-08 to 2023-04-20 (  31 days): STRONG_COLLAPSE      - std=0.0023, corr=+0.111, dir_acc=0.505
[WEAK] 2023-04-21 to 2023-05-24 (  24 days): WEAK_COLLAPSE        - std=0.0027, corr=+0.031, dir_acc=0.510
[WEAK] 2023-05-31 to 2023-06-22 (  16 days): WEAK_COLLAPSE        - std=0.0032, corr=-0.003, dir_acc=0.556
[DEGD] 2023-06-23 to 2023-07-17 (  16 days): DEGRADED             - std=0.0016, corr=+0.024, dir_acc=0.534
[ OK ] 2023-07-25 to 2023-08-17 (  18 days): HEALTHY              - std=0.0014, corr=-0.052, dir_acc=0.569
[DEGD] 2023-08-18 to 2023-09-18 (  21 days): DEGRADED             - std=0.0016, corr=-0.095, dir_acc=0.523
[DEGD] 2023-09-22 to 2023-10-18 (  18 days): DEGRADED             - std=0.0026, corr=-0.169, dir_acc=0.489
[DEGD] 2023-10-23 to 2024-02-20 (  82 days): DEGRADED             - std=0.0030, corr=-0.040, dir_acc=0.578
[DEGD] 2024-02-22 to 2024-03-20 (  20 days): DEGRADED             - std=0.0025, corr=+0.254, dir_acc=0.609
[WEAK] 2024-03-22 to 2024-04-11 (  14 days): WEAK_COLLAPSE        - std=0.0012, corr=+0.234, dir_acc=0.558
[FAIL] 2024-04-12 to 2024-05-20 (  27 days): STRONG_COLLAPSE      - std=0.0024, corr=+0.226, dir_acc=0.511
[WEAK] 2024-05-21 to 2024-06-20 (  21 days): WEAK_COLLAPSE        - std=0.0028, corr=-0.008, dir_acc=0.538
[DEGD] 2024-06-21 to 2024-07-08 (  11 days): DEGRADED             - std=0.0017, corr=-0.016, dir_acc=0.579
[ OK ] 2024-07-09 to 2024-10-22 (  74 days): HEALTHY              - std=0.0078, corr=-0.117, dir_acc=0.605
[DEGD] 2024-10-23 to 2024-11-19 (  19 days): DEGRADED             - std=0.0013, corr=-0.024, dir_acc=0.560
[ OK ] 2024-11-20 to 2025-01-21 (  40 days): HEALTHY              - std=0.0027, corr=+0.132, dir_acc=0.571
[DEGD] 2025-01-24 to 2025-02-21 (  20 days): DEGRADED             - std=0.0026, corr=+0.107, dir_acc=0.577
[DEGD] 2025-03-11 to 2025-03-28 (  14 days): DEGRADED             - std=0.0042, corr=-0.077, dir_acc=0.506
[DEGD] 2025-04-07 to 2025-04-28 (  15 days): DEGRADED             - std=0.0079, corr=-0.195, dir_acc=0.501
[ OK ] 2025-04-29 to 2025-08-11 (  72 days): HEALTHY              - std=0.0109, corr=-0.172, dir_acc=0.592
[DEGD] 2025-08-22 to 2025-09-17 (  18 days): DEGRADED             - std=0.0019, corr=-0.059, dir_acc=0.560
[WEAK] 2025-09-18 to 2025-10-06 (  13 days): WEAK_COLLAPSE        - std=0.0042, corr=-0.213, dir_acc=0.571
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           238 days ( 18.6%)
  DEGRADED:          457 days ( 35.7%)
  WEAK_COLLAPSE:     494 days ( 38.6%)
  STRONG_COLLAPSE:    91 days (  7.1%)

  Total problematic: 1042 days (81.4%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.177288
  RMSE:             1.085029
  MAE:              0.771862
  Out-of-sample RÂ²: -0.0004

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5409

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:01:40
======================================================================
  ✓ Success

Processing: 01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr5
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr5/checkpoints/tft-epoch=03-val_loss=0.1435.ckpt
  Validation loss: 0.143479

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr5/evaluation/evaluation_20251026_170141.log
Evaluation started at: 2025-10-26 17:01:41
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.054771
    Max: 0.097794
    Mean: 0.081259
    Std: 0.007787
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0548, max: 0.0978, mean: 0.0813
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   11 days (  0.9%)
2. Range-based                 [WARN] 1044 days ( 81.6%)
3. Consecutive-similarity      [WARN]  891 days ( 69.6%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   569 days ( 44.5%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)         [WARN]   277 days ( 21.6%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0019, corr=+nan, dir_acc=nan
[WEAK] 2020-10-01 to 2021-05-27 ( 163 days): WEAK_COLLAPSE        - std=0.0028, corr=+0.063, dir_acc=0.550
[FAIL] 2021-05-28 to 2021-06-11 (  10 days): STRONG_COLLAPSE      - std=0.0008, corr=+0.179, dir_acc=0.543
[WEAK] 2021-06-14 to 2022-03-11 ( 187 days): WEAK_COLLAPSE        - std=0.0043, corr=+0.189, dir_acc=0.558
[DEGD] 2022-03-14 to 2022-04-27 (  32 days): DEGRADED             - std=0.0051, corr=-0.103, dir_acc=0.440
[WEAK] 2022-04-28 to 2022-10-21 ( 122 days): WEAK_COLLAPSE        - std=0.0045, corr=-0.130, dir_acc=0.456
[DEGD] 2022-10-24 to 2022-11-29 (  25 days): DEGRADED             - std=0.0045, corr=-0.206, dir_acc=0.405
[WEAK] 2022-11-30 to 2022-12-20 (  15 days): WEAK_COLLAPSE        - std=0.0012, corr=-0.173, dir_acc=0.383
[DEGD] 2022-12-21 to 2023-01-26 (  24 days): DEGRADED             - std=0.0012, corr=-0.092, dir_acc=0.419
[WEAK] 2023-01-27 to 2023-07-21 ( 121 days): WEAK_COLLAPSE        - std=0.0030, corr=+0.122, dir_acc=0.507
[ OK ] 2023-07-26 to 2023-08-16 (  16 days): HEALTHY              - std=0.0009, corr=-0.041, dir_acc=0.571
[WEAK] 2023-08-17 to 2023-09-25 (  27 days): WEAK_COLLAPSE        - std=0.0027, corr=-0.091, dir_acc=0.520
[DEGD] 2023-09-26 to 2023-10-17 (  15 days): DEGRADED             - std=0.0009, corr=-0.137, dir_acc=0.490
[WEAK] 2023-10-18 to 2023-11-17 (  23 days): WEAK_COLLAPSE        - std=0.0018, corr=-0.070, dir_acc=0.474
[DEGD] 2023-11-20 to 2024-02-20 (  62 days): DEGRADED             - std=0.0027, corr=+0.017, dir_acc=0.610
[DEGD] 2024-02-23 to 2024-03-19 (  18 days): DEGRADED             - std=0.0013, corr=+0.229, dir_acc=0.610
[WEAK] 2024-03-20 to 2024-05-16 (  41 days): WEAK_COLLAPSE        - std=0.0012, corr=+0.206, dir_acc=0.530
[WEAK] 2024-05-20 to 2024-07-22 (  43 days): WEAK_COLLAPSE        - std=0.0055, corr=+0.008, dir_acc=0.575
[DEGD] 2024-07-23 to 2024-08-16 (  19 days): DEGRADED             - std=0.0042, corr=-0.087, dir_acc=0.617
[ OK ] 2024-08-22 to 2024-10-15 (  37 days): HEALTHY              - std=0.0030, corr=-0.107, dir_acc=0.589
[DEGD] 2024-10-16 to 2025-01-21 (  64 days): DEGRADED             - std=0.0023, corr=+0.076, dir_acc=0.568
[DEGD] 2025-01-27 to 2025-02-21 (  19 days): DEGRADED             - std=0.0016, corr=+0.147, dir_acc=0.576
[WEAK] 2025-02-24 to 2025-03-17 (  16 days): WEAK_COLLAPSE        - std=0.0021, corr=+0.098, dir_acc=0.498
[DEGD] 2025-03-25 to 2025-04-28 (  24 days): DEGRADED             - std=0.0061, corr=-0.172, dir_acc=0.512
[ OK ] 2025-04-29 to 2025-08-04 (  67 days): HEALTHY              - std=0.0070, corr=-0.170, dir_acc=0.593
[DEGD] 2025-08-05 to 2025-08-12 (   6 days): DEGRADED             - std=0.0007, corr=-0.079, dir_acc=0.581
[WEAK] 2025-08-13 to 2025-09-04 (  16 days): WEAK_COLLAPSE        - std=0.0022, corr=-0.017, dir_acc=0.560
[DEGD] 2025-09-05 to 2025-09-16 (   8 days): DEGRADED             - std=0.0011, corr=-0.081, dir_acc=0.562
[WEAK] 2025-09-17 to 2025-10-06 (  14 days): WEAK_COLLAPSE        - std=0.0034, corr=-0.221, dir_acc=0.570
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           149 days ( 11.6%)
  DEGRADED:          323 days ( 25.2%)
  WEAK_COLLAPSE:     797 days ( 62.3%)
  STRONG_COLLAPSE:    11 days (  0.9%)

  Total problematic: 1131 days (88.4%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.177300
  RMSE:             1.085035
  MAE:              0.771958
  Out-of-sample RÂ²: -0.0005

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5475

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h12_drop0.35_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:01:43
======================================================================
  ✓ Success

Processing: 01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr3
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr3/checkpoints/tft-epoch=05-val_loss=0.1541.ckpt
  Validation loss: 0.154143

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr3/evaluation/evaluation_20251026_170144.log
Evaluation started at: 2025-10-26 17:01:44
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.205059
    Max: 0.293864
    Mean: 0.228891
    Std: 0.012394
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.2051, max: 0.2939, mean: 0.2289
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   85 days (  6.6%)
2. Range-based                 [WARN]  980 days ( 76.6%)
3. Consecutive-similarity      [WARN]  955 days ( 74.6%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   200 days ( 15.6%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)         [ OK ]   102 days (  8.0%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0045, corr=+nan, dir_acc=nan
[DEGD] 2020-09-30 to 2020-10-28 (  20 days): DEGRADED             - std=0.0031, corr=-0.057, dir_acc=0.588
[ OK ] 2020-10-29 to 2021-02-03 (  65 days): HEALTHY              - std=0.0090, corr=+0.204, dir_acc=0.545
[DEGD] 2021-02-04 to 2021-04-01 (  40 days): DEGRADED             - std=0.0024, corr=+0.247, dir_acc=0.560
[ OK ] 2021-04-05 to 2021-04-27 (  17 days): HEALTHY              - std=0.0008, corr=+0.157, dir_acc=0.543
[WEAK] 2021-04-30 to 2021-09-09 (  92 days): WEAK_COLLAPSE        - std=0.0026, corr=+0.135, dir_acc=0.562
[FAIL] 2021-09-10 to 2021-09-20 (   7 days): STRONG_COLLAPSE      - std=0.0006, corr=+0.078, dir_acc=0.605
[WEAK] 2021-09-21 to 2021-10-04 (  10 days): WEAK_COLLAPSE        - std=0.0014, corr=+0.108, dir_acc=0.552
[FAIL] 2021-10-05 to 2021-11-24 (  35 days): STRONG_COLLAPSE      - std=0.0015, corr=+0.116, dir_acc=0.590
[WEAK] 2021-11-26 to 2022-01-24 (  40 days): WEAK_COLLAPSE        - std=0.0023, corr=+0.026, dir_acc=0.583
[DEGD] 2022-01-25 to 2022-02-03 (   8 days): DEGRADED             - std=0.0024, corr=+0.045, dir_acc=0.471
[WEAK] 2022-02-04 to 2022-02-11 (   6 days): WEAK_COLLAPSE        - std=0.0007, corr=+0.162, dir_acc=0.458
[DEGD] 2022-02-14 to 2022-02-25 (   9 days): DEGRADED             - std=0.0028, corr=+0.129, dir_acc=0.448
[WEAK] 2022-02-28 to 2022-03-08 (   7 days): WEAK_COLLAPSE        - std=0.0004, corr=+0.062, dir_acc=0.426
[DEGD] 2022-03-09 to 2022-04-11 (  24 days): DEGRADED             - std=0.0024, corr=+0.177, dir_acc=0.429
[WEAK] 2022-04-12 to 2024-02-16 ( 462 days): WEAK_COLLAPSE        - std=0.0069, corr=+0.114, dir_acc=0.493
[FAIL] 2024-02-20 to 2024-04-19 (  43 days): STRONG_COLLAPSE      - std=0.0016, corr=-0.052, dir_acc=0.581
[WEAK] 2024-04-22 to 2024-07-19 (  62 days): WEAK_COLLAPSE        - std=0.0062, corr=+0.047, dir_acc=0.552
[DEGD] 2024-07-22 to 2024-08-07 (  13 days): DEGRADED             - std=0.0092, corr=+0.161, dir_acc=0.623
[ OK ] 2024-08-08 to 2024-10-30 (  58 days): HEALTHY              - std=0.0049, corr=+0.226, dir_acc=0.590
[WEAK] 2024-11-05 to 2025-03-10 (  83 days): WEAK_COLLAPSE        - std=0.0026, corr=+0.131, dir_acc=0.561
[DEGD] 2025-03-11 to 2025-03-21 (   9 days): DEGRADED             - std=0.0039, corr=+0.114, dir_acc=0.500
[WEAK] 2025-03-24 to 2025-04-03 (   9 days): WEAK_COLLAPSE        - std=0.0008, corr=+0.087, dir_acc=0.528
[ OK ] 2025-04-09 to 2025-07-24 (  73 days): HEALTHY              - std=0.0209, corr=+0.130, dir_acc=0.574
[DEGD] 2025-07-25 to 2025-08-05 (   8 days): DEGRADED             - std=0.0006, corr=+0.166, dir_acc=0.608
[WEAK] 2025-08-06 to 2025-10-06 (  43 days): WEAK_COLLAPSE        - std=0.0038, corr=+0.027, dir_acc=0.566
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           242 days ( 18.9%)
  DEGRADED:          139 days ( 10.9%)
  WEAK_COLLAPSE:     814 days ( 63.6%)
  STRONG_COLLAPSE:    85 days (  6.6%)

  Total problematic: 1038 days (81.1%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.205917
  RMSE:             1.098143
  MAE:              0.785020
  Out-of-sample RÂ²: -0.0248

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4750

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:01:46
======================================================================
  ✓ Success

Processing: 01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr5
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr5/checkpoints/tft-epoch=03-val_loss=0.1530.ckpt
  Validation loss: 0.152988

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr5/evaluation/evaluation_20251026_170147.log
Evaluation started at: 2025-10-26 17:01:47
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.227937
    Max: 0.313118
    Mean: 0.252988
    Std: 0.012972
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.2279, max: 0.3131, mean: 0.2530
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   28 days (  2.2%)
2. Range-based                 [WARN]  973 days ( 76.0%)
3. Consecutive-similarity      [WARN]  984 days ( 76.9%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   222 days ( 17.3%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)         [ OK ]   123 days (  9.6%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0041, corr=+nan, dir_acc=nan
[DEGD] 2020-09-30 to 2020-10-07 (   6 days): DEGRADED             - std=0.0011, corr=-0.095, dir_acc=0.600
[WEAK] 2020-10-15 to 2020-10-26 (   8 days): WEAK_COLLAPSE        - std=0.0017, corr=-0.039, dir_acc=0.578
[ OK ] 2020-10-29 to 2021-02-03 (  65 days): HEALTHY              - std=0.0080, corr=+0.206, dir_acc=0.545
[DEGD] 2021-02-04 to 2021-02-12 (   7 days): DEGRADED             - std=0.0013, corr=+0.216, dir_acc=0.581
[WEAK] 2021-02-16 to 2021-02-23 (   6 days): WEAK_COLLAPSE        - std=0.0012, corr=+0.245, dir_acc=0.567
[DEGD] 2021-02-24 to 2021-04-23 (  42 days): DEGRADED             - std=0.0025, corr=+0.216, dir_acc=0.549
[WEAK] 2021-04-26 to 2021-10-13 ( 119 days): WEAK_COLLAPSE        - std=0.0034, corr=+0.093, dir_acc=0.562
[FAIL] 2021-10-14 to 2021-11-23 (  28 days): STRONG_COLLAPSE      - std=0.0012, corr=+0.116, dir_acc=0.599
[WEAK] 2021-11-24 to 2022-03-08 (  71 days): WEAK_COLLAPSE        - std=0.0061, corr=+0.034, dir_acc=0.527
[DEGD] 2022-03-09 to 2022-04-08 (  23 days): DEGRADED             - std=0.0017, corr=+0.151, dir_acc=0.428
[WEAK] 2022-04-11 to 2023-10-20 ( 382 days): WEAK_COLLAPSE        - std=0.0070, corr=+0.122, dir_acc=0.475
[WEAK] 2023-10-27 to 2023-12-21 (  39 days): WEAK_COLLAPSE        - std=0.0044, corr=+0.017, dir_acc=0.535
[DEGD] 2023-12-22 to 2024-01-18 (  17 days): DEGRADED             - std=0.0011, corr=-0.025, dir_acc=0.616
[WEAK] 2024-01-19 to 2024-07-03 ( 115 days): WEAK_COLLAPSE        - std=0.0036, corr=+0.042, dir_acc=0.572
[DEGD] 2024-07-05 to 2024-08-05 (  22 days): DEGRADED             - std=0.0047, corr=+0.100, dir_acc=0.637
[ OK ] 2024-08-06 to 2024-10-30 (  60 days): HEALTHY              - std=0.0056, corr=+0.220, dir_acc=0.590
[WEAK] 2024-11-05 to 2025-03-11 (  84 days): WEAK_COLLAPSE        - std=0.0029, corr=+0.121, dir_acc=0.561
[DEGD] 2025-03-12 to 2025-03-19 (   6 days): DEGRADED             - std=0.0024, corr=+0.146, dir_acc=0.497
[WEAK] 2025-03-20 to 2025-04-03 (  11 days): WEAK_COLLAPSE        - std=0.0010, corr=+0.129, dir_acc=0.526
[ OK ] 2025-04-09 to 2025-07-24 (  73 days): HEALTHY              - std=0.0195, corr=+0.131, dir_acc=0.574
[DEGD] 2025-07-25 to 2025-08-06 (   9 days): DEGRADED             - std=0.0005, corr=+0.165, dir_acc=0.607
[WEAK] 2025-08-07 to 2025-10-06 (  42 days): WEAK_COLLAPSE        - std=0.0049, corr=+0.002, dir_acc=0.565
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           227 days ( 17.7%)
  DEGRADED:          147 days ( 11.5%)
  WEAK_COLLAPSE:     878 days ( 68.6%)
  STRONG_COLLAPSE:    28 days (  2.2%)

  Total problematic: 1053 days (82.3%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.214957
  RMSE:             1.102251
  MAE:              0.789087
  Out-of-sample RÂ²: -0.0325

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4728

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.15_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:01:48
======================================================================
  ✓ Success

Processing: 01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr3
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr3/checkpoints/tft-epoch=05-val_loss=0.1576.ckpt
  Validation loss: 0.157562

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr3/evaluation/evaluation_20251026_170150.log
Evaluation started at: 2025-10-26 17:01:50
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.221860
    Max: 0.313233
    Mean: 0.246619
    Std: 0.013057
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.2219, max: 0.3132, mean: 0.2466
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]  101 days (  7.9%)
2. Range-based                 [WARN] 1007 days ( 78.7%)
3. Consecutive-similarity      [WARN]  962 days ( 75.2%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   220 days ( 17.2%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)         [ OK ]   104 days (  8.1%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0044, corr=+nan, dir_acc=nan
[DEGD] 2020-09-30 to 2020-10-28 (  20 days): DEGRADED             - std=0.0030, corr=-0.062, dir_acc=0.588
[ OK ] 2020-10-29 to 2021-02-03 (  65 days): HEALTHY              - std=0.0089, corr=+0.207, dir_acc=0.545
[DEGD] 2021-02-04 to 2021-04-29 (  59 days): DEGRADED             - std=0.0024, corr=+0.221, dir_acc=0.554
[WEAK] 2021-04-30 to 2021-09-09 (  92 days): WEAK_COLLAPSE        - std=0.0026, corr=+0.118, dir_acc=0.562
[FAIL] 2021-09-10 to 2021-09-20 (   7 days): STRONG_COLLAPSE      - std=0.0006, corr=+0.054, dir_acc=0.605
[WEAK] 2021-09-21 to 2021-09-29 (   7 days): WEAK_COLLAPSE        - std=0.0014, corr=+0.083, dir_acc=0.557
[FAIL] 2021-09-30 to 2021-11-24 (  38 days): STRONG_COLLAPSE      - std=0.0015, corr=+0.116, dir_acc=0.586
[WEAK] 2021-11-26 to 2022-01-26 (  42 days): WEAK_COLLAPSE        - std=0.0028, corr=+0.016, dir_acc=0.579
[WEAK] 2022-02-03 to 2022-02-14 (   8 days): WEAK_COLLAPSE        - std=0.0017, corr=+0.156, dir_acc=0.456
[DEGD] 2022-02-15 to 2022-02-23 (   6 days): DEGRADED             - std=0.0019, corr=+0.136, dir_acc=0.450
[WEAK] 2022-02-24 to 2022-03-08 (   9 days): WEAK_COLLAPSE        - std=0.0004, corr=+0.068, dir_acc=0.430
[DEGD] 2022-03-09 to 2022-04-11 (  24 days): DEGRADED             - std=0.0022, corr=+0.177, dir_acc=0.429
[WEAK] 2022-04-12 to 2024-02-16 ( 462 days): WEAK_COLLAPSE        - std=0.0074, corr=+0.117, dir_acc=0.493
[FAIL] 2024-02-20 to 2024-04-22 (  44 days): STRONG_COLLAPSE      - std=0.0016, corr=-0.072, dir_acc=0.578
[WEAK] 2024-04-23 to 2024-06-11 (  35 days): WEAK_COLLAPSE        - std=0.0018, corr=+0.021, dir_acc=0.517
[FAIL] 2024-06-12 to 2024-06-21 (   7 days): STRONG_COLLAPSE      - std=0.0007, corr=+0.184, dir_acc=0.562
[WEAK] 2024-06-24 to 2024-08-05 (  30 days): WEAK_COLLAPSE        - std=0.0037, corr=+0.108, dir_acc=0.620
[ OK ] 2024-08-09 to 2024-10-30 (  57 days): HEALTHY              - std=0.0041, corr=+0.219, dir_acc=0.590
[WEAK] 2024-11-05 to 2024-12-18 (  30 days): WEAK_COLLAPSE        - std=0.0020, corr=+0.066, dir_acc=0.581
[WEAK] 2024-12-26 to 2025-03-11 (  50 days): WEAK_COLLAPSE        - std=0.0023, corr=+0.158, dir_acc=0.549
[DEGD] 2025-03-12 to 2025-03-19 (   6 days): DEGRADED             - std=0.0037, corr=+0.102, dir_acc=0.497
[WEAK] 2025-03-20 to 2025-04-03 (  11 days): WEAK_COLLAPSE        - std=0.0008, corr=+0.083, dir_acc=0.526
[ OK ] 2025-04-09 to 2025-07-24 (  73 days): HEALTHY              - std=0.0218, corr=+0.134, dir_acc=0.574
[DEGD] 2025-07-25 to 2025-08-05 (   8 days): DEGRADED             - std=0.0004, corr=+0.156, dir_acc=0.608
[WEAK] 2025-08-06 to 2025-09-16 (  29 days): WEAK_COLLAPSE        - std=0.0019, corr=-0.016, dir_acc=0.564
[WEAK] 2025-09-24 to 2025-10-06 (   9 days): WEAK_COLLAPSE        - std=0.0018, corr=+0.031, dir_acc=0.569
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           224 days ( 17.5%)
  DEGRADED:          141 days ( 11.0%)
  WEAK_COLLAPSE:     814 days ( 63.6%)
  STRONG_COLLAPSE:   101 days (  7.9%)

  Total problematic: 1056 days (82.5%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.212376
  RMSE:             1.101080
  MAE:              0.787900
  Out-of-sample RÂ²: -0.0303

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4745

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:01:51
======================================================================
  ✓ Success

Processing: 01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr5
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr5/checkpoints/tft-epoch=03-val_loss=0.1603.ckpt
  Validation loss: 0.160338

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr5/evaluation/evaluation_20251026_170153.log
Evaluation started at: 2025-10-26 17:01:53
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.261072
    Max: 0.349449
    Mean: 0.288051
    Std: 0.014342
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.2611, max: 0.3494, mean: 0.2881
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   26 days (  2.0%)
2. Range-based                 [WARN]  922 days ( 72.0%)
3. Consecutive-similarity      [WARN]  975 days ( 76.2%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   235 days ( 18.4%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)         [ OK ]   119 days (  9.3%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0041, corr=+nan, dir_acc=nan
[WEAK] 2020-10-02 to 2020-10-09 (   6 days): WEAK_COLLAPSE        - std=0.0010, corr=-0.080, dir_acc=0.603
[WEAK] 2020-10-14 to 2020-10-27 (  10 days): WEAK_COLLAPSE        - std=0.0022, corr=-0.047, dir_acc=0.577
[ OK ] 2020-10-29 to 2021-02-03 (  65 days): HEALTHY              - std=0.0078, corr=+0.210, dir_acc=0.545
[DEGD] 2021-02-04 to 2021-02-11 (   6 days): DEGRADED             - std=0.0014, corr=+0.222, dir_acc=0.581
[WEAK] 2021-02-12 to 2021-02-25 (   9 days): WEAK_COLLAPSE        - std=0.0011, corr=+0.249, dir_acc=0.567
[DEGD] 2021-02-26 to 2021-04-23 (  40 days): DEGRADED             - std=0.0024, corr=+0.224, dir_acc=0.549
[WEAK] 2021-04-26 to 2021-10-15 ( 121 days): WEAK_COLLAPSE        - std=0.0037, corr=+0.067, dir_acc=0.562
[FAIL] 2021-10-18 to 2021-11-23 (  26 days): STRONG_COLLAPSE      - std=0.0012, corr=+0.132, dir_acc=0.601
[WEAK] 2021-11-24 to 2022-02-15 (  57 days): WEAK_COLLAPSE        - std=0.0035, corr=+0.023, dir_acc=0.550
[WEAK] 2022-02-25 to 2022-03-08 (   8 days): WEAK_COLLAPSE        - std=0.0005, corr=+0.005, dir_acc=0.429
[DEGD] 2022-03-09 to 2022-04-12 (  25 days): DEGRADED             - std=0.0014, corr=+0.148, dir_acc=0.429
[WEAK] 2022-04-13 to 2023-10-20 ( 380 days): WEAK_COLLAPSE        - std=0.0082, corr=+0.121, dir_acc=0.475
[DEGD] 2023-10-23 to 2023-11-24 (  24 days): DEGRADED             - std=0.0034, corr=-0.004, dir_acc=0.492
[ OK ] 2023-11-27 to 2023-12-14 (  14 days): HEALTHY              - std=0.0013, corr=+0.092, dir_acc=0.554
[DEGD] 2023-12-15 to 2024-01-19 (  23 days): DEGRADED             - std=0.0022, corr=+0.003, dir_acc=0.614
[WEAK] 2024-01-22 to 2024-06-28 ( 111 days): WEAK_COLLAPSE        - std=0.0036, corr=+0.043, dir_acc=0.571
[DEGD] 2024-07-01 to 2024-08-02 (  24 days): DEGRADED             - std=0.0046, corr=+0.097, dir_acc=0.633
[ OK ] 2024-08-05 to 2024-10-30 (  61 days): HEALTHY              - std=0.0059, corr=+0.217, dir_acc=0.590
[WEAK] 2024-11-05 to 2025-03-11 (  84 days): WEAK_COLLAPSE        - std=0.0031, corr=+0.117, dir_acc=0.561
[DEGD] 2025-03-12 to 2025-03-19 (   6 days): DEGRADED             - std=0.0019, corr=+0.154, dir_acc=0.497
[WEAK] 2025-03-20 to 2025-04-03 (  11 days): WEAK_COLLAPSE        - std=0.0011, corr=+0.138, dir_acc=0.526
[ OK ] 2025-04-09 to 2025-07-30 (  77 days): HEALTHY              - std=0.0202, corr=+0.134, dir_acc=0.577
[DEGD] 2025-07-31 to 2025-08-07 (   6 days): DEGRADED             - std=0.0006, corr=+0.177, dir_acc=0.594
[WEAK] 2025-08-08 to 2025-10-03 (  40 days): WEAK_COLLAPSE        - std=0.0055, corr=-0.007, dir_acc=0.564
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           246 days ( 19.2%)
  DEGRADED:          169 days ( 13.2%)
  WEAK_COLLAPSE:     839 days ( 65.5%)
  STRONG_COLLAPSE:    26 days (  2.0%)

  Total problematic: 1034 days (80.8%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.230036
  RMSE:             1.109070
  MAE:              0.795923
  Out-of-sample RÂ²: -0.0453

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4713

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.20_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:01:54
======================================================================
  ✓ Success

Processing: 01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr3
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr3/checkpoints/tft-epoch=05-val_loss=0.1607.ckpt
  Validation loss: 0.160732

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr3/evaluation/evaluation_20251026_170155.log
Evaluation started at: 2025-10-26 17:01:55
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.234190
    Max: 0.319956
    Mean: 0.259631
    Std: 0.012917
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.2342, max: 0.3200, mean: 0.2596
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   56 days (  4.4%)
2. Range-based                 [WARN] 1040 days ( 81.2%)
3. Consecutive-similarity      [WARN] 1006 days ( 78.6%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   231 days ( 18.0%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)         [ OK ]   112 days (  8.8%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0038, corr=+nan, dir_acc=nan
[WEAK] 2020-10-02 to 2020-10-27 (  17 days): WEAK_COLLAPSE        - std=0.0020, corr=-0.050, dir_acc=0.588
[ OK ] 2020-10-29 to 2021-02-03 (  65 days): HEALTHY              - std=0.0076, corr=+0.210, dir_acc=0.545
[WEAK] 2021-02-11 to 2021-02-25 (  10 days): WEAK_COLLAPSE        - std=0.0011, corr=+0.240, dir_acc=0.568
[DEGD] 2021-02-26 to 2021-04-23 (  40 days): DEGRADED             - std=0.0024, corr=+0.214, dir_acc=0.549
[WEAK] 2021-04-26 to 2021-10-05 ( 114 days): WEAK_COLLAPSE        - std=0.0033, corr=+0.077, dir_acc=0.562
[FAIL] 2021-10-06 to 2021-11-23 (  33 days): STRONG_COLLAPSE      - std=0.0012, corr=+0.078, dir_acc=0.592
[WEAK] 2021-11-24 to 2024-03-07 ( 570 days): WEAK_COLLAPSE        - std=0.0072, corr=+0.109, dir_acc=0.497
[FAIL] 2024-03-08 to 2024-04-10 (  23 days): STRONG_COLLAPSE      - std=0.0008, corr=-0.038, dir_acc=0.570
[WEAK] 2024-04-11 to 2024-08-05 (  80 days): WEAK_COLLAPSE        - std=0.0062, corr=+0.036, dir_acc=0.560
[ OK ] 2024-08-09 to 2024-10-29 (  56 days): HEALTHY              - std=0.0039, corr=+0.226, dir_acc=0.590
[WEAK] 2024-11-05 to 2025-03-17 (  88 days): WEAK_COLLAPSE        - std=0.0033, corr=+0.108, dir_acc=0.557
[WEAK] 2025-03-20 to 2025-04-04 (  12 days): WEAK_COLLAPSE        - std=0.0024, corr=+0.092, dir_acc=0.526
[ OK ] 2025-04-09 to 2025-07-23 (  72 days): HEALTHY              - std=0.0196, corr=+0.138, dir_acc=0.573
[DEGD] 2025-07-24 to 2025-08-05 (   9 days): DEGRADED             - std=0.0005, corr=+0.151, dir_acc=0.611
[WEAK] 2025-08-06 to 2025-10-06 (  43 days): WEAK_COLLAPSE        - std=0.0041, corr=-0.003, dir_acc=0.566
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           222 days ( 17.3%)
  DEGRADED:           68 days (  5.3%)
  WEAK_COLLAPSE:     934 days ( 73.0%)
  STRONG_COLLAPSE:    56 days (  4.4%)

  Total problematic: 1058 days (82.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.217601
  RMSE:             1.103449
  MAE:              0.790316
  Out-of-sample RÂ²: -0.0347

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4738

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:01:57
======================================================================
  ✓ Success

Processing: 01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr5
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr5/checkpoints/tft-epoch=04-val_loss=0.1603.ckpt
  Validation loss: 0.160339

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr5/evaluation/evaluation_20251026_170158.log
Evaluation started at: 2025-10-26 17:01:58
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.154588
    Max: 0.259001
    Mean: 0.177510
    Std: 0.014580
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1546, max: 0.2590, mean: 0.1775
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  239 days ( 18.7%)
2. Range-based                 [WARN]  783 days ( 61.2%)
3. Consecutive-similarity      [WARN]  804 days ( 62.8%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   197 days ( 15.4%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)         [ OK ]    70 days (  5.5%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0053, corr=+nan, dir_acc=nan
[DEGD] 2020-09-30 to 2020-10-27 (  19 days): DEGRADED             - std=0.0027, corr=-0.050, dir_acc=0.590
[ OK ] 2020-10-28 to 2021-04-28 ( 124 days): HEALTHY              - std=0.0093, corr=+0.215, dir_acc=0.549
[WEAK] 2021-05-04 to 2021-05-12 (   7 days): WEAK_COLLAPSE        - std=0.0009, corr=+0.101, dir_acc=0.510
[DEGD] 2021-05-13 to 2021-05-25 (   9 days): DEGRADED             - std=0.0023, corr=+0.131, dir_acc=0.524
[WEAK] 2021-05-26 to 2021-07-21 (  39 days): WEAK_COLLAPSE        - std=0.0013, corr=+0.109, dir_acc=0.549
[FAIL] 2021-07-22 to 2021-11-26 (  88 days): STRONG_COLLAPSE      - std=0.0020, corr=+0.161, dir_acc=0.590
[WEAK] 2021-12-28 to 2022-01-19 (  16 days): WEAK_COLLAPSE        - std=0.0015, corr=+0.057, dir_acc=0.581
[ OK ] 2022-01-28 to 2022-02-16 (  14 days): HEALTHY              - std=0.0033, corr=+0.191, dir_acc=0.460
[ OK ] 2022-02-22 to 2022-04-13 (  37 days): HEALTHY              - std=0.0033, corr=+0.178, dir_acc=0.430
[DEGD] 2022-04-14 to 2022-05-11 (  19 days): DEGRADED             - std=0.0037, corr=+0.245, dir_acc=0.450
[WEAK] 2022-05-12 to 2022-05-20 (   7 days): WEAK_COLLAPSE        - std=0.0011, corr=+0.257, dir_acc=0.443
[DEGD] 2022-05-23 to 2022-07-20 (  40 days): DEGRADED             - std=0.0032, corr=+0.296, dir_acc=0.465
[WEAK] 2022-07-21 to 2022-10-21 (  65 days): WEAK_COLLAPSE        - std=0.0051, corr=+0.116, dir_acc=0.453
[DEGD] 2022-10-24 to 2022-11-16 (  17 days): DEGRADED             - std=0.0044, corr=+0.186, dir_acc=0.402
[WEAK] 2022-11-17 to 2022-12-01 (  10 days): WEAK_COLLAPSE        - std=0.0008, corr=+0.171, dir_acc=0.412
[DEGD] 2022-12-02 to 2023-01-26 (  37 days): DEGRADED             - std=0.0025, corr=+0.161, dir_acc=0.405
[WEAK] 2023-01-27 to 2023-04-21 (  59 days): WEAK_COLLAPSE        - std=0.0044, corr=+0.109, dir_acc=0.480
[DEGD] 2023-04-24 to 2023-06-20 (  40 days): DEGRADED             - std=0.0022, corr=+0.139, dir_acc=0.528
[WEAK] 2023-06-21 to 2023-08-29 (  49 days): WEAK_COLLAPSE        - std=0.0013, corr=+0.083, dir_acc=0.551
[FAIL] 2023-08-30 to 2023-10-04 (  25 days): STRONG_COLLAPSE      - std=0.0016, corr=-0.012, dir_acc=0.509
[WEAK] 2023-10-05 to 2023-12-21 (  54 days): WEAK_COLLAPSE        - std=0.0045, corr=+0.046, dir_acc=0.514
[DEGD] 2023-12-22 to 2024-01-18 (  17 days): DEGRADED             - std=0.0006, corr=-0.061, dir_acc=0.616
[WEAK] 2024-01-19 to 2024-02-12 (  17 days): WEAK_COLLAPSE        - std=0.0006, corr=+0.137, dir_acc=0.660
[FAIL] 2024-02-13 to 2024-07-01 (  96 days): STRONG_COLLAPSE      - std=0.0021, corr=-0.047, dir_acc=0.556
[WEAK] 2024-07-02 to 2024-08-05 (  24 days): WEAK_COLLAPSE        - std=0.0032, corr=+0.101, dir_acc=0.633
[ OK ] 2024-08-09 to 2024-11-05 (  61 days): HEALTHY              - std=0.0052, corr=+0.211, dir_acc=0.589
[WEAK] 2024-11-06 to 2024-12-18 (  29 days): WEAK_COLLAPSE        - std=0.0019, corr=+0.105, dir_acc=0.581
[ OK ] 2024-12-24 to 2025-01-03 (   7 days): HEALTHY              - std=0.0009, corr=+0.234, dir_acc=0.548
[WEAK] 2025-01-07 to 2025-03-10 (  42 days): WEAK_COLLAPSE        - std=0.0028, corr=+0.197, dir_acc=0.551
[ OK ] 2025-03-14 to 2025-04-04 (  16 days): HEALTHY              - std=0.0057, corr=+0.038, dir_acc=0.521
[ OK ] 2025-04-09 to 2025-07-31 (  78 days): HEALTHY              - std=0.0287, corr=+0.138, dir_acc=0.577
[WEAK] 2025-08-07 to 2025-08-19 (   9 days): WEAK_COLLAPSE        - std=0.0004, corr=-0.014, dir_acc=0.570
[FAIL] 2025-08-20 to 2025-10-01 (  30 days): STRONG_COLLAPSE      - std=0.0021, corr=+0.006, dir_acc=0.562
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           368 days ( 28.7%)
  DEGRADED:          230 days ( 18.0%)
  WEAK_COLLAPSE:     443 days ( 34.6%)
  STRONG_COLLAPSE:   239 days ( 18.7%)

  Total problematic:  912 days (71.2%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.190733
  RMSE:             1.091207
  MAE:              0.777959
  Out-of-sample RÂ²: -0.0119

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4700

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.25_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:02:00
======================================================================
  ✓ Success

Processing: 01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr3
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr3/checkpoints/tft-epoch=05-val_loss=0.1624.ckpt
  Validation loss: 0.162382

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr3/evaluation/evaluation_20251026_170201.log
Evaluation started at: 2025-10-26 17:02:01
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.246444
    Max: 0.329035
    Mean: 0.273959
    Std: 0.013361
    Unique values: 1277

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.2464, max: 0.3290, mean: 0.2740
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   25 days (  2.0%)
2. Range-based                 [WARN] 1016 days ( 79.4%)
3. Consecutive-similarity      [WARN] 1071 days ( 83.7%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   278 days ( 21.7%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)         [ OK ]   126 days (  9.8%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0032, corr=+nan, dir_acc=nan
[WEAK] 2020-10-01 to 2020-10-28 (  19 days): WEAK_COLLAPSE        - std=0.0022, corr=-0.047, dir_acc=0.588
[ OK ] 2020-10-29 to 2021-01-26 (  59 days): HEALTHY              - std=0.0066, corr=+0.193, dir_acc=0.542
[WEAK] 2021-02-05 to 2021-03-10 (  23 days): WEAK_COLLAPSE        - std=0.0016, corr=+0.243, dir_acc=0.558
[WEAK] 2021-03-16 to 2021-10-15 ( 149 days): WEAK_COLLAPSE        - std=0.0046, corr=+0.055, dir_acc=0.560
[FAIL] 2021-10-18 to 2021-11-22 (  25 days): STRONG_COLLAPSE      - std=0.0011, corr=+0.022, dir_acc=0.602
[WEAK] 2021-11-23 to 2022-03-23 (  83 days): WEAK_COLLAPSE        - std=0.0070, corr=+0.016, dir_acc=0.512
[DEGD] 2022-03-24 to 2022-03-31 (   6 days): DEGRADED             - std=0.0009, corr=+0.226, dir_acc=0.431
[WEAK] 2022-04-01 to 2024-07-10 ( 567 days): WEAK_COLLAPSE        - std=0.0064, corr=+0.098, dir_acc=0.503
[DEGD] 2024-07-11 to 2024-08-07 (  20 days): DEGRADED             - std=0.0071, corr=+0.139, dir_acc=0.637
[ OK ] 2024-08-08 to 2024-09-25 (  34 days): HEALTHY              - std=0.0050, corr=+0.219, dir_acc=0.606
[DEGD] 2024-09-26 to 2024-10-07 (   8 days): DEGRADED             - std=0.0009, corr=+0.236, dir_acc=0.571
[ OK ] 2024-10-08 to 2024-10-18 (   8 days): HEALTHY              - std=0.0007, corr=+0.252, dir_acc=0.562
[DEGD] 2024-10-21 to 2024-11-04 (  11 days): DEGRADED             - std=0.0010, corr=+0.224, dir_acc=0.570
[WEAK] 2024-11-05 to 2025-04-04 ( 102 days): WEAK_COLLAPSE        - std=0.0035, corr=+0.093, dir_acc=0.553
[ OK ] 2025-04-09 to 2025-07-22 (  71 days): HEALTHY              - std=0.0180, corr=+0.144, dir_acc=0.573
[DEGD] 2025-07-23 to 2025-08-06 (  11 days): DEGRADED             - std=0.0008, corr=+0.161, dir_acc=0.612
[WEAK] 2025-08-07 to 2025-10-06 (  42 days): WEAK_COLLAPSE        - std=0.0048, corr=-0.013, dir_acc=0.565
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           202 days ( 15.8%)
  DEGRADED:           68 days (  5.3%)
  WEAK_COLLAPSE:     985 days ( 77.0%)
  STRONG_COLLAPSE:    25 days (  2.0%)

  Total problematic: 1078 days (84.2%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.223708
  RMSE:             1.106213
  MAE:              0.793116
  Out-of-sample RÂ²: -0.0399

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4743

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:02:02
======================================================================
  ✓ Success

Processing: 01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr5
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr5/checkpoints/tft-epoch=04-val_loss=0.1606.ckpt
  Validation loss: 0.160617

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr5/evaluation/evaluation_20251026_170204.log
Evaluation started at: 2025-10-26 17:02:04
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.153271
    Max: 0.250513
    Mean: 0.181241
    Std: 0.013976
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1533, max: 0.2505, mean: 0.1812
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   62 days (  4.8%)
2. Range-based                 [WARN]  956 days ( 74.7%)
3. Consecutive-similarity      [WARN]  965 days ( 75.4%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   204 days ( 15.9%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)         [ OK ]    88 days (  6.9%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0040, corr=+nan, dir_acc=nan
[DEGD] 2020-09-30 to 2020-10-23 (  17 days): DEGRADED             - std=0.0016, corr=-0.047, dir_acc=0.592
[ OK ] 2020-10-29 to 2021-02-03 (  65 days): HEALTHY              - std=0.0083, corr=+0.212, dir_acc=0.545
[DEGD] 2021-02-04 to 2021-02-19 (  11 days): DEGRADED             - std=0.0014, corr=+0.238, dir_acc=0.579
[DEGD] 2021-02-23 to 2021-04-21 (  41 days): DEGRADED             - std=0.0029, corr=+0.227, dir_acc=0.550
[WEAK] 2021-04-28 to 2021-09-15 (  98 days): WEAK_COLLAPSE        - std=0.0029, corr=+0.091, dir_acc=0.563
[WEAK] 2021-09-21 to 2021-10-15 (  18 days): WEAK_COLLAPSE        - std=0.0013, corr=+0.046, dir_acc=0.553
[FAIL] 2021-10-18 to 2021-10-28 (   9 days): STRONG_COLLAPSE      - std=0.0019, corr=+0.071, dir_acc=0.583
[FAIL] 2021-11-05 to 2021-11-23 (  12 days): STRONG_COLLAPSE      - std=0.0014, corr=+0.097, dir_acc=0.606
[WEAK] 2021-11-24 to 2022-01-26 (  43 days): WEAK_COLLAPSE        - std=0.0027, corr=+0.003, dir_acc=0.579
[DEGD] 2022-01-27 to 2022-02-07 (   8 days): DEGRADED             - std=0.0022, corr=+0.101, dir_acc=0.460
[DEGD] 2022-02-25 to 2022-04-12 (  33 days): DEGRADED             - std=0.0017, corr=+0.164, dir_acc=0.429
[WEAK] 2022-04-13 to 2023-10-20 ( 380 days): WEAK_COLLAPSE        - std=0.0075, corr=+0.144, dir_acc=0.475
[WEAK] 2023-10-24 to 2023-12-21 (  42 days): WEAK_COLLAPSE        - std=0.0047, corr=+0.027, dir_acc=0.527
[DEGD] 2023-12-22 to 2024-01-18 (  17 days): DEGRADED             - std=0.0006, corr=-0.038, dir_acc=0.616
[WEAK] 2024-01-19 to 2024-02-16 (  21 days): WEAK_COLLAPSE        - std=0.0006, corr=+0.155, dir_acc=0.654
[FAIL] 2024-02-20 to 2024-04-12 (  38 days): STRONG_COLLAPSE      - std=0.0016, corr=-0.073, dir_acc=0.589
[WEAK] 2024-04-15 to 2024-07-12 (  62 days): WEAK_COLLAPSE        - std=0.0059, corr=+0.009, dir_acc=0.539
[DEGD] 2024-07-15 to 2024-08-06 (  17 days): DEGRADED             - std=0.0073, corr=+0.146, dir_acc=0.639
[ OK ] 2024-08-07 to 2024-10-30 (  59 days): HEALTHY              - std=0.0059, corr=+0.212, dir_acc=0.590
[WEAK] 2024-11-05 to 2024-12-18 (  30 days): WEAK_COLLAPSE        - std=0.0021, corr=+0.059, dir_acc=0.581
[WEAK] 2024-12-23 to 2025-03-11 (  52 days): WEAK_COLLAPSE        - std=0.0023, corr=+0.179, dir_acc=0.549
[DEGD] 2025-03-12 to 2025-03-19 (   6 days): DEGRADED             - std=0.0028, corr=+0.139, dir_acc=0.497
[WEAK] 2025-03-20 to 2025-04-03 (  11 days): WEAK_COLLAPSE        - std=0.0010, corr=+0.107, dir_acc=0.526
[ OK ] 2025-04-09 to 2025-07-24 (  73 days): HEALTHY              - std=0.0225, corr=+0.138, dir_acc=0.574
[DEGD] 2025-07-25 to 2025-08-06 (   9 days): DEGRADED             - std=0.0003, corr=+0.194, dir_acc=0.607
[WEAK] 2025-08-07 to 2025-10-06 (  42 days): WEAK_COLLAPSE        - std=0.0045, corr=+0.021, dir_acc=0.565
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           232 days ( 18.1%)
  DEGRADED:          173 days ( 13.5%)
  WEAK_COLLAPSE:     813 days ( 63.5%)
  STRONG_COLLAPSE:    62 days (  4.8%)

  Total problematic: 1048 days (81.9%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.191905
  RMSE:             1.091744
  MAE:              0.778634
  Out-of-sample RÂ²: -0.0129

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4737

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.30_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:02:05
======================================================================
  ✓ Success

Processing: 01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr3
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr3/checkpoints/tft-epoch=06-val_loss=0.1620.ckpt
  Validation loss: 0.162025

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr3/evaluation/evaluation_20251026_170207.log
Evaluation started at: 2025-10-26 17:02:07
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.159282
    Max: 0.248428
    Mean: 0.187797
    Std: 0.013679
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1593, max: 0.2484, mean: 0.1878
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   59 days (  4.6%)
2. Range-based                 [WARN]  967 days ( 75.5%)
3. Consecutive-similarity      [WARN] 1016 days ( 79.4%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   265 days ( 20.7%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)         [ OK ]    86 days (  6.7%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0033, corr=+nan, dir_acc=nan
[WEAK] 2020-10-01 to 2020-10-28 (  19 days): WEAK_COLLAPSE        - std=0.0026, corr=-0.037, dir_acc=0.588
[ OK ] 2020-10-29 to 2021-02-03 (  65 days): HEALTHY              - std=0.0071, corr=+0.212, dir_acc=0.545
[WEAK] 2021-02-10 to 2021-03-01 (  13 days): WEAK_COLLAPSE        - std=0.0021, corr=+0.239, dir_acc=0.567
[DEGD] 2021-03-02 to 2021-04-23 (  38 days): DEGRADED             - std=0.0024, corr=+0.193, dir_acc=0.549
[WEAK] 2021-04-26 to 2021-10-18 ( 122 days): WEAK_COLLAPSE        - std=0.0034, corr=+0.054, dir_acc=0.562
[WEAK] 2021-10-22 to 2022-02-14 (  78 days): WEAK_COLLAPSE        - std=0.0057, corr=+0.015, dir_acc=0.567
[WEAK] 2022-02-16 to 2022-03-01 (   9 days): WEAK_COLLAPSE        - std=0.0029, corr=+0.124, dir_acc=0.446
[DEGD] 2022-03-02 to 2022-04-13 (  31 days): DEGRADED             - std=0.0016, corr=+0.175, dir_acc=0.428
[WEAK] 2022-04-14 to 2023-04-21 ( 254 days): WEAK_COLLAPSE        - std=0.0043, corr=+0.185, dir_acc=0.448
[DEGD] 2023-04-24 to 2023-06-20 (  40 days): DEGRADED             - std=0.0027, corr=+0.127, dir_acc=0.528
[WEAK] 2023-06-21 to 2024-02-26 ( 171 days): WEAK_COLLAPSE        - std=0.0036, corr=+0.050, dir_acc=0.554
[FAIL] 2024-02-27 to 2024-04-10 (  31 days): STRONG_COLLAPSE      - std=0.0010, corr=-0.145, dir_acc=0.585
[WEAK] 2024-04-11 to 2024-06-03 (  37 days): WEAK_COLLAPSE        - std=0.0011, corr=-0.086, dir_acc=0.514
[FAIL] 2024-06-04 to 2024-06-25 (  15 days): STRONG_COLLAPSE      - std=0.0018, corr=+0.227, dir_acc=0.553
[WEAK] 2024-06-26 to 2024-08-05 (  28 days): WEAK_COLLAPSE        - std=0.0029, corr=+0.109, dir_acc=0.625
[ OK ] 2024-08-20 to 2024-10-30 (  50 days): HEALTHY              - std=0.0024, corr=+0.173, dir_acc=0.586
[WEAK] 2024-11-05 to 2024-12-18 (  30 days): WEAK_COLLAPSE        - std=0.0010, corr=+0.031, dir_acc=0.581
[WEAK] 2024-12-20 to 2025-04-04 (  71 days): WEAK_COLLAPSE        - std=0.0033, corr=+0.086, dir_acc=0.541
[ OK ] 2025-04-09 to 2025-07-22 (  71 days): HEALTHY              - std=0.0200, corr=+0.141, dir_acc=0.573
[DEGD] 2025-07-23 to 2025-08-05 (  10 days): DEGRADED             - std=0.0002, corr=+0.151, dir_acc=0.613
[WEAK] 2025-08-06 to 2025-08-20 (  11 days): WEAK_COLLAPSE        - std=0.0005, corr=-0.023, dir_acc=0.573
[WEAK] 2025-08-25 to 2025-09-10 (  12 days): WEAK_COLLAPSE        - std=0.0001, corr=-0.101, dir_acc=0.554
[FAIL] 2025-09-11 to 2025-09-22 (   8 days): STRONG_COLLAPSE      - std=0.0007, corr=-0.081, dir_acc=0.575
[WEAK] 2025-09-23 to 2025-10-06 (  10 days): WEAK_COLLAPSE        - std=0.0016, corr=+0.000, dir_acc=0.568
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           219 days ( 17.1%)
  DEGRADED:          137 days ( 10.7%)
  WEAK_COLLAPSE:     865 days ( 67.6%)
  STRONG_COLLAPSE:    59 days (  4.6%)

  Total problematic: 1061 days (82.9%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.193701
  RMSE:             1.092566
  MAE:              0.779463
  Out-of-sample RÂ²: -0.0144

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4728

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:02:08
======================================================================
  ✓ Success

Processing: 01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr5
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr5/checkpoints/tft-epoch=04-val_loss=0.1633.ckpt
  Validation loss: 0.163338

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr5/evaluation/evaluation_20251026_170210.log
Evaluation started at: 2025-10-26 17:02:10
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.167534
    Max: 0.257809
    Mean: 0.195517
    Std: 0.013163
    Unique values: 1278

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.1675, max: 0.2578, mean: 0.1955
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]   28 days (  2.2%)
2. Range-based                 [WARN]  988 days ( 77.2%)
3. Consecutive-similarity      [WARN] 1022 days ( 79.8%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   262 days ( 20.5%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)         [ OK ]    97 days (  7.6%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0033, corr=+nan, dir_acc=nan
[WEAK] 2020-10-01 to 2020-10-28 (  19 days): WEAK_COLLAPSE        - std=0.0025, corr=-0.037, dir_acc=0.588
[ OK ] 2020-10-29 to 2021-02-03 (  65 days): HEALTHY              - std=0.0069, corr=+0.213, dir_acc=0.545
[WEAK] 2021-02-08 to 2021-03-03 (  17 days): WEAK_COLLAPSE        - std=0.0020, corr=+0.237, dir_acc=0.565
[DEGD] 2021-03-04 to 2021-04-19 (  32 days): DEGRADED             - std=0.0021, corr=+0.197, dir_acc=0.551
[WEAK] 2021-04-20 to 2021-10-18 ( 126 days): WEAK_COLLAPSE        - std=0.0037, corr=+0.043, dir_acc=0.561
[FAIL] 2021-10-19 to 2021-10-26 (   6 days): STRONG_COLLAPSE      - std=0.0018, corr=+0.000, dir_acc=0.581
[WEAK] 2021-10-27 to 2022-03-23 ( 101 days): WEAK_COLLAPSE        - std=0.0083, corr=+0.038, dir_acc=0.530
[DEGD] 2022-03-24 to 2022-04-08 (  12 days): DEGRADED             - std=0.0017, corr=+0.238, dir_acc=0.446
[WEAK] 2022-04-11 to 2023-04-24 ( 258 days): WEAK_COLLAPSE        - std=0.0040, corr=+0.181, dir_acc=0.449
[DEGD] 2023-04-25 to 2023-06-20 (  39 days): DEGRADED             - std=0.0026, corr=+0.127, dir_acc=0.528
[WEAK] 2023-06-21 to 2024-03-05 ( 177 days): WEAK_COLLAPSE        - std=0.0038, corr=+0.051, dir_acc=0.557
[FAIL] 2024-03-06 to 2024-04-05 (  22 days): STRONG_COLLAPSE      - std=0.0007, corr=-0.125, dir_acc=0.578
[WEAK] 2024-04-08 to 2024-08-05 (  83 days): WEAK_COLLAPSE        - std=0.0059, corr=+0.022, dir_acc=0.560
[ OK ] 2024-08-12 to 2024-10-30 (  56 days): HEALTHY              - std=0.0036, corr=+0.189, dir_acc=0.590
[WEAK] 2024-11-05 to 2025-04-04 ( 102 days): WEAK_COLLAPSE        - std=0.0035, corr=+0.099, dir_acc=0.553
[ OK ] 2025-04-09 to 2025-07-22 (  71 days): HEALTHY              - std=0.0201, corr=+0.143, dir_acc=0.573
[DEGD] 2025-07-23 to 2025-08-06 (  11 days): DEGRADED             - std=0.0003, corr=+0.175, dir_acc=0.612
[WEAK] 2025-08-07 to 2025-10-06 (  42 days): WEAK_COLLAPSE        - std=0.0045, corr=-0.013, dir_acc=0.565
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           221 days ( 17.3%)
  DEGRADED:          106 days (  8.3%)
  WEAK_COLLAPSE:     925 days ( 72.3%)
  STRONG_COLLAPSE:    28 days (  2.2%)

  Total problematic: 1059 days (82.7%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.195700
  RMSE:             1.093481
  MAE:              0.780391
  Out-of-sample RÂ²: -0.0161

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.4747

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h14_drop0.35_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:02:11
======================================================================
  ✓ Success

Processing: 01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr3
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr3/checkpoints/tft-epoch=01-val_loss=0.1297.ckpt
  Validation loss: 0.129664

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr3/evaluation/evaluation_20251026_170212.log
Evaluation started at: 2025-10-26 17:02:12
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.003992
    Max: 0.128361
    Mean: 0.082437
    Std: 0.024640
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0040, max: 0.1284, mean: 0.0824
Negative predictions: 4/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  549 days ( 42.9%)
3. Consecutive-similarity      [WARN]  432 days ( 33.8%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   993 days ( 77.6%)
  Directional acc < 52%                489 days ( 38.2%)
  Combined (BOTH poor)         [WARN]   361 days ( 28.2%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0022, corr=+nan, dir_acc=nan
[DEGD] 2020-09-30 to 2021-04-08 ( 129 days): DEGRADED             - std=0.0048, corr=-0.120, dir_acc=0.556
[ OK ] 2021-04-09 to 2021-04-27 (  13 days): HEALTHY              - std=0.0016, corr=+0.006, dir_acc=0.544
[WEAK] 2021-05-03 to 2021-05-11 (   7 days): WEAK_COLLAPSE        - std=0.0006, corr=+0.033, dir_acc=0.512
[DEGD] 2021-05-12 to 2021-05-19 (   6 days): DEGRADED             - std=0.0016, corr=-0.024, dir_acc=0.522
[WEAK] 2021-05-20 to 2021-12-03 ( 136 days): WEAK_COLLAPSE        - std=0.0054, corr=-0.145, dir_acc=0.575
[DEGD] 2021-12-06 to 2021-12-23 (  14 days): DEGRADED             - std=0.0054, corr=-0.023, dir_acc=0.606
[DEGD] 2021-12-28 to 2022-01-06 (   8 days): DEGRADED             - std=0.0014, corr=+0.028, dir_acc=0.608
[DEGD] 2022-02-01 to 2022-02-11 (   9 days): DEGRADED             - std=0.0027, corr=-0.039, dir_acc=0.459
[ OK ] 2022-02-17 to 2022-03-15 (  18 days): HEALTHY              - std=0.0030, corr=+0.053, dir_acc=0.424
[DEGD] 2022-03-16 to 2022-05-10 (  39 days): DEGRADED             - std=0.0039, corr=-0.153, dir_acc=0.444
[WEAK] 2022-05-11 to 2022-06-16 (  26 days): WEAK_COLLAPSE        - std=0.0013, corr=-0.194, dir_acc=0.468
[DEGD] 2022-06-17 to 2022-07-19 (  21 days): DEGRADED             - std=0.0014, corr=-0.139, dir_acc=0.452
[WEAK] 2022-07-20 to 2022-10-11 (  58 days): WEAK_COLLAPSE        - std=0.0050, corr=-0.148, dir_acc=0.460
[DEGD] 2022-10-12 to 2023-01-26 (  72 days): DEGRADED             - std=0.0161, corr=-0.173, dir_acc=0.405
[DEGD] 2023-01-30 to 2023-02-08 (   8 days): DEGRADED             - std=0.0009, corr=-0.040, dir_acc=0.456
[ OK ] 2023-02-09 to 2023-02-22 (   9 days): HEALTHY              - std=0.0027, corr=+0.037, dir_acc=0.444
[DEGD] 2023-02-23 to 2023-03-16 (  16 days): DEGRADED             - std=0.0034, corr=+0.055, dir_acc=0.460
[WEAK] 2023-03-17 to 2023-04-06 (  15 days): WEAK_COLLAPSE        - std=0.0051, corr=-0.035, dir_acc=0.511
[ OK ] 2023-04-11 to 2023-04-24 (  10 days): HEALTHY              - std=0.0045, corr=+0.031, dir_acc=0.522
[ OK ] 2023-05-05 to 2023-05-15 (   7 days): HEALTHY              - std=0.0007, corr=+0.009, dir_acc=0.500
[ OK ] 2023-05-25 to 2023-06-16 (  16 days): HEALTHY              - std=0.0013, corr=-0.063, dir_acc=0.552
[ OK ] 2023-06-21 to 2023-07-03 (   9 days): HEALTHY              - std=0.0016, corr=-0.075, dir_acc=0.537
[WEAK] 2023-07-11 to 2023-08-21 (  30 days): WEAK_COLLAPSE        - std=0.0036, corr=+0.044, dir_acc=0.563
[ OK ] 2023-08-23 to 2023-09-14 (  16 days): HEALTHY              - std=0.0015, corr=+0.051, dir_acc=0.521
[DEGD] 2023-09-15 to 2023-09-22 (   6 days): DEGRADED             - std=0.0028, corr=+0.088, dir_acc=0.511
[ OK ] 2023-09-25 to 2023-10-05 (   9 days): HEALTHY              - std=0.0019, corr=+0.062, dir_acc=0.496
[DEGD] 2023-10-06 to 2023-10-19 (   9 days): DEGRADED             - std=0.0034, corr=-0.077, dir_acc=0.474
[DEGD] 2023-11-01 to 2023-11-13 (   9 days): DEGRADED             - std=0.0003, corr=-0.116, dir_acc=0.491
[ OK ] 2023-11-14 to 2024-02-20 (  66 days): HEALTHY              - std=0.0073, corr=-0.144, dir_acc=0.606
[DEGD] 2024-02-23 to 2024-03-20 (  19 days): DEGRADED             - std=0.0019, corr=-0.029, dir_acc=0.609
[DEGD] 2024-03-25 to 2024-04-19 (  19 days): DEGRADED             - std=0.0028, corr=+0.137, dir_acc=0.547
[ OK ] 2024-04-22 to 2024-05-02 (   9 days): HEALTHY              - std=0.0021, corr=+0.120, dir_acc=0.502
[DEGD] 2024-05-03 to 2024-05-17 (  11 days): DEGRADED             - std=0.0008, corr=-0.047, dir_acc=0.511
[DEGD] 2024-05-22 to 2024-06-26 (  24 days): DEGRADED             - std=0.0031, corr=-0.176, dir_acc=0.542
[ OK ] 2024-06-27 to 2025-01-16 ( 138 days): HEALTHY              - std=0.0105, corr=-0.123, dir_acc=0.589
[DEGD] 2025-01-17 to 2025-03-28 (  49 days): DEGRADED             - std=0.0056, corr=-0.227, dir_acc=0.539
[ OK ] 2025-03-31 to 2025-04-08 (   7 days): HEALTHY              - std=0.0056, corr=-0.042, dir_acc=0.533
[DEGD] 2025-04-09 to 2025-04-17 (   7 days): DEGRADED             - std=0.0091, corr=-0.094, dir_acc=0.500
[DEGD] 2025-04-22 to 2025-04-29 (   6 days): DEGRADED             - std=0.0033, corr=-0.137, dir_acc=0.494
[DEGD] 2025-05-01 to 2025-05-15 (  11 days): DEGRADED             - std=0.0123, corr=-0.200, dir_acc=0.506
[ OK ] 2025-05-16 to 2025-08-18 (  64 days): HEALTHY              - std=0.0074, corr=-0.159, dir_acc=0.577
[ OK ] 2025-08-28 to 2025-09-17 (  14 days): HEALTHY              - std=0.0003, corr=-0.160, dir_acc=0.560
[DEGD] 2025-09-24 to 2025-10-06 (   9 days): DEGRADED             - std=0.0027, corr=-0.078, dir_acc=0.569
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           461 days ( 36.0%)
  DEGRADED:          537 days ( 42.0%)
  WEAK_COLLAPSE:     282 days ( 22.0%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic:  819 days (64.0%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.178543
  RMSE:             1.085607
  MAE:              0.772332
  Out-of-sample RÂ²: -0.0015

FINANCIAL METRICS:
  Directional Acc:  53.52%
  Sharpe Ratio:     0.7986
  Total Return:     86.29%
  Max Drawdown:     -25.25%
  Hit Rate:         53.44%
  Number of Trades: 1276

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5361
  Recall:           0.9956
  F1 Score:         0.6969
  AUC-ROC:          0.5221

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          1             592
  Actual Up:            3             684

ALPHA (vs Buy-and-Hold):
  Excess Return:    -5.87%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:02:14
======================================================================
  ✓ Success

Processing: 01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr5
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr5/checkpoints/tft-epoch=01-val_loss=0.1464.ckpt
  Validation loss: 0.146359

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr5/evaluation/evaluation_20251026_170215.log
Evaluation started at: 2025-10-26 17:02:15
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.040311
    Max: 0.125946
    Mean: 0.092592
    Std: 0.016964
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0403, max: 0.1259, mean: 0.0926
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  719 days ( 56.2%)
3. Consecutive-similarity      [WARN]  742 days ( 58.0%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   970 days ( 75.8%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)         [WARN]   344 days ( 26.9%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0017, corr=+nan, dir_acc=nan
[WEAK] 2020-10-02 to 2021-02-02 (  82 days): WEAK_COLLAPSE        - std=0.0026, corr=-0.080, dir_acc=0.553
[WEAK] 2021-02-04 to 2021-03-02 (  18 days): WEAK_COLLAPSE        - std=0.0018, corr=-0.108, dir_acc=0.568
[DEGD] 2021-03-03 to 2021-04-21 (  35 days): DEGRADED             - std=0.0035, corr=-0.067, dir_acc=0.550
[WEAK] 2021-04-22 to 2021-12-14 ( 163 days): WEAK_COLLAPSE        - std=0.0060, corr=-0.114, dir_acc=0.570
[DEGD] 2021-12-15 to 2022-03-10 (  59 days): DEGRADED             - std=0.0060, corr=+0.036, dir_acc=0.509
[DEGD] 2022-03-14 to 2022-04-28 (  33 days): DEGRADED             - std=0.0028, corr=-0.118, dir_acc=0.440
[WEAK] 2022-04-29 to 2022-10-20 ( 120 days): WEAK_COLLAPSE        - std=0.0040, corr=-0.164, dir_acc=0.456
[DEGD] 2022-10-21 to 2023-03-06 (  91 days): DEGRADED             - std=0.0125, corr=-0.120, dir_acc=0.417
[WEAK] 2023-03-07 to 2023-04-18 (  30 days): WEAK_COLLAPSE        - std=0.0060, corr=+0.009, dir_acc=0.503
[DEGD] 2023-04-19 to 2023-05-24 (  26 days): DEGRADED             - std=0.0026, corr=+0.010, dir_acc=0.511
[DEGD] 2023-05-26 to 2023-06-27 (  21 days): DEGRADED             - std=0.0013, corr=-0.067, dir_acc=0.552
[WEAK] 2023-06-28 to 2023-08-21 (  38 days): WEAK_COLLAPSE        - std=0.0033, corr=+0.061, dir_acc=0.555
[DEGD] 2023-08-22 to 2023-09-11 (  14 days): DEGRADED             - std=0.0017, corr=+0.060, dir_acc=0.526
[DEGD] 2023-09-15 to 2023-10-19 (  24 days): DEGRADED             - std=0.0034, corr=+0.019, dir_acc=0.492
[DEGD] 2023-11-01 to 2023-11-13 (   9 days): DEGRADED             - std=0.0001, corr=-0.099, dir_acc=0.491
[ OK ] 2023-11-14 to 2024-01-19 (  45 days): HEALTHY              - std=0.0064, corr=-0.132, dir_acc=0.584
[ OK ] 2024-01-24 to 2024-02-20 (  19 days): HEALTHY              - std=0.0021, corr=-0.156, dir_acc=0.652
[DEGD] 2024-02-26 to 2024-03-20 (  18 days): DEGRADED             - std=0.0016, corr=-0.029, dir_acc=0.607
[DEGD] 2024-03-27 to 2024-04-18 (  16 days): DEGRADED             - std=0.0021, corr=+0.133, dir_acc=0.552
[DEGD] 2024-04-23 to 2024-05-17 (  19 days): DEGRADED             - std=0.0012, corr=+0.007, dir_acc=0.508
[DEGD] 2024-05-23 to 2024-06-18 (  18 days): DEGRADED             - std=0.0013, corr=-0.166, dir_acc=0.538
[ OK ] 2024-07-03 to 2024-07-17 (  10 days): HEALTHY              - std=0.0018, corr=-0.037, dir_acc=0.638
[ OK ] 2024-07-24 to 2024-08-16 (  18 days): HEALTHY              - std=0.0054, corr=-0.171, dir_acc=0.615
[DEGD] 2024-08-22 to 2024-10-21 (  41 days): DEGRADED             - std=0.0035, corr=-0.205, dir_acc=0.587
[ OK ] 2024-10-22 to 2025-01-10 (  54 days): HEALTHY              - std=0.0026, corr=-0.044, dir_acc=0.569
[DEGD] 2025-01-13 to 2025-03-28 (  53 days): DEGRADED             - std=0.0038, corr=-0.206, dir_acc=0.540
[ OK ] 2025-03-31 to 2025-04-08 (   7 days): HEALTHY              - std=0.0036, corr=-0.059, dir_acc=0.533
[DEGD] 2025-04-09 to 2025-04-17 (   7 days): DEGRADED             - std=0.0048, corr=-0.097, dir_acc=0.500
[ OK ] 2025-04-29 to 2025-08-18 (  77 days): HEALTHY              - std=0.0129, corr=-0.174, dir_acc=0.590
[DEGD] 2025-08-22 to 2025-09-17 (  18 days): DEGRADED             - std=0.0021, corr=-0.195, dir_acc=0.560
[WEAK] 2025-09-18 to 2025-09-29 (   8 days): WEAK_COLLAPSE        - std=0.0027, corr=-0.143, dir_acc=0.562
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           270 days ( 21.1%)
  DEGRADED:          529 days ( 41.3%)
  WEAK_COLLAPSE:     481 days ( 37.6%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1010 days (78.9%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.178450
  RMSE:             1.085564
  MAE:              0.772292
  Out-of-sample RÂ²: -0.0014

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5242

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.15_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:02:16
======================================================================
  ✓ Success

Processing: 01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr3
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr3/checkpoints/tft-epoch=01-val_loss=0.1304.ckpt
  Validation loss: 0.130372

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr3/evaluation/evaluation_20251026_170218.log
Evaluation started at: 2025-10-26 17:02:18
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.012220
    Max: 0.124330
    Mean: 0.077817
    Std: 0.025158
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0122, max: 0.1243, mean: 0.0778
Negative predictions: 13/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  548 days ( 42.8%)
3. Consecutive-similarity      [WARN]  437 days ( 34.1%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   998 days ( 78.0%)
  Directional acc < 52%                534 days ( 41.7%)
  Combined (BOTH poor)         [WARN]   408 days ( 31.9%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0022, corr=+nan, dir_acc=nan
[DEGD] 2020-09-30 to 2021-04-07 ( 128 days): DEGRADED             - std=0.0048, corr=-0.123, dir_acc=0.556
[ OK ] 2021-04-08 to 2021-04-27 (  14 days): HEALTHY              - std=0.0015, corr=+0.004, dir_acc=0.544
[DEGD] 2021-05-11 to 2021-05-19 (   7 days): DEGRADED             - std=0.0016, corr=-0.020, dir_acc=0.519
[WEAK] 2021-05-26 to 2021-12-06 ( 133 days): WEAK_COLLAPSE        - std=0.0052, corr=-0.156, dir_acc=0.577
[DEGD] 2021-12-07 to 2022-01-18 (  29 days): DEGRADED             - std=0.0037, corr=+0.007, dir_acc=0.597
[DEGD] 2022-02-01 to 2022-02-11 (   9 days): DEGRADED             - std=0.0027, corr=-0.039, dir_acc=0.459
[ OK ] 2022-02-17 to 2022-03-15 (  18 days): HEALTHY              - std=0.0031, corr=+0.054, dir_acc=0.424
[DEGD] 2022-03-16 to 2022-05-10 (  39 days): DEGRADED             - std=0.0038, corr=-0.151, dir_acc=0.444
[WEAK] 2022-05-11 to 2022-06-15 (  25 days): WEAK_COLLAPSE        - std=0.0012, corr=-0.193, dir_acc=0.469
[DEGD] 2022-06-16 to 2022-07-19 (  22 days): DEGRADED             - std=0.0015, corr=-0.135, dir_acc=0.452
[WEAK] 2022-07-20 to 2022-10-11 (  58 days): WEAK_COLLAPSE        - std=0.0051, corr=-0.149, dir_acc=0.460
[DEGD] 2022-10-12 to 2023-01-26 (  72 days): DEGRADED             - std=0.0162, corr=-0.173, dir_acc=0.405
[DEGD] 2023-01-30 to 2023-02-08 (   8 days): DEGRADED             - std=0.0009, corr=-0.041, dir_acc=0.456
[ OK ] 2023-02-09 to 2023-02-22 (   9 days): HEALTHY              - std=0.0027, corr=+0.037, dir_acc=0.444
[DEGD] 2023-02-23 to 2023-03-16 (  16 days): DEGRADED             - std=0.0035, corr=+0.056, dir_acc=0.460
[WEAK] 2023-03-17 to 2023-04-06 (  15 days): WEAK_COLLAPSE        - std=0.0051, corr=-0.034, dir_acc=0.511
[ OK ] 2023-04-11 to 2023-04-24 (  10 days): HEALTHY              - std=0.0044, corr=+0.029, dir_acc=0.522
[ OK ] 2023-05-25 to 2023-06-16 (  16 days): HEALTHY              - std=0.0014, corr=-0.066, dir_acc=0.552
[ OK ] 2023-06-23 to 2023-07-03 (   7 days): HEALTHY              - std=0.0016, corr=-0.059, dir_acc=0.533
[WEAK] 2023-07-06 to 2023-08-21 (  33 days): WEAK_COLLAPSE        - std=0.0037, corr=+0.033, dir_acc=0.559
[ OK ] 2023-08-23 to 2023-09-14 (  16 days): HEALTHY              - std=0.0015, corr=+0.052, dir_acc=0.521
[DEGD] 2023-09-15 to 2023-09-22 (   6 days): DEGRADED             - std=0.0028, corr=+0.088, dir_acc=0.511
[ OK ] 2023-09-25 to 2023-10-05 (   9 days): HEALTHY              - std=0.0019, corr=+0.062, dir_acc=0.496
[DEGD] 2023-10-06 to 2023-10-19 (   9 days): DEGRADED             - std=0.0034, corr=-0.077, dir_acc=0.474
[DEGD] 2023-11-01 to 2023-11-13 (   9 days): DEGRADED             - std=0.0003, corr=-0.117, dir_acc=0.491
[ OK ] 2023-11-14 to 2024-02-20 (  66 days): HEALTHY              - std=0.0072, corr=-0.144, dir_acc=0.606
[DEGD] 2024-02-23 to 2024-03-20 (  19 days): DEGRADED             - std=0.0019, corr=-0.028, dir_acc=0.609
[DEGD] 2024-03-25 to 2024-04-18 (  18 days): DEGRADED             - std=0.0024, corr=+0.130, dir_acc=0.551
[ OK ] 2024-04-22 to 2024-05-02 (   9 days): HEALTHY              - std=0.0021, corr=+0.121, dir_acc=0.502
[DEGD] 2024-05-03 to 2024-05-17 (  11 days): DEGRADED             - std=0.0008, corr=-0.046, dir_acc=0.511
[DEGD] 2024-05-22 to 2024-06-18 (  19 days): DEGRADED             - std=0.0019, corr=-0.166, dir_acc=0.537
[ OK ] 2024-06-27 to 2025-01-16 ( 138 days): HEALTHY              - std=0.0107, corr=-0.124, dir_acc=0.589
[DEGD] 2025-01-17 to 2025-03-28 (  49 days): DEGRADED             - std=0.0057, corr=-0.227, dir_acc=0.539
[ OK ] 2025-03-31 to 2025-04-08 (   7 days): HEALTHY              - std=0.0058, corr=-0.039, dir_acc=0.533
[DEGD] 2025-04-09 to 2025-04-17 (   7 days): DEGRADED             - std=0.0093, corr=-0.094, dir_acc=0.500
[DEGD] 2025-04-22 to 2025-07-21 (  62 days): DEGRADED             - std=0.0284, corr=-0.177, dir_acc=0.443
[ OK ] 2025-07-22 to 2025-08-18 (  20 days): HEALTHY              - std=0.0017, corr=-0.119, dir_acc=0.576
[ OK ] 2025-08-28 to 2025-09-17 (  14 days): HEALTHY              - std=0.0003, corr=-0.159, dir_acc=0.560
[DEGD] 2025-09-24 to 2025-10-06 (   9 days): DEGRADED             - std=0.0027, corr=-0.075, dir_acc=0.569
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           410 days ( 32.0%)
  DEGRADED:          586 days ( 45.8%)
  WEAK_COLLAPSE:     284 days ( 22.2%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic:  870 days (68.0%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.178474
  RMSE:             1.085575
  MAE:              0.772343
  Out-of-sample RÂ²: -0.0015

FINANCIAL METRICS:
  Directional Acc:  52.97%
  Sharpe Ratio:     0.7292
  Total Return:     75.00%
  Max Drawdown:     -25.25%
  Hit Rate:         52.81%
  Number of Trades: 1267

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5335
  Recall:           0.9840
  F1 Score:         0.6919
  AUC-ROC:          0.5209

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          2             591
  Actual Up:           11             676

ALPHA (vs Buy-and-Hold):
  Excess Return:    -17.16%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:02:19
======================================================================
  ✓ Success

Processing: 01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr5
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr5
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr5/checkpoints/tft-epoch=01-val_loss=0.1479.ckpt
  Validation loss: 0.147934

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr5/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr5/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr5/evaluation/evaluation_20251026_170221.log
Evaluation started at: 2025-10-26 17:02:21
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: 0.029642
    Max: 0.120058
    Mean: 0.086199
    Std: 0.017458
    Unique values: 1279

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: 0.0296, max: 0.1201, mean: 0.0862
Negative predictions: 0/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    0 days (  0.0%)
2. Range-based                 [WARN]  718 days ( 56.1%)
3. Consecutive-similarity      [WARN]  753 days ( 58.8%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                   975 days ( 76.2%)
  Directional acc < 52%                477 days ( 37.3%)
  Combined (BOTH poor)         [WARN]   345 days ( 27.0%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0017, corr=+nan, dir_acc=nan
[WEAK] 2020-10-02 to 2020-11-06 (  25 days): WEAK_COLLAPSE        - std=0.0028, corr=+0.104, dir_acc=0.580
[WEAK] 2020-11-10 to 2021-02-02 (  56 days): WEAK_COLLAPSE        - std=0.0023, corr=-0.174, dir_acc=0.541
[WEAK] 2021-02-08 to 2021-03-01 (  15 days): WEAK_COLLAPSE        - std=0.0019, corr=-0.118, dir_acc=0.569
[DEGD] 2021-03-02 to 2021-04-21 (  36 days): DEGRADED             - std=0.0036, corr=-0.081, dir_acc=0.549
[WEAK] 2021-04-22 to 2021-12-14 ( 163 days): WEAK_COLLAPSE        - std=0.0056, corr=-0.124, dir_acc=0.570
[DEGD] 2021-12-15 to 2022-04-29 (  94 days): DEGRADED             - std=0.0078, corr=-0.019, dir_acc=0.483
[WEAK] 2022-05-02 to 2022-10-19 ( 118 days): WEAK_COLLAPSE        - std=0.0039, corr=-0.161, dir_acc=0.457
[DEGD] 2022-10-20 to 2023-03-06 (  92 days): DEGRADED             - std=0.0126, corr=-0.120, dir_acc=0.417
[WEAK] 2023-03-07 to 2023-04-19 (  31 days): WEAK_COLLAPSE        - std=0.0062, corr=+0.012, dir_acc=0.504
[DEGD] 2023-04-20 to 2023-06-26 (  46 days): DEGRADED             - std=0.0028, corr=-0.029, dir_acc=0.529
[WEAK] 2023-06-27 to 2023-08-21 (  39 days): WEAK_COLLAPSE        - std=0.0033, corr=+0.052, dir_acc=0.555
[DEGD] 2023-08-22 to 2023-10-19 (  41 days): DEGRADED             - std=0.0029, corr=+0.035, dir_acc=0.504
[DEGD] 2023-11-01 to 2023-11-13 (   9 days): DEGRADED             - std=0.0001, corr=-0.102, dir_acc=0.491
[ OK ] 2023-11-14 to 2024-01-19 (  45 days): HEALTHY              - std=0.0063, corr=-0.135, dir_acc=0.584
[ OK ] 2024-01-25 to 2024-02-20 (  18 days): HEALTHY              - std=0.0018, corr=-0.151, dir_acc=0.650
[DEGD] 2024-02-26 to 2024-03-19 (  17 days): DEGRADED             - std=0.0015, corr=-0.028, dir_acc=0.609
[WEAK] 2024-03-20 to 2024-04-05 (  12 days): WEAK_COLLAPSE        - std=0.0023, corr=+0.043, dir_acc=0.562
[DEGD] 2024-04-08 to 2024-04-18 (   9 days): DEGRADED             - std=0.0016, corr=+0.172, dir_acc=0.544
[DEGD] 2024-04-23 to 2024-05-16 (  18 days): DEGRADED             - std=0.0013, corr=+0.021, dir_acc=0.507
[DEGD] 2024-05-23 to 2024-06-17 (  17 days): DEGRADED             - std=0.0013, corr=-0.161, dir_acc=0.536
[WEAK] 2024-06-18 to 2024-06-26 (   6 days): WEAK_COLLAPSE        - std=0.0031, corr=-0.207, dir_acc=0.561
[ OK ] 2024-07-03 to 2024-07-17 (  10 days): HEALTHY              - std=0.0019, corr=-0.032, dir_acc=0.638
[ OK ] 2024-07-24 to 2024-08-16 (  18 days): HEALTHY              - std=0.0058, corr=-0.177, dir_acc=0.615
[DEGD] 2024-08-22 to 2024-10-21 (  41 days): DEGRADED             - std=0.0035, corr=-0.213, dir_acc=0.587
[ OK ] 2024-10-22 to 2025-01-10 (  54 days): HEALTHY              - std=0.0026, corr=-0.044, dir_acc=0.569
[DEGD] 2025-01-13 to 2025-03-28 (  53 days): DEGRADED             - std=0.0039, corr=-0.204, dir_acc=0.540
[ OK ] 2025-03-31 to 2025-04-08 (   7 days): HEALTHY              - std=0.0040, corr=-0.054, dir_acc=0.533
[DEGD] 2025-04-09 to 2025-04-17 (   7 days): DEGRADED             - std=0.0052, corr=-0.099, dir_acc=0.500
[ OK ] 2025-04-29 to 2025-08-18 (  77 days): HEALTHY              - std=0.0140, corr=-0.172, dir_acc=0.590
[DEGD] 2025-08-22 to 2025-09-17 (  18 days): DEGRADED             - std=0.0021, corr=-0.190, dir_acc=0.560
[WEAK] 2025-09-18 to 2025-09-29 (   8 days): WEAK_COLLAPSE        - std=0.0028, corr=-0.141, dir_acc=0.562
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           265 days ( 20.7%)
  DEGRADED:          530 days ( 41.4%)
  WEAK_COLLAPSE:     485 days ( 37.9%)
  STRONG_COLLAPSE:     0 days (  0.0%)

  Total problematic: 1015 days (79.3%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr5/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.178185
  RMSE:             1.085443
  MAE:              0.772264
  Out-of-sample RÂ²: -0.0012

FINANCIAL METRICS:
  Directional Acc:  53.67%
  Sharpe Ratio:     0.8330
  Total Return:     92.16%
  Max Drawdown:     -25.25%
  Hit Rate:         53.67%
  Number of Trades: 1280

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5367
  Recall:           1.0000
  F1 Score:         0.6985
  AUC-ROC:          0.5222

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          0             593
  Actual Up:            0             687

ALPHA (vs Buy-and-Hold):
  Excess Return:    0.00%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.20_lr5/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:02:22
======================================================================
  ✓ Success

Processing: 01_staleness_features_fixed/sweep_stale_h16_drop0.25_lr3
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:691: RuntimeWarning: Mean of empty slice
  avg_corr = np.nanmean(period_corr)
/Users/samufrank/dev/school/EEE598DL/final/sp500-tft-forecasting/train/evaluate_tft.py:692: RuntimeWarning: Mean of empty slice
  avg_dir_acc = np.nanmean(period_dir_acc)
======================================================================
Evaluating TFT: 01_staleness_features_fixed/sweep_stale_h16_drop0.25_lr3
======================================================================
Note: Corrected checkpoint path to include phase directory

Using best checkpoint from training:
  experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.25_lr3/checkpoints/tft-epoch=01-val_loss=0.1392.ckpt
  Validation loss: 0.139167

Loading configuration...
Loading config from: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.25_lr3/config.json
Output directory: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.25_lr3/evaluation
Logging to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.25_lr3/evaluation/evaluation_20251026_170223.log
Evaluation started at: 2025-10-26 17:02:23
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Detected staleness features in config, adding to data...
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1281 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1280, Total actuals: 1280

Prediction Generation Summary:
  Total predictions: 1280
  Test dataset size: 1280
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.026538
    Max: 0.117295
    Mean: 0.071116
    Std: 0.025664
    Unique values: 1280

WARNING: Predictions (1280) < Test samples (1300)
Date range: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1280 samples)
Computing metrics...
Predictions - min: -0.0265, max: 0.1173, mean: 0.0711
Negative predictions: 17/1280
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [ OK ]    3 days (  0.2%)
2. Range-based                 [WARN]  541 days ( 42.3%)
3. Consecutive-similarity      [WARN]  403 days ( 31.5%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.05                  1003 days ( 78.4%)
  Directional acc < 52%                534 days ( 41.7%)
  Combined (BOTH poor)         [WARN]   409 days ( 32.0%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-08-19 to 2020-09-29 (  29 days): HEALTHY              - std=0.0024, corr=+nan, dir_acc=nan
[DEGD] 2020-09-30 to 2021-04-05 ( 126 days): DEGRADED             - std=0.0047, corr=-0.122, dir_acc=0.556
[ OK ] 2021-04-06 to 2021-04-28 (  17 days): HEALTHY              - std=0.0015, corr=-0.001, dir_acc=0.542
[DEGD] 2021-04-29 to 2021-05-20 (  16 days): DEGRADED             - std=0.0012, corr=+0.002, dir_acc=0.518
[WEAK] 2021-05-26 to 2021-09-20 (  81 days): WEAK_COLLAPSE        - std=0.0019, corr=-0.161, dir_acc=0.575
[WEAK] 2021-09-29 to 2021-12-06 (  46 days): WEAK_COLLAPSE        - std=0.0042, corr=-0.209, dir_acc=0.583
[DEGD] 2021-12-07 to 2022-01-18 (  29 days): DEGRADED             - std=0.0036, corr=+0.004, dir_acc=0.597
[DEGD] 2022-02-01 to 2022-02-11 (   9 days): DEGRADED             - std=0.0028, corr=-0.041, dir_acc=0.459
[ OK ] 2022-02-17 to 2022-03-15 (  18 days): HEALTHY              - std=0.0032, corr=+0.054, dir_acc=0.424
[DEGD] 2022-03-16 to 2022-05-10 (  39 days): DEGRADED             - std=0.0038, corr=-0.149, dir_acc=0.444
[WEAK] 2022-05-11 to 2022-06-15 (  25 days): WEAK_COLLAPSE        - std=0.0013, corr=-0.188, dir_acc=0.469
[DEGD] 2022-06-16 to 2022-07-21 (  24 days): DEGRADED             - std=0.0016, corr=-0.136, dir_acc=0.454
[WEAK] 2022-07-22 to 2022-10-11 (  56 days): WEAK_COLLAPSE        - std=0.0050, corr=-0.151, dir_acc=0.459
[DEGD] 2022-10-12 to 2023-01-26 (  72 days): DEGRADED             - std=0.0166, corr=-0.172, dir_acc=0.405
[DEGD] 2023-01-30 to 2023-02-08 (   8 days): DEGRADED             - std=0.0009, corr=-0.041, dir_acc=0.456
[ OK ] 2023-02-09 to 2023-02-23 (  10 days): HEALTHY              - std=0.0030, corr=+0.039, dir_acc=0.443
[DEGD] 2023-03-01 to 2023-03-16 (  12 days): DEGRADED             - std=0.0030, corr=+0.060, dir_acc=0.468
[WEAK] 2023-03-17 to 2023-04-05 (  14 days): WEAK_COLLAPSE        - std=0.0046, corr=-0.036, dir_acc=0.510
[ OK ] 2023-04-11 to 2023-04-24 (  10 days): HEALTHY              - std=0.0043, corr=+0.026, dir_acc=0.522
[ OK ] 2023-05-25 to 2023-06-16 (  16 days): HEALTHY              - std=0.0015, corr=-0.067, dir_acc=0.552
[WEAK] 2023-07-06 to 2023-08-21 (  33 days): WEAK_COLLAPSE        - std=0.0037, corr=+0.034, dir_acc=0.559
[ OK ] 2023-08-23 to 2023-09-14 (  16 days): HEALTHY              - std=0.0014, corr=+0.055, dir_acc=0.521
[DEGD] 2023-09-15 to 2023-09-22 (   6 days): DEGRADED             - std=0.0029, corr=+0.088, dir_acc=0.511
[ OK ] 2023-09-25 to 2023-10-05 (   9 days): HEALTHY              - std=0.0019, corr=+0.060, dir_acc=0.496
[DEGD] 2023-10-06 to 2023-10-19 (   9 days): DEGRADED             - std=0.0034, corr=-0.079, dir_acc=0.474
[DEGD] 2023-11-01 to 2023-11-13 (   9 days): DEGRADED             - std=0.0004, corr=-0.119, dir_acc=0.491
[ OK ] 2023-11-14 to 2024-02-20 (  66 days): HEALTHY              - std=0.0071, corr=-0.144, dir_acc=0.606
[DEGD] 2024-02-23 to 2024-03-20 (  19 days): DEGRADED             - std=0.0019, corr=-0.026, dir_acc=0.609
[DEGD] 2024-03-25 to 2024-04-18 (  18 days): DEGRADED             - std=0.0024, corr=+0.133, dir_acc=0.551
[ OK ] 2024-04-22 to 2024-05-02 (   9 days): HEALTHY              - std=0.0021, corr=+0.118, dir_acc=0.502
[DEGD] 2024-05-03 to 2024-05-17 (  11 days): DEGRADED             - std=0.0008, corr=-0.047, dir_acc=0.511
[DEGD] 2024-05-22 to 2024-06-25 (  23 days): DEGRADED             - std=0.0026, corr=-0.176, dir_acc=0.541
[ OK ] 2024-06-26 to 2025-01-16 ( 139 days): HEALTHY              - std=0.0108, corr=-0.126, dir_acc=0.589
[DEGD] 2025-01-17 to 2025-03-28 (  49 days): DEGRADED             - std=0.0061, corr=-0.227, dir_acc=0.539
[ OK ] 2025-03-31 to 2025-04-08 (   7 days): HEALTHY              - std=0.0063, corr=-0.032, dir_acc=0.533
[DEGD] 2025-04-09 to 2025-04-17 (   7 days): DEGRADED             - std=0.0102, corr=-0.092, dir_acc=0.498
[DEGD] 2025-04-22 to 2025-07-21 (  62 days): DEGRADED             - std=0.0313, corr=-0.176, dir_acc=0.444
[ OK ] 2025-07-22 to 2025-08-20 (  22 days): HEALTHY              - std=0.0019, corr=-0.123, dir_acc=0.574
[ OK ] 2025-08-28 to 2025-09-17 (  14 days): HEALTHY              - std=0.0004, corr=-0.161, dir_acc=0.560
[DEGD] 2025-09-24 to 2025-10-06 (   9 days): DEGRADED             - std=0.0028, corr=-0.077, dir_acc=0.569
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           416 days ( 32.5%)
  DEGRADED:          591 days ( 46.2%)
  WEAK_COLLAPSE:     270 days ( 21.1%)
  STRONG_COLLAPSE:     3 days (  0.2%)

  Total problematic:  864 days (67.5%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Quality diagnostic plots saved to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.25_lr3/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.178447
  RMSE:             1.085563
  MAE:              0.772411
  Out-of-sample RÂ²: -0.0014

FINANCIAL METRICS:
  Directional Acc:  52.97%
  Sharpe Ratio:     0.7220
  Total Return:     73.47%
  Max Drawdown:     -25.25%
  Hit Rate:         52.66%
  Number of Trades: 1263

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5337
  Recall:           0.9811
  F1 Score:         0.6913
  AUC-ROC:          0.5201

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:          4             589
  Actual Up:           13             674

ALPHA (vs Buy-and-Hold):
  Excess Return:    -18.69%

======================================================================

Results saved to: experiments/01_staleness_features_fixed/sweep_stale_h16_drop0.25_lr3/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-26 17:02:25
======================================================================
