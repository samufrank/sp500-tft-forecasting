Logging to: experiments/00_baseline_exploration/sweep2_h16_enc_40/evaluation/evaluation_20251030_031454.log
Evaluation started at: 2025-10-30 03:14:54
======================================================================
Loading test data...
Loading data from:
  Test:  data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train: data/splits/fixed/core_proposal_daily_fixed_train.csv
Test samples: 1300
Preparing test dataset...
Expected test predictions: 1261 (test samples - encoder length + 1)
Loading model from checkpoint...
Generating predictions...
Total predictions: 1260, Total actuals: 1260

Prediction Generation Summary:
  Total predictions: 1260
  Test dataset size: 1260
  Test dataloader batches: 10
  Prediction statistics:
    Min: -0.043660
    Max: 0.226324
    Mean: 0.048515
    Std: 0.035650
    Unique values: 1259

WARNING: Predictions (1260) < Test samples (1300)
Date range: 2020-09-17T00:00:00.000000000 to 2025-10-06T00:00:00.000000000

Prediction period: 2020-09-17T00:00:00.000000000 to 2025-10-06T00:00:00.000000000 (1260 samples)
Computing metrics...
Predictions - min: -0.0437, max: 0.2263, mean: 0.0485
Negative predictions: 46/1260
Analyzing prediction behavior for collapse...

======================================================================
TEMPORAL QUALITY ANALYSIS (4-Mode Detection)
======================================================================

Structural Detection Methods:
----------------------------------------------------------------------
1. Variance-based              [WARN]  208 days ( 16.5%)
2. Range-based                 [ OK ]   35 days (  2.8%)
3. Consecutive-similarity      [ OK ]   32 days (  2.5%)

Quality Metrics:
----------------------------------------------------------------------
  Correlation < 0.0                    204 days ( 16.2%)
  Directional acc < 52%                476 days ( 37.8%)
  Combined (BOTH poor)                  60 days (  4.8%)
  Unidirectional (>98%)        [WARN]   934 days ( 74.1%)

----------------------------------------------------------------------
Temporal Summary:
----------------------------------------------------------------------
[ OK ] 2020-09-17 to 2020-10-29 (  30 days): HEALTHY              - std=0.0231, corr=+0.000, dir_acc=0.500
[UNI ] 2020-10-30 to 2022-03-18 ( 345 days): UNIDIRECTIONAL       - std=0.0387, corr=+0.173, dir_acc=0.551
[ OK ] 2022-03-21 to 2022-09-14 ( 123 days): HEALTHY              - std=0.0548, corr=+0.092, dir_acc=0.458
[DEGD] 2022-09-15 to 2022-10-14 (  21 days): DEGRADED             - std=0.0362, corr=-0.088, dir_acc=0.445
[ OK ] 2022-10-17 to 2023-03-01 (  92 days): HEALTHY              - std=0.0241, corr=+0.126, dir_acc=0.414
[UNI ] 2023-03-02 to 2024-02-01 ( 231 days): UNIDIRECTIONAL       - std=0.0207, corr=+0.085, dir_acc=0.536
[WEAK] 2024-02-02 to 2024-02-21 (  13 days): WEAK_COLLAPSE        - std=0.0021, corr=+0.005, dir_acc=0.637
[FAIL] 2024-02-27 to 2024-03-21 (  18 days): STRONG_COLLAPSE      - std=0.0010, corr=+0.159, dir_acc=0.606
[WEAK] 2024-03-22 to 2024-04-15 (  16 days): WEAK_COLLAPSE        - std=0.0058, corr=+0.238, dir_acc=0.558
[UNI ] 2024-04-16 to 2025-05-13 ( 268 days): UNIDIRECTIONAL       - std=0.0322, corr=+0.064, dir_acc=0.560
[ OK ] 2025-05-14 to 2025-08-08 (  60 days): HEALTHY              - std=0.0172, corr=+0.056, dir_acc=0.553
[UNI ] 2025-08-11 to 2025-10-06 (  40 days): UNIDIRECTIONAL       - std=0.0034, corr=+0.217, dir_acc=0.564
----------------------------------------------------------------------

Mode Distribution:
  HEALTHY:           305 days ( 24.2%)
  DEGRADED:           21 days (  1.7%)
  UNIDIRECTIONAL:    885 days ( 70.2%)
  WEAK_COLLAPSE:      31 days (  2.5%)
  STRONG_COLLAPSE:    18 days (  1.4%)

  Total problematic:  955 days (75.8%)

[WARN] STRUCTURAL COLLAPSE DETECTED
[WARN] PREDICTION QUALITY DEGRADATION DETECTED
======================================================================

Creating diagnostic plots...
Regression diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_h16_enc_40/evaluation/diagnostic_plots.png
Quality diagnostic plots saved to: experiments/00_baseline_exploration/sweep2_h16_enc_40/evaluation/quality_diagnostics.png
Saving results...

======================================================================
EVALUATION RESULTS
======================================================================

STATISTICAL METRICS:
  MSE:              1.162594
  RMSE:             1.078237
  MAE:              0.768543
  Out-of-sample RÂ²: 0.0036

FINANCIAL METRICS:
  Directional Acc:  53.33%
  Sharpe Ratio:     0.9160
  Total Return:     101.56%
  Max Drawdown:     -21.95%
  Hit Rate:         51.59%
  Number of Trades: 1214

CLASSIFICATION METRICS (Binary Up/Down):
  Precision:        0.5354
  Recall:           0.9644
  F1 Score:         0.6886
  AUC-ROC:          0.5174

  Confusion Matrix:
                   Predicted Down  Predicted Up
  Actual Down:         22             564
  Actual Up:           24             650

ALPHA (vs Buy-and-Hold):
  Excess Return:    9.16%

======================================================================

Results saved to: experiments/00_baseline_exploration/sweep2_h16_enc_40/evaluation
  - predictions.csv
  - evaluation_metrics.json
  - diagnostic_plots.png
  - performance_plots.png
  - evaluation_<timestamp>.log

Evaluation completed at: 2025-10-30 03:15:04
======================================================================
