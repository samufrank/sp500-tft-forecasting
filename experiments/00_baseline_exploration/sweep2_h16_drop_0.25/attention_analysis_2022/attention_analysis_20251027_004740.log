Logging to: experiments/00_baseline_exploration/sweep2_h16_drop_0.25/attention_analysis/attention_analysis_20251027_004740.log
Analysis started at: 2025-10-27 00:47:40
======================================================================
Experiment: 00_baseline_exploration/sweep2_h16_drop_0.25
Output directory: experiments/00_baseline_exploration/sweep2_h16_drop_0.25/attention_analysis
Using best checkpoint: experiments/00_baseline_exploration/sweep2_h16_drop_0.25/checkpoints/tft-epoch=01-val_loss=0.1260.ckpt

Loading data...
Loading test data from: data/splits/fixed/core_proposal_daily_fixed_test.csv
  Train samples: 6066
  Test samples: 1300

Preparing test dataset...
Test dataset size after filtering: 1280

Loading model...
Loading model from: experiments/00_baseline_exploration/sweep2_h16_drop_0.25/checkpoints/tft-epoch=01-val_loss=0.1260.ckpt

Extracting attention patterns...
Extracting attention patterns...
Total batches to process: 10
  Processed 10/10 batches

Total predictions: 1280
Total actuals: 1280
Attention shape: (1280, 20)
Encoder variables shape: (1280, 5)

Prediction period: 2020-08-19T00:00:00.000000000 to 2025-10-06T00:00:00.000000000
Total predictions: 1280

Creating temporal periods:
  2022-H1: 2022-01-01 to 2022-06-30 (124 samples)
  2022-H2: 2022-07-01 to 2022-12-31 (125 samples)

Attention over 20 encoder timesteps

Analyzing attention patterns by period...

Comparing attention patterns across periods...

Creating visualizations...
Saved attention heatmap: experiments/00_baseline_exploration/sweep2_h16_drop_0.25/attention_analysis/attention_heatmap.png
Saved attention trends: experiments/00_baseline_exploration/sweep2_h16_drop_0.25/attention_analysis/attention_trends.png
Saved feature importance comparison: experiments/00_baseline_exploration/sweep2_h16_drop_0.25/attention_analysis/temporal_attention_comparison.png

Saving results...
Saved results: experiments/00_baseline_exploration/sweep2_h16_drop_0.25/attention_analysis/attention_analysis_results.json

======================================================================
ATTENTION ANALYSIS SUMMARY
======================================================================

Per-Period Statistics:
----------------------------------------------------------------------

2022-H1:
  Samples: 124
  Entropy: 2.9830 ± 0.0138
  Concentration: 0.0502
  Top 5 features:
    t-20                           0.0595
    t-19                           0.0547
    t-18                           0.0525
    t-1                            0.0512
    t-2                            0.0511

2022-H2:
  Samples: 125
  Entropy: 2.9831 ± 0.0060
  Concentration: 0.0511
  Top 5 features:
    t-20                           0.0732
    t-19                           0.0657
    t-18                           0.0601
    t-17                           0.0550
    t-16                           0.0515

----------------------------------------------------------------------
Period Comparisons:
----------------------------------------------------------------------

2022-H1_vs_2022-H2:
  Cosine similarity: 0.9943
  L2 distance: 0.0241
  Entropy change: 0.0000
  Concentration change: 0.0010

======================================================================

Analysis complete!
Results saved to: experiments/00_baseline_exploration/sweep2_h16_drop_0.25/attention_analysis
  - attention_analysis_results.json
  - attention_heatmap.png
  - attention_trends.png
  - temporal_attention_comparison.png
